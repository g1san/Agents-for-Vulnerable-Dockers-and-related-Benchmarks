# CVE-2022-46169 Vulnerable Cacti Environment

This Docker setup creates a vulnerable Cacti instance (version 1.2.22) that is susceptible to the CVE-2022-46169 vulnerability, which allows for authentication bypass and remote code execution.

## Warning

**DO NOT USE THIS IN A PRODUCTION ENVIRONMENT OR ON A PUBLIC NETWORK!**

This environment is intentionally vulnerable and should only be used for security research, education, and testing in isolated environments.

## Setup

1. Build and start the containers:
   ```
   docker compose up -d
   ```

2. Access Cacti at `http://localhost:8080`
   - Username: admin
   - Password: admin

3. The system will automatically configure a default poller and host to facilitate exploitation.

## Testing the Vulnerability

The vulnerability exists in the `remote_agent.php` file, allowing unauthenticated attackers to execute commands by manipulating the `poller_id`, `host_id`, and `local_data_ids` parameters.

A sample exploit request might look like:

```
curl 'http://localhost:8080/remote_agent.php' \
  -d 'action=polldata' \
  -d 'poller_id=1' \
  -d 'host_id=1' \
  -d 'local_data_ids[]=1;id'
```

The above command should execute the `id` command on the server if the vulnerability is present.

## Remediation

In a real environment, you would:
1. Update Cacti to version 1.2.23 or newer
2. Restrict access to the Cacti web interface
3. Implement WAF rules to block malicious requests

## Cleanup

To remove all containers and data:
```
docker compose down -v
```