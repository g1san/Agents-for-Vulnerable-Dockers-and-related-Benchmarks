CREATE DATABASE IF NOT EXISTS cacti;
USE cacti;

-- Import Cacti schema (simplified; in practice, use official schema)
-- For brevity, we include only the necessary tables and data
CREATE TABLE poller (
    id INT AUTO_INCREMENT PRIMARY KEY,
    hostname VARCHAR(255) NOT NULL
);

CREATE TABLE poller_item (
    id INT AUTO_INCREMENT PRIMARY KEY,
    host_id INT NOT NULL,
    local_data_id INT NOT NULL,
    poller_id INT NOT NULL,
    action INT NOT NULL,
    arg1 TEXT
);

-- Insert a poller with the container's IP (bypassable via Forwarded-For)
INSERT INTO poller (hostname) VALUES ('cacti');

-- Insert a poller_item with POLLER_ACTION_SCRIPT_PHP (action = 2)
INSERT INTO poller_item (host_id, local_data_id, poller_id, action, arg1)
VALUES (1, 1, 1, 2, 'script.php');

-- Create a default admin user for Cacti login (optional for testing)
CREATE TABLE user_auth (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL,
    password VARCHAR(255) NOT NULL,
    enabled CHAR(1) DEFAULT '1'
);

INSERT INTO user_auth (username, password)
VALUES ('admin', MD5('admin')); -- Default password: admin