#!/bin/bash
set -e

# Wait for MySQL to be ready and verify credentials
until mysql -h "$DB_HOST" -u "$DB_USER" -p"$DB_PASS" -e "USE cacti; SELECT 1"; do
  >&2 echo "MySQL is unavailable or cacti DB not ready - sleeping"
  sleep 2
done

exec "$@"