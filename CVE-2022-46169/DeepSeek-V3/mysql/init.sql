-- Reset root password and privileges (if coming from previous failed attempts)
ALTER USER 'root'@'%' IDENTIFIED BY 'insecure_root_pass';
ALTER USER 'root'@'localhost' IDENTIFIED BY 'insecure_root_pass';

-- Create database if not exists
CREATE DATABASE IF NOT EXISTS cacti;

-- Create user and grant privileges (full permissions)
GRANT ALL PRIVILEGES ON cacti.* TO 'cactiuser'@'%' IDENTIFIED BY 'cactipass' WITH GRANT OPTION;
GRANT ALL PRIVILEGES ON *.* TO 'cactiuser'@'%' WITH GRANT OPTION;

-- Flush privileges
FLUSH PRIVILEGES;

-- Initialize Cacti database schema
USE cacti;
SOURCE /var/www/html/cacti.sql;