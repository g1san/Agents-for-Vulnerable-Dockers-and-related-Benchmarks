'code': CodeGenerationResult(
file_name=['docker-compose.yml', 'cacti/Dockerfile', 'cacti/config.php', 'cacti/remote_agent.php'],
file_code=['version: \'3.7\'\nservices:\n  cacti:\n    build: ./cacti\n    ports:\n      - "8080:80"\n    depends_on:\n      - db\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: cacti\n      MYSQL_USER: cactiuser\n      MYSQL_PASSWORD: cactipass\n    volumes:\n      - db_data:/var/lib/mysql\nvolumes:\n  db_data:', 'FROM php:7.4-apache\n\nRUN apt-get update && \\\n    apt-get install -y librrd-dev libsnmp-dev git && \\\n    docker-php-ext-install mysqli && \\\n    a2enmod rewrite\n\nCOPY config.php /var/www/html/config.php\nCOPY remote_agent.php /var/www/html/remote_agent.php\n\nRUN echo "ServerName localhost" >> /etc/apache2/apache2.conf\n\nCMD ["apache2-foreground"]', '<?php\n// config.php\n$database_type = "mysql";\n$database_default = "cacti";\n$database_hostname = "db";\n$database_username = "cactiuser";\n$database_password = "cactipass";\n$database_port = "3306";\n$database_ssl = false;\n?>', '<?php\n// remote_agent.php\n// This is a vulnerable script for demonstration purposes only.\n\nif (isset($_GET[\'cmd\'])) {\n    $cmd = $_GET[\'cmd\'];\n    // Vulnerable to command injection\n    system($cmd);\n} else {\n    echo "No command provided.";\n}\n?>'],
directory_tree='CVE-2022-46169/
├── docker-compose.yml
└── cacti/
    ├── Dockerfile
    ├── config.php
    └── remote_agent.php',
),