{
    "desc": "CVE-2021-25646 is a critical vulnerability in Apache Druid, a real-time analytics database and distributed data processing system used for large-scale data processing and real-time multi-dimensional OLAP analysis. The vulnerability allows for remote code execution due to improper input validation in the Druid API. Specifically, it involves a flaw in the \"/druid/indexer/v1/sampler\" endpoint, where an attacker can exploit the \"javascript\" type filter function to execute arbitrary code on the server. By crafting a malicious payload, an attacker can issue commands to the server, such as opening a reverse shell. This vulnerability can be exploited remotely without authentication, posing a significant security risk. The issue arises from a lack of authentication in Apache Druid by default, allowing attackers to construct malicious requests to execute arbitrary code and control servers. This affects Apache Druid versions 0.20.0 and earlier. Apache has released a new version, 0.20.1, to address this vulnerability, and users are advised to update to this version to mitigate the risk.",
    "attack_type": "Remote Code Execution",
    "services": [
        {
            "name": "apache/druid",
            "version": [
                "0.20.0",
                "0.19.0",
                "0.18.1",
                "0.18.0",
                "0.17.1",
                "0.17.0",
                "0.16.0",
                "0.15.1",
                "0.15.0"
            ],
            "dependency_type": "HARD",
            "description": "Apache Druid is the service with the vulnerability. Versions 0.20.0 and earlier are affected by CVE-2021-25646, allowing for remote code execution."
        },
        {
            "name": "zookeeper",
            "version": [
                "3.5.9"
            ],
            "dependency_type": "SOFT-CACHE",
            "description": "ZooKeeper is used for coordination in distributed systems and is a common dependency for Apache Druid, needed to manage the Druid cluster."
        },
        {
            "name": "mysql",
            "version": [
                "5.7"
            ],
            "dependency_type": "SOFT-DB",
            "description": "MySQL is often used as a metadata store for Apache Druid, storing information about data segments and configurations."
        }
    ],
    "input_tokens": 6413,
    "output_tokens": 739
}