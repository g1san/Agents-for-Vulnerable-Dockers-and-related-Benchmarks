FROM atlassian/confluence-server:8.5.2

# Ensure necessary SLF4J binding is included and remove others
RUN apt-get update && apt-get install -y \
    wget \
    && rm -rf /var/lib/apt/lists/*

# Add SLF4J binding for logging
ADD https://repo1.maven.org/maven2/org/slf4j/slf4j-log4j12/1.7.30/slf4j-log4j12-1.7.30.jar /opt/atlassian/confluence/confluence/WEB-INF/lib/

# Use an available version of confluence-logging
ADD https://repo1.maven.org/maven2/com/atlassian/confluence/confluence-logging/7.10.0/confluence-logging-7.10.0.jar /opt/atlassian/confluence/confluence/WEB-INF/lib/

# CMD is already set in the base image
CMD ["/opt/atlassian/confluence/bin/start-confluence.sh", "-fg"]
