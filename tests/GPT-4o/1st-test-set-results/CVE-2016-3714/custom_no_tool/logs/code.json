{
    "files": [
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/docker-compose.yml",
            "content": "version: '3'\nservices:\n  web:\n    build: ./web\n    ports:\n      - \"8080:80\"\n    volumes:\n      - ./web/html:/var/www/html\n    depends_on:\n      - imagemagick\n\n  imagemagick:\n    build: ./imagemagick\n    ports:\n      - \"8081:80\"\n    volumes:\n      - ./imagemagick/images:/images\n    command: [\"/usr/sbin/apache2ctl\", \"-D\", \"FOREGROUND\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/web/Dockerfile",
            "content": "FROM php:7.4-apache\n\n# Install dependencies for PHP imagick extension\nRUN apt-get update && \\\n    apt-get install -y libmagickwand-dev && \\\n    pecl install imagick && \\\n    docker-php-ext-enable imagick && \\\n    rm -rf /var/lib/apt/lists/*\n\nCOPY html/ /var/www/html/\n\nRUN docker-php-ext-install mysqli\n\nEXPOSE 80\n"
        },
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/web/html/index.php",
            "content": "<?php\n$target_dir = \"/images/\";\n$target_file = $target_dir . basename($_FILES[\"fileToUpload\"][\"name\"]);\n$uploadOk = 1;\n$imageFileType = strtolower(pathinfo($target_file,PATHINFO_EXTENSION));\n\nif(isset($_POST[\"submit\"])) {\n    $check = getimagesize($_FILES[\"fileToUpload\"][\"tmp_name\"]);\n    if($check !== false) {\n        echo \"File is an image - \" . $check[\"mime\"] . \".\";\n        $uploadOk = 1;\n    } else {\n        echo \"File is not an image.\";\n        $uploadOk = 0;\n    }\n}\n\nif ($uploadOk == 0) {\n    echo \"Sorry, your file was not uploaded.\";\n} else {\n    if (move_uploaded_file($_FILES[\"fileToUpload\"][\"tmp_name\"], $target_file)) {\n        echo \"The file \". htmlspecialchars( basename( $_FILES[\"fileToUpload\"][\"name\"])) . \" has been uploaded.\";\n        // Process the image using ImageMagick via PHP Imagick extension\n        $imagick = new Imagick($target_file);\n        $imagick->writeImage('/images/output.png');\n        echo \"Image processed.\";\n    } else {\n        echo \"Sorry, there was an error uploading your file.\";\n    }\n}\n?>\n\n<!DOCTYPE html>\n<html>\n<body>\n\n<form action=\"index.php\" method=\"post\" enctype=\"multipart/form-data\">\n    Select image to upload:\n    <input type=\"file\" name=\"fileToUpload\" id=\"fileToUpload\">\n    <input type=\"submit\" value=\"Upload Image\" name=\"submit\">\n</form>\n\n</body>\n</html>\n"
        },
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/imagemagick/Dockerfile",
            "content": "FROM ubuntu:18.04\n\nRUN apt-get update && \\\n    apt-get install -y wget build-essential apache2 && \\\n    mkdir /images && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Download and build ImageMagick 6.9.3-9\nRUN wget https://www.imagemagick.org/download/releases/ImageMagick-6.9.3-9.tar.gz && \\\n    tar xvzf ImageMagick-6.9.3-9.tar.gz && \\\n    cd ImageMagick-6.9.3-9 && \\\n    ./configure && \\\n    make && \\\n    make install && \\\n    ldconfig && \\\n    cd .. && \\\n    rm -rf ImageMagick-6.9.3-9.tar.gz ImageMagick-6.9.3-9\n\nCOPY ./apache-config.conf /etc/apache2/sites-available/000-default.conf\n\nEXPOSE 80\n\nCMD [\"/usr/sbin/apache2ctl\", \"-D\", \"FOREGROUND\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/imagemagick/apache-config.conf",
            "content": "<VirtualHost *:80>\n    DocumentRoot /var/www/html\n    <Directory /var/www/html>\n        Options Indexes FollowSymLinks\n        AllowOverride All\n        Require all granted\n    </Directory>\n\n    Alias /images/ \"/images/\"\n    <Directory \"/images\">\n        Options Indexes MultiViews\n        AllowOverride None\n        Require all granted\n    </Directory>\n\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n</VirtualHost>\n"
        }
    ],
    "directory_tree": "CVE-2016-3714/\n\u251c\u2500\u2500 custom_no_tool\n\u2502   \u251c\u2500\u2500 docker-compose.yml\n\u2502   \u251c\u2500\u2500 imagemagick\n\u2502   \u2502   \u251c\u2500\u2500 apache-config.conf\n\u2502   \u2502   \u2514\u2500\u2500 Dockerfile\n\u2502   \u2514\u2500\u2500 web\n\u2502       \u251c\u2500\u2500 Dockerfile\n\u2502       \u2514\u2500\u2500 html\n\u2502           \u2514\u2500\u2500 index.php\n"
}