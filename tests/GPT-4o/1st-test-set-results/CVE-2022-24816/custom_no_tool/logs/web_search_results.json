{
    "desc": "CVE-2022-24816 is a critical code injection vulnerability in the jt-jiffle extension of GeoServer, primarily affecting versions prior to JAI-EXT 1.1.22. This vulnerability allows unauthenticated remote code execution by exploiting Jiffle scripts, which are compiled into Java code using the Janino compiler. The vulnerability arises from the improper handling of Jiffle scripts, which are used for image processing. These scripts are converted into Java source code without properly escaping comments, allowing an attacker to inject Java code. This can be exploited by sending a crafted Web Processing Service (WPS) XML request to the GeoServer's WMS endpoint, which is accessible without authentication. The vulnerability has a CVSS score of 9.8 to 10.0, indicating its high to critical severity. Exploitation requires no privileges or user interaction and is network-based. To mitigate, users should upgrade to version 1.1.22 or later, or remove the janino-x.y.z.jar from the classpath if unable to upgrade.",
    "attack_type": "Remote Code Execution",
    "services": [
        {
            "name": "geoserver",
            "version": [
                "1.1.1"
            ],
            "dependency_type": "HARD",
            "description": "GeoServer is the main service affected by CVE-2022-24816, specifically in its jt-jiffle extension, which is vulnerable to code injection attacks."
        },
        {
            "name": "openjdk",
            "version": [
                "8-jre"
            ],
            "dependency_type": "SOFT",
            "description": "OpenJDK is required to run GeoServer, as it is a Java-based application."
        },
        {
            "name": "nginx",
            "version": [
                "1.21.6"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx is used as a reverse proxy to handle web requests to GeoServer."
        }
    ],
    "input_tokens": 8065,
    "output_tokens": 943
}