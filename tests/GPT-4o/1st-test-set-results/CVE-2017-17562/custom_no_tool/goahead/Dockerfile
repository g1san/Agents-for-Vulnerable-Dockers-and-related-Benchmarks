FROM alpine:3.6

RUN apk add --no-cache \
    build-base \
    git \
    libc-dev \
    libgcc \
    libstdc++ \
    linux-headers \
    make \
    openssl-dev \
    pcre-dev \
    zlib-dev

WORKDIR /app

RUN git clone https://github.com/embedthis/goahead.git \
    && cd goahead \
    && git checkout c5c7f7b

RUN cd goahead \
    && make

COPY cgi-bin /app/goahead/web/cgi-bin

CMD ["/app/goahead/build/linux-x86/bin/goahead", "--home", "/app/goahead/web", "--port", "80"]
