{
    "desc": "CVE-2023-46604 is a deserialization vulnerability in Apache ActiveMQ's OpenWire protocol, which affects both ActiveMQ Classic and ActiveMQ Artemis brokers, as well as Java-based OpenWire clients. This vulnerability allows remote code execution (RCE) by enabling a remote attacker with network access to execute arbitrary shell commands. The attack is achieved by manipulating serialized class types in the OpenWire protocol, which can cause the client or broker to instantiate any class on the classpath. Specifically, for ActiveMQ Classic, the vulnerability can be exploited using the `ClassPathXmlApplicationContext` from Spring dependencies to load a malicious XML configuration file over HTTP. ActiveMQ Artemis includes the vulnerable code, though it does not ship with Spring, making exploitation less straightforward. Users are advised to upgrade to specific versions to mitigate this vulnerability.",
    "attack_type": "Remote Code Execution",
    "services": [
        {
            "name": "rmohr/activemq",
            "version": [
                "5.15.15"
            ],
            "dependency_type": "HARD",
            "description": "Apache ActiveMQ Classic is the primary service affected by CVE-2023-46604, which allows remote code execution through the OpenWire protocol deserialization vulnerability."
        },
        {
            "name": "openjdk",
            "version": [
                "8-jdk-alpine"
            ],
            "dependency_type": "SOFT",
            "description": "Java is required to run the ActiveMQ broker since ActiveMQ is a Java-based application."
        },
        {
            "name": "nginx",
            "version": [
                "1.21.6"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "A web server like Nginx is needed to serve the malicious XML configuration file over HTTP, which is part of the exploit for CVE-2023-46604."
        }
    ],
    "input_tokens": 4341,
    "output_tokens": 776
}