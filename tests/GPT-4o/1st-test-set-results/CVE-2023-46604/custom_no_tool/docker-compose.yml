services:
  activemq:
    image: rmohr/activemq:5.15.15
    container_name: activemq
    ports:
      - "61616:61616"  # OpenWire port
      - "8161:8161"    # Web Console
    environment:
      ACTIVEMQ_ADMIN_LOGIN: admin
      ACTIVEMQ_ADMIN_PASSWORD: admin

  nginx:
    image: nginx:1.21.6
    container_name: nginx
    ports:
      - "8080:80"  # HTTP port
    volumes:
      - ./nginx/html:/usr/share/nginx/html

  openjdk:
    image: openjdk:8-jdk-slim
    container_name: openjdk
    volumes:
      - ./malicious:/app
    command: ["sh", "-c", "cd /app && javac Exploit.java && java Exploit"]
    depends_on:
      - activemq
      - nginx
    networks:
      - default

networks:
  default:
    driver: bridge
