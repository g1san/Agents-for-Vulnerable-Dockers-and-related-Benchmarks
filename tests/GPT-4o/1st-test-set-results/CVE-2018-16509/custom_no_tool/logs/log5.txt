time="2025-11-11T05:21:27+01:00" level=warning msg="/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2018-16509/custom_no_tool/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
#1 [internal] load local bake definitions
#1 reading from stdin 2.05kB done
#1 DONE 0.0s

#2 [ghostscript internal] load build definition from Dockerfile
#2 transferring dockerfile: 499B done
#2 DONE 0.0s

#3 [imagemagick internal] load build definition from Dockerfile
#3 transferring dockerfile: 514B done
#3 DONE 0.0s

#4 [python internal] load build definition from Dockerfile
#4 transferring dockerfile: 205B done
#4 DONE 0.0s

#5 [python internal] load metadata for docker.io/library/python:3.7.0-slim
#5 ...

#6 [imagemagick internal] load metadata for docker.io/library/ubuntu:18.04
#6 DONE 0.4s

#7 [imagemagick internal] load .dockerignore
#7 transferring context: 2B done
#7 DONE 0.0s

#8 [ghostscript internal] load metadata for docker.io/library/debian:bullseye-slim
#8 DONE 0.5s

#9 [ghostscript internal] load .dockerignore
#9 transferring context: 2B done
#9 DONE 0.0s

#5 [python internal] load metadata for docker.io/library/python:3.7.0-slim
#5 DONE 0.5s

#10 [imagemagick 1/2] FROM docker.io/library/ubuntu:18.04@sha256:152dc042452c496007f07ca9127571cb9c29697f42acbfad72324b2bb2e43c98
#10 resolve docker.io/library/ubuntu:18.04@sha256:152dc042452c496007f07ca9127571cb9c29697f42acbfad72324b2bb2e43c98 0.0s done
#10 DONE 0.0s

#11 [imagemagick 2/2] RUN apt-get update     && apt-get install -y wget build-essential imagemagick     && wget https://github.com/ArtifexSoftware/ghostpdl-downloads/releases/download/gs923/ghostscript-9.23.tar.gz     && tar -xzf ghostscript-9.23.tar.gz     && cd ghostscript-9.23     && ./configure     && make     && make install     && apt-get clean     && rm -rf /var/lib/apt/lists/* /ghostscript-9.23 /ghostscript-9.23.tar.gz
#11 CACHED

#12 [python internal] load .dockerignore
#12 transferring context: 2B done
#12 DONE 0.0s

#13 [ghostscript 1/2] FROM docker.io/library/debian:bullseye-slim@sha256:75e0b7a6158b4cc911d4be07d9f6b8a65254eb8c58df14023c3da5c462335593
#13 resolve docker.io/library/debian:bullseye-slim@sha256:75e0b7a6158b4cc911d4be07d9f6b8a65254eb8c58df14023c3da5c462335593 0.0s done
#13 DONE 0.0s

#14 [python internal] load build context
#14 transferring context: 757B done
#14 DONE 0.0s

#15 [ghostscript 2/2] RUN apt-get update     && apt-get install -y wget build-essential     && wget https://github.com/ArtifexSoftware/ghostpdl-downloads/releases/download/gs923/ghostscript-9.23.tar.gz     && tar -xzf ghostscript-9.23.tar.gz     && cd ghostscript-9.23     && ./configure     && make     && make install     && apt-get clean     && rm -rf /var/lib/apt/lists/* /ghostscript-9.23 /ghostscript-9.23.tar.gz
#15 CACHED

#16 [ghostscript] exporting to image
#16 exporting layers done
#16 exporting manifest sha256:73a8e4621f1f9bc53a28812b73417b7881ae26f16af86a575f7063d49788d0ae done
#16 exporting config sha256:d7a76139121d226e97357f92a2a5478bd439aaf4960d82c8c23e72ea3b3a426b
#16 ...

#17 [python 1/3] FROM docker.io/library/python:3.7.0-slim@sha256:9d7187226f875b77adb835036936f93718174638132adcdfa1629844a4f26fa2
#17 resolve docker.io/library/python:3.7.0-slim@sha256:9d7187226f875b77adb835036936f93718174638132adcdfa1629844a4f26fa2 0.1s done
#17 DONE 0.1s

#18 [python 2/3] RUN pip install --upgrade pip     && pip install Pillow
#18 CACHED

#19 [imagemagick] exporting to image
#19 exporting layers done
#19 exporting manifest sha256:dfb463a27de380326d883bdaac8bc391375b6e9fe3dcea322630bc793388bb1c done
#19 exporting config sha256:70729af1a8a6cbbcfef7962c5a6ccac1f31fd02f9f04e5cae36154da0de4b222 done
#19 exporting attestation manifest sha256:eccd952ff6ffd5efed7d90e4dda1287b484a82b654fdb97050e67ab216c51ac6 0.0s done
#19 exporting manifest list sha256:47d328e87435ac63181dedf907b8486cf8d17c64440afc84d60bc907a58fa32f 0.0s done
#19 naming to docker.io/library/custom_no_tool-imagemagick:latest done
#19 unpacking to docker.io/library/custom_no_tool-imagemagick:latest 0.0s done
#19 DONE 0.1s

#16 [ghostscript] exporting to image
#16 exporting config sha256:d7a76139121d226e97357f92a2a5478bd439aaf4960d82c8c23e72ea3b3a426b done
#16 exporting attestation manifest sha256:272578bf2867f251236032f909245a57822f151318926001c6ff18b38e10b759 0.1s done
#16 exporting manifest list sha256:5a689ce111454d91b21243721b805a3124b58a9c1dea06316a5d56759c187af5 0.0s done
#16 naming to docker.io/library/custom_no_tool-ghostscript:latest
#16 naming to docker.io/library/custom_no_tool-ghostscript:latest 0.0s done
#16 unpacking to docker.io/library/custom_no_tool-ghostscript:latest 0.0s done
#16 DONE 0.2s

#20 [python 3/3] COPY exploit.py /usr/src/app/exploit.py
#20 DONE 0.1s

#21 [python] exporting to image
#21 exporting layers 0.2s done
#21 exporting manifest sha256:0104390c6f75a71108e444f2b1e5768ecae5f184d11598a54e92e71e326c93ae 0.0s done
#21 exporting config sha256:3ec0be7e21be41b8b4cff81ce100b40f51d7da1a19c406b835d39db7f959a1af 0.0s done
#21 exporting attestation manifest sha256:2f4af96d33b18b683e8581cdce8ae8c0ea515b8b4ca50220df1f703646eceadf 0.0s done
#21 exporting manifest list sha256:c2b90f985797bfc85bdb0f7416613ca9e588bd5c2ff16ef45bf94b8843f53c5f
#21 exporting manifest list sha256:c2b90f985797bfc85bdb0f7416613ca9e588bd5c2ff16ef45bf94b8843f53c5f 0.0s done
#21 naming to docker.io/library/custom_no_tool-python:latest done
#21 unpacking to docker.io/library/custom_no_tool-python:latest 0.0s done
#21 DONE 0.4s

#22 [imagemagick] resolving provenance for metadata file
#22 DONE 0.0s

#23 [ghostscript] resolving provenance for metadata file
#23 DONE 0.0s

#24 [python] resolving provenance for metadata file
#24 DONE 0.0s
 custom_no_tool-python  Built
 custom_no_tool-ghostscript  Built
 custom_no_tool-imagemagick  Built
 Network custom_no_tool_default  Creating
 Network custom_no_tool_default  Created
 Container ghostscript_vulnerable  Creating
 Container ghostscript_vulnerable  Created
 Container python_script  Creating
 Container imagemagick_vulnerable  Creating
 Container imagemagick_vulnerable  Created
 Container python_script  Created
 Container ghostscript_vulnerable  Starting
 Container ghostscript_vulnerable  Started
 Container imagemagick_vulnerable  Starting
 Container python_script  Starting
 Container python_script  Started
 Container imagemagick_vulnerable  Started


sudo docker logs 98d11b9fdb00d50f8efef8468c70301bc5032bd9f08b77f68aaee8b3f7556549 --details
STDOUT:  GPL Ghostscript 9.23 (2018-03-21)
 Copyright (C) 2018 Artifex Software, Inc.  All rights reserved.
 Usage: gs [switches] [file1.ps file2.ps ...]
 Most frequently used switches: (you can use # in place of =)
  -dNOPAUSE           no pause after page   | -q       `quiet', fewer messages
  -g<width>x<height>  page size in pixels   | -r<res>  pixels/inch resolution
  -sDEVICE=<devname>  select device         | -dBATCH  exit after last file
  -sOutputFile=<file> select output file: - for stdout, |command for pipe,
                                          embed %d or %ld for page #
 Input formats: PostScript PostScriptLevel1 PostScriptLevel2 PostScriptLevel3 PDF
 Default output device: bbox
 Available devices:
    alc1900 alc2000 alc4000 alc4100 alc8500 alc8600 alc9100 ap3250 atx23
    atx24 atx38 bbox bit bitcmyk bitrgb bitrgbtags bj10e bj10v bj10vh bj200
    bjc600 bjc800 bjc880j bjccmyk bjccolor bjcgray bjcmono bmp16 bmp16m
    bmp256 bmp32b bmpgray bmpmono bmpsep1 bmpsep8 ccr cdeskjet cdj1600 cdj500
    cdj550 cdj670 cdj850 cdj880 cdj890 cdj970 cdjcolor cdjmono cdnj500 cfax
    chp2200 cif cljet5 cljet5c cljet5pr coslw2p coslwxl declj250 deskjet
    devicen dfaxhigh dfaxlow dj505j djet500 djet500c dl2100 dnj650c epl2050
    epl2050p epl2120 epl2500 epl2750 epl5800 epl5900 epl6100 epl6200 eplcolor
    eplmono eps2write eps9high eps9mid epson epsonc escp escpage faxg3
    faxg32d faxg4 fmlbp fmpr fpng fs600 gdi gprf hl1240 hl1250 hl7x0
    hpdj1120c hpdj310 hpdj320 hpdj340 hpdj400 hpdj500 hpdj500c hpdj510
    hpdj520 hpdj540 hpdj550c hpdj560c hpdj600 hpdj660c hpdj670c hpdj680c
    hpdj690c hpdj850c hpdj855c hpdj870c hpdj890c hpdjplus hpdjportable ibmpro
    ijs imagen inferno ink_cov inkcov itk24i itk38 jetp3852 jj100 jpeg
    jpegcmyk jpeggray la50 la70 la75 la75plus laserjet lbp310 lbp320 lbp8
    lex2050 lex3200 lex5700 lex7000 lips2p lips3 lips4 lips4v lj250 lj3100sw
    lj4dith lj4dithp lj5gray lj5mono ljet2p ljet3 ljet3d ljet4 ljet4d
    ljet4pjl ljetplus ln03 lp1800 lp1900 lp2000 lp2200 lp2400 lp2500 lp2563
    lp3000c lp7500 lp7700 lp7900 lp8000 lp8000c lp8100 lp8200c lp8300c
    lp8300f lp8400f lp8500c lp8600 lp8600f lp8700 lp8800c lp8900 lp9000b
    lp9000c lp9100 lp9200b lp9200c lp9300 lp9400 lp9500c lp9600 lp9600s
    lp9800c lps4500 lps6500 lq850 lxm3200 lxm5700m m8510 md1xMono md2k
    md50Eco md50Mono md5k mgr4 mgr8 mgrgray2 mgrgray4 mgrgray8 mgrmono miff24
    mj500c mj6000c mj700v2c mj8000c ml600 necp6 npdl nullpage oce9050 oki182
    oki4w okiibm oprp opvp paintjet pam pamcmyk32 pamcmyk4 pbm pbmraw pcl3
    pclm pcx16 pcx24b pcx256 pcxcmyk pcxgray pcxmono pdfimage24 pdfimage32
    pdfimage8 pdfwrite pgm pgmraw pgnm pgnmraw photoex picty180 pj pjetxl
    pjxl pjxl300 pkm pkmraw pksm pksmraw plan plan9bm planc plang plank planm
    plib plibc plibg plibk plibm png16 png16m png256 png48 pngalpha pnggray
    pngmono pngmonod pnm pnmraw ppm ppmraw pr1000 pr1000_4 pr150 pr201
    ps2write psdcmyk psdcmykog psdrgb pxlcolor pxlmono r4081 rinkj rpdl
    samsunggdi sj48 spotcmyk st800 stcolor t4693d2 t4693d4 t4693d8 tek4696
    tiff12nc tiff24nc tiff32nc tiff48nc tiff64nc tiffcrle tiffg3 tiffg32d
    tiffg4 tiffgray tifflzw tiffpack tiffscaled tiffscaled24 tiffscaled32
    tiffscaled4 tiffscaled8 tiffsep tiffsep1 txtwrite uniprint xcf xes
    xpswrite
 Search path:
    %rom%Resource/Init/ : %rom%lib/ :
    /usr/local/share/ghostscript/9.23/Resource/Init :
    /usr/local/share/ghostscript/9.23/lib :
    /usr/local/share/ghostscript/9.23/Resource/Font :
    /usr/local/share/ghostscript/fonts :
    /usr/local/share/fonts/default/ghostscript :
    /usr/local/share/fonts/default/Type1 :
    /usr/local/share/fonts/default/TrueType : /usr/lib/DPS/outline/base :
    /usr/openwin/lib/X11/fonts/Type1 : /usr/openwin/lib/X11/fonts/TrueType
 Initialization files are compiled into the executable.
 For more information, see /usr/local/share/doc/ghostscript/9.23/Use.htm.
 Please report bugs to bugs.ghostscript.com.

STDERR: 



sudo docker inspect 98d11b9fdb00d50f8efef8468c70301bc5032bd9f08b77f68aaee8b3f7556549[
    {
        "Id": "98d11b9fdb00d50f8efef8468c70301bc5032bd9f08b77f68aaee8b3f7556549",
        "Created": "2025-11-11T04:21:28.925320911Z",
        "Path": "gs",
        "Args": [
            "-h"
        ],
        "State": {
            "Status": "exited",
            "Running": false,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 0,
            "ExitCode": 0,
            "Error": "",
            "StartedAt": "2025-11-11T04:21:29.140054533Z",
            "FinishedAt": "2025-11-11T04:21:29.318111966Z"
        },
        "Image": "sha256:5a689ce111454d91b21243721b805a3124b58a9c1dea06316a5d56759c187af5",
        "ResolvConfPath": "/var/lib/docker/containers/98d11b9fdb00d50f8efef8468c70301bc5032bd9f08b77f68aaee8b3f7556549/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/98d11b9fdb00d50f8efef8468c70301bc5032bd9f08b77f68aaee8b3f7556549/hostname",
        "HostsPath": "/var/lib/docker/containers/98d11b9fdb00d50f8efef8468c70301bc5032bd9f08b77f68aaee8b3f7556549/hosts",
        "LogPath": "/var/lib/docker/containers/98d11b9fdb00d50f8efef8468c70301bc5032bd9f08b77f68aaee8b3f7556549/98d11b9fdb00d50f8efef8468c70301bc5032bd9f08b77f68aaee8b3f7556549-json.log",
        "Name": "/ghostscript_vulnerable",
        "RestartCount": 0,
        "Driver": "overlayfs",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": null,
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "custom_no_tool_default",
            "PortBindings": {},
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "ConsoleSize": [
                0,
                0
            ],
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": null,
            "DnsOptions": null,
            "DnsSearch": null,
            "ExtraHosts": [],
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": false,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": null,
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": null,
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": null,
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": [
                "/proc/asound",
                "/proc/acpi",
                "/proc/interrupts",
                "/proc/kcore",
                "/proc/keys",
                "/proc/latency_stats",
                "/proc/timer_list",
                "/proc/timer_stats",
                "/proc/sched_debug",
                "/proc/scsi",
                "/sys/firmware",
                "/sys/devices/virtual/powercap"
            ],
            "ReadonlyPaths": [
                "/proc/bus",
                "/proc/fs",
                "/proc/irq",
                "/proc/sys",
                "/proc/sysrq-trigger"
            ]
        },
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "Mounts": [],
        "Config": {
            "Hostname": "98d11b9fdb00",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": true,
            "AttachStderr": true,
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
            ],
            "Cmd": [
                "gs",
                "-h"
            ],
            "Image": "custom_no_tool-ghostscript",
            "Volumes": null,
            "WorkingDir": "",
            "Entrypoint": null,
            "OnBuild": null,
            "Labels": {
                "com.docker.compose.config-hash": "eb21fd6d808070de3718787a81c6ab0028270b63a6a4de14afc44694bea7b16b",
                "com.docker.compose.container-number": "1",
                "com.docker.compose.depends_on": "",
                "com.docker.compose.image": "sha256:5a689ce111454d91b21243721b805a3124b58a9c1dea06316a5d56759c187af5",
                "com.docker.compose.oneoff": "False",
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.project.config_files": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2018-16509/custom_no_tool/docker-compose.yml",
                "com.docker.compose.project.working_dir": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2018-16509/custom_no_tool",
                "com.docker.compose.service": "ghostscript",
                "com.docker.compose.version": "2.40.3",
                "desktop.docker.io/wsl-distro": "Ubuntu"
            },
            "StopTimeout": 1
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "",
            "SandboxKey": "",
            "Ports": {},
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "",
            "Gateway": "",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "",
            "IPPrefixLen": 0,
            "IPv6Gateway": "",
            "MacAddress": "",
            "Networks": {
                "custom_no_tool_default": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": [
                        "ghostscript_vulnerable",
                        "ghostscript"
                    ],
                    "MacAddress": "",
                    "DriverOpts": null,
                    "GwPriority": 0,
                    "NetworkID": "d8a50baab7210207402bf09aed3b52b10382624393bcf015bbdabddebd4bb6f4",
                    "EndpointID": "",
                    "Gateway": "",
                    "IPAddress": "",
                    "IPPrefixLen": 0,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "DNSNames": [
                        "ghostscript_vulnerable",
                        "ghostscript",
                        "98d11b9fdb00"
                    ]
                }
            }
        },
        "ImageManifestDescriptor": {
            "mediaType": "application/vnd.oci.image.manifest.v1+json",
            "digest": "sha256:73a8e4621f1f9bc53a28812b73417b7881ae26f16af86a575f7063d49788d0ae",
            "size": 676,
            "platform": {
                "architecture": "amd64",
                "os": "linux"
            }
        }
    }
]