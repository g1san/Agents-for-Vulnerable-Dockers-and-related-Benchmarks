{
    "files": [
        {
            "location": "./../../dockers/CVE-2015-1427/custom_no_tool/docker-compose.yml",
            "content": "services:\n  elasticsearch:\n    build: .\n    container_name: es-vulnerable\n    environment:\n      - discovery.type=single-node\n      - ES_JAVA_OPTS=-Xms512m -Xmx512m\n    ports:\n      - \"9200:9200\"\n      - \"9300:9300\"\n    volumes:\n      - esdata:/usr/share/elasticsearch/data\n\nvolumes:\n  esdata:\n    driver: local\n"
        },
        {
            "location": "./../../dockers/CVE-2015-1427/custom_no_tool/Dockerfile",
            "content": "# Use AdoptOpenJDK 8 base image\nFROM adoptopenjdk:8-jdk-hotspot\n\n# Set environment variables\nENV ELASTICSEARCH_VERSION=1.3.7\nENV ES_HOME=/usr/share/elasticsearch\n\n# Install necessary packages and download Elasticsearch\nRUN apt-get update && \\\n    apt-get install -y wget && \\\n    wget https://download.elastic.co/elasticsearch/elasticsearch/elasticsearch-$ELASTICSEARCH_VERSION.tar.gz && \\\n    mkdir -p $ES_HOME && \\\n    tar -xzf elasticsearch-$ELASTICSEARCH_VERSION.tar.gz -C $ES_HOME --strip-components=1 && \\\n    rm elasticsearch-$ELASTICSEARCH_VERSION.tar.gz && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Copy configuration files\nCOPY elasticsearch.yml $ES_HOME/config/elasticsearch.yml\n\n# Set the default command to run Elasticsearch\nCMD [\"/usr/share/elasticsearch/bin/elasticsearch\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2015-1427/custom_no_tool/elasticsearch.yml",
            "content": "cluster.name: \"docker-cluster\"\nnetwork.host: 0.0.0.0\nscript.inline: on\nscript.indexed: on\n"
        },
        {
            "location": "./../../dockers/CVE-2015-1427/custom_no_tool/init.sh",
            "content": "#!/bin/bash\n# Script to initialize Elasticsearch with test data\n\n# Wait for Elasticsearch to start\nuntil curl -s http://localhost:9200/; do\n  echo \"Waiting for Elasticsearch...\"\n  sleep 2\n\ndone\n\n# Add test data\ncurl -XPOST 'http://localhost:9200/test_index/test_type/1' -H 'Content-Type: application/json' -d '{ \"message\": \"Test data\" }'\n\n# Restart Elasticsearch to apply changes\nservice elasticsearch restart\n"
        },
        {
            "location": "./../../dockers/CVE-2015-1427/custom_no_tool/README.md",
            "content": "# CVE-2015-1427 Vulnerable Environment\n\nThis setup uses Docker to create an environment vulnerable to CVE-2015-1427, a remote code execution vulnerability in Elasticsearch.\n\n## Setup Instructions\n\n1. Ensure Docker and Docker Compose are installed on your system.\n2. Navigate to the directory containing the `docker-compose.yml` file.\n3. Run the following command to start the environment:\n\n   ```bash\n   docker compose up --build\n   ```\n\n4. The Elasticsearch service will be available at `http://localhost:9200`.\n\n## Exploitation\n\nThe vulnerability can be tested by sending a crafted script to the Elasticsearch server. This setup is intended for educational and testing purposes only.\n\n## Note\n\n- This environment is intentionally vulnerable. Do not expose it to untrusted networks.\n- Dynamic scripting is enabled to demonstrate the vulnerability. In a production environment, this feature should be disabled or properly secured.\n"
        }
    ],
    "directory_tree": "CVE-2015-1427/\n  \u2514\u2500\u2500 custom_no_tool/\n      \u251c\u2500\u2500 docker-compose.yml\n      \u251c\u2500\u2500 Dockerfile\n      \u251c\u2500\u2500 elasticsearch.yml\n      \u251c\u2500\u2500 init.sh\n      \u2514\u2500\u2500 README.md"
}