FROM openjdk:8-jdk

# Set the H2 version
ENV H2_VERSION 1.4.197

# Download and extract H2
RUN mkdir -p /opt/h2
RUN curl -L https://repo1.maven.org/maven2/com/h2database/h2/${H2_VERSION}/h2-${H2_VERSION}.jar -o /opt/h2/h2.jar

# Set the working directory
WORKDIR /opt/h2

# Copy the init script
COPY init.sql /docker-entrypoint-initdb.d/

# Expose ports
EXPOSE 8082 1521

# Default command
CMD ["java", "-cp", "/opt/h2/h2.jar", "org.h2.tools.Server", "-web", "-webAllowOthers=false", "-tcp", "-tcpAllowOthers=false", "-webPort", "8082", "-tcpPort", "1521"]
