services:
  hadoop:
    build:
      context: ./hadoop
    container_name: hadoop
    environment:
      - CLUSTER_NAME=test
    volumes:
      - hadoop_data:/hadoop/dfs/name
    networks:
      - hadoop-net
    command: "/entrypoint.sh"

  datanode:
    build:
      context: ./hadoop
    container_name: datanode
    environment:
      - CLUSTER_NAME=test
    volumes:
      - hadoop_data:/hadoop/dfs/data
    networks:
      - hadoop-net
    depends_on:
      - hadoop
    command: "/entrypoint.sh"

  resourcemanager:
    build:
      context: ./hadoop
    container_name: resourcemanager
    environment:
      - CLUSTER_NAME=test
    networks:
      - hadoop-net
    depends_on:
      - hadoop
    command: "/entrypoint.sh"

  nodemanager:
    build:
      context: ./hadoop
    container_name: nodemanager
    environment:
      - CLUSTER_NAME=test
    networks:
      - hadoop-net
    depends_on:
      - resourcemanager
    command: "/entrypoint.sh"

  historyserver:
    build:
      context: ./hadoop
    container_name: historyserver
    environment:
      - CLUSTER_NAME=test
    networks:
      - hadoop-net
    depends_on:
      - hadoop
      - resourcemanager
    command: "/entrypoint.sh"

volumes:
  hadoop_data:

networks:
  hadoop-net:
    driver: bridge
