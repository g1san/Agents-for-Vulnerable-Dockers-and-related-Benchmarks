FROM adoptopenjdk:8-jdk-hotspot

# Install wget to download JMeter
RUN apt-get update && apt-get install -y wget && rm -rf /var/lib/apt/lists/*

# Set JMeter version
ENV JMETER_VERSION=3.2

# Download and extract JMeter
RUN wget https://archive.apache.org/dist/jmeter/binaries/apache-jmeter-${JMETER_VERSION}.tgz \
    && tar -xzf apache-jmeter-${JMETER_VERSION}.tgz \
    && mv apache-jmeter-${JMETER_VERSION} /opt/jmeter \
    && rm apache-jmeter-${JMETER_VERSION}.tgz

# Set JMeter home
ENV JMETER_HOME /opt/jmeter

# Add JMeter to the PATH
ENV PATH $JMETER_HOME/bin:$PATH

# Copy entrypoint script
COPY entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh

# Expose the RMI port
EXPOSE 1099

ENTRYPOINT ["/entrypoint.sh"]
