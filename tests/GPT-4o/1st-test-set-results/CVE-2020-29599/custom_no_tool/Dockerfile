# Use Ubuntu 20.04 as the base image
FROM ubuntu:20.04

# Install necessary packages for building ImageMagick
RUN apt-get update && \
    DEBIAN_FRONTEND=noninteractive apt-get install -y \
    build-essential \
    wget \
    libjpeg-dev \
    libpng-dev \
    libtiff-dev \
    libfreetype6-dev \
    libxml2-dev && \
    rm -rf /var/lib/apt/lists/*

# Download and build ImageMagick version 6.9.11-39
WORKDIR /tmp
RUN wget https://download.imagemagick.org/ImageMagick/download/releases/ImageMagick-6.9.11-39.tar.gz && \
    tar -xzf ImageMagick-6.9.11-39.tar.gz && \
    cd ImageMagick-6.9.11-39 && \
    ./configure && \
    make && \
    make install && \
    ldconfig && \
    cd .. && \
    rm -rf ImageMagick-6.9.11-39 ImageMagick-6.9.11-39.tar.gz

# Set the working directory
WORKDIR /scripts

# Copy the scripts into the container
COPY scripts /scripts

# Run a simple command to keep the container alive
CMD ["/bin/sh", "-c", "while :; do sleep 2073600; done"]
