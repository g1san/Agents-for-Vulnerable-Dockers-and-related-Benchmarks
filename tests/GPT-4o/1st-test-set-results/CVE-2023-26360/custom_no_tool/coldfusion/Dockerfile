FROM ubuntu:18.04

# Install necessary packages
RUN apt-get update && \
    apt-get install -y wget unzip openjdk-8-jdk-headless && \
    rm -rf /var/lib/apt/lists/*

# Set environment variables
ENV CF_HOME=/opt/coldfusion2018
ENV CFUSION_HOME=$CF_HOME/cfusion

# Copy ColdFusion installer
COPY coldfusion2018.0.15.zip /tmp/coldfusion.zip

# Install ColdFusion
RUN unzip /tmp/coldfusion.zip -d /tmp/coldfusion && \
    /tmp/coldfusion/install.sh -f /tmp/coldfusion/install.properties && \
    rm -rf /tmp/coldfusion /tmp/coldfusion.zip

# Copy application files
COPY . /app

# Set working directory
WORKDIR /app

# Expose necessary ports
EXPOSE 8500

# Start ColdFusion server
CMD ["/opt/coldfusion2018/cfusion/bin/coldfusion", "start"]
