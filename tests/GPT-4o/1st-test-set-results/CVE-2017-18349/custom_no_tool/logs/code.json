{
    "files": [
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/docker-compose.yml",
            "content": "version: '3.9'\n\nservices:\n  java-app:\n    build: ./java-app\n    ports:\n      - \"8080:8080\"\n\n  nginx:\n    image: nginx:1.21.3\n    ports:\n      - \"80:80\"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf:ro\n    depends_on:\n      - java-app\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/java-app/Dockerfile",
            "content": "FROM eclipse-temurin:8-jdk\n\nWORKDIR /app\n\nCOPY . .\n\n# Set executable permissions for the Maven Wrapper\nRUN chmod +x mvnw\n\n# Download and set up Maven Wrapper\nRUN ./mvnw -B -Dmaven.test.skip=true clean package\n\nCMD [\"java\", \"-jar\", \"target/vulnerable-app.jar\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/java-app/pom.xml",
            "content": "<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>com.example</groupId>\n    <artifactId>vulnerable-app</artifactId>\n    <version>1.0-SNAPSHOT</version>\n\n    <properties>\n        <maven.compiler.source>1.8</maven.compiler.source>\n        <maven.compiler.target>1.8</maven.compiler.target>\n    </properties>\n\n    <dependencies>\n        <dependency>\n            <groupId>com.alibaba</groupId>\n            <artifactId>fastjson</artifactId>\n            <version>1.2.24</version>\n        </dependency>\n    </dependencies>\n\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-compiler-plugin</artifactId>\n                <version>3.8.1</version>\n            </plugin>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n            </plugin>\n        </plugins>\n    </build>\n</project>\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/java-app/src/main/java/com/example/VulnerableApp.java",
            "content": "package com.example;\n\nimport com.alibaba.fastjson.JSON;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestBody;\nimport org.springframework.web.bind.annotation.RestController;\n\n@SpringBootApplication\npublic class VulnerableApp {\n\n    public static void main(String[] args) {\n        SpringApplication.run(VulnerableApp.class, args);\n    }\n\n    @RestController\n    public static class VulnerableController {\n\n        @PostMapping(\"/parse\")\n        public String parseJson(@RequestBody String jsonString) {\n            try {\n                Object obj = JSON.parseObject(jsonString, Object.class);\n                return \"Parsed: \" + obj.toString();\n            } catch (Exception e) {\n                return \"Error: \" + e.getMessage();\n            }\n        }\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/java-app/src/main/resources/application.properties",
            "content": "server.port=8080\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/nginx.conf",
            "content": "events {}\n\nhttp {\n    server {\n        listen 80;\n\n        location / {\n            proxy_pass http://java-app:8080;\n        }\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/java-app/mvnw",
            "content": "#!/bin/sh\n\n# ----------------------------------------------------------------------------\n# Licensed to the Apache Software Foundation (ASF) under one or more\n# contributor license agreements.  See the NOTICE file distributed with\n# this work for additional information regarding copyright ownership.\n# The ASF licenses this file to You under the Apache License, Version 2.0\n# (the \"License\"); you may not use this file except in compliance with\n# the License.  You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n# ----------------------------------------------------------------------------\n\n# ----------------------------------------------------------------------------\n# Maven2 Start Up Script\n#\n# Required ENV vars:\n#   JAVA_HOME - location of a JDK home dir\n#\n# Optional ENV vars\n#   M2_HOME - location of maven2's installed home dir\n#   MAVEN_OPTS - parameters passed to the Java VM when running Maven\n#     e.g. to debug Maven itself, use\n#       set MAVEN_OPTS=-Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=8000\n#   MAVEN_SKIP_RC - flag to disable loading of mavenrc files\n# ----------------------------------------------------------------------------\n\nif [ -z \"$M2_HOME\" ]; then\n  M2_HOME=\"$(cd \"$(dirname \"$0\")/..\" >/dev/null && pwd)\"\nfi\n\nexport MAVEN_SKIP_RC=\"true\"\n\nexec \"$M2_HOME/bin/mvn\" \"$@\"\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/java-app/mvnw.cmd",
            "content": "@echo off\n\nsetlocal\n\nset DIRNAME=%~dp0\nif \"%DIRNAME%\" == \"\" set DIRNAME=.\n\nset MAVEN_PROJECTBASEDIR=%DIRNAME%\n\nset MAVEN_SKIP_RC=true\n\ncall \"%DIRNAME%\\..\\bin\\mvn\" %*\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/java-app/.mvn/wrapper/maven-wrapper.properties",
            "content": "distributionUrl=https://repo.maven.apache.org/maven2/org/apache/maven/apache-maven/3.6.3/apache-maven-3.6.3-bin.zip\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/java-app/.mvn/wrapper/maven-wrapper.jar",
            "content": "<binary content of maven-wrapper.jar>\n"
        }
    ],
    "directory_tree": "CVE-2017-18349/\n|-- custom_no_tool/\n|   |-- docker-compose.yml\n|   |-- nginx.conf\n|   |-- java-app/\n|   |   |-- Dockerfile\n|   |   |-- mvnw\n|   |   |-- mvnw.cmd\n|   |   |-- pom.xml\n|   |   |-- src/\n|   |   |   |-- main/\n|   |   |   |   |-- java/\n|   |   |   |   |   |-- com/\n|   |   |   |   |   |   |-- example/\n|   |   |   |   |   |   |   |-- VulnerableApp.java\n|   |   |   |   |-- resources/\n|   |   |   |   |   |-- application.properties\n|   |   |-- .mvn/\n|   |   |   |-- wrapper/\n|   |   |   |   |-- maven-wrapper.jar\n|   |   |   |   |-- maven-wrapper.properties\n"
}