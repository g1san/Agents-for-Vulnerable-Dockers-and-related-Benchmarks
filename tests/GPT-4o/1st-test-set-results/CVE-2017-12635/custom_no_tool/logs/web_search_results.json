{
    "desc": "CVE-2017-12635 is a critical vulnerability in Apache CouchDB that allows remote privilege escalation. This issue arises due to discrepancies between CouchDB's Erlang-based JSON parser and its JavaScript-based JSON parser. Specifically, the vulnerability is present in CouchDB versions 1.7.0 and 2.x before 2.1.1, where the server improperly handles JSON input, allowing the creation of user documents with duplicate 'roles' keys in the '_users' database. Attackers can exploit this flaw by submitting documents with both an empty 'roles' key and a '_admin' role key. The Erlang parser retains both keys, while the JavaScript parser retains only the last one. As a result, an attacker can gain administrative privileges by creating a user document like {\"roles\": [\"_admin\"], \"roles\": []}. This vulnerability allows unauthorized users to escalate their privileges to admin level, potentially exposing sensitive data and compromising the database's security. To mitigate this issue, users are advised to upgrade to CouchDB version 2.1.1 or later, which addresses the discrepancy by aligning the behavior of the Erlang JSON parser with the JavaScript parser.",
    "attack_type": "Remote Privilege Escalation",
    "services": [
        {
            "name": "couchdb",
            "version": [
                "1.7.0",
                "2.0.0",
                "2.0.1",
                "2.0.2",
                "2.0.3",
                "2.0.4"
            ],
            "dependency_type": "HARD",
            "description": "Apache CouchDB is the primary service affected by CVE-2017-12635. It is a NoSQL database that suffers from a vulnerability allowing remote privilege escalation due to improper handling of JSON input."
        },
        {
            "name": "erlang",
            "version": [
                "21.3.8.21"
            ],
            "dependency_type": "SOFT",
            "description": "Erlang is required for running CouchDB, as CouchDB is built on the Erlang OTP platform. The specified version is compatible with CouchDB 2.x."
        },
        {
            "name": "ubuntu",
            "version": [
                "18.04"
            ],
            "dependency_type": "SOFT",
            "description": "Ubuntu serves as the operating system to host CouchDB and its dependencies in a Docker container. The specified version is compatible with CouchDB 2.x."
        }
    ],
    "input_tokens": 6995,
    "output_tokens": 936
}