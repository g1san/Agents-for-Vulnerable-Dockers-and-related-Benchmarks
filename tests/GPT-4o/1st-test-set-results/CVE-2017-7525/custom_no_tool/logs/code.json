{
    "files": [
        {
            "location": "./../../dockers/CVE-2017-7525/custom_no_tool/docker-compose.yml",
            "content": "services:\n  vulnerable-app:\n    build: ./vulnerable-app\n    ports:\n      - \"8080:8080\"\n    depends_on:\n      - maven\n\n  maven:\n    image: maven:3.6.3-jdk-8-slim\n    volumes:\n      - ./vulnerable-app:/usr/src/app\n    working_dir: /usr/src/app\n    command: mvn clean package\n\n  openjdk:\n    image: openjdk:8-jdk-bullseye\n    command: sleep infinity\n"
        },
        {
            "location": "./../../dockers/CVE-2017-7525/custom_no_tool/vulnerable-app/Dockerfile",
            "content": "FROM openjdk:8-jdk-bullseye\n\nCOPY target/vulnerable-app.jar /app/vulnerable-app.jar\n\nCMD [\"java\", \"-jar\", \"/app/vulnerable-app.jar\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2017-7525/custom_no_tool/vulnerable-app/pom.xml",
            "content": "<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n    <groupId>com.example</groupId>\n    <artifactId>vulnerable-app</artifactId>\n    <version>1.0-SNAPSHOT</version>\n    <dependencies>\n        <dependency>\n            <groupId>com.fasterxml.jackson.core</groupId>\n            <artifactId>jackson-databind</artifactId>\n            <version>2.10.0</version>\n        </dependency>\n    </dependencies>\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-compiler-plugin</artifactId>\n                <version>3.8.1</version>\n                <configuration>\n                    <source>1.8</source>\n                    <target>1.8</target>\n                </configuration>\n            </plugin>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-jar-plugin</artifactId>\n                <version>3.1.0</version>\n                <configuration>\n                    <archive>\n                        <manifest>\n                            <mainClass>com.example.VulnerableApp</mainClass>\n                        </manifest>\n                    </archive>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n</project>\n"
        },
        {
            "location": "./../../dockers/CVE-2017-7525/custom_no_tool/vulnerable-app/src/main/java/com/example/VulnerableApp.java",
            "content": "package com.example;\n\nimport com.fasterxml.jackson.databind.ObjectMapper;\nimport com.fasterxml.jackson.databind.SerializationFeature;\nimport com.fasterxml.jackson.databind.jsontype.BasicPolymorphicTypeValidator;\nimport com.fasterxml.jackson.databind.jsontype.PolymorphicTypeValidator;\nimport com.fasterxml.jackson.databind.ObjectMapper.DefaultTyping;\nimport spark.Spark;\n\npublic class VulnerableApp {\n    public static void main(String[] args) {\n        ObjectMapper objectMapper = new ObjectMapper();\n        PolymorphicTypeValidator ptv = BasicPolymorphicTypeValidator.builder()\n            .allowIfBaseType(Object.class)\n            .build();\n        objectMapper.activateDefaultTyping(ptv, DefaultTyping.NON_FINAL, ObjectMapper.As.WRAPPER_ARRAY);\n\n        Spark.port(8080);\n\n        Spark.post(\"/deserialize\", (req, res) -> {\n            String json = req.body();\n            try {\n                Object obj = objectMapper.readValue(json, Object.class);\n                return \"Deserialized: \" + obj.toString();\n            } catch (Exception e) {\n                res.status(500);\n                return \"Deserialization error: \" + e.getMessage();\n            }\n        });\n    }\n}\n"
        }
    ],
    "directory_tree": "CVE-2017-7525/\n|-- custom_no_tool/\n|   |-- docker-compose.yml\n|   |-- vulnerable-app/\n|   |   |-- Dockerfile\n|   |   |-- pom.xml\n|   |   |-- src/\n|   |   |   |-- main/\n|   |   |   |   |-- java/\n|   |   |   |   |   |-- com/\n|   |   |   |   |   |   |-- example/\n|   |   |   |   |   |   |   |-- VulnerableApp.java"
}