#!/bin/bash

# Wait for PostgreSQL to be ready
until pg_isready -h db -U hertzbeat; do
  echo "Waiting for PostgreSQL..."
  sleep 2
done

# Initialize the database with test data
psql -h db -U hertzbeat -d hertzbeat << EOF
BEGIN;
-- Create a sample table
CREATE TABLE IF NOT EXISTS monitor_data (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    value VARCHAR(255) NOT NULL
);

-- Insert sample data
INSERT INTO monitor_data (name, value) VALUES ('CPU Usage', '20%');
INSERT INTO monitor_data (name, value) VALUES ('Memory Usage', '50%');
COMMIT;
EOF
