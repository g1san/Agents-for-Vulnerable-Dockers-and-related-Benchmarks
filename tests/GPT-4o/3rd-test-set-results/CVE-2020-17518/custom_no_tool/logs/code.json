{
    "files": [
        {
            "location": "./../../dockers/CVE-2020-17518/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\n\nservices:\n  flink-jobmanager:\n    image: flink:1.11.2\n    command: jobmanager\n    ports:\n      - \"8081:8081\"\n    environment:\n      - JOB_MANAGER_RPC_ADDRESS=flink-jobmanager\n    networks:\n      - flink-network\n\n  flink-taskmanager:\n    image: flink:1.11.2\n    command: taskmanager\n    environment:\n      - JOB_MANAGER_RPC_ADDRESS=flink-jobmanager\n    depends_on:\n      - flink-jobmanager\n    networks:\n      - flink-network\n\n  zookeeper:\n    image: zookeeper:3.5.8\n    ports:\n      - \"2181:2181\"\n    networks:\n      - flink-network\n\nnetworks:\n  flink-network:\n    driver: bridge\n"
        },
        {
            "location": "./../../dockers/CVE-2020-17518/custom_no_tool/Dockerfile",
            "content": "# Use the official Flink image\nFROM flink:1.11.2\n\n# Install OpenJDK\nRUN apt-get update && \\\n    apt-get install -y openjdk-8-jdk && \\\n    apt-get clean;\n\n# Copy the vulnerable FileUploadHandler.java for testing purposes\nCOPY FileUploadHandler.java /opt/flink/src/FileUploadHandler.java\n\n# Set the working directory\nWORKDIR /opt/flink\n\n# Expose necessary ports\nEXPOSE 8081 6123 6124\n\n# Start Flink JobManager by default\nCMD [\"/docker-entrypoint.sh\", \"jobmanager\"]"
        },
        {
            "location": "./../../dockers/CVE-2020-17518/custom_no_tool/FileUploadHandler.java",
            "content": "// This is a simplified version of the vulnerable FileUploadHandler.java\n// It's only for demonstration purposes and not functional\n\npublic class FileUploadHandler {\n    public void handleUpload(String filename) {\n        // Vulnerable code: lacks sanitization of the filename\n        File file = new File(\"/uploads/\" + filename);\n        // Further processing...\n    }\n}\n"
        }
    ],
    "directory_tree": "CVE-2020-17518/\n\u2514\u2500\u2500 custom_no_tool/\n    \u251c\u2500\u2500 docker-compose.yml\n    \u251c\u2500\u2500 Dockerfile\n    \u2514\u2500\u2500 FileUploadHandler.java"
}