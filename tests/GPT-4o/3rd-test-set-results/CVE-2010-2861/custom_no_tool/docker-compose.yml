services:
  coldfusion:
    build: ./coldfusion
    ports:
      - "8500:8500"
    volumes:
      - ./coldfusion_data:/opt/coldfusion9
    networks:
      - cve_network

  httpd:
    image: httpd:2.4.54
    ports:
      - "80:80"
    volumes:
      - ./httpd.conf:/usr/local/apache2/conf/httpd.conf
      - ./www:/usr/local/apache2/htdocs
    networks:
      - cve_network

  mysql:
    image: mysql:5.7
    environment:
      MYSQL_ROOT_PASSWORD: rootpass
      MYSQL_DATABASE: cfdb
      MYSQL_USER: cfuser
      MYSQL_PASSWORD: cfpass
    volumes:
      - mysql_data:/var/lib/mysql
    networks:
      - cve_network
    command: --default-authentication-plugin=mysql_native_password
    healthcheck:
      test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
      interval: 10s
      retries: 5

volumes:
  mysql_data:

networks:
  cve_network:
    driver: bridge
