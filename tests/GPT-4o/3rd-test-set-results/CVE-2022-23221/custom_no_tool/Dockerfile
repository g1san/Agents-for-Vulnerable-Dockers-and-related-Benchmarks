FROM eclipse-temurin:8-jdk-focal

RUN mkdir /h2-data

# Download H2 database JAR
RUN mkdir -p /h2/bin && \
    curl -o /h2/bin/h2.jar https://repo1.maven.org/maven2/com/h2database/h2/1.4.200/h2-1.4.200.jar

COPY init.sql /h2-data/
COPY run-init.sh /h2/bin/

CMD ["/bin/sh", "-c", "java -cp /h2/bin/h2.jar org.h2.tools.Server -tcp -tcpAllowOthers -web -webAllowOthers -ifNotExists & sleep 5 && java -cp /h2/bin/h2.jar org.h2.tools.RunScript -url jdbc:h2:tcp://localhost/~/test -script /h2-data/init.sql"]
