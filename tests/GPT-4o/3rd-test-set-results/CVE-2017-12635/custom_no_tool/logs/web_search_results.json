{
    "desc": "CVE-2017-12635 is a vulnerability in Apache CouchDB, specifically impacting versions 1.7.0 and 2.x prior to 2.1.1. The vulnerability arises from a discrepancy between the Erlang-based JSON parser and the JavaScript-based JSON parser used in CouchDB. This discrepancy allows non-admin users to escalate their privileges by submitting documents with duplicate 'roles' keys in the '_users' database, including the '_admin' role, which grants administrative access. The Erlang parser retains both values, while the JavaScript parser only retains the last one, resulting in the attacker gaining admin privileges. This issue can be exploited by sending a specially crafted JSON payload to the CouchDB server's HTTP API, effectively bypassing authentication and gaining unauthorized administrative access. This allows attackers to execute arbitrary commands and potentially take control of the affected system. To mitigate the vulnerability, users should update to CouchDB version 2.1.1 or later and configure the database to require valid user authentication by setting 'require_valid_user' to true in the configuration file.",
    "attack_type": "Remote Privilege Escalation",
    "services": [
        {
            "name": "couchdb",
            "version": [
                "1.7.0",
                "2.0.0"
            ],
            "dependency_type": "HARD",
            "description": "Apache CouchDB is the primary service that is vulnerable to CVE-2017-12635 due to its flawed JSON parsing and authentication handling."
        },
        {
            "name": "erlang",
            "version": [
                "20.0"
            ],
            "dependency_type": "SOFT",
            "description": "Erlang is required to run CouchDB as it is built on the Erlang programming language."
        }
    ],
    "input_tokens": 6879,
    "output_tokens": 914
}