{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/docker-compose.yml",
            "content": "version: '3.7'\n\nservices:\n  web:\n    image: nginx:1.21\n    ports:\n      - \"8080:80\"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf\n      - ./fastcgi-php.conf:/etc/nginx/snippets/fastcgi-php.conf\n    depends_on:\n      - php\n\n  php:\n    image: php:7.4-fpm\n    volumes:\n      - ./ecshop:/var/www/html\n    depends_on:\n      - db\n\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpassword\n      MYSQL_DATABASE: ecshop\n      MYSQL_USER: ecshopuser\n      MYSQL_PASSWORD: ecshoppassword\n    volumes:\n      - db_data:/var/lib/mysql\n    ports:\n      - \"3306:3306\"\n\nvolumes:\n  db_data:\n    "
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/nginx.conf",
            "content": "events {\n    worker_connections 1024;\n}\n\nhttp {\n    server {\n        listen 80;\n        server_name localhost;\n\n        root /var/www/html;\n        index index.php index.html index.htm;\n\n        location / {\n            try_files $uri $uri/ =404;\n        }\n\n        location ~ \\.php$ {\n            include snippets/fastcgi-php.conf;\n            fastcgi_pass php:9000;\n            fastcgi_index index.php;\n            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n            include fastcgi_params;\n        }\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/fastcgi-php.conf",
            "content": "fastcgi_param QUERY_STRING    $query_string;\nfastcgi_param REQUEST_METHOD  $request_method;\nfastcgi_param CONTENT_TYPE    $content_type;\nfastcgi_param CONTENT_LENGTH  $content_length;\n\nfastcgi_param SCRIPT_NAME     $fastcgi_script_name;\nfastcgi_param REQUEST_URI     $request_uri;\nfastcgi_param DOCUMENT_URI    $document_uri;\nfastcgi_param DOCUMENT_ROOT   $document_root;\nfastcgi_param SERVER_PROTOCOL $server_protocol;\n\nfastcgi_param GATEWAY_INTERFACE CGI/1.1;\nfastcgi_param SERVER_SOFTWARE  nginx/$nginx_version;\n\nfastcgi_param REMOTE_ADDR     $remote_addr;\nfastcgi_param REMOTE_PORT     $remote_port;\nfastcgi_param SERVER_ADDR     $server_addr;\nfastcgi_param SERVER_PORT     $server_port;\nfastcgi_param SERVER_NAME     $server_name;\n\nfastcgi_param HTTPS           $https if_not_empty;\n\nfastcgi_param REDIRECT_STATUS 200;\n"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/ecshop/index.php",
            "content": "<?php\n// Sample vulnerable script for ECShop 4.1.0\n\n$mysqli = new mysqli(\"db\", \"ecshopuser\", \"ecshoppassword\", \"ecshop\");\n\nif ($mysqli->connect_error) {\n    die(\"Connection failed: \" . $mysqli->connect_error);\n}\n\n$id = $_GET['id'];\n$query = \"SELECT * FROM products WHERE id = '$id'\";\n$result = $mysqli->query($query);\n\nif ($result->num_rows > 0) {\n    while($row = $result->fetch_assoc()) {\n        echo \"id: \" . $row[\"id\"]. \" - Name: \" . $row[\"name\"]. \"<br>\";\n    }\n} else {\n    echo \"0 results\";\n}\n\n$mysqli->close();\n?>\n"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/ecshop/db_init.sql",
            "content": "CREATE TABLE products (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(255) NOT NULL\n);\n\nINSERT INTO products (name) VALUES ('Product 1'), ('Product 2'), ('Product 3');\n"
        }
    ],
    "directory_tree": "CVE-2021-41460/\n\u2514\u2500\u2500 custom_no_tool\n    \u251c\u2500\u2500 docker-compose.yml\n    \u251c\u2500\u2500 nginx.conf\n    \u251c\u2500\u2500 fastcgi-php.conf\n    \u251c\u2500\u2500 ecshop\n    \u2502   \u251c\u2500\u2500 index.php\n    \u2502   \u2514\u2500\u2500 db_init.sql\n"
}