<?php
/**
 * Simple connector for elFinder
 *
 * @package elfinder
 * @author  Naoki Sawada
 * @license New BSD
 */

/**
 * elFinder connector
 *
 * @author Naoki Sawada
 **/
class elFinderConnector {
    /**
     * elFinder instance
     *
     * @var elFinder
     **/
    protected $elFinder;

    /**
     * Options
     *
     * @var array
     **/
    protected $options = array();

    /**
     * Constructor
     *
     * @param  elFinder  $elFinder  elFinder instance
     * @param  array     $options   Options
     * @return void
     **/
    public function __construct($elFinder, $options = array()) {
        $this->elFinder = $elFinder;
        $this->options  = $options;
    }

    /**
     * Run connector
     *
     * @return void
     **/
    public function run() {
        $isPost = $_SERVER["REQUEST_METHOD"] == 'POST';

        if ($isPost) {
            $src = file_get_contents('php://input');
            $args = json_decode($src, true);
        } else {
            $args = $_GET;
        }

        $this->output($this->elFinder->exec($args));
    }

    /**
     * Output JSON
     *
     * @param  array  $data  Data to output
     * @return void
     **/
    protected function output(array $data) {
        header('Content-Type: application/json');
        echo json_encode($data);
    }
}
