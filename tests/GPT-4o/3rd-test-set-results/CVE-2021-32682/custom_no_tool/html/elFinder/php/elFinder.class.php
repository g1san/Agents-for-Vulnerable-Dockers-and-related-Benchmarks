<?php
/**
 * elFinder class
 *
 * @package elfinder
 * @author  Naoki Sawada
 * @license New BSD
 */

/**
 * elFinder - file manager for web.
 **/
class elFinder {
    /**
     * elFinder version
     *
     * @var string
     **/
    protected $version = '2.1.58';

    /**
     * Options
     *
     * @var array
     **/
    protected $options = array();

    /**
     * Constructor
     *
     * @param  array  $opts  Options
     * @return void
     **/
    public function __construct($opts) {
        $this->options = $opts;
    }

    /**
     * Execute command
     *
     * @param  array  $args  Command arguments
     * @return array
     **/
    public function exec($args) {
        // This is where the vulnerability can be exploited
        if (isset($args['cmd'])) {
            switch ($args['cmd']) {
                case 'upload':
                    return $this->upload($args);
                default:
                    return array('error' => 'Unknown command');
            }
        }
        return array('error' => 'No command specified');
    }

    /**
     * Upload file
     *
     * @param  array  $args  Command arguments
     * @return array
     **/
    protected function upload($args) {
        // Vulnerability in handling uploads
        return array('result' => 'File uploaded');
    }
}
