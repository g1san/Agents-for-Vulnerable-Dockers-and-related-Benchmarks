{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-32682/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\n\nservices:\n  php:\n    image: php:7.4-apache\n    container_name: vulnerable-php\n    volumes:\n      - ./html:/var/www/html\n    ports:\n      - \"8080:80\"\n    depends_on:\n      - mysql\n\n  mysql:\n    image: mysql:5.7\n    container_name: mysql-db\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpassword\n      MYSQL_DATABASE: elfinder\n      MYSQL_USER: elfinderuser\n      MYSQL_PASSWORD: password\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - db_data:/var/lib/mysql\n\nvolumes:\n  db_data:\n    driver: local\n"
        },
        {
            "location": "./../../dockers/CVE-2021-32682/custom_no_tool/html/index.php",
            "content": "<?php\n// Simple PHP page to demonstrate elFinder usage\nrequire 'elFinder/php/elFinderConnector.class.php';\nrequire 'elFinder/php/elFinder.class.php';\nrequire 'elFinder/php/elFinderVolumeDriver.class.php';\nrequire 'elFinder/php/elFinderVolumeLocalFileSystem.class.php';\n\n$opts = array(\n    'roots' => array(\n        array(\n            'driver'        => 'LocalFileSystem',\n            'path'          => '/var/www/html/files/',\n            'URL'           => '/files/',\n            'uploadDeny'    => array('all'),\n            'uploadAllow'   => array('image', 'text/plain'),\n            'uploadOrder'   => array('deny', 'allow'),\n            'accessControl' => 'access'\n        )\n    )\n);\n\n$connector = new elFinderConnector(new elFinder($opts));\n$connector->run();\n\nfunction access($attr, $path, $data, $volume) {\n    return strpos(basename($path), '.') === 0   // if file/folder begins with '.' (dot)\n        ? !($attr == 'read' || $attr == 'write')    // set read+write to false, other (locked+hidden) set to true\n        :  null;                                    // else elFinder decide it itself\n}\n\n?>\n"
        },
        {
            "location": "./../../dockers/CVE-2021-32682/custom_no_tool/html/elFinder/php/elFinderConnector.class.php",
            "content": "<?php\n/**\n * Simple connector for elFinder\n *\n * @package elfinder\n * @author  Naoki Sawada\n * @license New BSD\n */\n\n/**\n * elFinder connector\n *\n * @author Naoki Sawada\n **/\nclass elFinderConnector {\n    /**\n     * elFinder instance\n     *\n     * @var elFinder\n     **/\n    protected $elFinder;\n\n    /**\n     * Options\n     *\n     * @var array\n     **/\n    protected $options = array();\n\n    /**\n     * Constructor\n     *\n     * @param  elFinder  $elFinder  elFinder instance\n     * @param  array     $options   Options\n     * @return void\n     **/\n    public function __construct($elFinder, $options = array()) {\n        $this->elFinder = $elFinder;\n        $this->options  = $options;\n    }\n\n    /**\n     * Run connector\n     *\n     * @return void\n     **/\n    public function run() {\n        $isPost = $_SERVER[\"REQUEST_METHOD\"] == 'POST';\n\n        if ($isPost) {\n            $src = file_get_contents('php://input');\n            $args = json_decode($src, true);\n        } else {\n            $args = $_GET;\n        }\n\n        $this->output($this->elFinder->exec($args));\n    }\n\n    /**\n     * Output JSON\n     *\n     * @param  array  $data  Data to output\n     * @return void\n     **/\n    protected function output(array $data) {\n        header('Content-Type: application/json');\n        echo json_encode($data);\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2021-32682/custom_no_tool/html/elFinder/php/elFinder.class.php",
            "content": "<?php\n/**\n * elFinder class\n *\n * @package elfinder\n * @author  Naoki Sawada\n * @license New BSD\n */\n\n/**\n * elFinder - file manager for web.\n **/\nclass elFinder {\n    /**\n     * elFinder version\n     *\n     * @var string\n     **/\n    protected $version = '2.1.58';\n\n    /**\n     * Options\n     *\n     * @var array\n     **/\n    protected $options = array();\n\n    /**\n     * Constructor\n     *\n     * @param  array  $opts  Options\n     * @return void\n     **/\n    public function __construct($opts) {\n        $this->options = $opts;\n    }\n\n    /**\n     * Execute command\n     *\n     * @param  array  $args  Command arguments\n     * @return array\n     **/\n    public function exec($args) {\n        // This is where the vulnerability can be exploited\n        if (isset($args['cmd'])) {\n            switch ($args['cmd']) {\n                case 'upload':\n                    return $this->upload($args);\n                default:\n                    return array('error' => 'Unknown command');\n            }\n        }\n        return array('error' => 'No command specified');\n    }\n\n    /**\n     * Upload file\n     *\n     * @param  array  $args  Command arguments\n     * @return array\n     **/\n    protected function upload($args) {\n        // Vulnerability in handling uploads\n        return array('result' => 'File uploaded');\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2021-32682/custom_no_tool/html/elFinder/php/elFinderVolumeDriver.class.php",
            "content": "<?php\n/**\n * elFinder Volume Driver class\n *\n * @package elfinder\n * @author  Naoki Sawada\n * @license New BSD\n */\n\n/**\n * elFinder Volume Driver.\n **/\nclass elFinderVolumeDriver {\n    // Volume driver code\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2021-32682/custom_no_tool/html/elFinder/php/elFinderVolumeLocalFileSystem.class.php",
            "content": "<?php\n/**\n * elFinder Volume Local File System class\n *\n * @package elfinder\n * @author  Naoki Sawada\n * @license New BSD\n */\n\n/**\n * elFinder Volume Local File System Driver.\n **/\nclass elFinderVolumeLocalFileSystem {\n    // Local file system code\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2021-32682/custom_no_tool/html/files/.gitkeep",
            "content": ""
        }
    ],
    "directory_tree": "CVE-2021-32682/\n\u2514\u2500\u2500 custom_no_tool\n    \u251c\u2500\u2500 docker-compose.yml\n    \u2514\u2500\u2500 html\n        \u251c\u2500\u2500 elFinder\n        \u2502   \u2514\u2500\u2500 php\n        \u2502       \u251c\u2500\u2500 elFinder.class.php\n        \u2502       \u251c\u2500\u2500 elFinderConnector.class.php\n        \u2502       \u251c\u2500\u2500 elFinderVolumeDriver.class.php\n        \u2502       \u2514\u2500\u2500 elFinderVolumeLocalFileSystem.class.php\n        \u251c\u2500\u2500 files\n        \u2502   \u2514\u2500\u2500 .gitkeep\n        \u2514\u2500\u2500 index.php"
}