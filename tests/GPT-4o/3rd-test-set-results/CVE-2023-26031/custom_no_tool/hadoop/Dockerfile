FROM ubuntu:20.04

RUN apt-get update && \
    apt-get install -y openjdk-11-jre wget && \
    wget --tries=5 --timeout=30 -O hadoop-3.3.5.tar.gz https://downloads.apache.org/hadoop/common/hadoop-3.3.5/hadoop-3.3.5.tar.gz && \
    tar -xzvf hadoop-3.3.5.tar.gz -C /opt/ && \
    mv /opt/hadoop-3.3.5 /opt/hadoop && \
    rm hadoop-3.3.5.tar.gz && \
    apt-get clean && rm -rf /var/lib/apt/lists/*

ENV JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64
ENV PATH="$PATH:/opt/hadoop/bin:/opt/hadoop/sbin"

WORKDIR /opt/hadoop

RUN useradd -ms /bin/bash hadoop && \
    chown -R hadoop:hadoop /opt/hadoop

CMD ["/bin/bash"]
