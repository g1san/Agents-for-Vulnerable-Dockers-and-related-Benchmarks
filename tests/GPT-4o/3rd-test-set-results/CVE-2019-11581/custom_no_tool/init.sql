CREATE DATABASE IF NOT EXISTS jiradb;

-- Create user only if it does not already exist
CREATE USER IF NOT EXISTS 'jirauser'@'%' IDENTIFIED BY 'secret';

GRANT ALL PRIVILEGES ON jiradb.* TO 'jirauser'@'%';
FLUSH PRIVILEGES;

CREATE TABLE IF NOT EXISTS jiradb.example_table (
    id INT PRIMARY KEY,
    data VARCHAR(255)
);

-- Insert data only if it does not already exist
INSERT INTO jiradb.example_table (id, data)
SELECT 1, 'test data'
WHERE NOT EXISTS (
    SELECT 1 FROM jiradb.example_table WHERE id = 1
);
