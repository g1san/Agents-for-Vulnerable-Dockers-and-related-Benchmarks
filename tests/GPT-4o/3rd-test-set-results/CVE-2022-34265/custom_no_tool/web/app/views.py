from django.shortcuts import render
from django.http import HttpResponse
from django.db.models.functions import Trunc
from .models import SampleData

# Vulnerable view

def vulnerable_view(request):
    kind = request.GET.get('kind', 'day')  # This is where the vulnerability exists
    data = SampleData.objects.annotate(truncated=Trunc('created_at', kind))
    return HttpResponse(data)
