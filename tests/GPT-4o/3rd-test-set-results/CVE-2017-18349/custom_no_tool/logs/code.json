{
    "files": [
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/docker-compose.yml",
            "content": "services:\n  web:\n    image: tomcat:8.5.73-jdk8-openjdk\n    container_name: tomcat_server\n    ports:\n      - \"8080:8080\"\n    volumes:\n      - ./webapp:/usr/local/tomcat/webapps\n\n  nginx:\n    image: nginx:1.21.6\n    container_name: nginx_server\n    ports:\n      - \"80:80\"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf\n\n  rmi_server:\n    build: ./rmi_server\n    container_name: rmi_server\n    ports:\n      - \"1099:1099\"\n\nnetworks:\n  default:\n    driver: bridge\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/webapp/WEB-INF/web.xml",
            "content": "<web-app xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd\"\n         version=\"3.1\">\n\n    <servlet>\n        <servlet-name>FastjsonServlet</servlet-name>\n        <servlet-class>com.example.fastjson.FastjsonServlet</servlet-class>\n    </servlet>\n\n    <servlet-mapping>\n        <servlet-name>FastjsonServlet</servlet-name>\n        <url-pattern>/fastjson</url-pattern>\n    </servlet-mapping>\n\n</web-app>\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/webapp/WEB-INF/classes/com/example/fastjson/FastjsonServlet.java",
            "content": "package com.example.fastjson;\n\nimport com.alibaba.fastjson.JSON;\nimport com.alibaba.fastjson.JSONObject;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\nimport java.io.PrintWriter;\n\n@WebServlet(name = \"FastjsonServlet\", urlPatterns = {\"/fastjson\"})\npublic class FastjsonServlet extends HttpServlet {\n\n    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        response.setContentType(\"application/json\");\n        PrintWriter out = response.getWriter();\n\n        try {\n            String jsonPayload = request.getReader().lines().reduce(\"\", (accumulator, actual) -> accumulator + actual);\n            JSONObject jsonObject = JSON.parseObject(jsonPayload);\n            out.println(jsonObject.toJSONString());\n        } catch (Exception e) {\n            e.printStackTrace();\n            response.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);\n            out.println(\"Error processing request\");\n        }\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/nginx.conf",
            "content": "events {}\n\nhttp {\n    server {\n        listen 80;\n\n        location / {\n            proxy_pass http://web:8080;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n        }\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/rmi_server/Dockerfile",
            "content": "FROM openjdk:8-jdk-alpine\n\nCOPY Exploit.java /Exploit.java\nRUN javac Exploit.java\n\nCMD [\"java\", \"-Djava.rmi.server.hostname=0.0.0.0\", \"-cp\", \"/\", \"Exploit\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/rmi_server/Exploit.java",
            "content": "import javax.naming.Context;\nimport javax.naming.InitialContext;\nimport javax.naming.NamingException;\nimport java.rmi.registry.LocateRegistry;\nimport java.rmi.registry.Registry;\n\npublic class Exploit {\n    public static void main(String[] args) throws NamingException {\n        try {\n            Registry registry = LocateRegistry.createRegistry(1099);\n            System.out.println(\"RMI Registry started on port 1099\");\n\n            // Setup JNDI context\n            System.setProperty(Context.INITIAL_CONTEXT_FACTORY, \"com.sun.jndi.rmi.registry.RegistryContextFactory\");\n            System.setProperty(Context.PROVIDER_URL, \"rmi://localhost:1099\");\n\n            InitialContext context = new InitialContext();\n            context.bind(\"Exploit\", new Exploit());\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n    @Override\n    public String toString() {\n        return \"Exploit executed!\";\n    }\n}\n"
        }
    ],
    "directory_tree": "CVE-2017-18349/\n\u2514\u2500\u2500 custom_no_tool/\n    \u251c\u2500\u2500 docker-compose.yml\n    \u251c\u2500\u2500 nginx.conf\n    \u251c\u2500\u2500 rmi_server/\n    \u2502   \u251c\u2500\u2500 Dockerfile\n    \u2502   \u2514\u2500\u2500 Exploit.java\n    \u2514\u2500\u2500 webapp/\n        \u2514\u2500\u2500 WEB-INF/\n            \u251c\u2500\u2500 classes/\n            \u2502   \u2514\u2500\u2500 com/\n            \u2502       \u2514\u2500\u2500 example/\n            \u2502           \u2514\u2500\u2500 fastjson/\n            \u2502               \u2514\u2500\u2500 FastjsonServlet.java\n            \u2514\u2500\u2500 web.xml\n"
}