FROM openjdk:11-jre-slim

# Install Jetty
RUN apt-get update && apt-get install -y wget \
    && wget -qO- https://repo1.maven.org/maven2/org/eclipse/jetty/jetty-distribution/9.4.44.v20210927/jetty-distribution-9.4.44.v20210927.tar.gz | tar xz -C /opt \
    && mv /opt/jetty-distribution-9.4.44.v20210927 /opt/jetty \
    && rm -rf /var/lib/apt/lists/*

# Set environment variables
ENV JETTY_HOME=/opt/jetty
ENV PATH="$JETTY_HOME/bin:$PATH"

# Add ActiveMQ Jolokia configuration (to enable the vulnerability)
COPY jolokia-access.xml $JETTY_HOME/etc/jolokia-access.xml

# Expose ports
EXPOSE 8080

# Start Jetty
CMD ["java", "-jar", "$JETTY_HOME/start.jar"]
