# Use a JRE base image
FROM eclipse-temurin:8-jre-focal

# Set environment variables
ENV GEOSERVER_HOME=/opt/geoserver
ENV GEOSERVER_DATA_DIR=/opt/geoserver/data_dir

# Create geoserver directory
RUN mkdir -p $GEOSERVER_HOME

# Install unzip utility
RUN apt-get update && apt-get install -y unzip && rm -rf /var/lib/apt/lists/*

# Download GeoServer WAR file
ADD https://sourceforge.net/projects/geoserver/files/GeoServer/2.21.3/geoserver-2.21.3-war.zip/download /tmp/geoserver.zip

# Unzip and set up GeoServer
RUN unzip /tmp/geoserver.zip -d $GEOSERVER_HOME && \
    rm /tmp/geoserver.zip

# Expose the default GeoServer port
EXPOSE 8080

# Command to run GeoServer
CMD ["java", "-jar", "/opt/geoserver/start.jar"]
