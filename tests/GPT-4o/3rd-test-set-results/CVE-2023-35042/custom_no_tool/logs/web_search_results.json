{
    "desc": "CVE-2023-35042 is a critical vulnerability in GeoServer, specifically involving the improper control of code generation in the Jiffle map algebra language provided by jai-ext. This flaw allows remote attackers to execute arbitrary code via `java.lang.Runtime.getRuntime().exec` in `wps:LiteralData` within a `wps:Execute` request. The vulnerability arises from Jiffle's script-to-Java compilation mechanism, which translates user-controlled scripts into executable Java code through Janino, enabling code injection. This vulnerability affects various versions of GeoServer, and although the vendor has stated they are unable to reproduce the issue, it has been actively exploited since June 2023. Mitigation involves removing the `janino-<version>.jar` from the GeoServer's `WEB-INF/lib` directory to disable Jiffle's Java code compilation capability.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "geoserver",
            "version": [
                "2.21.0",
                "2.21.1",
                "2.21.2",
                "2.21.3",
                "2.21.4",
                "2.22.0",
                "2.22.1",
                "2.22.2",
                "2.22.3",
                "2.22.4"
            ],
            "dependency_type": "HARD",
            "description": "GeoServer is the main service affected by CVE-2023-35042. It is needed to demonstrate the vulnerability."
        },
        {
            "name": "openjdk",
            "version": [
                "8-jdk"
            ],
            "dependency_type": "SOFT",
            "description": "OpenJDK is required to run GeoServer, as it provides the necessary Java environment."
        },
        {
            "name": "postgres",
            "version": [
                "13"
            ],
            "dependency_type": "SOFT-DB",
            "description": "PostgreSQL is a common database service used with GeoServer for data storage and retrieval."
        },
        {
            "name": "nginx",
            "version": [
                "1.21"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx can be used as a reverse proxy server to handle web requests to GeoServer."
        }
    ],
    "input_tokens": 7271,
    "output_tokens": 875
}