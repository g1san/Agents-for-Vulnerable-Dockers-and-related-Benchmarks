{
    "desc": "CVE-2020-11981 is a critical vulnerability found in Apache Airflow versions up to 1.10.10. This vulnerability is specifically associated with the use of the CeleryExecutor. It arises due to improper handling of sensitive information, such as the broker URL, which can be exposed to unauthorized users. The broker URL often contains credentials that are crucial for the secure operation of the CeleryExecutor. If an attacker gains access to this URL, they could potentially interfere with the task execution process, leading to unauthorized access and manipulation of data. Furthermore, if an attacker can connect directly to the broker (such as Redis or RabbitMQ), they can inject commands that lead to the execution of arbitrary commands by the celery worker. This vulnerability allows for remote code execution, making it highly critical with a CVSS v3 score of 9.8. The issue underscores the importance of securely handling and storing sensitive configuration details to prevent unauthorized access and maintain the integrity of the system. Users are advised to upgrade to Apache Airflow version 1.10.11 or later to mitigate this risk.",
    "attack_type": "Remote Code Execution",
    "services": [
        {
            "name": "apache/airflow",
            "version": [
                "1.10.10"
            ],
            "dependency_type": "HARD",
            "description": "Apache Airflow is the service that contains the vulnerability, specifically in versions up to 1.10.10 when using CeleryExecutor."
        },
        {
            "name": "redis",
            "version": [
                "6.0.9"
            ],
            "dependency_type": "SOFT-CACHE",
            "description": "Redis is used as a broker by the CeleryExecutor in Apache Airflow, which is necessary to exploit the vulnerability."
        },
        {
            "name": "rabbitmq",
            "version": [
                "3.8.9-management"
            ],
            "dependency_type": "SOFT-CACHE",
            "description": "RabbitMQ can also be used as a broker by the CeleryExecutor in Apache Airflow, providing an alternative to Redis for exploiting the vulnerability."
        },
        {
            "name": "postgres",
            "version": [
                "12.4"
            ],
            "dependency_type": "SOFT-DB",
            "description": "PostgreSQL is used as the backend database for Apache Airflow to store metadata and state information."
        }
    ],
    "input_tokens": 36504,
    "output_tokens": 622
}