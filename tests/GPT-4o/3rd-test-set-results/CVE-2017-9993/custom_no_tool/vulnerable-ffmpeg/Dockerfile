FROM ubuntu:16.04

RUN apt-get update && \
    apt-get install -y \
    wget \
    build-essential \
    yasm \
    libx264-dev \
    libx265-dev \
    libvpx-dev \
    libfdk-aac-dev \
    libmp3lame-dev \
    libopus-dev \
    python3

# Download and compile FFmpeg version 3.3.1 (vulnerable version)
RUN wget https://ffmpeg.org/releases/ffmpeg-3.3.1.tar.bz2 && \
    tar xjf ffmpeg-3.3.1.tar.bz2 && \
    cd ffmpeg-3.3.1 && \
    ./configure --enable-gpl --enable-libx264 --enable-libx265 --enable-libvpx --enable-libfdk-aac \
                --enable-libmp3lame --enable-libopus --enable-nonfree && \
    make && \
    make install

WORKDIR /media

# Start a simple HTTP server to serve media files
CMD ["python3", "-m", "http.server", "80"]
