{
    "desc": "CVE-2022-24816 is a critical code injection vulnerability in the jt-jiffle extension of GeoServer. It primarily affects versions of JAI-EXT prior to 1.1.22 and allows unauthenticated remote code execution. The vulnerability arises from improper input validation in Jiffle scripts, which are used for image processing. These scripts are compiled into Java code via the Janino library. An attacker can exploit this vulnerability by injecting malicious Java code through a crafted Web Processing Service (WPS) request to GeoServer's /geoserver/wms endpoint. The exploit enables execution of arbitrary commands on the server, posing a severe risk to confidentiality, integrity, and availability. The vulnerability is rated with a CVSS score of 10.0, indicating critical severity. Mitigation involves upgrading to JAI-EXT version 1.1.22 or later, or removing the janino-x.y.z.jar from the classpath to prevent Jiffle script compilation.",
    "attack_type": "Remote Code Execution",
    "services": [
        {
            "name": "geoserver",
            "version": [
                "2.20.0",
                "2.19.0",
                "2.18.0",
                "2.17.0"
            ],
            "dependency_type": "HARD",
            "description": "GeoServer is the main service that contains the vulnerable jt-jiffle extension, which allows the execution of Jiffle scripts, leading to the vulnerability."
        },
        {
            "name": "openjdk",
            "version": [
                "11-jre"
            ],
            "dependency_type": "SOFT",
            "description": "OpenJDK is required to run GeoServer, as it is a Java-based application and needs a Java runtime environment."
        },
        {
            "name": "nginx",
            "version": [
                "1.21"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx acts as a reverse proxy server to handle HTTP requests to GeoServer."
        }
    ],
    "input_tokens": 8256,
    "output_tokens": 967
}