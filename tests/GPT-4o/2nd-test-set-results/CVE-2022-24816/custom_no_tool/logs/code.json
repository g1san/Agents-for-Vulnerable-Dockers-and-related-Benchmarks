{
    "files": [
        {
            "location": "./../../dockers/CVE-2022-24816/custom_no_tool/docker-compose.yml",
            "content": "services:\n  geoserver:\n    image: \"kartoza/geoserver:2.21.0\"\n    ports:\n      - \"8080:8080\"\n    environment:\n      - GEOSERVER_DATA_DIR=/opt/geoserver/data_dir\n    volumes:\n      - ./geoserver_data:/opt/geoserver/data_dir\n      - ./wait-for-postgres.sh:/wait-for-postgres.sh\n    depends_on:\n      - postgres\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8080/geoserver/web\"]\n      interval: 30s\n      timeout: 10s\n      retries: 5\n    entrypoint: [\"/bin/sh\", \"-c\", \"./wait-for-postgres.sh postgres && /start-geoserver.sh\"]\n\n  postgres:\n    image: \"postgres:14\"\n    environment:\n      POSTGRES_USER: geoserver\n      POSTGRES_PASSWORD: geoserver\n      POSTGRES_DB: geoserver\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n    command: [\"postgres\", \"-c\", \"listen_addresses=*\"]\n    ports:\n      - \"5432:5432\"\n    healthcheck:\n      test: [\"CMD\", \"pg_isready\", \"-U\", \"geoserver\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n\nvolumes:\n  postgres_data:\n  geoserver_data:\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24816/custom_no_tool/geoserver_data/security/auth/geoserver.jiffle",
            "content": "// Secure Jiffle script with no potential for code execution\nz = x + y; // Simple operation with no malicious intent\n\n/*\n * Ensure no arbitrary Java code execution is possible\n */\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24816/custom_no_tool/geoserver_data/workspaces/default.xml",
            "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<workspace>\n  <name>default</name>\n  <isolated>false</isolated>\n</workspace>\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24816/custom_no_tool/geoserver_data/layers/layer.xml",
            "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<layer>\n  <name>example_layer</name>\n  <type>VECTOR</type>\n  <defaultStyle>\n    <name>default</name>\n    <workspace>default</workspace>\n  </defaultStyle>\n</layer>\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24816/custom_no_tool/postgres_init.sql",
            "content": "-- Initialize the PostgreSQL database with some test data\nCREATE TABLE test_table (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    value INTEGER NOT NULL\n);\n\nINSERT INTO test_table (name, value) VALUES\n    ('Test1', 100),\n    ('Test2', 200),\n    ('Test3', 300);\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24816/custom_no_tool/geoserver_data/gwc/geowebcache-diskquota.xml",
            "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<gwcConfiguration>\n  <diskQuota>\n    <enabled>false</enabled>\n  </diskQuota>\n</gwcConfiguration>\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24816/custom_no_tool/geoserver_data/security/usergroup/default/users.xml",
            "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<userGroupService>\n  <users>\n    <user password=\"digest1:admin:geoserver\" name=\"admin\" enabled=\"true\"/>\n  </users>\n</userGroupService>\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24816/custom_no_tool/geoserver_data/security/accessDenied.jsp",
            "content": "<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n<html>\n<head>\n    <title>Access Denied</title>\n</head>\n<body>\n<h1>Access Denied</h1>\n<p>You do not have permission to access this resource.</p>\n</body>\n</html>\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24816/custom_no_tool/wait-for-postgres.sh",
            "content": "#!/bin/sh\n# wait-for-postgres.sh\nset -e\n\nhost=\"$1\"\nshift\ncmd=\"$@\"\n\nuntil pg_isready -h \"$host\" -U \"geoserver\"; do\n  >&2 echo \"Postgres is unavailable - sleeping\"\n  sleep 1\ndone\n\n>&2 echo \"Postgres is up - executing command\"\nexec $cmd\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24816/custom_no_tool/start-geoserver.sh",
            "content": "#!/bin/sh\n# start-geoserver.sh\nset -e\n\n# Start GeoServer\necho \"Starting GeoServer...\"\nexec /usr/local/tomcat/bin/catalina.sh run\n"
        }
    ],
    "directory_tree": "CVE-2022-24816/\n\u251c\u2500\u2500 custom_no_tool\n\u2502   \u251c\u2500\u2500 docker-compose.yml\n\u2502   \u251c\u2500\u2500 geoserver_data\n\u2502   \u2502   \u251c\u2500\u2500 gwc\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 geowebcache-diskquota.xml\n\u2502   \u2502   \u251c\u2500\u2500 layers\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 layer.xml\n\u2502   \u2502   \u251c\u2500\u2500 security\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 accessDenied.jsp\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 auth\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 geoserver.jiffle\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 usergroup\n\u2502   \u2502   \u2502       \u2514\u2500\u2500 default\n\u2502   \u2502   \u2502           \u2514\u2500\u2500 users.xml\n\u2502   \u2502   \u2514\u2500\u2500 workspaces\n\u2502   \u2502       \u2514\u2500\u2500 default.xml\n\u2502   \u251c\u2500\u2500 postgres_init.sql\n\u2502   \u251c\u2500\u2500 start-geoserver.sh\n\u2502   \u2514\u2500\u2500 wait-for-postgres.sh\n"
}