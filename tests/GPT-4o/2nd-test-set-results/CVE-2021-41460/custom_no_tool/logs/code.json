{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\n\nservices:\n  web:\n    image: nginx:1.21\n    ports:\n      - \"8080:80\"\n    volumes:\n      - ./nginx/default.conf:/etc/nginx/conf.d/default.conf\n    depends_on:\n      - php\n\n  php:\n    build:\n      context: ./ecshop\n      dockerfile: Dockerfile\n    volumes:\n      - ./ecshop:/var/www/html\n    depends_on:\n      - db\n\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpassword\n      MYSQL_DATABASE: ecshop\n      MYSQL_USER: ecshop_user\n      MYSQL_PASSWORD: ecshop_pass\n    volumes:\n      - db_data:/var/lib/mysql\n    ports:\n      - \"3306:3306\"\n    command: --default-authentication-plugin=mysql_native_password\n\nvolumes:\n  db_data:\n    driver: local\n"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/nginx/default.conf",
            "content": "server {\n    listen 80;\n    server_name localhost;\n\n    root /var/www/html;\n    index index.php index.html index.htm;\n\n    location / {\n        try_files $uri $uri/ /index.php?$query_string;\n    }\n\n    location ~ \\.php$ {\n        fastcgi_pass php:9000;\n        fastcgi_index index.php;\n        include fastcgi_params;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/ecshop/index.php",
            "content": "<?php\n\n// Simulated vulnerable ECShop index.php\n\n$servername = \"db\";\n$username = \"ecshop_user\";\n$password = \"ecshop_pass\";\n$dbname = \"ecshop\";\n\n// Create connection\n$conn = new mysqli($servername, $username, $password, $dbname);\n\n// Check connection\nif ($conn->connect_error) {\n  die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Secure SQL query using prepared statements\nif (isset($_GET['id'])) {\n    $id = $_GET['id'];\n    $stmt = $conn->prepare(\"SELECT * FROM products WHERE id = ?\");\n    $stmt->bind_param(\"i\", $id);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    if ($result->num_rows > 0) {\n        while($row = $result->fetch_assoc()) {\n            echo \"id: \" . $row[\"id\"]. \" - Name: \" . $row[\"name\"]. \"<br>\";\n        }\n    } else {\n        echo \"0 results\";\n    }\n    $stmt->close();\n}\n\n$conn->close();\n\n?>\n"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/ecshop/init.sql",
            "content": "CREATE TABLE products (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(255) NOT NULL\n);\n\nINSERT INTO products (name) VALUES ('Product 1'), ('Product 2'), ('Product 3');\n"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/ecshop/Dockerfile",
            "content": "FROM php:7.4-fpm\n\n# Install necessary extensions and tools\nRUN apt-get update && apt-get install -y \\\n    unzip \\\n    && docker-php-ext-install mysqli\n\n# Use a local copy of ECShop files instead of downloading\nCOPY ./ecshop_v4.1.0 /var/www/html\n\n# Copy the custom index.php\nCOPY ./index.php /var/www/html/index.php\n\n# Copy the initial SQL setup\nCOPY ./init.sql /docker-entrypoint-initdb.d/\n\nEXPOSE 9000\nCMD [\"php-fpm\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/ecshop/ecshop_v4.1.0/index.html",
            "content": "<html><body>ECShop 4.1.0 Placeholder</body></html>"
        }
    ],
    "directory_tree": "CVE-2021-41460/\n\u251c\u2500\u2500 custom_no_tool\n\u2502   \u251c\u2500\u2500 docker-compose.yml\n\u2502   \u251c\u2500\u2500 ecshop\n\u2502   \u2502   \u251c\u2500\u2500 Dockerfile\n\u2502   \u2502   \u251c\u2500\u2500 ecshop_v4.1.0\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 index.html\n\u2502   \u2502   \u251c\u2500\u2500 index.php\n\u2502   \u2502   \u2514\u2500\u2500 init.sql\n\u2502   \u2514\u2500\u2500 nginx\n\u2502       \u2514\u2500\u2500 default.conf\n"
}