services:
  geoserver:
    image: kartoza/geoserver:2.19.2
    ports:
      - "8080:8080"
    environment:
      - GEOSERVER_DATA_DIR=/opt/geoserver/data_dir
      - JAVA_OPTS=-Djava.security.egd=file:/dev/./urandom -Dgeoserver.global.environment=PROD -Djava.awt.headless=true
    volumes:
      - ./geoserver_data_dir:/opt/geoserver/data_dir
    networks:
      - geoserver-net

  php:
    image: php:7.4-fpm
    networks:
      - geoserver-net

  nginx:
    image: nginx:1.19
    ports:
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
    networks:
      - geoserver-net

networks:
  geoserver-net:
    driver: bridge
