{
    "desc": "CVE-2017-6920 is a critical vulnerability found in Drupal, a widely used content management system. This vulnerability is located in Drupal Core's YAML parser and affects versions prior to 8.3.4. The issue arises from the improper handling of YAML parsing, specifically when dealing with the `!php/object` tag. An attacker can exploit this vulnerability by crafting a serialized object with a `!php/object` tag, which is then processed by the `yaml_parse` function. This can lead to unsafe deserialization and the potential execution of arbitrary PHP code. The vulnerability is triggered when external input is passed to the `Yaml::decode` function in `ConfigSingleImportForm.php`, which calls the `YamlPecl::decode` method if the YAML extension is installed. To exploit this vulnerability, an attacker needs to serialize a `GuzzleHttp\\Psr7\\FnStream` class and prepend it with a `!php/object` tag. The attacker must then log in as an administrator and access the configuration import page at `/admin/config/development/configuration/single/import` to import the crafted YAML, executing the embedded PHP code. This vulnerability allows attackers to gain unauthorized access or escalate privileges within the system, emphasizing the importance of securing file upload functionalities and ensuring that access controls are correctly implemented and enforced.",
    "attack_type": "Remote Code Execution",
    "services": [
        {
            "name": "drupal",
            "version": [
                "8.0.0",
                "8.1.0",
                "8.1.1",
                "8.1.2",
                "8.1.3",
                "8.1.4",
                "8.1.5",
                "8.1.6",
                "8.1.7",
                "8.2.0",
                "8.2.1",
                "8.2.2",
                "8.2.3",
                "8.2.4",
                "8.2.5",
                "8.2.6",
                "8.2.7",
                "8.2.8",
                "8.3.0",
                "8.3.1",
                "8.3.2",
                "8.3.3"
            ],
            "dependency_type": "HARD",
            "description": "Drupal is the content management system that contains the vulnerability in its YAML parser, allowing for remote code execution."
        },
        {
            "name": "php",
            "version": [
                "7.0"
            ],
            "dependency_type": "SOFT",
            "description": "PHP is required to run Drupal and to exploit the vulnerability through the YAML parser."
        },
        {
            "name": "mysql",
            "version": [
                "5.7"
            ],
            "dependency_type": "SOFT-DB",
            "description": "MySQL serves as the database for storing Drupal data and is necessary for running a Drupal instance."
        },
        {
            "name": "nginx",
            "version": [
                "1.19"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx acts as the web server to host the Drupal application, allowing HTTP requests to reach Drupal."
        }
    ],
    "input_tokens": 8951,
    "output_tokens": 760
}