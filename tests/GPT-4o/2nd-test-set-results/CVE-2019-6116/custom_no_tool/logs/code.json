{
    "files": [
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/docker-compose.yml",
            "content": "services:\n  ghostscript:\n    build: ./ghostscript\n    container_name: ghostscript\n    volumes:\n      - ./scripts:/scripts\n    command: tail -f /dev/null\n\n  imagemagick:\n    image: dpokidov/imagemagick:7.0.8-14\n    container_name: imagemagick\n    volumes:\n      - ./scripts:/scripts\n    depends_on:\n      - ghostscript\n\n  python:\n    image: python:3.7\n    container_name: python\n    volumes:\n      - ./scripts:/scripts\n    working_dir: /scripts\n    depends_on:\n      - imagemagick\n    command: python script.py\n"
        },
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/scripts/script.py",
            "content": "import os\n\n# This script would typically be used to demonstrate the vulnerability by processing a crafted file\n# For safety, this example assumes the presence of a crafted file named 'exploit.ps' in the scripts directory\n\nexploit_file = 'exploit.ps'\n\n# Command to use ImageMagick to convert the crafted PostScript file to another format, triggering Ghostscript\ncommand = f'convert {exploit_file} output.png'\n\n# Execute the command\nos.system(command)\n\nprint(\"Executed ImageMagick convert command with potential exploit file.\")\n"
        },
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/scripts/exploit.ps",
            "content": "%!PS\n\n% This is a crafted PostScript file intended to exploit the Ghostscript vulnerability\n% For demonstration purposes, this file does not contain actual exploit code\n\nuserdict begin\n  /exploit (This is a test exploit for CVE-2019-6116) def\n  exploit\nend\n\nshowpage\n"
        },
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/ghostscript/Dockerfile",
            "content": "FROM debian:bullseye\n\nRUN apt-get update && \\\n    apt-get install -y build-essential wget && \\\n    wget https://github.com/ArtifexSoftware/ghostpdl-downloads/releases/download/gs926/ghostscript-9.26.tar.gz && \\\n    tar -xzf ghostscript-9.26.tar.gz && \\\n    cd ghostscript-9.26 && \\\n    ./configure && \\\n    make && \\\n    make install && \\\n    cd .. && \\\n    rm -rf ghostscript-9.26 ghostscript-9.26.tar.gz && \\\n    apt-get remove --purge -y build-essential wget && \\\n    apt-get autoremove -y && \\\n    rm -rf /var/lib/apt/lists/*\n\nCMD [\"tail\", \"-f\", \"/dev/null\"]\n"
        }
    ],
    "directory_tree": "CVE-2019-6116/\n|-- custom_no_tool/\n|   |-- docker-compose.yml\n|   |-- ghostscript/\n|   |   `-- Dockerfile\n|   `-- scripts/\n|       |-- script.py\n|       `-- exploit.ps\n"
}