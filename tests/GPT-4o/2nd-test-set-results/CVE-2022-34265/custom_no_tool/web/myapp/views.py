from django.shortcuts import render
from django.db.models.functions import Trunc
from .models import Event

# This view is vulnerable to SQL injection via the 'kind' parameter
# Example: /events/?kind=year

def event_list(request):
    kind = request.GET.get('kind', 'day')  # Default to 'day' if no kind is provided
    events = Event.objects.annotate(truncated_date=Trunc('date', kind)).all()
    return render(request, 'event_list.html', {'events': events})
