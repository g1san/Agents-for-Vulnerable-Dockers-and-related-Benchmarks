{
    "files": [
        {
            "location": "./../../dockers/CVE-2022-34265/custom_no_tool/docker-compose.yml",
            "content": "version: '3.9'\n\nservices:\n  web:\n    build: ./web\n    ports:\n      - \"8000:8000\"\n    depends_on:\n      db:\n        condition: service_healthy\n\n  db:\n    image: postgres:14\n    environment:\n      POSTGRES_DB: django_db\n      POSTGRES_USER: django_user\n      POSTGRES_PASSWORD: django_pass\n    ports:\n      - \"5432:5432\"\n    volumes:\n      - db_data:/var/lib/postgresql/data\n      - ./init.sql:/docker-entrypoint-initdb.d/init.sql\n    healthcheck:\n      test: [\"CMD\", \"pg_isready\", \"-U\", \"django_user\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n\nvolumes:\n  db_data:\n"
        },
        {
            "location": "./../../dockers/CVE-2022-34265/custom_no_tool/web/Dockerfile",
            "content": "# Use Python 3.9 as the base image\nFROM python:3.9\n\n# Install netcat-openbsd for the wait-for-it script\nRUN apt-get update && apt-get install -y netcat-openbsd && rm -rf /var/lib/apt/lists/*\n\n# Set the working directory in the container\nWORKDIR /app\n\n# Copy the current directory contents into the container at /app\nCOPY . /app\n\n# Install any needed packages specified in requirements.txt\nRUN pip install --no-cache-dir -r requirements.txt\n\n# Add wait-for-it script\nCOPY wait-for-it.sh /wait-for-it.sh\nRUN chmod +x /wait-for-it.sh\n\n# Make port 8000 available to the world outside this container\nEXPOSE 8000\n\n# Run app.py when the container launches\nCMD [\"/wait-for-it.sh\", \"db:5432\", \"--\", \"python\", \"manage.py\", \"runserver\", \"0.0.0.0:8000\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2022-34265/custom_no_tool/web/requirements.txt",
            "content": "Django==3.2.13\npsycopg2==2.9.3\n"
        },
        {
            "location": "./../../dockers/CVE-2022-34265/custom_no_tool/web/manage.py",
            "content": "#!/usr/bin/env python\nimport os\nimport sys\n\ndef main():\n    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'mysite.settings')\n    try:\n        from django.core.management import execute_from_command_line\n    except ImportError as exc:\n        raise ImportError(\n            \"Couldn't import Django. Are you sure it's installed and \"\n            \"available on your PYTHONPATH environment variable? Did you \"\n            \"forget to activate a virtual environment?\"\n        ) from exc\n    execute_from_command_line(sys.argv)\n\nif __name__ == '__main__':\n    main()\n"
        },
        {
            "location": "./../../dockers/CVE-2022-34265/custom_no_tool/web/mysite/settings.py",
            "content": "from pathlib import Path\n\n# Build paths inside the project like this: BASE_DIR / 'subdir'.\nBASE_DIR = Path(__file__).resolve().parent.parent\n\n# SECURITY WARNING: keep the secret key used in production secret!\nSECRET_KEY = 'django-insecure-please_change_this_key'\n\n# SECURITY WARNING: don't run with debug turned on in production!\nDEBUG = True\n\nALLOWED_HOSTS = ['*']\n\n# Application definition\nINSTALLED_APPS = [\n    'django.contrib.admin',\n    'django.contrib.auth',\n    'django.contrib.contenttypes',\n    'django.contrib.sessions',\n    'django.contrib.messages',\n    'django.contrib.staticfiles',\n    'myapp',\n]\n\nMIDDLEWARE = [\n    'django.middleware.security.SecurityMiddleware',\n    'django.contrib.sessions.middleware.SessionMiddleware',\n    'django.middleware.common.CommonMiddleware',\n    'django.middleware.csrf.CsrfViewMiddleware',\n    'django.contrib.auth.middleware.AuthenticationMiddleware',\n    'django.contrib.messages.middleware.MessageMiddleware',\n    'django.middleware.clickjacking.XFrameOptionsMiddleware',\n]\n\nROOT_URLCONF = 'mysite.urls'\n\nTEMPLATES = [\n    {\n        'BACKEND': 'django.template.backends.django.DjangoTemplates',\n        'DIRS': [],\n        'APP_DIRS': True,\n        'OPTIONS': {\n            'context_processors': [\n                'django.template.context_processors.debug',\n                'django.template.context_processors.request',\n                'django.contrib.auth.context_processors.auth',\n                'django.contrib.messages.context_processors.messages',\n            ],\n        },\n    },\n]\n\nWSGI_APPLICATION = 'mysite.wsgi.application'\n\n# Database\n# https://docs.djangoproject.com/en/3.2/ref/settings/#databases\n\nDATABASES = {\n    'default': {\n        'ENGINE': 'django.db.backends.postgresql',\n        'NAME': 'django_db',\n        'USER': 'django_user',\n        'PASSWORD': 'django_pass',\n        'HOST': 'db',\n        'PORT': '5432',\n    }\n}\n\n# Password validation\n# https://docs.djangoproject.com/en/3.2/ref/settings/#auth-password-validators\n\nAUTH_PASSWORD_VALIDATORS = [\n    {\n        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',\n    },\n    {\n        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',\n    },\n    {\n        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',\n    },\n    {\n        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',\n    },\n]\n\n# Internationalization\n# https://docs.djangoproject.com/en/3.2/topics/i18n/\n\nLANGUAGE_CODE = 'en-us'\n\nTIME_ZONE = 'UTC'\n\nUSE_I18N = True\n\nUSE_L10N = True\n\nUSE_TZ = True\n\n# Static files (CSS, JavaScript, Images)\n# https://docs.djangoproject.com/en/3.2/howto/static-files/\n\nSTATIC_URL = '/static/'\n\n# Default primary key field type\n# https://docs.djangoproject.com/en/3.2/ref/settings/#default-auto-field\n\nDEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'\n"
        },
        {
            "location": "./../../dockers/CVE-2022-34265/custom_no_tool/web/mysite/urls.py",
            "content": "from django.contrib import admin\nfrom django.urls import path, include\n\nurlpatterns = [\n    path('admin/', admin.site.urls),\n    path('', include('myapp.urls')),\n]\n"
        },
        {
            "location": "./../../dockers/CVE-2022-34265/custom_no_tool/web/mysite/wsgi.py",
            "content": "import os\n\nfrom django.core.wsgi import get_wsgi_application\n\nos.environ.setdefault('DJANGO_SETTINGS_MODULE', 'mysite.settings')\n\napplication = get_wsgi_application()\n"
        },
        {
            "location": "./../../dockers/CVE-2022-34265/custom_no_tool/web/myapp/__init__.py",
            "content": ""
        },
        {
            "location": "./../../dockers/CVE-2022-34265/custom_no_tool/web/myapp/admin.py",
            "content": "from django.contrib import admin\nfrom .models import Event\n\nadmin.site.register(Event)\n"
        },
        {
            "location": "./../../dockers/CVE-2022-34265/custom_no_tool/web/myapp/apps.py",
            "content": "from django.apps import AppConfig\n\nclass MyappConfig(AppConfig):\n    default_auto_field = 'django.db.models.BigAutoField'\n    name = 'myapp'\n"
        },
        {
            "location": "./../../dockers/CVE-2022-34265/custom_no_tool/web/myapp/models.py",
            "content": "from django.db import models\n\nclass Event(models.Model):\n    name = models.CharField(max_length=100)\n    date = models.DateField()\n\n    def __str__(self):\n        return self.name\n"
        },
        {
            "location": "./../../dockers/CVE-2022-34265/custom_no_tool/web/myapp/urls.py",
            "content": "from django.urls import path\nfrom . import views\n\nurlpatterns = [\n    path('events/', views.event_list, name='event_list'),\n]\n"
        },
        {
            "location": "./../../dockers/CVE-2022-34265/custom_no_tool/web/myapp/views.py",
            "content": "from django.shortcuts import render\nfrom django.db.models.functions import Trunc\nfrom .models import Event\n\n# This view is vulnerable to SQL injection via the 'kind' parameter\n# Example: /events/?kind=year\n\ndef event_list(request):\n    kind = request.GET.get('kind', 'day')  # Default to 'day' if no kind is provided\n    events = Event.objects.annotate(truncated_date=Trunc('date', kind)).all()\n    return render(request, 'event_list.html', {'events': events})\n"
        },
        {
            "location": "./../../dockers/CVE-2022-34265/custom_no_tool/web/myapp/templates/event_list.html",
            "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Event List</title>\n</head>\n<body>\n    <h1>Events</h1>\n    <ul>\n        {% for event in events %}\n            <li>{{ event.name }} on {{ event.truncated_date }}</li>\n        {% endfor %}\n    </ul>\n</body>\n</html>\n"
        },
        {
            "location": "./../../dockers/CVE-2022-34265/custom_no_tool/web/wait-for-it.sh",
            "content": "#!/usr/bin/env bash\n#   Use this script to test if a given TCP host/port are available\n\n# The MIT License (MIT)\n#\n# Copyright (c) 2016 Vincent Demeester\n#\n# Permission is hereby granted, free of charge, to any person obtaining a copy\n# of this software and associated documentation files (the \"Software\"), to deal\n# in the Software without restriction, including without limitation the rights\n# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n# copies of the Software, and to permit persons to whom the Software is\n# furnished to do so, subject to the following conditions:\n#\n# The above copyright notice and this permission notice shall be included in\n# all copies or substantial portions of the Software.\n#\n# THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n# THE SOFTWARE.\n\n\nTIMEOUT=15\nQUIET=0\n\nfunction usage()\n{\n    echo \"Usage: wait-for-it.sh host:port [-s] [-t timeout] [-- command args]\"\n    echo \"-h HOST | --host=HOST       Host or IP under test\"\n    echo \"-p PORT | --port=PORT       TCP port under test\"\n    echo \"-s | --strict               Only execute subcommand if the test succeeds\"\n    echo \"-q | --quiet                Don't output any status messages\"\n    echo \"-t TIMEOUT | --timeout=TIMEOUT\"\n    echo \"                            Timeout in seconds, zero for no timeout\"\n    echo \"-- COMMAND ARGS             Execute command with args after the test finishes\"\n    exit 1\n}\n\nwhile [[ $# -gt 0 ]]\ndo\n    case \"$1\" in\n        *:*)\n        HOST=\"${1%:*}\"\n        PORT=\"${1##*:}\"\n        shift 1\n        ;;\n        -h)\n        HOST=\"$2\"\n        if [[ \"$HOST\" == \"\" ]]; then break; fi\n        shift 2\n        ;;\n        --host=*)\n        HOST=\"${1#*=}\"\n        shift 1\n        ;;\n        -p)\n        PORT=\"$2\"\n        if [[ \"$PORT\" == \"\" ]]; then break; fi\n        shift 2\n        ;;\n        --port=*)\n        PORT=\"${1#*=}\"\n        shift 1\n        ;;\n        -q | --quiet)\n        QUIET=1\n        shift 1\n        ;;\n        -s | --strict)\n        STRICT=1\n        shift 1\n        ;;\n        -t)\n        TIMEOUT=\"$2\"\n        if [[ \"$TIMEOUT\" == \"\" ]]; then break; fi\n        shift 2\n        ;;\n        --timeout=*)\n        TIMEOUT=\"${1#*=}\"\n        shift 1\n        ;;\n        --)\n        shift\n        CLI=\"$@\"\n        break\n        ;;\n        --help)\n        usage\n        ;;\n        *)\n        echo \"Unknown argument: $1\"\n        usage\n        ;;\n    esac\n\ndone\n\nif [[ \"$HOST\" == \"\" || \"$PORT\" == \"\" ]]; then\n    echo \"Error: you need to provide a host and port to test.\"\n    usage\nfi\n\nfor i in `seq $TIMEOUT`;\ndo\n    nc -z \"$HOST\" \"$PORT\"\n    result=$?\n    if [[ $result -eq 0 ]]; then\n        if [[ $QUIET -ne 1 ]]; then echo \"Success: $HOST:$PORT is available\"; fi\n        if [[ \"$CLI\" != \"\" ]]; then\n            exec $CLI\n        fi\n        exit 0\n    fi\n    sleep 1\n\ndone\n\nif [[ $STRICT -eq 1 ]]; then\n    echo \"Timeout occurred after waiting $TIMEOUT seconds for $HOST:$PORT\"\n    exit 1\nfi\n\nif [[ $QUIET -ne 1 ]]; then echo \"Timeout occurred after waiting $TIMEOUT seconds for $HOST:$PORT\"; fi\n\nif [[ \"$CLI\" != \"\" ]]; then\n    exec $CLI\nfi\n\nexit 0\n"
        },
        {
            "location": "./../../dockers/CVE-2022-34265/custom_no_tool/init.sql",
            "content": "-- Initialize the database with test data\n\nCREATE TABLE IF NOT EXISTS event (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100),\n    date DATE\n);\n\nINSERT INTO event (name, date) VALUES\n('Event 1', '2023-01-01'),\n('Event 2', '2023-02-01'),\n('Event 3', '2023-03-01');\n"
        }
    ],
    "directory_tree": "CVE-2022-34265/\n|-- custom_no_tool/\n    |-- docker-compose.yml\n    |-- init.sql\n    |-- web/\n        |-- Dockerfile\n        |-- manage.py\n        |-- mysite/\n            |-- __init__.py\n            |-- settings.py\n            |-- urls.py\n            |-- wsgi.py\n        |-- myapp/\n            |-- __init__.py\n            |-- admin.py\n            |-- apps.py\n            |-- models.py\n            |-- templates/\n                |-- event_list.html\n            |-- urls.py\n            |-- views.py\n        |-- requirements.txt\n        |-- wait-for-it.sh\n"
}