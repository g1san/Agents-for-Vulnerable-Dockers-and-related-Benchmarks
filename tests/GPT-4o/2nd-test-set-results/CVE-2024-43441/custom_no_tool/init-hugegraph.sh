#!/bin/bash

# Wait for Cassandra to be ready
until cqlsh -e 'describe keyspaces'; do
  echo "Waiting for Cassandra to be ready..."
  sleep 5
done

# Wait for HugeGraph server to be ready
until curl -s http://localhost:8080/graphs; do
  echo "Waiting for HugeGraph server to be ready..."
  sleep 5
done

# Initialize HugeGraph Schema
curl -X POST -H "Content-Type: application/json" \
     -d '{
            "name": "person",
            "properties": {
                "name": "text",
                "age": "int"
            }
        }' \
     http://localhost:8080/graphs/hugegraph/schema/vertexlabels

# Add sample data
curl -X POST -H "Content-Type: application/json" \
     -d '{
            "label": "person",
            "properties": {
                "name": "John",
                "age": 30
            }
        }' \
     http://localhost:8080/graphs/hugegraph/vertices

curl -X POST -H "Content-Type: application/json" \
     -d '{
            "label": "person",
            "properties": {
                "name": "Jane",
                "age": 25
            }
        }' \
     http://localhost:8080/graphs/hugegraph/vertices
