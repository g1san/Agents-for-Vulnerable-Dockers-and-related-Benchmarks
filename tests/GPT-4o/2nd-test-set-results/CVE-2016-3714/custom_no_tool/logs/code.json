{
    "files": [
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/docker-compose.yml",
            "content": "services:\n  web:\n    image: nginx:1.19\n    ports:\n      - \"8080:80\"\n    volumes:\n      - ./html:/var/www/html\n    depends_on:\n      - php\n\n  php:\n    image: php:7.4-fpm\n    volumes:\n      - ./html:/var/www/html\n\n  imagemagick:\n    build: ./imagemagick\n    volumes:\n      - ./html:/var/www/html\n    depends_on:\n      - php\n    command: [\"tail\", \"-f\", \"/dev/null\"]\n\nvolumes:\n  html:\n"
        },
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/imagemagick/Dockerfile",
            "content": "FROM debian:bullseye-slim\n\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends \\\n    wget \\\n    build-essential \\\n    libjpeg-dev \\\n    libpng-dev \\\n    libtiff-dev \\\n    libtool \\\n    ca-certificates \\\n    && rm -rf /var/lib/apt/lists/*\n\n# Download and build ImageMagick 6.9.3-8 (as 6.9.3-9 is not available)\nWORKDIR /usr/src\nRUN wget https://download.imagemagick.org/archive/releases/ImageMagick-6.9.3-8.tar.gz && \\\n    tar xzf ImageMagick-6.9.3-8.tar.gz && \\\n    cd ImageMagick-6.9.3-8 && \\\n    ./configure && \\\n    make && \\\n    make install && \\\n    ldconfig && \\\n    cd .. && \\\n    rm -rf ImageMagick-6.9.3-8 ImageMagick-6.9.3-8.tar.gz\n\nWORKDIR /var/www/html\n\nCMD [\"tail\", \"-f\", \"/dev/null\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/html/index.php",
            "content": "<?php\n// index.php\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_FILES['image'])) {\n    $uploadfile = '/var/www/html/' . basename($_FILES['image']['name']);\n\n    if (move_uploaded_file($_FILES['image']['tmp_name'], $uploadfile)) {\n        echo \"Image uploaded successfully.\\n\";\n        echo \"<pre>\";\n        // Convert the image using ImageMagick\n        system(\"convert \" . escapeshellarg($uploadfile) . \" /var/www/html/output.png\");\n        echo \"</pre>\";\n    } else {\n        echo \"Possible file upload attack!\";\n    }\n}\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Image Upload</title>\n</head>\n<body>\n    <h1>Upload an Image</h1>\n    <form enctype=\"multipart/form-data\" action=\"index.php\" method=\"POST\">\n        <input type=\"file\" name=\"image\" accept=\"image/*\">\n        <input type=\"submit\" value=\"Upload\">\n    </form>\n</body>\n</html>\n"
        }
    ],
    "directory_tree": "CVE-2016-3714/\n|-- custom_no_tool\n|   |-- docker-compose.yml\n|   |-- html\n|   |   `-- index.php\n|   `-- imagemagick\n|       `-- Dockerfile\n"
}