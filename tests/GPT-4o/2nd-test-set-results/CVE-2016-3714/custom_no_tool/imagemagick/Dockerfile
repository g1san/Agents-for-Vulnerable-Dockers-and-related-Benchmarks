FROM debian:bullseye-slim

RUN apt-get update && \
    apt-get install -y --no-install-recommends \
    wget \
    build-essential \
    libjpeg-dev \
    libpng-dev \
    libtiff-dev \
    libtool \
    ca-certificates \
    && rm -rf /var/lib/apt/lists/*

# Download and build ImageMagick 6.9.3-8 (as 6.9.3-9 is not available)
WORKDIR /usr/src
RUN wget https://download.imagemagick.org/archive/releases/ImageMagick-6.9.3-8.tar.gz && \
    tar xzf ImageMagick-6.9.3-8.tar.gz && \
    cd ImageMagick-6.9.3-8 && \
    ./configure && \
    make && \
    make install && \
    ldconfig && \
    cd .. && \
    rm -rf ImageMagick-6.9.3-8 ImageMagick-6.9.3-8.tar.gz

WORKDIR /var/www/html

CMD ["tail", "-f", "/dev/null"]
