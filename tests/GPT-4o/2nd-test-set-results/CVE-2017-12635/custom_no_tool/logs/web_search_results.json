{
    "desc": "CVE-2017-12635 is a critical vulnerability affecting Apache CouchDB, a NoSQL database. This vulnerability arises due to discrepancies between the Erlang-based and JavaScript-based JSON parsers used by CouchDB. Specifically, it allows remote privilege escalation by exploiting the way CouchDB handles JSON payloads with duplicate 'roles' keys in the _users database. Non-admin users can submit documents with duplicate roles keys, including the _admin role, which can lead to unauthorized administrative access. The Erlang parser stores both values, while the JavaScript parser retains only the last one. This mismatch allows attackers to escalate privileges by submitting specially crafted HTTP requests, bypassing authentication mechanisms and potentially compromising the database. The vulnerability affects Apache CouchDB versions 1.7.0 and 2.x before 2.1.1. To mitigate this issue, users should upgrade to version 2.1.1 or later, or configure CouchDB to require valid user authentication by setting 'require_valid_user' to true.",
    "attack_type": "Remote Privilege Escalation",
    "services": [
        {
            "name": "couchdb",
            "version": [
                "1.7.0",
                "2.0.0",
                "2.0.1"
            ],
            "dependency_type": "HARD",
            "description": "Apache CouchDB is the main service affected by CVE-2017-12635. The vulnerability exists in specific versions of CouchDB, allowing remote privilege escalation due to improper handling of JSON payloads."
        },
        {
            "name": "erlang",
            "version": [
                "20.0"
            ],
            "dependency_type": "SOFT",
            "description": "Erlang is required to run CouchDB as it is built on the Erlang OTP platform. The specified version is compatible with the vulnerable CouchDB versions."
        },
        {
            "name": "ubuntu",
            "version": [
                "16.04"
            ],
            "dependency_type": "SOFT",
            "description": "Ubuntu serves as the operating system for running the Docker container. It provides a stable environment for CouchDB and Erlang."
        }
    ],
    "input_tokens": 6995,
    "output_tokens": 846
}