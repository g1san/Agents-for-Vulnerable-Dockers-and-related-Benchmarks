{
    "desc": "CVE-2023-46604 is a vulnerability in the Java OpenWire protocol marshaller that affects both ActiveMQ Classic and ActiveMQ Artemis brokers and Java-based OpenWire clients. It allows remote code execution by enabling a remote attacker with network access to manipulate serialized class types in the OpenWire protocol. This manipulation can cause a broker or client to instantiate any class on the classpath, leading to the potential execution of arbitrary code. The vulnerability is exploited by sending a crafted OpenWire command, which requires network access and a class on the classpath capable of executing arbitrary code via a String parameter. The exploit commonly uses the Spring dependency `ClassPathXmlApplicationContext` to load a malicious XML application configuration file over HTTP. Although Artemis does not include Spring by default, it still contains the vulnerable code, making it necessary to upgrade to the latest versions of ActiveMQ Classic and Artemis to mitigate the risk.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "rmohr/activemq",
            "version": [
                "5.15.15",
                "5.16.6",
                "5.17.5",
                "5.18.2"
            ],
            "dependency_type": "HARD",
            "description": "Apache ActiveMQ is the primary service affected by CVE-2023-46604. It is essential to have a vulnerable version of ActiveMQ to replicate the vulnerability."
        },
        {
            "name": "openjdk",
            "version": [
                "8-jdk",
                "11-jdk"
            ],
            "dependency_type": "SOFT",
            "description": "OpenJDK is required to run Java applications, including the ActiveMQ broker, which is necessary for testing the vulnerability."
        },
        {
            "name": "nginx",
            "version": [
                "1.21.3"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx is used as a web server to potentially serve the malicious XML application configuration file needed to exploit the vulnerability."
        }
    ],
    "input_tokens": 4341,
    "output_tokens": 771
}