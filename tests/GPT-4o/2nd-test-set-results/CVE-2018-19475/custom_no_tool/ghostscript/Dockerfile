FROM debian:10

# Install necessary packages for building Ghostscript and Python3
RUN echo "deb http://archive.debian.org/debian buster main" > /etc/apt/sources.list && \
    echo "deb http://archive.debian.org/debian-security buster/updates main" >> /etc/apt/sources.list && \
    apt-get update -o Acquire::Check-Valid-Until=false && \
    apt-get install -y --allow-unauthenticated wget build-essential python3 && \
    apt-get install -y --allow-unauthenticated libx11-dev libtiff5-dev libpng-dev && \
    wget https://github.com/ArtifexSoftware/ghostpdl-downloads/releases/download/gs925/ghostscript-9.25-linux-x86_64.tgz && \
    tar -xzf ghostscript-9.25-linux-x86_64.tgz && \
    mv ghostscript-9.25-linux-x86_64/gs-925-linux-x86_64 /usr/local/bin/gs && \
    rm -rf ghostscript-9.25-linux-x86_64.tgz ghostscript-9.25-linux-x86_64

COPY entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh

ENTRYPOINT ["/entrypoint.sh"]
