version: '3.8'

services:
  webui-aria2:
    build:
      context: ./webui-aria2
      dockerfile: Dockerfile
    container_name: webui-aria2
    volumes:
      - ./webui-aria2:/app
    working_dir: /app
    command: node node-server.js
    ports:
      - "8080:80"
    depends_on:
      - aria2

  aria2:
    image: p3terx/aria2-pro:latest
    container_name: aria2
    volumes:
      - ./aria2:/config
    ports:
      - "6801:6801"
    command: aria2c --conf-path=/config/aria2.conf --enable-rpc --rpc-listen-all=true --rpc-allow-origin-all --rpc-listen-port=6801 --rpc-secret=mysecret

  nginx:
    image: nginx:1.25.2
    container_name: nginx
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf
    ports:
      - "80:80"
    depends_on:
      - webui-aria2
