{
    "files": [
        {
            "location": "./../../dockers/CVE-2023-39141/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\n\nservices:\n  webui-aria2:\n    build:\n      context: ./webui-aria2\n      dockerfile: Dockerfile\n    container_name: webui-aria2\n    volumes:\n      - ./webui-aria2:/app\n    working_dir: /app\n    command: node node-server.js\n    ports:\n      - \"8080:80\"\n    depends_on:\n      - aria2\n\n  aria2:\n    image: p3terx/aria2-pro:latest\n    container_name: aria2\n    volumes:\n      - ./aria2:/config\n    ports:\n      - \"6801:6801\"\n    command: aria2c --conf-path=/config/aria2.conf --enable-rpc --rpc-listen-all=true --rpc-allow-origin-all --rpc-listen-port=6801 --rpc-secret=mysecret\n\n  nginx:\n    image: nginx:1.25.2\n    container_name: nginx\n    volumes:\n      - ./nginx/nginx.conf:/etc/nginx/nginx.conf\n    ports:\n      - \"80:80\"\n    depends_on:\n      - webui-aria2\n"
        },
        {
            "location": "./../../dockers/CVE-2023-39141/custom_no_tool/webui-aria2/Dockerfile",
            "content": "FROM node:18.17.0\n\nWORKDIR /app\n\nRUN apt-get update && apt-get install -y git \\\n    && git clone https://github.com/ziahamza/webui-aria2.git . \\\n    && git checkout 109903f0e2774cf948698cd95a01f77f33d7dd2c\n\nCOPY . .\n\nCMD [\"node\", \"node-server.js\"]"
        },
        {
            "location": "./../../dockers/CVE-2023-39141/custom_no_tool/webui-aria2/node-server.js",
            "content": "const http = require('http');\nconst fs = require('fs');\nconst path = require('path');\n\nconst server = http.createServer((req, res) => {\n  // Normalize and sanitize the file path\n  const safePath = path.normalize(path.join(__dirname, req.url));\n  if (!safePath.startsWith(__dirname)) {\n    res.writeHead(403, {'Content-Type': 'text/plain'});\n    res.write('Forbidden');\n    res.end();\n    return;\n  }\n\n  fs.readFile(safePath, (err, data) => {\n    if (err) {\n      res.writeHead(404, {'Content-Type': 'text/plain'});\n      res.write('Not Found');\n      res.end();\n    } else {\n      res.writeHead(200, {'Content-Type': 'text/html'});\n      res.write(data);\n      res.end();\n    }\n  });\n});\n\nserver.listen(80, () => {\n  console.log('Server running at http://0.0.0.0:80/');\n});"
        },
        {
            "location": "./../../dockers/CVE-2023-39141/custom_no_tool/webui-aria2/index.html",
            "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>WebUI Aria2</title>\n</head>\n<body>\n    <h1>Welcome to WebUI Aria2</h1>\n</body>\n</html>"
        },
        {
            "location": "./../../dockers/CVE-2023-39141/custom_no_tool/nginx/nginx.conf",
            "content": "events {}\n\nhttp {\n    server {\n        listen 80;\n\n        location / {\n            proxy_pass http://webui-aria2:80;\n        }\n    }\n}"
        },
        {
            "location": "./../../dockers/CVE-2023-39141/custom_no_tool/aria2/aria2.conf",
            "content": "dir=/downloads\nfile-allocation=none\nlog-level=notice\nmax-concurrent-downloads=5\nenable-rpc=true\nrpc-listen-all=true\nrpc-allow-origin-all=true\nrpc-listen-port=6801\nrpc-secret=mysecret"
        }
    ],
    "directory_tree": "CVE-2023-39141/\n\u251c\u2500\u2500 custom_no_tool\n\u2502   \u251c\u2500\u2500 docker-compose.yml\n\u2502   \u251c\u2500\u2500 webui-aria2\n\u2502   \u2502   \u251c\u2500\u2500 Dockerfile\n\u2502   \u2502   \u251c\u2500\u2500 index.html\n\u2502   \u2502   \u2514\u2500\u2500 node-server.js\n\u2502   \u251c\u2500\u2500 nginx\n\u2502   \u2502   \u2514\u2500\u2500 nginx.conf\n\u2502   \u2514\u2500\u2500 aria2\n\u2502       \u2514\u2500\u2500 aria2.conf\n"
}