{
    "files": [
        {
            "location": "./../../dockers/CVE-2018-15685/custom_no_tool/docker-compose.yml",
            "content": "services:\n  electron-app:\n    build: ./electron-app\n    ports:\n      - \"3000:3000\"\n    environment:\n      - NODE_ENV=development\n    volumes:\n      - ./electron-app:/app\n    depends_on:\n      - nodejs\n\n  nodejs:\n    image: node:8.11.4\n    volumes:\n      - ./electron-app:/app\n    working_dir: /app\n    command: npm install && npm start\n"
        },
        {
            "location": "./../../dockers/CVE-2018-15685/custom_no_tool/electron-app/Dockerfile",
            "content": "# Use a specific version of Node.js with a supported Debian base\nFROM node:8.11.4-stretch\n\n# Install necessary libraries for Electron GUI\nRUN apt-get update && \\\n    apt-get install -y libgtk-3-0 libnotify-dev libgconf-2-4 libnss3 libxss1 libasound2 xvfb && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Set working directory\nWORKDIR /app\n\n# Copy application files\nCOPY . /app\n\n# Install dependencies\nRUN npm install\n\n# Expose the application port\nEXPOSE 3000\n\n# Start Xvfb and the Electron app\nCMD [\"/bin/sh\", \"-c\", \"Xvfb :99 -screen 0 1024x768x16 & PATH=./node_modules/.bin:$PATH npm start\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2018-15685/custom_no_tool/electron-app/package.json",
            "content": "{\n  \"name\": \"vulnerable-electron-app\",\n  \"version\": \"1.0.0\",\n  \"main\": \"main.js\",\n  \"scripts\": {\n    \"start\": \"DISPLAY=:99 electron .\"\n  },\n  \"dependencies\": {\n    \"electron\": \"3.0.0-beta.7\"\n  }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2018-15685/custom_no_tool/electron-app/main.js",
            "content": "const { app, BrowserWindow } = require('electron');\n\nfunction createWindow() {\n  const win = new BrowserWindow({\n    width: 800,\n    height: 600,\n    webPreferences: {\n      nodeIntegration: false,\n      nativeWindowOpen: false,\n      contextIsolation: true,\n      sandbox: false\n    }\n  });\n\n  win.loadFile('index.html');\n}\n\napp.whenReady().then(createWindow);\n\napp.on('window-all-closed', () => {\n  if (process.platform !== 'darwin') {\n    app.quit();\n  }\n});\n\napp.on('activate', () => {\n  if (BrowserWindow.getAllWindows().length === 0) {\n    createWindow();\n  }\n});\n"
        },
        {
            "location": "./../../dockers/CVE-2018-15685/custom_no_tool/electron-app/index.html",
            "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Vulnerable Electron App</title>\n</head>\n<body>\n  <h1>Vulnerable Electron App</h1>\n  <script>\n    // Example script to demonstrate iframe vulnerability\n    const iframe = document.createElement('iframe');\n    iframe.srcdoc = `\n      <script>\n        console.log('Iframe script running');\n      <\\/script>\n    `;\n    document.body.appendChild(iframe);\n  </script>\n</body>\n</html>\n"
        }
    ],
    "directory_tree": "CVE-2018-15685/\n\u2514\u2500\u2500 custom_no_tool/\n    \u251c\u2500\u2500 docker-compose.yml\n    \u2514\u2500\u2500 electron-app/\n        \u251c\u2500\u2500 Dockerfile\n        \u251c\u2500\u2500 package.json\n        \u251c\u2500\u2500 main.js\n        \u2514\u2500\u2500 index.html"
}