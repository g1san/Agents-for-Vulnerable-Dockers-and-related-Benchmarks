# Use a specific version of Node.js with a supported Debian base
FROM node:8.11.4-stretch

# Install necessary libraries for Electron GUI
RUN apt-get update && \
    apt-get install -y libgtk-3-0 libnotify-dev libgconf-2-4 libnss3 libxss1 libasound2 xvfb && \
    rm -rf /var/lib/apt/lists/*

# Set working directory
WORKDIR /app

# Copy application files
COPY . /app

# Install dependencies
RUN npm install

# Expose the application port
EXPOSE 3000

# Start Xvfb and the Electron app
CMD ["/bin/sh", "-c", "Xvfb :99 -screen 0 1024x768x16 & PATH=./node_modules/.bin:$PATH npm start"]
