{
    "files": [
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\n\nservices:\n  vulnerable-app:\n    build: ./vulnerable-app\n    ports:\n      - \"8080:8080\"\n    depends_on:\n      - rmi-server\n\n  rmi-server:\n    build: ./rmi-server\n    expose:\n      - \"1099\"\n\n  nginx:\n    image: nginx:1.21.6\n    ports:\n      - \"80:80\"\n    volumes:\n      - ./nginx/nginx.conf:/etc/nginx/nginx.conf\n    depends_on:\n      - vulnerable-app\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/vulnerable-app/Dockerfile",
            "content": "FROM openjdk:8-jdk-slim\n\nCOPY . /app\nWORKDIR /app\n\nRUN ./gradlew build\n\nCMD [\"java\", \"-jar\", \"build/libs/vulnerable-app.jar\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/vulnerable-app/build.gradle",
            "content": "plugins {\n    id 'java'\n    id 'application'\n}\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    implementation 'com.alibaba:fastjson:1.2.24'\n}\n\napplication {\n    mainClassName = 'com.example.VulnerableApp'\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/vulnerable-app/src/main/java/com/example/VulnerableApp.java",
            "content": "package com.example;\n\nimport com.alibaba.fastjson.JSON;\nimport com.alibaba.fastjson.JSONObject;\nimport spark.Spark;\n\npublic class VulnerableApp {\n    public static void main(String[] args) {\n        Spark.port(8080);\n        Spark.post(\"/parse\", (req, res) -> {\n            String json = req.body();\n            JSONObject object = JSON.parseObject(json);\n            return object.toJSONString();\n        });\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/rmi-server/Dockerfile",
            "content": "FROM openjdk:8-jdk-slim\n\nCOPY . /app\nWORKDIR /app\n\nRUN javac Exploit.java\n\nCMD [\"rmiregistry\", \"1099\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/rmi-server/Exploit.java",
            "content": "import java.io.Serializable;\n\npublic class Exploit implements Serializable {\n    static {\n        try {\n            Runtime.getRuntime().exec(\"touch /tmp/exploited\");\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2017-18349/custom_no_tool/nginx/nginx.conf",
            "content": "events {}\nhttp {\n    server {\n        listen 80;\n\n        location / {\n            proxy_pass http://vulnerable-app:8080;\n        }\n    }\n}\n"
        }
    ],
    "directory_tree": "CVE-2017-18349/\n\u251c\u2500\u2500 custom_no_tool\n\u2502   \u251c\u2500\u2500 docker-compose.yml\n\u2502   \u251c\u2500\u2500 nginx\n\u2502   \u2502   \u2514\u2500\u2500 nginx.conf\n\u2502   \u251c\u2500\u2500 rmi-server\n\u2502   \u2502   \u251c\u2500\u2500 Dockerfile\n\u2502   \u2502   \u2514\u2500\u2500 Exploit.java\n\u2502   \u2514\u2500\u2500 vulnerable-app\n\u2502       \u251c\u2500\u2500 Dockerfile\n\u2502       \u251c\u2500\u2500 build.gradle\n\u2502       \u2514\u2500\u2500 src\n\u2502           \u2514\u2500\u2500 main\n\u2502               \u2514\u2500\u2500 java\n\u2502                   \u2514\u2500\u2500 com\n\u2502                       \u2514\u2500\u2500 example\n\u2502                           \u2514\u2500\u2500 VulnerableApp.java"
}