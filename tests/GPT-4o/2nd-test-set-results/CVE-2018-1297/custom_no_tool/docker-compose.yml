services:
  jmeter:
    image: justb4/jmeter:3.3
    ports:
      - "1099:1099"  # Default RMI port
    environment:
      - JVM_ARGS=-Djava.rmi.server.hostname=0.0.0.0
    command: ["-n", "-t", "/jmeter/test.jmx", "-l", "/jmeter/results.jtl"]
    volumes:
      - ./jmeter:/jmeter
    networks:
      - jmeter_net

  openjdk:
    image: adoptopenjdk:8-jdk-hotspot
    networks:
      - jmeter_net

  nginx:
    image: nginx:1.21.6
    ports:
      - "8080:80"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf
    networks:
      - jmeter_net

networks:
  jmeter_net:
    driver: bridge
