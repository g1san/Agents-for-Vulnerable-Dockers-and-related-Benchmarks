{
    "desc": "CVE-2023-35042 is a critical vulnerability in GeoServer 2 that allows remote attackers to execute arbitrary code. The vulnerability is associated with the Jiffle map algebra language provided by the jai-ext library. It arises from improper control of code generation, allowing attackers to execute arbitrary code via `java.lang.Runtime.getRuntime().exec` through `wps:LiteralData` in a `wps:Execute` request. This is due to Jiffle's script-to-Java compilation using the Janino library. The vulnerability was actively exploited in June 2023. Mitigation involves removing the `janino-<version>.jar` file from the GeoServer's WEB-INF/lib directory, disabling Jiffle's ability to compile scripts into Java code, which prevents the execution of malicious scripts. The vulnerability has a CVSS score of 9.8, indicating high severity, with potential impacts on confidentiality, integrity, and availability.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "geoserver",
            "version": [
                "2.18.5",
                "2.19.0",
                "2.19.1",
                "2.19.2",
                "2.19.3",
                "2.19.4",
                "2.20.0",
                "2.20.1",
                "2.20.2",
                "2.20.3",
                "2.20.4"
            ],
            "dependency_type": "HARD",
            "description": "GeoServer is the main service where the vulnerability exists, specifically in versions prior to 2.18.6 and certain versions between 2.19.0 and 2.20.4."
        },
        {
            "name": "openjdk",
            "version": [
                "8-jdk"
            ],
            "dependency_type": "SOFT",
            "description": "OpenJDK is required to run GeoServer, as it is a Java-based application."
        },
        {
            "name": "postgres",
            "version": [
                "14.4"
            ],
            "dependency_type": "SOFT-DB",
            "description": "PostgreSQL is used as a database backend to store GeoServer's spatial data."
        },
        {
            "name": "nginx",
            "version": [
                "1.21.6"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx is used as a reverse proxy to handle HTTP requests to GeoServer."
        }
    ],
    "input_tokens": 7140,
    "output_tokens": 897
}