{
    "desc": "CVE-2023-4450 is a critical remote code execution vulnerability found in JeecgBoot's JimuReport tool, specifically affecting versions prior to 1.6.0. The vulnerability arises from the improper handling of user-supplied template data processed by the FreeMarker template engine. The endpoint `/jeecg-boot/jmreport/queryFieldBySql` is vulnerable to injection of malicious FreeMarker expressions within SQL queries, which are executed without proper validation. This flaw allows attackers to execute arbitrary system commands using FreeMarker classes like `freemarker.template.utility.Execute`, potentially leading to full system compromise if the endpoint is publicly accessible. The vulnerability can be exploited by sending a specially crafted payload to the vulnerable endpoint, leveraging FreeMarker's template utility for command execution. It has been tested on JDK 17 and above, where traditional reflection-based techniques are restricted by the named module mechanism introduced in JDK 9 and further enforced in JDK 17. Exploitation involves using `MethodHandles.Lookup` to bypass these restrictions and execute commands. Mitigation involves updating to version 1.6.1 or later, restricting endpoint access, implementing input validation, disabling dangerous template methods, and monitoring for suspicious activities.",
    "attack_type": "Remote Code Execution",
    "services": [
        {
            "name": "jeecgboot/jimureport",
            "version": [
                "1.0.0",
                "1.0.1",
                "1.0.2",
                "1.0.3",
                "1.0.4",
                "1.0.5",
                "1.0.6",
                "1.0.7",
                "1.0.8",
                "1.0.9",
                "1.1.0",
                "1.1.1",
                "1.1.2",
                "1.1.3",
                "1.1.4",
                "1.1.5",
                "1.1.6",
                "1.1.7",
                "1.1.8",
                "1.1.9",
                "1.2.0",
                "1.2.1",
                "1.2.2",
                "1.2.3",
                "1.2.4",
                "1.2.5",
                "1.2.6",
                "1.2.7",
                "1.2.8",
                "1.2.9",
                "1.3.0",
                "1.3.1",
                "1.3.2",
                "1.3.3",
                "1.3.4",
                "1.3.5",
                "1.3.6",
                "1.3.7",
                "1.3.8",
                "1.3.9",
                "1.4.0",
                "1.4.1",
                "1.4.2",
                "1.4.3",
                "1.4.4",
                "1.4.5",
                "1.4.6",
                "1.4.7",
                "1.4.8",
                "1.4.9",
                "1.5.0",
                "1.5.1",
                "1.5.2",
                "1.5.3",
                "1.5.4",
                "1.5.5",
                "1.5.6",
                "1.5.7",
                "1.5.8",
                "1.5.9"
            ],
            "dependency_type": "HARD",
            "description": "JimuReport is the vulnerable application that contains the CVE-2023-4450 vulnerability. It is essential to include this service to create a testable Docker system that replicates the vulnerability."
        },
        {
            "name": "openjdk",
            "version": [
                "17.0.8"
            ],
            "dependency_type": "SOFT",
            "description": "OpenJDK is required to run the JimuReport application, as the vulnerability has been tested on JDK 17 and above."
        },
        {
            "name": "mysql",
            "version": [
                "8.0"
            ],
            "dependency_type": "SOFT-DB",
            "description": "MySQL serves as the database backend for JimuReport, storing data that can be queried and manipulated through the vulnerable endpoint."
        },
        {
            "name": "nginx",
            "version": [
                "1.21"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx is used as a web server to serve the JimuReport application, providing access to the vulnerable endpoint."
        }
    ],
    "input_tokens": 11646,
    "output_tokens": 728
}