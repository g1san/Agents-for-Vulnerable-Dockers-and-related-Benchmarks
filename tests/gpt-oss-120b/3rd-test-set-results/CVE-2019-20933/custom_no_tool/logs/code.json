{
    "files": [
        {
            "location": "./../../dockers/CVE-2019-20933/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  influxdb:\n    image: influxdb:1.7.5\n    container_name: influxdb\n    ports:\n      - \"8086:8086\"\n    environment:\n      - INFLUXDB_DB=testdb\n      - INFLUXDB_ADMIN_ENABLED=true\n      - INFLUXDB_ADMIN_USER=admin\n      - INFLUXDB_ADMIN_PASSWORD=adminpass\n      - INFLUXDB_HTTP_AUTH_ENABLED=true\n    restart: unless-stopped\n\n  vulnerable_app:\n    build:\n      context: ./app\n    ports:\n      - \"8080:80\"\n    restart: unless-stopped\n    volumes:\n      - ./app:/var/www/html\n    depends_on:\n      - influxdb"
        },
        {
            "location": "./../../dockers/CVE-2019-20933/custom_no_tool/app/Dockerfile",
            "content": "FROM php:5.6-apache\nCOPY . /var/www/html/\nEXPOSE 80"
        },
        {
            "location": "./../../dockers/CVE-2019-20933/custom_no_tool/app/index.php",
            "content": "<?php\n// Simple demonstration of a path traversal vulnerability (CVE-2019-20933)\n// The script reads a file specified via the 'file' GET parameter without proper validation.\nif (isset($_GET['file'])) {\n    $file = $_GET['file'];\n    // No sanitisation \u2013 allows '../../../../etc/passwd' style traversal\n    $content = @file_get_contents($file);\n    if ($content === false) {\n        echo \"Unable to read file: \" . htmlspecialchars($file);\n    } else {\n        header('Content-Type: text/plain');\n        echo $content;\n    }\n} else {\n    echo \"Provide a file path via the 'file' query parameter, e.g., ?file=README.md\";\n}\n?>"
        }
    ],
    "directory_tree": "CVE-2019-20933/custom_no_tool"
}