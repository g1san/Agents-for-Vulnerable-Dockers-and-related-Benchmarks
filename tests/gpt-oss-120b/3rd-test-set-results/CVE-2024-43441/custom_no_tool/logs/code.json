{
    "files": [
        {
            "location": "./../../dockers/CVE-2024-43441/custom_no_tool/docker-compose.yml",
            "content": "services:\n  webapp:\n    build:\n      context: ./webapp\n    ports:\n      - \"5000:5000\"\n    depends_on:\n      - redis\n      - hugegraph\n    environment:\n      - REDIS_HOST=redis\n      - REDIS_PORT=6379\n\n  redis:\n    image: redis:6.2\n    command: [\"redis-server\", \"--protected-mode\", \"no\", \"--bind\", \"0.0.0.0\"]\n    ports:\n      - \"6379:6379\"\n\n  hugegraph:\n    build:\n      context: ./hugegraph\n    ports:\n      - \"8080:8080\"\n    environment:\n      - HUGRAPH_GREMLIN_SERVER_HOST=0.0.0.0\n      - HUGRAPH_GREMLIN_SERVER_PORT=8182\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8080\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n\n  hugegraph_init:\n    image: curlimages/curl:7.85.0\n    depends_on:\n      hugegraph:\n        condition: service_healthy\n    working_dir: /scripts\n    volumes:\n      - ./init_hugegraph:/scripts\n    command: [\"sh\", \"-c\", \"chmod +x /scripts/init.sh && /scripts/init.sh\"]\n    restart: \"no\"\n"
        },
        {
            "location": "./../../dockers/CVE-2024-43441/custom_no_tool/webapp/Dockerfile",
            "content": "FROM python:3.11-slim\nWORKDIR /app\nCOPY requirements.txt ./\nRUN pip install --no-cache-dir -r requirements.txt\nCOPY app.py ./\nEXPOSE 5000\nCMD [\"python\", \"app.py\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2024-43441/custom_no_tool/webapp/requirements.txt",
            "content": "flask==2.3.2\nredis==5.0.1\n"
        },
        {
            "location": "./../../dockers/CVE-2024-43441/custom_no_tool/webapp/app.py",
            "content": "import os\nfrom flask import Flask, request, jsonify\nimport redis\n\napp = Flask(__name__)\n\nredis_host = os.getenv('REDIS_HOST', 'localhost')\nredis_port = int(os.getenv('REDIS_PORT', 6379))\nclient = redis.Redis(host=redis_host, port=redis_port, decode_responses=True)\n\n@app.route('/')\ndef index():\n    return 'Secure Demo Application for CVE-2024-43441', 200\n\n@app.route('/retrieve', methods=['GET'])\ndef retrieve():\n    key = request.args.get('key')\n    if not key:\n        return jsonify({'error': 'key required'}), 400\n    value = client.get(key)\n    return jsonify({'key': key, 'value': value}), 200\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000)\n"
        },
        {
            "location": "./../../dockers/CVE-2024-43441/custom_no_tool/init_hugegraph/init.sh",
            "content": "#!/bin/sh\n# Simple initialization script for HugeGraph to create a test graph, vertex, and edge.\n# Adjust the payloads according to the actual HugeGraph REST API if necessary.\n\n# Wait a few seconds to ensure the HugeGraph HTTP service is ready.\nsleep 5\n\n# Add a vertex\ncurl -X POST http://hugegraph:8080/graphs/hugegraph/vertices \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\"id\":\"v1\",\"name\":\"sample vertex\"}'\n\n# Add another vertex\ncurl -X POST http://hugegraph:8080/graphs/hugegraph/vertices \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\"id\":\"v2\",\"name\":\"another vertex\"}'\n\n# Add an edge between the two vertices\ncurl -X POST http://hugegraph:8080/graphs/hugegraph/edges \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\"source\":\"v1\",\"target\":\"v2\",\"label\":\"connects\"}'\n\necho \"HugeGraph test data loaded.\"\n"
        },
        {
            "location": "./../../dockers/CVE-2024-43441/custom_no_tool/hugegraph/Dockerfile",
            "content": "FROM hugegraph/hugegraph:1.4.2\nRUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*\n"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2024-43441/custom_no_tool"
}