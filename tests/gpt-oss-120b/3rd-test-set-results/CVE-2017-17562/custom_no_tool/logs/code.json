{
    "files": [
        {
            "location": "./../../dockers/CVE-2017-17562/custom_no_tool/docker-compose.yml",
            "content": "services:\n  vulnerable:\n    build: ./app\n    environment:\n      - VULN=1\n    ports:\n      - \"5000:5000\"\n    depends_on:\n      - db\n      - goahead\n  db:\n    image: mysql:5.7\n    command: --default-authentication-plugin=mysql_native_password\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: testdb\n      MYSQL_USER: testuser\n      MYSQL_PASSWORD: testpass\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\n    ports:\n      - \"3306:3306\"\n  goahead:\n    build: ./goahead\n    environment:\n      - CGI_ENABLE=1\n    ports:\n      - \"8080:80\"\nvolumes:\n  db_data:"
        },
        {
            "location": "./../../dockers/CVE-2017-17562/custom_no_tool/app/Dockerfile",
            "content": "FROM python:3.9-slim\nWORKDIR /app\nCOPY requirements.txt .\nCOPY vuln_app.py .\nRUN pip install --no-cache-dir -r requirements.txt\nEXPOSE 5000\nCMD [\"python\", \"vuln_app.py\"]"
        },
        {
            "location": "./../../dockers/CVE-2017-17562/custom_no_tool/app/requirements.txt",
            "content": "Flask==2.2.2"
        },
        {
            "location": "./../../dockers/CVE-2017-17562/custom_no_tool/app/vuln_app.py",
            "content": "from flask import Flask, request, abort\nimport os\napp = Flask(__name__)\n\n@app.route('/')\ndef index():\n    return 'Vulnerable Flask app running in container.'\n\n# Vulnerable endpoint \u2013 reads arbitrary file path supplied via query parameter\n@app.route('/read')\ndef read_file():\n    path = request.args.get('path')\n    if not path:\n        abort(400, 'path parameter required')\n    # No validation \u2013 path traversal / host file read possible\n    try:\n        with open(path, 'r') as f:\n            data = f.read()\n        return f'<pre>{data}</pre>'\n    except Exception as e:\n        return f'Error: {e}', 500\n\nif __name__ == '__main__':\n    # Run as root and bind to all interfaces\n    app.run(host='0.0.0.0', port=5000)"
        },
        {
            "location": "./../../dockers/CVE-2017-17562/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE users (id INT AUTO_INCREMENT PRIMARY KEY, username VARCHAR(50), password VARCHAR(50));\nINSERT INTO users (username, password) VALUES ('alice', 'alice123'), ('bob', 'bob123');"
        },
        {
            "location": "./../../dockers/CVE-2017-17562/custom_no_tool/goahead/Dockerfile",
            "content": "FROM debian:bullseye-slim\n\n# Install required development tools, libraries and runtime SSL package (use libssl3 instead of libssl1.1)\nRUN apt-get update && apt-get install -y \\\n    wget \\\n    build-essential \\\n    autoconf \\\n    automake \\\n    libtool \\\n    libssl-dev \\\n    libssl3 \\\n    libpcre3-dev \\\n    zlib1g-dev \\\n    pkg-config \\\n    && rm -rf /var/lib/apt/lists/*\n\nWORKDIR /goahead\n\n# Download GoAhead source for version 3.6.4 (tag includes leading 'v')\nRUN wget -O goahead.tar.gz https://github.com/goahead/goahead/archive/refs/tags/v3.6.4.tar.gz \\\n    && tar -xzf goahead.tar.gz --strip-components=1 \\\n    && rm goahead.tar.gz\n\n# Generate the configure script and build\nRUN autoreconf -i \\\n    && ./configure --prefix=/usr/local \\\n    && make \\\n    && make install\n\n# Create document root required by GoAhead CGI\nRUN mkdir -p /var/www\n\n# Copy a minimal configuration file\nCOPY goahead.cfg /etc/goahead.cfg\n\n# Expose the default HTTP port used by GoAhead\nEXPOSE 80\n\n# Run GoAhead with the provided configuration file (full binary path)\nCMD [\"/usr/local/bin/goahead\", \"-c\", \"/etc/goahead.cfg\"]"
        },
        {
            "location": "./../../dockers/CVE-2017-17562/custom_no_tool/goahead/goahead.cfg",
            "content": "# Minimal GoAhead configuration\ncgi_enable = 1\ndoc_root = /var/www\nlisten_port = 80"
        }
    ],
    "directory_tree": "CVE-2017-17562/custom_no_tool"
}