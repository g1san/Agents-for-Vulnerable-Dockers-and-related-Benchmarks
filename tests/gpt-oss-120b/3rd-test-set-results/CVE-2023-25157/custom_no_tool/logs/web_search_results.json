{
    "desc": "CVE-2023-25157 is a critical SQL injection vulnerability in GeoServer, the open\u2011source Java based OGC server that publishes geospatial data. The flaw resides in the processing of OGC filter parameters (CQL_FILTER) used by the Web Feature Service (WFS) endpoint. GeoServer concatenates the filter string directly into a SQL query executed by the backend relational data store (such as PostGIS), without proper escaping or parameterisation. An attacker can supply a crafted CQL filter that is injected into the WHERE clause, allowing arbitrary SQL commands to be run against the database. This enables data exfiltration, data manipulation, and can lead to further host compromise depending on database privileges. The vulnerability affects GeoServer versions prior to the patched releases and is rated 9.8/10 (critical).",
    "attack_type": "SQL injection",
    "services": [
        {
            "name": "osgeo/geoserver",
            "version": [
                "2.21.3",
                "2.21.2",
                "2.21.1",
                "2.21.0",
                "2.20.7",
                "2.20.6",
                "2.20.5",
                "2.20.4",
                "2.20.3",
                "2.20.2",
                "2.20.1",
                "2.20.0",
                "2.19.7",
                "2.19.6",
                "2.19.5",
                "2.19.4",
                "2.19.3",
                "2.19.2",
                "2.19.1",
                "2.19.0"
            ],
            "dependency_type": "HARD",
            "description": "GeoServer provides the vulnerable OGC WFS endpoint that processes CQL_FILTER. Running a vulnerable version is essential for the SQL injection to be exploitable."
        },
        {
            "name": "postgres",
            "version": [
                "15"
            ],
            "dependency_type": "SOFT-DB",
            "description": "PostgreSQL (with optional PostGIS extension) acts as the relational database backend for GeoServer, enabling the execution of injected SQL statements."
        }
    ],
    "input_tokens": 11944,
    "output_tokens": 2689
}