FROM node:14-alpine
WORKDIR /usr/src/app
# Install required Alpine packages (MariaDB client, build tools, Python)
RUN apk add --no-cache mariadb-client build-base python3
# Copy package definition files and install Node dependencies
COPY package*.json ./
RUN npm install
# Copy application source code (including wait-for-db.sh)
COPY . ./
# Ensure the startup script is executable
RUN chmod +x wait-for-db.sh
EXPOSE 8080
ENTRYPOINT ["sh", "/usr/src/app/wait-for-db.sh"]