{
    "desc": "CVE\u20112020\u201117518 is a critical vulnerability in Apache Flink that allows an unauthenticated attacker to write arbitrary files to the server's filesystem via the Flink REST API. The flaw resides in the `FileUploadHandler` that processes multipart POST requests to the `/jars/upload` endpoint. The handler resolves the uploaded file name directly with `currentUploadDir.resolve(fileUpload.getFilename())` without sanitising the `filename` parameter. Because the filename is taken from user input, an attacker can include directory\u2011traversal sequences such as `../` to escape the intended upload directory. The handler then renames the temporary file to the resolved path, causing the Flink process to create or overwrite files anywhere it has write permissions. By placing a malicious JAR or script and subsequently triggering its execution through Flink's job submission APIs, the attacker can achieve remote code execution and gain full control over the host system. All Flink releases from 1.5.1 up to and including 1.11.2 are affected. The vulnerability was fixed in Flink 1.11.3 (and subsequently in 1.12.0 and later) by stripping path information with `new File(fileUpload.getFilename()).getName()`, which removes any directory components before resolution.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "apache/flink",
            "version": [
                "1.5.1",
                "1.6.0",
                "1.6.1",
                "1.6.2",
                "1.6.3",
                "1.6.4",
                "1.6.5",
                "1.7.0",
                "1.7.1",
                "1.7.2",
                "1.7.3",
                "1.7.4",
                "1.8.0",
                "1.8.1",
                "1.8.2",
                "1.8.3",
                "1.8.4",
                "1.8.5",
                "1.9.0",
                "1.9.1",
                "1.9.2",
                "1.9.3",
                "1.9.4",
                "1.10.0",
                "1.10.1",
                "1.10.2",
                "1.10.3",
                "1.11.0",
                "1.11.1",
                "1.11.2"
            ],
            "dependency_type": "HARD",
            "description": "Apache Flink provides the vulnerable REST endpoint `/jars/upload`. Versions listed are exactly the releases in which the FileUploadHandler flaw exists, making the container vulnerable to arbitrary file write and remote code execution."
        },
        {
            "name": "docker",
            "version": [
                "20.10.24"
            ],
            "dependency_type": "SOFT-CORE",
            "description": "Docker Engine is required to run the Flink container. Any recent stable version is compatible with the vulnerable Flink images."
        }
    ],
    "input_tokens": 7329,
    "output_tokens": 1433
}