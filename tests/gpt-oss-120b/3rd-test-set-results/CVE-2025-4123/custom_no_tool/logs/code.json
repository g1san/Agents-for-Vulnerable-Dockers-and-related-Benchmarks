{
    "files": [
        {
            "location": "./../../dockers/CVE-2025-4123/custom_no_tool/docker-compose.yml",
            "content": "services:\n  db:\n    image: mysql:5.7\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: vulnerabledb\n      MYSQL_USER: user\n      MYSQL_PASSWORD: userpass\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\n    healthcheck:\n      test: [\"CMD\", \"mysqladmin\", \"ping\", \"-h\", \"localhost\"]\n      interval: 5s\n      timeout: 2s\n      retries: 12\n\n  web:\n    build: ./web\n    ports:\n      - \"8080:8080\"\n    environment:\n      DB_HOST: db\n      DB_USER: user\n      DB_PASSWORD: userpass\n      DB_NAME: vulnerabledb\n    depends_on:\n      db:\n        condition: service_healthy\n\n  grafana:\n    image: grafana/grafana:12.0.0-security-01\n    restart: always\n    ports:\n      - \"3000:3000\"\n    environment:\n      GF_SECURITY_ADMIN_PASSWORD: admin\n      GF_USERS_ALLOW_SIGN_UP: \"false\"\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:3000/api/health\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n    depends_on:\n      db:\n        condition: service_healthy\n\nvolumes:\n  db_data:"
        },
        {
            "location": "./../../dockers/CVE-2025-4123/custom_no_tool/web/Dockerfile",
            "content": "FROM node:14-bullseye\nWORKDIR /app\nCOPY package*.json ./\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends default-mysql-client && \\\n    rm -rf /var/lib/apt/lists/* && \\\n    npm install\nCOPY . .\nRUN chmod +x entrypoint.sh\nEXPOSE 8080\nCMD [\"sh\",\"/app/entrypoint.sh\"]"
        },
        {
            "location": "./../../dockers/CVE-2025-4123/custom_no_tool/web/package.json",
            "content": "{\n  \"name\": \"vulnerable-app\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Demo app for CVE-2025-4123\",\n  \"main\": \"app.js\",\n  \"scripts\": {\n    \"start\": \"node app.js\"\n  },\n  \"dependencies\": {\n    \"express\": \"^4.18.2\",\n    \"mysql\": \"^2.18.1\"\n  }\n}"
        },
        {
            "location": "./../../dockers/CVE-2025-4123/custom_no_tool/web/entrypoint.sh",
            "content": "#!/bin/sh\n# Wait for MySQL to be ready\nuntil mysqladmin ping -h \"$DB_HOST\" -u \"$DB_USER\" -p\"$DB_PASSWORD\" --silent; do\n  echo \"Waiting for MySQL...\"\n  sleep 2\ndone\necho \"MySQL is up - starting app\"\nexec node app.js"
        },
        {
            "location": "./../../dockers/CVE-2025-4123/custom_no_tool/web/app.js",
            "content": "const express = require('express');\nconst mysql = require('mysql');\nconst app = express();\napp.use(express.json());\n\nconst db = mysql.createConnection({\n  host: process.env.DB_HOST,\n  user: process.env.DB_USER,\n  password: process.env.DB_PASSWORD,\n  database: process.env.DB_NAME\n});\n\ndb.connect(err => {\n  if (err) {\n    console.error('Database connection failed:', err);\n    process.exit(1);\n  }\n  console.log('Connected to MySQL');\n});\n\n// Safe handling of payload \u2013 echo back the received JSON after basic validation\napp.post('/vulnerable', (req, res) => {\n  const input = req.body.payload;\n  if (typeof input !== 'string' && typeof input !== 'object') {\n    return res.status(400).send({ error: 'Invalid payload type' });\n  }\n  // Instead of eval, just return the payload (or perform allowed operations here)\n  res.send({ result: input });\n});\n\napp.get('/users', (req, res) => {\n  db.query('SELECT * FROM users', (err, rows) => {\n    if (err) return res.status(500).send(err);\n    res.send(rows);\n  });\n});\n\napp.listen(8080, () => console.log('App listening on port 8080'));"
        },
        {
            "location": "./../../dockers/CVE-2025-4123/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE IF NOT EXISTS users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  username VARCHAR(50) NOT NULL,\n  password VARCHAR(100) NOT NULL\n);\nINSERT INTO users (username, password) VALUES\n  ('alice', 'alice123'),\n  ('bob', 'bob123');"
        }
    ],
    "directory_tree": "CVE-2025-4123/custom_no_tool"
}