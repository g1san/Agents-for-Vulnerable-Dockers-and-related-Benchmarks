{
    "files": [
        {
            "location": "./../../dockers/CVE-2010-2861/custom_no_tool/docker-compose.yml",
            "content": "services:\n  coldfusion:\n    build: ./coldfusion\n    ports:\n      - \"8500:8080\"\n    networks:\n      - cve-net\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: testdb\n    volumes:\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\n    ports:\n      - \"3306:3306\"\n    networks:\n      - cve-net\n  web:\n    build: ./web\n    ports:\n      - \"8080:80\"\n    networks:\n      - cve-net\nnetworks:\n  cve-net:\n    driver: bridge"
        },
        {
            "location": "./../../dockers/CVE-2010-2861/custom_no_tool/db/init.sql",
            "content": "CREATE DATABASE IF NOT EXISTS testdb;\nUSE testdb;\nCREATE TABLE users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    username VARCHAR(50) NOT NULL,\n    password VARCHAR(255) NOT NULL\n);\nINSERT INTO users (username, password) VALUES ('alice', 'password1'), ('bob', 'password2');"
        },
        {
            "location": "./../../dockers/CVE-2010-2861/custom_no_tool/coldfusion/Dockerfile",
            "content": "FROM tomcat:9.0-jdk11\n# Copy the CFIDE pages into the Tomcat webapps directory so they are reachable\nCOPY cfide/ /usr/local/tomcat/webapps/CFIDE/\nEXPOSE 8080"
        },
        {
            "location": "./../../dockers/CVE-2010-2861/custom_no_tool/coldfusion/cfide/enter.cfm",
            "content": "<cfparam name=\"url.locale\" default=\"default\">\n<!--- Whitelist of allowed locale templates --->\n<cfset allowedLocales = [\"default\", \"en\", \"fr\"]>\n<cfif arrayContains(allowedLocales, url.locale)>\n    <cfinclude template=\"#url.locale#.cfm\">\n<cfelse>\n    <!--- Fallback to a safe default template --->\n    <cfinclude template=\"default.cfm\">\n</cfif>"
        },
        {
            "location": "./../../dockers/CVE-2010-2861/custom_no_tool/coldfusion/cfide/default.cfm",
            "content": "<h2>Default CFIDE Page</h2>\n<p>This is a safe default page included when an invalid or missing locale is supplied.</p>"
        },
        {
            "location": "./../../dockers/CVE-2010-2861/custom_no_tool/web/Dockerfile",
            "content": "FROM php:7.4-apache\n# Install any additional packages if needed (none for this demo)\nCOPY public-html/ /var/www/html/\n# Ensure the CFIDE directory is available; it will be mounted as a volume from host\nEXPOSE 80"
        },
        {
            "location": "./../../dockers/CVE-2010-2861/custom_no_tool/web/public-html/index.php",
            "content": "<?php\n// Hardened demo page \u2013 only allows reads from the safe directory and blocks traversal attempts\n$baseDir = __DIR__ . '/safe/';\nif (isset($_GET['file'])) {\n    $requested = $_GET['file'];\n    // Reject any path containing \"..\" or starting with a slash (absolute paths)\n    if (strpos($requested, '..') !== false || strpos($requested, '/') === 0) {\n        http_response_code(400);\n        echo \"Invalid file request.\";\n        exit;\n    }\n    $fullPath = realpath($baseDir . $requested);\n    // Verify that the resolved path is inside the allowed base directory\n    if ($fullPath && strpos($fullPath, realpath($baseDir)) === 0 && is_file($fullPath)) {\n        readfile($fullPath);\n    } else {\n        http_response_code(404);\n        echo \"File not found.\";\n    }\n} else {\n    echo \"<h1>Hardened Demo</h1>\";\n    echo \"<p>Supply a filename via the 'file' query parameter to read files from the safe directory.</p>\";\n    echo \"<p>Example: <code>?file=example.txt</code></p>\";\n}\n?>"
        },
        {
            "location": "./../../dockers/CVE-2010-2861/custom_no_tool/web/public-html/safe/example.txt",
            "content": "This is a safe example file that can be read via the hardened index.php script."
        }
    ],
    "directory_tree": "CVE-2010-2861/custom_no_tool\n\u251c\u2500 docker-compose.yml\n\u251c\u2500 db\n\u2502  \u2514\u2500 init.sql\n\u251c\u2500 coldfusion\n\u2502  \u251c\u2500 Dockerfile\n\u2502  \u2514\u2500 cfide\n\u2502     \u251c\u2500 enter.cfm\n\u2502     \u2514\u2500 default.cfm\n\u251c\u2500 cfide\n\u2502  \u251c\u2500 enter.cfm\n\u2502  \u2514\u2500 default.cfm\n\u2514\u2500 web\n   \u251c\u2500 Dockerfile\n   \u2514\u2500 public-html\n      \u251c\u2500 index.php\n      \u251c\u2500 safe\n      \u2502  \u2514\u2500 example.txt\n"
}