{
    "files": [
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/docker-compose.yml",
            "content": "services:\n  vulnerable_dind:\n    build: .\n    privileged: true\n    environment:\n      - DOCKER_TLS_CERTDIR=\n    ports:\n      - \"2376:2376\"\n    command: [\"--host=tcp://0.0.0.0:2376\"]\n    restart: unless-stopped\n  ghostserve:\n    image: python:3-alpine\n    depends_on:\n      - vulnerable_dind\n    volumes:\n      - ./pdfs:/pdfs\n    working_dir: /pdfs\n    command: [\"python\", \"-m\", \"http.server\", \"8080\"]\n    ports:\n      - \"8080:8080\""
        },
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/Dockerfile",
            "content": "FROM docker:20.10-dind-buster\n\n# Ensure the Debian Buster repository is present and install the vulnerable Ghostscript version (9.26)\nRUN echo \"deb http://deb.debian.org/debian buster main\" > /etc/apt/sources.list && \\\n    apt-get update && \\\n    apt-get install -y --no-install-recommends ghostscript=9.26* && \\\n    apt-mark hold ghostscript && \\\n    rm -rf /var/lib/apt/lists/*"
        },
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/entrypoint.sh",
            "content": "#!/bin/sh\n# Compatibility placeholder \u2013 the container relies on the default Docker entrypoint.\n# If executed manually, it forwards arguments to the original entrypoint.\nexec /usr/local/bin/docker-entrypoint.sh \"$@\"\n"
        },
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/README.md",
            "content": "# CVE\u20112019\u20116116 Test Environment\n\nThis directory contains a ready\u2011to\u2011run Docker\u202fCompose stack that reproduces the vulnerable environment required for CVE\u20112019\u20116116.\n\n## How to start\n```bash\ncd ./../../dockers/CVE-2019-6116/custom_no_tool\ndocker compose up --build -d\n```\n\nThe stack consists of two services:\n\n* **vulnerable_dind** \u2013 a Docker\u2011in\u2011Docker daemon built on the Debian\u202fBuster\u2011based `docker:20.10-dind-buster` image. It installs the exact vulnerable `ghostscript` package (version\u202f9.26).\n* **ghostserve** \u2013 a lightweight Python HTTP server that serves the sample PDFs placed in the `pdfs` directory.\n\nBoth services are exposed on their default ports (2376 for the nested Docker daemon and 8080 for the HTTP server) and require no manual configuration.\n\n## Test data\nA single sample PDF (`sample.pdf`) is provided in the `pdfs` folder and can be accessed via:\n```\nhttp://localhost:8080/sample.pdf\n```"
        },
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/exploit.sh",
            "content": "#!/bin/sh\n# Example script that launches a container inside the DIND service and calls the vulnerable Ghostscript binary.\n# It demonstrates that the interpreter is present and can be invoked.\n\n# Connect to the nested daemon\nexport DOCKER_HOST=tcp://localhost:2376\n\n# Pull a tiny image and run gs on the sample PDF\ndocker run --rm -v $(pwd)/pdfs:/pdfs alpine:3.14 sh -c \"\\\n    apk add --no-cache ghostscript && \\\n    gs -dNOPAUSE -dBATCH -sDEVICE=png16m -r72 -sOutputFile=/dev/null /pdfs/sample.pdf\"\n"
        },
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/pdfs/sample.pdf",
            "content": "%PDF-1.4\n%\u00e2\u00e3\u00cf\u00d3\n1 0 obj\n<< /Type /Catalog /Pages 2 0 R >>\nendobj\n2 0 obj\n<< /Type /Pages /Kids [3 0 R] /Count 1 >>\nendobj\n3 0 obj\n<< /Type /Page /Parent 2 0 R /MediaBox [0 0 612 792] /Contents 4 0 R >>\nendobj\n4 0 obj\n<< /Length 55 >>\nstream\nBT\n/F1 24 Tf\n100 700 Td\n(This is a test PDF.) Tj\nET\nendstream\nendobj\nxref\n0 5\n0000000000 65535 f \n0000000010 00000 n \n0000000061 00000 n \n0000000116 00000 n \n0000000211 00000 n \ntrailer\n<< /Size 5 /Root 1 0 R >>\nstartxref\n297\n%%EOF"
        }
    ],
    "directory_tree": "CVE-2019-6116/custom_no_tool"
}