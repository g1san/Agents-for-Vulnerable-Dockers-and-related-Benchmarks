{
    "files": [
        {
            "location": "./../../dockers/CVE-2018-15685/custom_no_tool/docker-compose.yml",
            "content": "version: '3'\nservices:\n  registry:\n    image: registry:2.6.2\n    ports:\n      - \"5000:5000\"\n    volumes:\n      - ./registry:/var/lib/registry\n      - ./registry/config.yml:/etc/docker/registry/config.yml\n      - ./registry/htpasswd:/etc/docker/registry/htpasswd\n    environment:\n      - REGISTRY_AUTH=htpasswd\n      - REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm\n      - REGISTRY_AUTH_HTPASSWD_PATH=/etc/docker/registry/htpasswd\n\n  app:\n    build:\n      context: ./app\n    ports:\n      - \"8080:8080\"\n    depends_on:\n      - registry\n    environment:\n      - ELECTRON_ENABLE_LOGGING=1"
        },
        {
            "location": "./../../dockers/CVE-2018-15685/custom_no_tool/app/Dockerfile",
            "content": "FROM node:12.22.12-bullseye\n\n# Install system dependencies required for Electron, graphical libraries, and a virtual X server\nRUN apt-get update && apt-get install -y \\\n    libgtk-3-0 \\\n    libgtk2.0-0 \\\n    libnotify-dev \\\n    libgconf-2-4 \\\n    libnss3 \\\n    libxss1 \\\n    libasound2 \\\n    libxtst6 \\\n    libgbm-dev \\\n    libxcb-dri3-0 \\\n    libxcb-dri2-0 \\\n    libxcb-glx0 \\\n    libxcb-present0 \\\n    libxshmfence1 \\\n    ca-certificates \\\n    python3 \\\n    make \\\n    g++ \\\n    xvfb \\\n    && rm -rf /var/lib/apt/lists/*\n\n# Set working directory\nWORKDIR /app\n\n# Copy package definition files (excluding lockfile to avoid integrity issues)\nCOPY package.json ./\n\n# Install Node.js dependencies (including Electron)\nRUN npm install\n\n# Copy application source code\nCOPY . .\n\n# Expose a port for health\u2011check purposes\nEXPOSE 8080\n\n# Start the Electron application under a virtual X server\nCMD [\"xvfb-run\", \"npx\", \"electron\", \".\"]"
        },
        {
            "location": "./../../dockers/CVE-2018-15685/custom_no_tool/app/package.json",
            "content": "{\n  \"name\": \"vulnerable-electron-app\",\n  \"version\": \"1.0.0\",\n  \"main\": \"main.js\",\n  \"scripts\": {\n    \"start\": \"electron .\"\n  },\n  \"devDependencies\": {\n    \"electron\": \"1.8.7\"\n  }\n}"
        },
        {
            "location": "./../../dockers/CVE-2018-15685/custom_no_tool/app/main.js",
            "content": "const { app, BrowserWindow } = require('electron');\n\nfunction createWindow () {\n  const win = new BrowserWindow({\n    width: 800,\n    height: 600,\n    webPreferences: {\n      nodeIntegration: true,\n      contextIsolation: false\n    }\n  });\n  win.loadURL('data:text/html,<h1>Vulnerable Electron App</h1>');\n}\n\napp.whenReady().then(createWindow);\n\napp.on('window-all-closed', () => {\n  if (process.platform !== 'darwin') {\n    app.quit();\n  }\n});"
        },
        {
            "location": "./../../dockers/CVE-2018-15685/custom_no_tool/registry/config.yml",
            "content": "version: 0.1\nlog:\n  fields:\n    service: registry\nstorage:\n  filesystem:\n    rootdirectory: /var/lib/registry\nhttp:\n  addr: :5000"
        },
        {
            "location": "./../../dockers/CVE-2018-15685/custom_no_tool/registry/htpasswd",
            "content": "testuser:$2y$05$KJf1J0zN0pR6R9lB/2v6eO8hZV6Z9R2XvJd1Qx6yK4e8Y1a9C6gW"
        }
    ],
    "directory_tree": "CVE-2018-15685/custom_no_tool"
}