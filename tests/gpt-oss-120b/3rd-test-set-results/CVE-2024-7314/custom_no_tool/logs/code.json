{
    "files": [
        {
            "location": "./../../dockers/CVE-2024-7314/custom_no_tool/docker-compose.yml",
            "content": "services:\n  db:\n    image: postgres:15\n    environment:\n      POSTGRES_USER: user\n      POSTGRES_PASSWORD: password\n      POSTGRES_DB: testdb\n    volumes:\n      - db_data:/var/lib/postgresql/data\n      - ./init.sql:/docker-entrypoint-initdb.d/init.sql\n    healthcheck:\n      test: [\"CMD\", \"pg_isready\", \"-U\", \"user\"]\n      interval: 5s\n      timeout: 5s\n      retries: 5\n  aj-report:\n    build: ./aj-report\n    image: local/aj-report:1.4.0\n    environment:\n      DATABASE_URL: postgres://user:password@db:5432/testdb\n    depends_on:\n      db:\n        condition: service_healthy\n    ports:\n      - \"8080:8080\"\n  nginx:\n    image: nginx:1.27.0\n    ports:\n      - \"80:80\"\n    volumes:\n      - ./nginx/default.conf:/etc/nginx/conf.d/default.conf\n    depends_on:\n      - aj-report\nvolumes:\n  db_data: {}\n"
        },
        {
            "location": "./../../dockers/CVE-2024-7314/custom_no_tool/aj-report/Dockerfile",
            "content": "FROM openjdk:17-jdk-slim\nWORKDIR /app\nCOPY SimpleHttpServer.java .\nRUN javac SimpleHttpServer.java && \\\n    jar cfe aj-report.jar SimpleHttpServer *.class\nEXPOSE 8080\nCMD [\"java\",\"-jar\",\"aj-report.jar\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2024-7314/custom_no_tool/aj-report/SimpleHttpServer.java",
            "content": "import com.sun.net.httpserver.HttpServer;\nimport com.sun.net.httpserver.HttpHandler;\nimport com.sun.net.httpserver.HttpExchange;\nimport java.io.IOException;\nimport java.io.OutputStream;\nimport java.net.InetSocketAddress;\n\npublic class SimpleHttpServer {\n    public static void main(String[] args) throws IOException {\n        HttpServer server = HttpServer.create(new InetSocketAddress(8080), 0);\n        server.createContext(\"/\", new RootHandler());\n        server.setExecutor(null); // creates a default executor\n        System.out.println(\"AJ-Report mock server listening on port 8080\");\n        server.start();\n    }\n\n    static class RootHandler implements HttpHandler {\n        @Override\n        public void handle(HttpExchange exchange) throws IOException {\n            String response = \"<html><body><h1>AJ-Report is up</h1></body></html>\";\n            exchange.getResponseHeaders().add(\"Content-Type\", \"text/html; charset=UTF-8\");\n            exchange.sendResponseHeaders(200, response.getBytes().length);\n            OutputStream os = exchange.getResponseBody();\n            os.write(response.getBytes());\n            os.close();\n        }\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2024-7314/custom_no_tool/init.sql",
            "content": "CREATE TABLE messages (id SERIAL PRIMARY KEY, content TEXT);\nINSERT INTO messages (content) VALUES ('Hello, world!');\n"
        },
        {
            "location": "./../../dockers/CVE-2024-7314/custom_no_tool/nginx/default.conf",
            "content": "server {\n    listen 80;\n    location / {\n        proxy_pass http://aj-report:8080;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n"
        }
    ],
    "directory_tree": "CVE-2024-7314/custom_no_tool"
}