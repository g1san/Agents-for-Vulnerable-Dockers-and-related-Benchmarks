{
    "desc": "CVE\u20112019\u20116341 is a stored cross\u2011site scripting vulnerability in the core File (image) module of the Drupal content management system. When a user uploads an image file (for example a user picture) Drupal stores the file under the public files directory (/sites/default/files/pictures/\u2026) using the original filename without sufficient validation of the file\u2019s contents or metadata. An attacker can supply a crafted file that appears to be an image (such as a GIF with a .gif extension) but whose payload contains HTML and JavaScript. The file is saved unchanged and the URL to the file is predictable. When any other user (authenticated or anonymous) accesses that URL, the embedded script is executed in the victim\u2019s browser in the context of the Drupal site, allowing theft of cookies, session hijacking, phishing, or further attacks. The vulnerability affects Drupal 7 versions prior to 7.65, Drupal 8.5 versions prior to 8.5.14, and Drupal 8.6 versions prior to 8.6.13. The fix was introduced in Drupal 7.65, 8.5.14 and 8.6.13 by adding proper sanitisation of uploaded file content and metadata.",
    "attack_type": "cross site scripting",
    "services": [
        {
            "name": "drupal",
            "version": [
                "7.0",
                "7.1",
                "7.2",
                "7.3",
                "7.4",
                "7.5",
                "7.6",
                "7.7",
                "7.8",
                "7.9",
                "7.10",
                "7.11",
                "7.12",
                "7.13",
                "7.14",
                "7.15",
                "7.16",
                "7.17",
                "7.18",
                "7.19",
                "7.20",
                "7.21",
                "7.22",
                "7.23",
                "7.24",
                "7.25",
                "7.26",
                "7.27",
                "7.28",
                "7.29",
                "7.30",
                "7.31",
                "7.32",
                "7.33",
                "7.34",
                "7.35",
                "7.36",
                "7.37",
                "7.38",
                "7.39",
                "7.40",
                "7.41",
                "7.42",
                "7.43",
                "7.44",
                "7.45",
                "7.46",
                "7.47",
                "7.48",
                "7.49",
                "7.50",
                "7.51",
                "7.52",
                "7.53",
                "7.54",
                "7.55",
                "7.56",
                "7.57",
                "7.58",
                "7.59",
                "7.60",
                "7.61",
                "7.62",
                "7.63",
                "7.64",
                "8.5.0",
                "8.5.1",
                "8.5.2",
                "8.5.3",
                "8.5.4",
                "8.5.5",
                "8.5.6",
                "8.5.7",
                "8.5.8",
                "8.5.9",
                "8.5.10",
                "8.5.11",
                "8.5.12",
                "8.5.13",
                "8.6.0",
                "8.6.1",
                "8.6.2",
                "8.6.3",
                "8.6.4",
                "8.6.5",
                "8.6.6",
                "8.6.7",
                "8.6.8",
                "8.6.9",
                "8.6.10",
                "8.6.11",
                "8.6.12"
            ],
            "dependency_type": "HARD",
            "description": "Core Drupal CMS image/file handling service that contains the vulnerable File module. Required to reproduce the file upload path and stored cross\u2011site scripting vulnerability."
        },
        {
            "name": "mysql",
            "version": [
                "5.7"
            ],
            "dependency_type": "SOFT-DB",
            "description": "Relational database service required by Drupal to store site configuration, users and content. Not directly related to the vulnerability but needed for a functional Drupal installation."
        }
    ],
    "input_tokens": 5899,
    "output_tokens": 1714
}