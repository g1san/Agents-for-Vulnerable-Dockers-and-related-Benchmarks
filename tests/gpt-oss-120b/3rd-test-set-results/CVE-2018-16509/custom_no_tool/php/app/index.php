<?php
// Simple PoC for CVE-2018-16509 demonstrating vulnerable Ghostscript usage
// The script expects an EPS file upload via the 'file' POST field
if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_FILES['file'])) {
    $tmp = $_FILES['file']['tmp_name'];
    // Pass the uploaded file to Ghostscript (the vulnerable version is installed in the container)
    $output = [];
    $returnVar = 0;
    exec("gs -q -dNOPAUSE -dBATCH -sDEVICE=pngalpha -o /dev/null $tmp", $output, $returnVar);
    echo "Ghostscript execution return code: $returnVar\n";
    echo "Output: " . implode("\n", $output);
} else {
    echo "Upload an EPS file using a POST request with the field name 'file'.";
}
?>