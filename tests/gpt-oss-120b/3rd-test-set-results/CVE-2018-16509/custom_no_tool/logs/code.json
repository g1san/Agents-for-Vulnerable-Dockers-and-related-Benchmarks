{
    "files": [
        {
            "location": "./../../dockers/CVE-2018-16509/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  web:\n    build:\n      context: ./web\n    ports:\n      - \"80:80\"\n    depends_on:\n      - php\n    volumes:\n      - ./php/app:/usr/share/nginx/html\n    networks:\n      - appnet\n  php:\n    build:\n      context: ./php\n    volumes:\n      - ./php/app:/var/www/html\n    depends_on:\n      - db\n    networks:\n      - appnet\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: vulnerabledb\n      MYSQL_USER: user\n      MYSQL_PASSWORD: userpass\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\n    ports:\n      - \"3306:3306\"\n    networks:\n      - appnet\nnetworks:\n  appnet:\n    driver: bridge\nvolumes:\n  db_data:"
        },
        {
            "location": "./../../dockers/CVE-2018-16509/custom_no_tool/web/Dockerfile",
            "content": "FROM nginx:1.15-alpine\nCOPY default.conf /etc/nginx/conf.d/default.conf"
        },
        {
            "location": "./../../dockers/CVE-2018-16509/custom_no_tool/web/default.conf",
            "content": "server {\n    listen 80;\n    root /usr/share/nginx/html;\n    index index.php index.html;\n    location ~ \\.php$ {\n        fastcgi_pass php:9000;\n        fastcgi_index index.php;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        include fastcgi_params;\n    }\n}"
        },
        {
            "location": "./../../dockers/CVE-2018-16509/custom_no_tool/php/Dockerfile",
            "content": "FROM php:7.4-fpm-alpine3.13\n\n# Install build dependencies, runtime libraries, vulnerable Ghostscript, and Python stack\nRUN apk add --no-cache \\\n        $PHPIZE_DEPS \\\n        build-base \\\n        zlib-dev \\\n        libpng-dev \\\n        libjpeg-turbo-dev \\\n        freetype-dev \\\n        ghostscript=9.23-r0 \\\n        python3 \\\n        py3-pip \\\n        python3-dev \\\n    && docker-php-ext-configure gd --with-freetype --with-jpeg \\\n    && docker-php-ext-install mysqli pdo pdo_mysql gd \\\n    && python3 -m ensurepip \\\n    && pip3 install --no-cache-dir flask pillow \\\n    && apk del $PHPIZE_DEPS build-base python3-dev \\\n    && rm -rf /var/cache/apk/* /root/.cache"
        },
        {
            "location": "./../../dockers/CVE-2018-16509/custom_no_tool/php/php.ini",
            "content": "display_errors=On\nlog_errors=On\nerror_reporting=E_ALL"
        },
        {
            "location": "./../../dockers/CVE-2018-16509/custom_no_tool/php/app/index.php",
            "content": "<?php\n// Simple PoC for CVE-2018-16509 demonstrating vulnerable Ghostscript usage\n// The script expects an EPS file upload via the 'file' POST field\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_FILES['file'])) {\n    $tmp = $_FILES['file']['tmp_name'];\n    // Pass the uploaded file to Ghostscript (the vulnerable version is installed in the container)\n    $output = [];\n    $returnVar = 0;\n    exec(\"gs -q -dNOPAUSE -dBATCH -sDEVICE=pngalpha -o /dev/null $tmp\", $output, $returnVar);\n    echo \"Ghostscript execution return code: $returnVar\\n\";\n    echo \"Output: \" . implode(\"\\n\", $output);\n} else {\n    echo \"Upload an EPS file using a POST request with the field name 'file'.\";\n}\n?>"
        },
        {
            "location": "./../../dockers/CVE-2018-16509/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE users (id INT AUTO_INCREMENT PRIMARY KEY, username VARCHAR(50), email VARCHAR(100));\nINSERT INTO users (username, email) VALUES ('alice', 'alice@example.com'), ('bob', 'bob@example.com');"
        }
    ],
    "directory_tree": "CVE-2018-16509/custom_no_tool"
}