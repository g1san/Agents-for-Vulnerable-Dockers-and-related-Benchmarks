{
    "desc": "CVE-2017-8386 is a vulnerability in Git's restricted login shell (git-shell). The git-shell program limits SSH users to a small whitelist of Git commands (git-receive-pack, git-upload-pack, git-upload-archive) and any administrator\u2011provided scripts. When one of these allowed commands is invoked with the '--help' option, Git calls the system 'man' utility to display the manual page. The 'man' program pipes its formatted output to the pager 'less'. If the SSH session allocates a pseudo\u2011terminal, 'less' runs in interactive mode and exposes its built\u2011in commands such as '!<cmd>', ':e <file>', and 'Shift+E' which allow the user to execute arbitrary shell commands, read arbitrary files, and write files. By forcing a PTY (e.g., using 'ssh -t'), an attacker can trigger this behaviour, causing 'less' to provide a shell\u2011like environment and thereby escape the restrictions imposed by git-shell. The result is remote authenticated arbitrary command execution and full read/write access to the filesystem, effectively a privilege\u2011escalation vulnerability on any server that uses git-shell as the login shell for SSH access.",
    "attack_type": "remote authenticated arbitrary command execution",
    "services": [
        {
            "name": "git",
            "version": [
                "2.4.11",
                "2.5.5",
                "2.6.6",
                "2.7.4",
                "2.8.4",
                "2.9.3",
                "2.10.2",
                "2.11.1",
                "2.12.2",
                "2.13.0"
            ],
            "dependency_type": "HARD",
            "description": "Provides the vulnerable git-shell binary. Versions listed are the exact releases that do not contain the fix for CVE-2017-8386; upgrading to any of the patched versions eliminates the vulnerability."
        },
        {
            "name": "ubuntu",
            "version": [
                "20.04"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Base operating system image that includes OpenSSH server; required to accept SSH connections and run git-shell."
        }
    ],
    "input_tokens": 12624,
    "output_tokens": 2899
}