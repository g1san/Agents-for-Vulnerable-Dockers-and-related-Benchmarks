{
    "files": [
        {
            "location": "./../../dockers/CVE-2017-8386/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  vulnerable-struts:\n    build:\n      context: ./web\n    ports:\n      - \"8080:8080\"\n    restart: unless-stopped"
        },
        {
            "location": "./../../dockers/CVE-2017-8386/custom_no_tool/web/Dockerfile",
            "content": "FROM maven:3.9-eclipse-temurin-8 AS build\nWORKDIR /app\n\n# Copy the entire project (pom and source files)\nCOPY . /app\n\n# Adjust project structure for Maven standard layout\nRUN mkdir -p src/main && mv webapp src/main/webapp\n\n# Build the WAR (skip tests for speed)\nRUN mvn -B package -DskipTests\n\n# ---------- Final image ----------\nFROM tomcat:8.5-jre8\n# Clean default webapps\nRUN rm -rf /usr/local/tomcat/webapps/*\n# Deploy the built WAR as ROOT\nCOPY --from=build /app/target/vulnerable-struts-1.0.0.war /usr/local/tomcat/webapps/ROOT.war\nEXPOSE 8080"
        },
        {
            "location": "./../../dockers/CVE-2017-8386/custom_no_tool/web/pom.xml",
            "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n  <modelVersion>4.0.0</modelVersion>\n  <groupId>com.example</groupId>\n  <artifactId>vulnerable-struts</artifactId>\n  <version>1.0.0</version>\n  <packaging>war</packaging>\n  <name>vulnerable-struts</name>\n  <properties>\n    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n    <maven.compiler.source>1.8</maven.compiler.source>\n    <maven.compiler.target>1.8</maven.compiler.target>\n  </properties>\n  <dependencies>\n    <dependency>\n      <groupId>org.apache.struts</groupId>\n      <artifactId>struts2-core</artifactId>\n      <version>2.3.32</version>\n    </dependency>\n    <dependency>\n      <groupId>org.apache.struts</groupId>\n      <artifactId>struts2-convention-plugin</artifactId>\n      <version>2.3.32</version>\n    </dependency>\n    <dependency>\n      <groupId>org.apache.logging.log4j</groupId>\n      <artifactId>log4j-api</artifactId>\n      <version>2.17.2</version>\n    </dependency>\n    <dependency>\n      <groupId>org.apache.logging.log4j</groupId>\n      <artifactId>log4j-core</artifactId>\n      <version>2.17.2</version>\n    </dependency>\n    <dependency>\n      <groupId>org.apache.logging.log4j</groupId>\n      <artifactId>log4j-slf4j-impl</artifactId>\n      <version>2.17.2</version>\n    </dependency>\n    <dependency>\n      <groupId>org.codehaus.plexus</groupId>\n      <artifactId>plexus-utils</artifactId>\n      <version>3.4.2</version>\n    </dependency>\n    <dependency>\n      <groupId>ognl</groupId>\n      <artifactId>ognl</artifactId>\n      <version>3.2.21</version>\n    </dependency>\n    <dependency>\n      <groupId>commons-fileupload</groupId>\n      <artifactId>commons-fileupload</artifactId>\n      <version>1.5</version>\n    </dependency>\n    <dependency>\n      <groupId>commons-io</groupId>\n      <artifactId>commons-io</artifactId>\n      <version>2.13.0</version>\n    </dependency>\n    <dependency>\n      <groupId>org.freemarker</groupId>\n      <artifactId>freemarker</artifactId>\n      <version>2.3.31</version>\n    </dependency>\n    <dependency>\n      <groupId>org.apache.velocity</groupId>\n      <artifactId>velocity-engine-core</artifactId>\n      <version>2.3</version>\n    </dependency>\n    <dependency>\n      <groupId>org.slf4j</groupId>\n      <artifactId>slf4j-api</artifactId>\n      <version>1.7.36</version>\n    </dependency>\n    <!-- Servlet API supplied by Tomcat -->\n    <dependency>\n      <groupId>javax.servlet</groupId>\n      <artifactId>javax.servlet-api</artifactId>\n      <version>3.1.0</version>\n      <scope>provided</scope>\n    </dependency>\n  </dependencies>\n  <build>\n    <plugins>\n      <plugin>\n        <groupId>org.apache.maven.plugins</groupId>\n        <artifactId>maven-war-plugin</artifactId>\n        <version>3.4.0</version>\n        <configuration>\n          <failOnMissingWebXml>false</failOnMissingWebXml>\n          <archive>\n            <manifest>\n              <addClasspath>true</addClasspath>\n            </manifest>\n          </archive>\n          <packagingExcludes></packagingExcludes>\n          <includeDependencies>true</includeDependencies>\n        </configuration>\n      </plugin>\n    </plugins>\n  </build>\n</project>"
        },
        {
            "location": "./../../dockers/CVE-2017-8386/custom_no_tool/web/webapp/WEB-INF/web.xml",
            "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<web-app xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd\"\n         version=\"3.1\">\n    <display-name>Struts2 Exploit Demo</display-name>\n    <welcome-file-list>\n        <welcome-file>index.jsp</welcome-file>\n    </welcome-file-list>\n    <filter>\n        <filter-name>struts2</filter-name>\n        <filter-class>org.apache.struts2.dispatcher.filter.StrutsPrepareAndExecuteFilter</filter-class>\n    </filter>\n    <filter-mapping>\n        <filter-name>struts2</filter-name>\n        <url-pattern>/*</url-pattern>\n    </filter-mapping>\n    <!-- Listener removed to avoid ClassNotFoundException -->\n</web-app>"
        },
        {
            "location": "./../../dockers/CVE-2017-8386/custom_no_tool/web/webapp/WEB-INF/classes/struts.xml",
            "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE struts PUBLIC \"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN\"\n        \"http://struts.apache.org/dtds/struts-2.3.dtd\">\n<struts>\n    <!-- Minimal configuration; can be expanded as needed -->\n</struts>"
        },
        {
            "location": "./../../dockers/CVE-2017-8386/custom_no_tool/web/webapp/index.jsp",
            "content": "<%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\"\n    pageEncoding=\"UTF-8\"%>\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Struts2 Exploit Demo</title>\n</head>\n<body>\n    <h1>Welcome to the Struts2 Exploit Demo Application</h1>\n    <p>This application is intentionally vulnerable to CVE-2017-8386 for testing purposes.</p>\n</body>\n</html>"
        }
    ],
    "directory_tree": "custom_no_tool/\n\u251c\u2500 docker-compose.yml\n\u2514\u2500 web/\n   \u251c\u2500 Dockerfile\n   \u251c\u2500 pom.xml\n   \u2514\u2500 webapp/\n      \u251c\u2500 index.jsp\n      \u2514\u2500 WEB-INF/\n         \u251c\u2500 web.xml\n         \u2514\u2500 classes/\n            \u2514\u2500 struts.xml"
}