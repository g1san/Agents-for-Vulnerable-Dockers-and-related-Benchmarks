{
    "files": [
        {
            "location": "./../../dockers/CVE-2020-13945/custom_no_tool/docker-compose.yml",
            "content": "services:\n  apisix:\n    image: apache/apisix:1.5-alpine\n    container_name: apisix\n    depends_on:\n      - etcd\n    ports:\n      - \"9080:9080\"\n      - \"9180:9180\"\n    environment:\n      - TZ=UTC\n    volumes:\n      - ./apisix/conf/config.yaml:/usr/local/apisix/conf/config.yaml:ro\n  etcd:\n    image: bitnami/etcd:3.5.0\n    container_name: etcd\n    environment:\n      - ALLOW_NONE_AUTHENTICATION=yes\n      - ETCD_ADVERTISE_CLIENT_URLS=http://0.0.0.0:2379\n      - ETCD_LISTEN_CLIENT_URLS=http://0.0.0.0:2379\n    ports:\n      - \"2379:2379\"\n  web:\n    build: ./app\n    ports:\n      - \"8080:80\"\n    depends_on:\n      - db\n    environment:\n      DB_HOST: db\n      DB_USER: exploit_user\n      DB_PASSWORD: exploit_pass\n      DB_NAME: exploit_db\n  db:\n    image: mysql:5.7\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: exploit_db\n      MYSQL_USER: exploit_user\n      MYSQL_PASSWORD: exploit_pass\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./app/init.sql:/docker-entrypoint-initdb.d/init.sql\nvolumes:\n  db_data:"
        },
        {
            "location": "./../../dockers/CVE-2020-13945/custom_no_tool/app/Dockerfile",
            "content": "FROM php:8.2-apache\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends \\\n        default-mysql-client \\\n        libzip-dev libpng-dev zip unzip gnupg zlib1g-dev && \\\n    docker-php-ext-install mysqli && \\\n    docker-php-ext-configure zip --with-libzip && \\\n    docker-php-ext-install zip && \\\n    rm -rf /var/lib/apt/lists/*\nCOPY src/ /var/www/html/\nEXPOSE 80"
        },
        {
            "location": "./../../dockers/CVE-2020-13945/custom_no_tool/app/src/index.php",
            "content": "<?php\n$whitelist = [\n    'home' => __DIR__ . '/home.php',\n    'about' => __DIR__ . '/about.php'\n];\n\nif (isset($_GET['page'])) {\n    $page = $_GET['page'];\n    if (array_key_exists($page, $whitelist)) {\n        include $whitelist[$page];\n    } else {\n        http_response_code(404);\n        echo \"Page not found.\";\n    }\n} else {\n    echo \"<h1>Welcome to the secure demo app</h1>\";\n    echo \"<p>Use ?page=home or ?page=about</p>\";\n}\n?>"
        },
        {
            "location": "./../../dockers/CVE-2020-13945/custom_no_tool/app/src/home.php",
            "content": "<?php echo \"<h2>Home Page</h2><p>This is the home page.</p>\"; ?>"
        },
        {
            "location": "./../../dockers/CVE-2020-13945/custom_no_tool/app/src/about.php",
            "content": "<?php echo \"<h2>About Page</h2><p>Information about this demo.</p>\"; ?>"
        },
        {
            "location": "./../../dockers/CVE-2020-13945/custom_no_tool/app/init.sql",
            "content": "-- MySQL initialization script for the vulnerable environment\nCREATE TABLE users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    username VARCHAR(50) NOT NULL,\n    password VARCHAR(255) NOT NULL\n);\nINSERT INTO users (username, password) VALUES ('admin', 'adminpass'), ('guest', 'guestpass');"
        },
        {
            "location": "./../../dockers/CVE-2020-13945/custom_no_tool/apisix/conf/config.yaml",
            "content": "apisix:\n  node_listen: 9080\n  admin_api:\n    listen:\n      ip: 0.0.0.0\n      port: 9180\n    admin_key:\n      - \"mysecureadmin123\"\n    ip_whitelist:\n      - \"127.0.0.1\"\netcd:\n  host:\n    - \"http://etcd:2379\""
        }
    ],
    "directory_tree": "CVE-2020-13945/custom_no_tool"
}