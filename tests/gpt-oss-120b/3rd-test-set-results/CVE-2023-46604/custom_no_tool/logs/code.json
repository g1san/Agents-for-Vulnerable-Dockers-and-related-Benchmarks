{
    "files": [
        {
            "location": "./../../dockers/CVE-2023-46604/custom_no_tool/docker-compose.yml",
            "content": "services:\n  web:\n    build:\n      context: ./web\n      dockerfile: Dockerfile\n    ports:\n      - \"80:80\"\n    depends_on:\n      - db\n      - activemq\n    environment:\n      - DB_HOST=db\n      - DB_USER=testuser\n      - DB_PASSWORD=testpass\n      - DB_NAME=testdb\n  db:\n    image: mysql:5.7\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: testdb\n      MYSQL_USER: testuser\n      MYSQL_PASSWORD: testpass\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\n  activemq:\n    build:\n      context: ./activemq\n      dockerfile: Dockerfile\n    ports:\n      - \"61616:61616\"\n    environment:\n      - ACTIVEMQ_ADMIN_LOGIN=admin\n      - ACTIVEMQ_ADMIN_PASSWORD=admin\n  alpine_helper:\n    image: alpine:3.20\n    command: [\"sh\", \"-c\", \"while true; do sleep 3600; done\"]\n    depends_on:\n      - activemq\nvolumes:\n  db_data:\n"
        },
        {
            "location": "./../../dockers/CVE-2023-46604/custom_no_tool/web/Dockerfile",
            "content": "FROM php:8.2-apache\n# Install additional packages without interactive prompts\nRUN DEBIAN_FRONTEND=noninteractive apt-get update && \\\n    apt-get install -y --no-install-recommends ca-certificates && \\\n    rm -rf /var/lib/apt/lists/*\nCOPY src/ /var/www/html/\nCOPY entrypoint.sh /entrypoint.sh\nRUN chmod +x /entrypoint.sh\nENTRYPOINT [\"/entrypoint.sh\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2023-46604/custom_no_tool/web/entrypoint.sh",
            "content": "#!/bin/sh\n# Simple entrypoint to start Apache in foreground\napache2-foreground\n"
        },
        {
            "location": "./../../dockers/CVE-2023-46604/custom_no_tool/web/src/index.php",
            "content": "<?php\n$mysqli = new mysqli($_ENV['DB_HOST'], $_ENV['DB_USER'], $_ENV['DB_PASSWORD'], $_ENV['DB_NAME']);\nif ($mysqli->connect_error) {\n    die('Connection error: ' . $mysqli->connect_error);\n}\n$res = $mysqli->query('SELECT id, name FROM users');\nwhile ($row = $res->fetch_assoc()) {\n    echo '<p>' . htmlspecialchars($row['id']) . ': ' . htmlspecialchars($row['name']) . '</p>';\n}\n?>\n"
        },
        {
            "location": "./../../dockers/CVE-2023-46604/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE IF NOT EXISTS users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL\n);\nINSERT INTO users (name) VALUES ('Alice'), ('Bob'), ('Charlie');\n"
        },
        {
            "location": "./../../dockers/CVE-2023-46604/custom_no_tool/activemq/Dockerfile",
            "content": "FROM openjdk:11-jre-slim\nENV ACTIVEMQ_VERSION=5.17.5\nRUN apt-get update && apt-get install -y --no-install-recommends curl && rm -rf /var/lib/apt/lists/* \\\n    && mkdir -p /opt/activemq \\\n    && curl -L https://archive.apache.org/dist/activemq/${ACTIVEMQ_VERSION}/apache-activemq-${ACTIVEMQ_VERSION}-bin.tar.gz \\\n       | tar -xz -C /opt/activemq --strip-components=1 \\\n    && groupadd -r activemq && useradd -r -g activemq activemq \\\n    && chown -R activemq:activemq /opt/activemq\nEXPOSE 61616 61613 8161\nUSER activemq\nWORKDIR /opt/activemq\nCMD [\"bin/activemq\", \"console\"]\n"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2023-46604/custom_no_tool"
}