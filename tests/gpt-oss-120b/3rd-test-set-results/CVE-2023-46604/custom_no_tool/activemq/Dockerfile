FROM openjdk:11-jre-slim
ENV ACTIVEMQ_VERSION=5.17.5
RUN apt-get update && apt-get install -y --no-install-recommends curl && rm -rf /var/lib/apt/lists/* \
    && mkdir -p /opt/activemq \
    && curl -L https://archive.apache.org/dist/activemq/${ACTIVEMQ_VERSION}/apache-activemq-${ACTIVEMQ_VERSION}-bin.tar.gz \
       | tar -xz -C /opt/activemq --strip-components=1 \
    && groupadd -r activemq && useradd -r -g activemq activemq \
    && chown -R activemq:activemq /opt/activemq
EXPOSE 61616 61613 8161
USER activemq
WORKDIR /opt/activemq
CMD ["bin/activemq", "console"]
