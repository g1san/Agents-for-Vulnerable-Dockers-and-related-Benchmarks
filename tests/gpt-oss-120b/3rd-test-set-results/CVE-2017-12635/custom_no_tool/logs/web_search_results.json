{
    "desc": "CVE-2017-12635 is a privilege escalation vulnerability in Apache CouchDB. The database uses two different JSON parsers: the Erlang\u2011based jiffy parser for storing documents and a JavaScript\u2011based parser for validation. When a user document in the _users database contains duplicate \\\"roles\\\" keys, the Erlang parser keeps the first occurrence while the JavaScript parser keeps the last. An attacker can craft a document where the first \\\"roles\\\" entry contains the special role \\\"_admin\\\" and the second entry is empty. The validation step sees the empty array and allows the request, but the authorization step sees the \\\"_admin\\\" role and grants full administrative privileges. This flaw affects Apache CouchDB versions prior to 1.7.0 and CouchDB 2.x versions prior to 2.1.1, allowing an unauthenticated or low\u2011privilege user to obtain admin rights and subsequently perform any operation on the database, including creating or deleting databases, modifying configuration, and chaining to remote code execution via other vulnerabilities.",
    "attack_type": "privilege escalation",
    "services": [
        {
            "name": "couchdb",
            "version": [
                "1.6.1",
                "2.0.0",
                "2.0.1"
            ],
            "dependency_type": "HARD",
            "description": "Apache CouchDB instance that contains the vulnerable JSON parsing logic allowing duplicate \\\"roles\\\" keys to be interpreted differently, which is required for the privilege escalation exploit."
        }
    ],
    "input_tokens": 7261,
    "output_tokens": 2227
}