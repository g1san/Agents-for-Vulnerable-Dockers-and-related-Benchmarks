{
    "files": [
        {
            "location": "./../../dockers/CVE-2017-12635/custom_no_tool/docker-compose.yml",
            "content": "services:\n  couchdb:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    container_name: cve_2017_12635_couchdb\n    ports:\n      - \"5984:5984\"\n    environment:\n      COUCHDB_USER: admin\n      COUCHDB_PASSWORD: admin\n    restart: unless-stopped\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:5984/_up\"]\n      interval: 30s\n      timeout: 10s\n      retries: 5\n    volumes:\n      - couchdb_data:/opt/couchdb/data\nvolumes:\n  couchdb_data:\n    driver: local"
        },
        {
            "location": "./../../dockers/CVE-2017-12635/custom_no_tool/Dockerfile",
            "content": "FROM couchdb:2.0.1\n\n# Copy the initialization JSON to the directory processed by the official entrypoint\nCOPY init-user.json /docker-entrypoint-initdb.d/\n\n# Copy the custom init script (will be executed after CouchDB starts)\nCOPY init.sh /docker-entrypoint-initdb.d/\nRUN chmod +x /docker-entrypoint-initdb.d/init.sh"
        },
        {
            "location": "./../../dockers/CVE-2017-12635/custom_no_tool/init-user.json",
            "content": "{\n  \"_id\": \"org.couchdb.user:testuser\",\n  \"type\": \"user\",\n  \"name\": \"testuser\",\n  \"password\": \"testpass\",\n  \"roles\": [\"_admin\"]\n}"
        },
        {
            "location": "./../../dockers/CVE-2017-12635/custom_no_tool/init.sh",
            "content": "#!/bin/sh\n\n# Wait until CouchDB responds to the health endpoint\nwhile ! curl -s http://127.0.0.1:5984/_up > /dev/null; do\n  echo \"Waiting for CouchDB to become ready...\"\n  sleep 2\ndone\n\necho \"CouchDB is up. Creating test user...\"\n\n# Create the test user using the admin credentials defined in the environment\ncurl -s -X PUT \\\n  -H \"Content-Type: application/json\" \\\n  -d @/docker-entrypoint-initdb.d/init-user.json \\\n  http://$COUCHDB_USER:$COUCHDB_PASSWORD@127.0.0.1:5984/_users/org.couchdb.user:testuser"
        }
    ],
    "directory_tree": "CVE-2017-12635/custom_no_tool"
}