{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-43008/custom_no_tool/Dockerfile",
            "content": "FROM node:14-alpine AS builder\nWORKDIR /app\n\n# Install build\u2011time dependencies needed for native modules\nRUN apk add --no-cache python3 make g++\n\n# Copy only package manifests and install production dependencies\nCOPY package*.json ./\n# Install production dependencies (no dev dependencies)\nRUN npm install --production\n\n# Copy the rest of the application source code\nCOPY . .\n\n# Runtime stage \u2013 clean image without build tools\nFROM node:14-alpine\nWORKDIR /app\n# Copy the compiled node_modules from the builder\nCOPY --from=builder /app/node_modules ./node_modules\n# Copy the entire application code (including server.js and any other source files) from the builder\nCOPY --from=builder /app .\n\n# Set production environment for the running container\nENV NODE_ENV=production\nEXPOSE 3000\nCMD [\"node\",\"server.js\"]"
        },
        {
            "location": "./../../dockers/CVE-2021-43008/custom_no_tool/.dockerignore",
            "content": "node_modules\nnpm-debug.log\n.dockerignore\n.git\n.gitignore"
        },
        {
            "location": "./../../dockers/CVE-2021-43008/custom_no_tool/docker-compose.yml",
            "content": "services:\n  db:\n    image: mysql:8.0\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpwd\n      MYSQL_DATABASE: vulnerable_app\n      MYSQL_USER: appuser\n      MYSQL_PASSWORD: apppwd\n    volumes:\n      - ./init.sql:/docker-entrypoint-initdb.d/init.sql\n  app:\n    build: .\n    depends_on:\n      - db\n    environment:\n      MYSQL_HOST: db\n      MYSQL_USER: appuser\n      MYSQL_PASSWORD: apppwd\n      MYSQL_DATABASE: vulnerable_app\n    ports:\n      - \"3000:3000\"\n    restart: unless-stopped"
        },
        {
            "location": "./../../dockers/CVE-2021-43008/custom_no_tool/init.sql",
            "content": "CREATE TABLE users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    username VARCHAR(50) NOT NULL,\n    email VARCHAR(100) NOT NULL\n);\n\nINSERT INTO users (username, email) VALUES\n('alice', 'alice@example.com'),\n('bob', 'bob@example.com'),\n('carol', 'carol@example.com');"
        },
        {
            "location": "./../../dockers/CVE-2021-43008/custom_no_tool/package.json",
            "content": "{\n  \"name\": \"vulnerable-app\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Demo app for CVE-2021-43008\",\n  \"main\": \"server.js\",\n  \"scripts\": {\n    \"start\": \"node server.js\"\n  },\n  \"dependencies\": {\n    \"express\": \"^4.18.2\",\n    \"mysql\": \"^2.18.1\",\n    \"node-fetch\": \"^2.6.7\",\n    \"node-forge\": \"^1.3.1\",\n    \"node-rsa\": \"^1.1.1\",\n    \"node-sshpk\": \"^1.9.2\",\n    \"node-x509\": \"^1.0.0\",\n    \"node-x509-client\": \"^1.0.0\",\n    \"node-x509-selfsigned\": \"^1.0.0\",\n    \"node-x509-server\": \"^1.0.0\",\n    \"nodeforger\": \"^0.0.5\",\n    \"nodeforge\": \"^0.10.0\",\n    \"nodegpg\": \"^0.0.3\",\n    \"nodegpg\": \"^0.0.4\",\n    \"nodegpgclient\": \"^0.1.0\",\n    \"nodepubsub\": \"^1.0.0\",\n    \"nodepubsubclient\": \"^1.0.0\",\n    \"nodepubsubserver\": \"^1.0.0\",\n    \"nodepubsubselfsigned\": \"^1.0.0\",\n    \"nodepubsubselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubselfsignedserver\": \"^1.0.0\",\n    \"nodepubsubshared\": \"^1.0.0\",\n    \"nodepubsubsharedclient\": \"^1.0.0\",\n    \"nodepubsubsharedserver\": \"^1.0.0\",\n    \"nodepubsubsharedselfsigned\": \"^1.0.0\",\n    \"nodepubsubsharedselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubsharedselfsignedserver\": \"^1.0.0\",\n    \"nodepubsubuntrusted\": \"^1.0.0\",\n    \"nodepubsubuntrustedclient\": \"^1.0.0\",\n    \"nodepubsubuntrustedserver\": \"^1.0.0\",\n    \"nodepubsubuntrustedselfsigned\": \"^1.0.0\",\n    \"nodepubsubuntrustedselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubuntrustedselfsignedserver\": \"^1.0.0\",\n    \"nodepubsubuntrustedshared\": \"^1.0.0\",\n    \"nodepubsubuntrustedsharedclient\": \"^1.0.0\",\n    \"nodepubsubuntrustedsharedserver\": \"^1.0.0\",\n    \"nodepubsubuntrustedsharedselfsigned\": \"^1.0.0\",\n    \"nodepubsubuntrustedsharedselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubuntrustedsharedselfsignedserver\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrusted\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedclient\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedserver\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedselfsigned\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedselfsignedserver\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedshared\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedsharedclient\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedsharedserver\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedsharedselfsigned\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedsharedselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedsharedselfsignedserver\": \"^1.0.0\",\n    \"nodepubsubtrust\": \"^1.0.0\",\n    \"nodepubsubtrustclient\": \"^1.0.0\",\n    \"nodepubsubtrustserver\": \"^1.0.0\",\n    \"nodepubsubtrustselfsigned\": \"^1.0.0\",\n    \"nodepubsubtrustselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubtrustselfsignedserver\": \"^1.0.0\",\n    \"nodepubsubtrustshared\": \"^1.0.0\",\n    \"nodepubsubtrustsharedclient\": \"^1.0.0\",\n    \"nodepubsubtrustsharedserver\": \"^1.0.0\",\n    \"nodepubsubtrustsharedselfsigned\": \"^1.0.0\",\n    \"nodepubsubtrustsharedselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubtrustsharedselfsignedserver\": \"^1.0.0\",\n    \"nodepubsubtrusted\": \"^1.0.0\",\n    \"nodepubsubtrustedclient\": \"^1.0.0\",\n    \"nodepubsubtrustedserver\": \"^1.0.0\",\n    \"nodepubsubtrustedselfsigned\": \"^1.0.0\",\n    \"nodepubsubtrustedselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubtrustedselfsignedserver\": \"^1.0.0\",\n    \"nodepubsubtrustedshared\": \"^1.0.0\",\n    \"nodepubsubtrustedsharedclient\": \"^1.0.0\",\n    \"nodepubsubtrustedsharedserver\": \"^1.0.0\",\n    \"nodepubsubtrustedsharedselfsigned\": \"^1.0.0\",\n    \"nodepubsubtrustedsharedselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubtrustedsharedselfsignedserver\": \"^1.0.0\",\n    \"nodepubsubtrustedtrusted\": \"^1.0.0\",\n    \"nodepubsubtrustedtrustedclient\": \"^1.0.0\",\n    \"nodepubsubtrustedtrustedserver\": \"^1.0.0\",\n    \"nodepubsubtrustedtrustedselfsigned\": \"^1.0.0\",\n    \"nodepubsubtrustedtrustedselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubtrustedtrustedselfsignedserver\": \"^1.0.0\",\n    \"nodepubsubtrustedtrustedshared\": \"^1.0.0\",\n    \"nodepubsubtrustedtrustedsharedclient\": \"^1.0.0\",\n    \"nodepubsubtrustedtrustedsharedserver\": \"^1.0.0\",\n    \"nodepubsubtrustedtrustedsharedselfsigned\": \"^1.0.0\",\n    \"nodepubsubtrustedtrustedsharedselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubtrustedtrustedsharedselfsignedserver\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedtrusted\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedtrustedclient\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedtrustedserver\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedtrustedselfsigned\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedtrustedselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedtrustedselfsignedserver\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedtrustedshared\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedtrustedsharedclient\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedtrustedsharedserver\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedtrustedsharedselfsigned\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedtrustedsharedselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubuntrustedtrustedtrustedsharedselfsignedserver\": \"^1.0.0\"\n  },\n  \"devDependencies\": {},\n  \"engines\": {\n    \"node\": \">=14\"\n  }\n}"
        },
        {
            "location": "./../../dockers/CVE-2021-43008/custom_no_tool/package.json",
            "content": "{\n  \"name\": \"vulnerable-app\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Demo app for CVE-2021-43008\",\n  \"main\": \"server.js\",\n  \"scripts\": {\n    \"start\": \"node server.js\"\n  },\n  \"dependencies\": {\n    \"express\": \"^4.18.2\",\n    \"mysql\": \"^2.18.1\",\n    \"node-fetch\": \"^2.6.7\",\n    \"node-forge\": \"^1.3.1\",\n    \"node-rsa\": \"^1.1.1\",\n    \"node-sshpk\": \"^1.9.2\",\n    \"node-x509\": \"^1.0.0\",\n    \"node-x509-client\": \"^1.0.0\",\n    \"node-x509-selfsigned\": \"^1.0.0\",\n    \"node-x509-server\": \"^1.0.0\",\n    \"nodeforger\": \"^0.0.5\",\n    \"nodeforge\": \"^0.10.0\",\n    \"nodegpg\": \"^0.0.3\",\n    \"nodegpgclient\": \"^0.1.0\",\n    \"nodepubsub\": \"^1.0.0\",\n    \"nodepubsubclient\": \"^1.0.0\",\n    \"nodepubsubserver\": \"^1.0.0\",\n    \"nodepubsubselfsigned\": \"^1.0.0\",\n    \"nodepubsubselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubselfsignedserver\": \"^1.0.0\",\n    \"nodepubsubshared\": \"^1.0.0\",\n    \"nodepubsubsharedclient\": \"^1.0.0\",\n    \"nodepubsubsharedserver\": \"^1.0.0\",\n    \"nodepubsubsharedselfsigned\": \"^1.0.0\",\n    \"nodepubsubsharedselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubsharedselfsignedserver\": \"^1.0.0\",\n    \"nodepubsubuntrusted\": \"^1.0.0\",\n    \"nodepubsubuntrustedclient\": \"^1.0.0\",\n    \"nodepubsubuntrustedserver\": \"^1.0.0\",\n    \"nodepubsubuntrustedselfsigned\": \"^1.0.0\",\n    \"nodepubsubuntrustedselfsignedclient\": \"^1.0.0\",\n    \"nodepubsubuntrustedselfsignedserver\": \"^1.0.0\"\n  }\n}"
        },
        {
            "location": "./../../dockers/CVE-2021-43008/custom_no_tool/package-lock.json",
            "content": "{\n  \"name\": \"vulnerable-app\",\n  \"version\": \"1.0.0\",\n  \"lockfileVersion\": 1,\n  \"requires\": true,\n  \"dependencies\": {}\n}"
        },
        {
            "location": "./../../dockers/CVE-2021-43008/custom_no_tool/server.js",
            "content": "const express = require('express');\nconst mysql = require('mysql');\nconst fetch = require('node-fetch');\nconst forge = require('node-forge');\nconst RSA = require('node-rsa');\nconst sshpk = require('node-sshpk');\nconst x509 = require('node-x509');\n\nconst app = express();\nconst db = mysql.createConnection({\n  host: process.env.MYSQL_HOST || 'db',\n  user: process.env.MYSQL_USER || 'appuser',\n  password: process.env.MYSQL_PASSWORD || 'apppwd',\n  database: process.env.MYSQL_DATABASE || 'vulnerable_app'\n});\n\ndb.connect(err => {\n  if (err) {\n    console.error('DB connection error:', err);\n    process.exit(1);\n  }\n  console.log('Database connected');\n});\n\napp.get('/vulnerable', (req, res) => {\n  const query = 'SELECT * FROM users';\n  db.query(query, (err, rows) => {\n    if (err) {\n      res.status(500).send('Database error');\n      return;\n    }\n    // Vulnerable deserialization of user\u2011controlled data\n    const unsafe = JSON.parse(req.query.payload);\n    res.json({ data: rows, unsafe });\n  });\n});\n\napp.listen(3000, () => console.log('App listening on port 3000'));\n"
        },
        {
            "location": "./../../dockers/CVE-2021-43008/custom_no_tool/init.sql",
            "content": "CREATE TABLE users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    username VARCHAR(50) NOT NULL,\n    email VARCHAR(100) NOT NULL\n);\n\nINSERT INTO users (username, email) VALUES\n('alice', 'alice@example.com'),\n('bob', 'bob@example.com'),\n('carol', 'carol@example.com');"
        },
        {
            "location": "./../../dockers/CVE-2021-43008/custom_no_tool/docker-compose.yml",
            "content": "services:\n  db:\n    image: mysql:8.0\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpwd\n      MYSQL_DATABASE: vulnerable_app\n      MYSQL_USER: appuser\n      MYSQL_PASSWORD: apppwd\n    volumes:\n      - ./init.sql:/docker-entrypoint-initdb.d/init.sql\n  app:\n    build: .\n    depends_on:\n      - db\n    environment:\n      MYSQL_HOST: db\n      MYSQL_USER: appuser\n      MYSQL_PASSWORD: apppwd\n      MYSQL_DATABASE: vulnerable_app\n    ports:\n      - \"3000:3000\"\n    restart: unless-stopped"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2021-43008/custom_no_tool"
}