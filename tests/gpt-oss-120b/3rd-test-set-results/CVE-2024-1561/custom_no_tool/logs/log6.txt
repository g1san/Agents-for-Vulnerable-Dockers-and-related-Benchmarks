#1 [internal] load local bake definitions
#1 reading from stdin 693B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile: 772B done
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/library/python:3.11-slim
#3 DONE 0.4s

#4 [internal] load .dockerignore
#4 transferring context: 2B done
#4 DONE 0.0s

#5 [1/7] FROM docker.io/library/python:3.11-slim@sha256:8eb5fc663972b871c528fef04be4eaa9ab8ab4539a5316c4b8c133771214a617
#5 resolve docker.io/library/python:3.11-slim@sha256:8eb5fc663972b871c528fef04be4eaa9ab8ab4539a5316c4b8c133771214a617 0.0s done
#5 DONE 0.0s

#6 [internal] load build context
#6 transferring context: 75.67kB done
#6 DONE 0.0s

#7 [2/7] RUN apt-get update &&     apt-get install -y --no-install-recommends         gcc         libpq-dev         python3-dev         build-essential &&     rm -rf /var/lib/apt/lists/*
#7 CACHED

#8 [3/7] WORKDIR /app
#8 CACHED

#9 [4/7] COPY requirements.txt ./
#9 DONE 0.0s

#10 [5/7] RUN pip install --upgrade pip &&     pip install --no-cache-dir -r requirements.txt
#10 1.548 Requirement already satisfied: pip in /usr/local/lib/python3.11/site-packages (24.0)
#10 1.668 Collecting pip
#10 1.734   Downloading pip-25.3-py3-none-any.whl.metadata (4.7 kB)
#10 1.759 Downloading pip-25.3-py3-none-any.whl (1.8 MB)
#10 2.052    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.8/1.8 MB 6.1 MB/s eta 0:00:00
#10 2.102 Installing collected packages: pip
#10 2.102   Attempting uninstall: pip
#10 2.104     Found existing installation: pip 24.0
#10 2.142     Uninstalling pip-24.0:
#10 2.306       Successfully uninstalled pip-24.0
#10 3.027 Successfully installed pip-25.3
#10 3.027 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
#10 3.507 Collecting Flask==2.3.3 (from -r requirements.txt (line 1))
#10 3.566   Downloading flask-2.3.3-py3-none-any.whl.metadata (3.6 kB)
#10 3.650 Collecting psycopg2-binary==2.9.9 (from -r requirements.txt (line 2))
#10 3.665   Downloading psycopg2_binary-2.9.9-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
#10 3.724 Collecting PyYAML==6.0.1 (from -r requirements.txt (line 3))
#10 3.738   Downloading PyYAML-6.0.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (2.1 kB)
#10 3.769 Collecting Werkzeug>=2.3.7 (from Flask==2.3.3->-r requirements.txt (line 1))
#10 3.783   Downloading werkzeug-3.1.3-py3-none-any.whl.metadata (3.7 kB)
#10 3.806 Collecting Jinja2>=3.1.2 (from Flask==2.3.3->-r requirements.txt (line 1))
#10 3.820   Downloading jinja2-3.1.6-py3-none-any.whl.metadata (2.9 kB)
#10 3.838 Collecting itsdangerous>=2.1.2 (from Flask==2.3.3->-r requirements.txt (line 1))
#10 3.852   Downloading itsdangerous-2.2.0-py3-none-any.whl.metadata (1.9 kB)
#10 3.876 Collecting click>=8.1.3 (from Flask==2.3.3->-r requirements.txt (line 1))
#10 3.891   Downloading click-8.3.0-py3-none-any.whl.metadata (2.6 kB)
#10 3.910 Collecting blinker>=1.6.2 (from Flask==2.3.3->-r requirements.txt (line 1))
#10 3.923   Downloading blinker-1.9.0-py3-none-any.whl.metadata (1.6 kB)
#10 3.991 Collecting MarkupSafe>=2.0 (from Jinja2>=3.1.2->Flask==2.3.3->-r requirements.txt (line 1))
#10 4.006   Downloading markupsafe-3.0.3-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (2.7 kB)
#10 4.025 Downloading flask-2.3.3-py3-none-any.whl (96 kB)
#10 4.055 Downloading psycopg2_binary-2.9.9-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.0 MB)
#10 4.498    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.0/3.0 MB 6.8 MB/s  0:00:00
#10 4.512 Downloading PyYAML-6.0.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (757 kB)
#10 4.629    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 757.7/757.7 kB 6.5 MB/s  0:00:00
#10 4.644 Downloading blinker-1.9.0-py3-none-any.whl (8.5 kB)
#10 4.657 Downloading click-8.3.0-py3-none-any.whl (107 kB)
#10 4.684 Downloading itsdangerous-2.2.0-py3-none-any.whl (16 kB)
#10 4.700 Downloading jinja2-3.1.6-py3-none-any.whl (134 kB)
#10 4.731 Downloading markupsafe-3.0.3-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (22 kB)
#10 4.748 Downloading werkzeug-3.1.3-py3-none-any.whl (224 kB)
#10 4.815 Installing collected packages: PyYAML, psycopg2-binary, MarkupSafe, itsdangerous, click, blinker, Werkzeug, Jinja2, Flask
#10 5.232 
#10 5.234 Successfully installed Flask-2.3.3 Jinja2-3.1.6 MarkupSafe-3.0.3 PyYAML-6.0.1 Werkzeug-3.1.3 blinker-1.9.0 click-8.3.0 itsdangerous-2.2.0 psycopg2-binary-2.9.9
#10 5.234 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
#10 DONE 5.5s

#11 [6/7] COPY . ./
#11 DONE 0.0s

#12 [7/7] RUN chmod +x /app/app/wait_for_db_and_start.sh
#12 DONE 0.2s

#13 exporting to image
#13 exporting layers
#13 exporting layers 1.4s done
#13 exporting manifest sha256:6fbc777c8fc7572113e0b48adcd356b5e0558de17925e16d21e47e1ae8ffc229 0.0s done
#13 exporting config sha256:45c6f654fe4adeb8271332e62e76e25da06cf79790129bbf6d0f6fa547cc6df2 0.0s done
#13 exporting attestation manifest sha256:88418db75bff3886ab0021f12e19bc8112140cdf6114ba214d3252bf19392027 0.0s done
#13 exporting manifest list sha256:647bd32ed8cd09ae883907a46e749aaf24ae1d5065c868dcc2cc51bc8e07ff6a 0.0s done
#13 naming to docker.io/library/custom_no_tool-app:latest done
#13 unpacking to docker.io/library/custom_no_tool-app:latest
#13 unpacking to docker.io/library/custom_no_tool-app:latest 0.5s done
#13 DONE 2.0s

#14 resolving provenance for metadata file
#14 DONE 0.0s
 custom_no_tool-app  Built
 Network custom_no_tool_default  Creating
 Network custom_no_tool_default  Created
 Volume custom_no_tool_db_data  Creating
 Volume custom_no_tool_db_data  Created
 Container cve2024_1561_db  Creating
 Container cve2024_1561_db  Created
 Container cve2024_1561_app  Creating
 Container cve2024_1561_app  Created
 Container cve2024_1561_db  Starting
 Container cve2024_1561_db  Started
 Container cve2024_1561_db  Waiting
 Container cve2024_1561_db  Healthy
 Container cve2024_1561_app  Starting
 Container cve2024_1561_app  Started


sudo docker logs 3bef7da96cdd58f0f4060cffd231231887ca8439a9d0bb3e6f4edeb771852a57 --details
STDOUT:  Waiting for PostgreSQL... (1)
 Waiting for PostgreSQL... (2)
 Waiting for PostgreSQL... (3)
 Waiting for PostgreSQL... (4)
 Waiting for PostgreSQL... (5)
 Waiting for PostgreSQL... (6)
 Waiting for PostgreSQL... (7)
 Waiting for PostgreSQL... (8)
 Waiting for PostgreSQL... (9)
 Waiting for PostgreSQL... (10)
 Waiting for PostgreSQL... (11)
 Waiting for PostgreSQL... (12)
 Waiting for PostgreSQL... (13)
 Waiting for PostgreSQL... (14)
 Waiting for PostgreSQL... (15)
 Waiting for PostgreSQL... (16)
 Waiting for PostgreSQL... (17)
 Waiting for PostgreSQL... (18)
 Waiting for PostgreSQL... (19)
 Waiting for PostgreSQL... (20)
 Waiting for PostgreSQL... (21)
 Waiting for PostgreSQL... (22)
 Waiting for PostgreSQL... (23)
 Waiting for PostgreSQL... (24)
 Waiting for PostgreSQL... (25)
 Waiting for PostgreSQL... (26)
 Waiting for PostgreSQL... (27)
 Waiting for PostgreSQL... (28)
 Waiting for PostgreSQL... (29)
 PostgreSQL did not become ready in time, exiting.

STDERR: 



sudo docker inspect 3bef7da96cdd58f0f4060cffd231231887ca8439a9d0bb3e6f4edeb771852a57[
    {
        "Id": "3bef7da96cdd58f0f4060cffd231231887ca8439a9d0bb3e6f4edeb771852a57",
        "Created": "2025-11-03T00:35:06.483411374Z",
        "Path": "/app/app/wait_for_db_and_start.sh",
        "Args": [],
        "State": {
            "Status": "exited",
            "Running": false,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 0,
            "ExitCode": 1,
            "Error": "",
            "StartedAt": "2025-11-03T00:35:12.33874432Z",
            "FinishedAt": "2025-11-03T00:35:41.558651605Z"
        },
        "Image": "sha256:647bd32ed8cd09ae883907a46e749aaf24ae1d5065c868dcc2cc51bc8e07ff6a",
        "ResolvConfPath": "/var/lib/docker/containers/3bef7da96cdd58f0f4060cffd231231887ca8439a9d0bb3e6f4edeb771852a57/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/3bef7da96cdd58f0f4060cffd231231887ca8439a9d0bb3e6f4edeb771852a57/hostname",
        "HostsPath": "/var/lib/docker/containers/3bef7da96cdd58f0f4060cffd231231887ca8439a9d0bb3e6f4edeb771852a57/hosts",
        "LogPath": "/var/lib/docker/containers/3bef7da96cdd58f0f4060cffd231231887ca8439a9d0bb3e6f4edeb771852a57/3bef7da96cdd58f0f4060cffd231231887ca8439a9d0bb3e6f4edeb771852a57-json.log",
        "Name": "/cve2024_1561_app",
        "RestartCount": 0,
        "Driver": "overlayfs",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": null,
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "custom_no_tool_default",
            "PortBindings": {
                "5000/tcp": [
                    {
                        "HostIp": "",
                        "HostPort": "5000"
                    }
                ]
            },
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "ConsoleSize": [
                0,
                0
            ],
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": null,
            "DnsOptions": null,
            "DnsSearch": null,
            "ExtraHosts": [],
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": false,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": null,
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": null,
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": null,
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": [
                "/proc/asound",
                "/proc/acpi",
                "/proc/interrupts",
                "/proc/kcore",
                "/proc/keys",
                "/proc/latency_stats",
                "/proc/timer_list",
                "/proc/timer_stats",
                "/proc/sched_debug",
                "/proc/scsi",
                "/sys/firmware",
                "/sys/devices/virtual/powercap"
            ],
            "ReadonlyPaths": [
                "/proc/bus",
                "/proc/fs",
                "/proc/irq",
                "/proc/sys",
                "/proc/sysrq-trigger"
            ]
        },
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "Mounts": [],
        "Config": {
            "Hostname": "3bef7da96cdd",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": true,
            "AttachStderr": true,
            "ExposedPorts": {
                "5000/tcp": {}
            },
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "POSTGRES_PASSWORD=demo_pass",
                "POSTGRES_DB=demo_db",
                "POSTGRES_USER=demo_user",
                "PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
                "LANG=C.UTF-8",
                "GPG_KEY=A035C8C19219BA821ECEA86B64E628F8D684696D",
                "PYTHON_VERSION=3.11.14",
                "PYTHON_SHA256=8d3ed8ec5c88c1c95f5e558612a725450d2452813ddad5e58fdb1a53b1209b78",
                "FLASK_APP=app/app.py",
                "FLASK_RUN_HOST=0.0.0.0",
                "FLASK_RUN_PORT=5000"
            ],
            "Cmd": [
                "/app/app/wait_for_db_and_start.sh"
            ],
            "Image": "custom_no_tool-app",
            "Volumes": null,
            "WorkingDir": "/app",
            "Entrypoint": null,
            "OnBuild": null,
            "Labels": {
                "com.docker.compose.config-hash": "dca90467f6f1532b2118cca0f4fc70b9933f230bd3d90478fa96a6f927726e62",
                "com.docker.compose.container-number": "1",
                "com.docker.compose.depends_on": "db:service_healthy:false",
                "com.docker.compose.image": "sha256:647bd32ed8cd09ae883907a46e749aaf24ae1d5065c868dcc2cc51bc8e07ff6a",
                "com.docker.compose.oneoff": "False",
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.project.config_files": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2024-1561/custom_no_tool/docker-compose.yml",
                "com.docker.compose.project.working_dir": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2024-1561/custom_no_tool",
                "com.docker.compose.service": "app",
                "com.docker.compose.version": "2.40.2",
                "desktop.docker.io/wsl-distro": "Ubuntu"
            },
            "StopTimeout": 1
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "",
            "SandboxKey": "",
            "Ports": {},
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "",
            "Gateway": "",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "",
            "IPPrefixLen": 0,
            "IPv6Gateway": "",
            "MacAddress": "",
            "Networks": {
                "custom_no_tool_default": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": [
                        "cve2024_1561_app",
                        "app"
                    ],
                    "MacAddress": "",
                    "DriverOpts": null,
                    "GwPriority": 0,
                    "NetworkID": "67ebae4d43653d02eced9c28aeef60a23b1348437978e7f2bc6b8e8975c18c31",
                    "EndpointID": "",
                    "Gateway": "",
                    "IPAddress": "",
                    "IPPrefixLen": 0,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "DNSNames": [
                        "cve2024_1561_app",
                        "app",
                        "3bef7da96cdd"
                    ]
                }
            }
        },
        "ImageManifestDescriptor": {
            "mediaType": "application/vnd.oci.image.manifest.v1+json",
            "digest": "sha256:6fbc777c8fc7572113e0b48adcd356b5e0558de17925e16d21e47e1ae8ffc229",
            "size": 2195,
            "platform": {
                "architecture": "amd64",
                "os": "linux"
            }
        }
    }
]