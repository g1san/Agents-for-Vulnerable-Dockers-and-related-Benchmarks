{
    "files": [
        {
            "location": "./../../dockers/CVE-2017-7504/custom_no_tool/docker-compose.yml",
            "content": "version: \"3.9\"\nservices:\n  app:\n    build: ./app\n    ports:\n      - \"5000:5000\"\n    depends_on:\n      db:\n        condition: service_healthy\n      jboss:\n        condition: service_healthy\n    environment:\n      FLASK_ENV: development\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: testdb\n      MYSQL_USER: testuser\n      MYSQL_PASSWORD: testpass\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - db_data:/var/lib/mysql\n      - \"${PWD}/db/init.sql:/docker-entrypoint-initdb.d/init.sql\"\n    healthcheck:\n      test: [\"CMD\", \"mysqladmin\", \"ping\", \"-h\", \"localhost\", \"-u\", \"root\", \"-p${MYSQL_ROOT_PASSWORD}\"]\n      interval: 5s\n      timeout: 3s\n      retries: 10\n  jboss:\n    image: jboss/jboss-as:4.2.3.GA\n    ports:\n      - \"8080:8080\"\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8080/\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\nvolumes:\n  db_data:\n"
        },
        {
            "location": "./../../dockers/CVE-2017-7504/custom_no_tool/app/Dockerfile",
            "content": "FROM python:3.8-slim\nWORKDIR /app\nCOPY requirements.txt .\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends gcc libyaml-dev && \\\n    pip install --no-cache-dir -r requirements.txt && \\\n    apt-get purge -y --auto-remove gcc && \\\n    rm -rf /var/lib/apt/lists/*\nCOPY . .\nENV FLASK_APP=app.py\nEXPOSE 5000\nCMD [\"python\", \"app.py\"]"
        },
        {
            "location": "./../../dockers/CVE-2017-7504/custom_no_tool/app/requirements.txt",
            "content": "Flask==1.1.2\nWerkzeug==1.0.1\nJinja2==2.11.3\nPyYAML==3.12\nmarkupsafe==2.0.1\nitsdangerous==1.1.0"
        },
        {
            "location": "./../../dockers/CVE-2017-7504/custom_no_tool/app/app.py",
            "content": "from flask import Flask, request, jsonify\nimport yaml\n\napp = Flask(__name__)\n\n@app.route('/vuln', methods=['POST'])\ndef vulnerable_endpoint():\n    # The request body is expected to be YAML. Use safe_load to avoid unsafe deserialization.\n    data = request.data\n    try:\n        loaded = yaml.safe_load(data)\n        return jsonify({'status': 'ok', 'loaded': str(loaded)})\n    except Exception as e:\n        return jsonify({'status': 'error', 'error': str(e)}), 400\n\n@app.route('/')\ndef index():\n    return 'Vulnerable Flask app ready.'\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000)\n"
        },
        {
            "location": "./../../dockers/CVE-2017-7504/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE IF NOT EXISTS users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  username VARCHAR(50) NOT NULL,\n  password VARCHAR(255) NOT NULL\n) ENGINE=InnoDB;\n\nINSERT INTO users (username, password) VALUES ('alice', 'password123'), ('bob', 'secret');"
        },
        {
            "location": "./../../dockers/CVE-2017-7504/custom_no_tool/jboss/Dockerfile",
            "content": "FROM openjdk:8-jdk-slim\nENV JBOSS_VERSION=4.2.3.GA\nENV JBOSS_HOME=/opt/jboss\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends wget unzip && \\\n    mkdir -p $JBOSS_HOME && \\\n    wget -q -L -O /tmp/jboss.zip \"https://downloads.sourceforge.net/project/jboss/JBoss%20${JBOSS_VERSION}/jboss-${JBOSS_VERSION}.zip\" && \\\n    unzip -q /tmp/jboss.zip -d $JBOSS_HOME && \\\n    rm /tmp/jboss.zip && \\\n    chmod +x $JBOSS_HOME/jboss-${JBOSS_VERSION}/bin/run.sh && \\\n    apt-get purge -y --auto-remove wget unzip && \\\n    rm -rf /var/lib/apt/lists/*\nEXPOSE 8080\nWORKDIR $JBOSS_HOME/jboss-${JBOSS_VERSION}\nCMD [\"./bin/run.sh\", \"-b\", \"0.0.0.0\"]"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2017-7504/custom_no_tool"
}