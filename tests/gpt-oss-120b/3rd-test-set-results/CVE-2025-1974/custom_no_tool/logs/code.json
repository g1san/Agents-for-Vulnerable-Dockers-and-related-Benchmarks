{
    "files": [
        {
            "location": "./../../dockers/CVE-2025-1974/custom_no_tool/docker-compose.yml",
            "content": "services:\n  webapp:\n    build:\n      context: ./app\n    ports:\n      - \"8080:8080\"\n    environment:\n      - NODE_ENV=production\n      - POSTGRES_USER=testuser\n      - POSTGRES_PASSWORD=testpass\n      - POSTGRES_DB=testdb\n    depends_on:\n      db:\n        condition: service_healthy\n    command: [\"sh\", \"-c\", \"until pg_isready -h db -p 5432; do sleep 1; done; node server.js\"]\n  db:\n    image: postgres:13-alpine\n    environment:\n      POSTGRES_USER: testuser\n      POSTGRES_PASSWORD: testpass\n      POSTGRES_DB: testdb\n    volumes:\n      - db_data:/var/lib/postgresql/data\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\n    ports:\n      - \"5432:5432\"\n    healthcheck:\n      test: [\"CMD\", \"pg_isready\", \"-U\", \"testuser\"]\n      interval: 5s\n      timeout: 5s\n      retries: 5\n  controller:\n    image: registry.k8s.io/ingress-nginx/controller:v1.11.4\n    command: [\"sleep\", \"infinity\"]\n    ports:\n      - \"80:80\"\n      - \"443:443\"\n      - \"8443:8443\"\n  kube-proxy:\n    image: registry.k8s.io/kube-proxy:v1.30.0\n    command: [\"sleep\", \"infinity\"]\nvolumes:\n  db_data:\n"
        },
        {
            "location": "./../../dockers/CVE-2025-1974/custom_no_tool/app/Dockerfile",
            "content": "FROM node:18-alpine\nWORKDIR /usr/src/app\nCOPY package*.json ./\n# Install build tools required for native npm modules, then clean up\nRUN apk add --no-cache --virtual .gyp python3 make g++ libc-dev \\\n    && npm install \\\n    && apk del .gyp\nCOPY . .\nEXPOSE 8080\nCMD [\"node\", \"server.js\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2025-1974/custom_no_tool/app/package.json",
            "content": "{\n  \"name\": \"vulnerable-app\",\n  \"version\": \"1.0.0\",\n  \"main\": \"server.js\",\n  \"scripts\": {\n    \"start\": \"node server.js\"\n  },\n  \"dependencies\": {\n    \"express\": \"4.16.0\",\n    \"pg\": \"8.7.1\"\n  }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2025-1974/custom_no_tool/app/server.js",
            "content": "const express = require('express');\nconst { Pool } = require('pg');\n\nconst pool = new Pool({\n  user: process.env.POSTGRES_USER || 'testuser',\n  host: 'db',\n  database: process.env.POSTGRES_DB || 'testdb',\n  password: process.env.POSTGRES_PASSWORD || 'testpass',\n  port: 5432,\n});\n\nconst app = express();\napp.use(express.json());\n\napp.get('/search', async (req, res) => {\n  const q = req.query.q || '';\n  const client = await pool.connect();\n  try {\n    const result = await client.query('SELECT * FROM users WHERE name = $1', [q]);\n    res.json(result.rows);\n  } catch (err) {\n    console.error('Query error:', err);\n    res.status(500).json({ error: 'Internal server error' });\n  } finally {\n    client.release();\n  }\n});\n\napp.listen(8080, () => {\n  console.log('Web app listening on port 8080');\n});\n"
        },
        {
            "location": "./../../dockers/CVE-2025-1974/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE IF NOT EXISTS users (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    email VARCHAR(100) NOT NULL\n);\n\nINSERT INTO users (name, email) VALUES\n    ('alice', 'alice@example.com'),\n    ('bob', 'bob@example.com'),\n    ('carol', 'carol@example.com');\n"
        }
    ],
    "directory_tree": "CVE-2025-1974/custom_no_tool"
}