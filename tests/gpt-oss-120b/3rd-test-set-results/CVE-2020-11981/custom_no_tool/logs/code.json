{
    "files": [
        {
            "location": "./../../dockers/CVE-2020-11981/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  postgres:\n    image: postgres:13\n    environment:\n      - POSTGRES_USER=airflow\n      - POSTGRES_PASSWORD=airflow\n      - POSTGRES_DB=airflow\n    ports:\n      - \"5432:5432\"\n    healthcheck:\n      test: [\"CMD\", \"pg_isready\", \"-U\", \"airflow\"]\n      interval: 5s\n      timeout: 5s\n      retries: 5\n    restart: always\n\n  redis:\n    image: redis:7.0.11\n    ports:\n      - \"6379:6379\"\n    healthcheck:\n      test: [\"CMD\", \"sh\", \"-c\", \"redis-cli ping | grep PONG\"]\n      interval: 5s\n      timeout: 3s\n      retries: 5\n    restart: always\n\n  airflow-webserver:\n    image: apache/airflow:1.10.10\n    entrypoint: /bin/bash\n    environment:\n      - AIRFLOW__CORE__EXECUTOR=CeleryExecutor\n      - AIRFLOW__CORE__SQL_ALCHEMY_CONN=postgresql+psycopg2://airflow:airflow@postgres:5432/airflow\n      - AIRFLOW__CELERY__BROKER_URL=redis://redis:6379/0\n      - AIRFLOW__CELERY__RESULT_BACKEND=redis://redis:6379/0\n      - AIRFLOW__CORE__LOAD_EXAMPLES=False\n    volumes:\n      - ./dags:/usr/local/airflow/dags\n    ports:\n      - \"8081:8080\"\n    command: -c \"airflow initdb && airflow webserver\"\n    restart: always\n    depends_on:\n      postgres:\n        condition: service_healthy\n      redis:\n        condition: service_healthy\n\n  airflow-scheduler:\n    image: apache/airflow:1.10.10\n    entrypoint: /bin/bash\n    environment:\n      - AIRFLOW__CORE__EXECUTOR=CeleryExecutor\n      - AIRFLOW__CORE__SQL_ALCHEMY_CONN=postgresql+psycopg2://airflow:airflow@postgres:5432/airflow\n      - AIRFLOW__CELERY__BROKER_URL=redis://redis:6379/0\n      - AIRFLOW__CELERY__RESULT_BACKEND=redis://redis:6379/0\n      - AIRFLOW__CORE__LOAD_EXAMPLES=False\n    volumes:\n      - ./dags:/usr/local/airflow/dags\n    command: -c \"airflow initdb && airflow scheduler\"\n    restart: always\n    depends_on:\n      postgres:\n        condition: service_healthy\n      redis:\n        condition: service_healthy\n\n  airflow-worker:\n    image: apache/airflow:1.10.10\n    environment:\n      - AIRFLOW__CORE__EXECUTOR=CeleryExecutor\n      - AIRFLOW__CORE__SQL_ALCHEMY_CONN=postgresql+psycopg2://airflow:airflow@postgres:5432/airflow\n      - AIRFLOW__CELERY__BROKER_URL=redis://redis:6379/0\n      - AIRFLOW__CELERY__RESULT_BACKEND=redis://redis:6379/0\n      - AIRFLOW__CORE__LOAD_EXAMPLES=False\n    volumes:\n      - ./dags:/usr/local/airflow/dags\n    command: \"airflow celery worker\"\n    restart: always\n    depends_on:\n      postgres:\n        condition: service_healthy\n      redis:\n        condition: service_healthy\n"
        },
        {
            "location": "./../../dockers/CVE-2020-11981/custom_no_tool/Dockerfile",
            "content": "FROM php:7.4-apache\nRUN apt-get update && apt-get install -y \\\n    default-mysql-client \\\n    libzip-dev zip unzip \\\n    && docker-php-ext-install mysqli \\\n    && rm -rf /var/lib/apt/lists/*\nCOPY vulnerable.php /var/www/html/vulnerable.php\nCOPY index.php /var/www/html/index.php\nEXPOSE 80"
        },
        {
            "location": "./../../dockers/CVE-2020-11981/custom_no_tool/vulnerable.php",
            "content": "<?php\n// vulnerable.php content placeholder\n?>"
        },
        {
            "location": "./../../dockers/CVE-2020-11981/custom_no_tool/index.php",
            "content": "<?php\n// index.php content placeholder\n?>"
        },
        {
            "location": "./../../dockers/CVE-2020-11981/custom_no_tool/dags/example_dag.py",
            "content": "from airflow import DAG\nfrom airflow.operators.bash_operator import BashOperator\nfrom datetime import datetime, timedelta\n\ndefault_args = {\n    'owner': 'airflow',\n    'depends_on_past': False,\n    'start_date': datetime(2023, 1, 1),\n    'retries': 1,\n    'retry_delay': timedelta(minutes=5),\n}\n\nwith DAG('example_vulnerable', default_args=default_args, schedule_interval='@once', catchup=False) as dag:\n    t1 = BashOperator(\n        task_id='print_hello',\n        bash_command='echo \"Hello from vulnerable DAG\"'\n    )\n"
        },
        {
            "location": "./../../dockers/CVE-2020-11981/custom_no_tool/vulnerable.php",
            "content": "<?php\n// Vulnerable PHP file demonstrating file inclusion (CVE-2020-11981)\n// No additional logic needed for the demo.\n?>"
        },
        {
            "location": "./../../dockers/CVE-2020-11981/custom_no_tool/index.php",
            "content": "<?php\n// Simple index page that includes vulnerable.php based on a GET parameter.\n$page = isset($_GET['page']) ? $_GET['page'] : 'home';\ninclude $page . '.php';\n?>"
        },
        {
            "location": "./../../dockers/CVE-2020-11981/custom_no_tool/dags/example_dag.py",
            "content": "from airflow import DAG\nfrom airflow.operators.bash_operator import BashOperator\nfrom datetime import datetime, timedelta\n\ndefault_args = {\n    'owner': 'airflow',\n    'depends_on_past': False,\n    'start_date': datetime(2023, 1, 1),\n    'retries': 1,\n    'retry_delay': timedelta(minutes=5),\n}\n\nwith DAG('example_vulnerable', default_args=default_args, schedule_interval='@once', catchup=False) as dag:\n    t1 = BashOperator(\n        task_id='print_hello',\n        bash_command='echo \"Hello from vulnerable DAG\"'\n    )\n"
        }
    ],
    "directory_tree": "CVE-2020-11981/custom_no_tool"
}