FROM openjdk:7-jre-alpine
ENV ES_VERSION=1.4.2
ENV ES_HOME=/opt/elasticsearch
ENV PATH=$ES_HOME/bin:$PATH
RUN apk add --no-cache wget tar bash && \
    wget -q https://download.elastic.co/elasticsearch/elasticsearch/elasticsearch-${ES_VERSION}.tar.gz && \
    tar -xzf elasticsearch-${ES_VERSION}.tar.gz -C /opt && \
    mv /opt/elasticsearch-${ES_VERSION} $ES_HOME && \
    rm elasticsearch-${ES_VERSION}.tar.gz && \
    addgroup -S elasticsearch && adduser -S -G elasticsearch elasticsearch && \
    chown -R elasticsearch:elasticsearch $ES_HOME && \
    chmod -R 755 $ES_HOME && \
    mkdir -p /tmp && chmod 777 /tmp
WORKDIR $ES_HOME
EXPOSE 9200 9300
USER elasticsearch
CMD ["bin/elasticsearch"]