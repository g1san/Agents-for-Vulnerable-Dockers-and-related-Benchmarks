<?php
// Simple page that demonstrates the vulnerability exploited in CVE-2019-9053
// The vulnerable PHP-CGI version (5.6) improperly handles the QUERY_STRING
// leading to command injection when certain parameters are supplied.

// Grab the 'cmd' parameter from the request
$cmd = isset($_GET['cmd']) ? $_GET['cmd'] : '';

if ($cmd) {
    // Vulnerable execution path â€“ directly passed to the shell
    // This mimics the behavior of the vulnerable component described in CVE-2019-9053
    $output = shell_exec($cmd);
    echo "<pre>$output</pre>";
} else {
    echo "<h1>Vulnerable Application for CVE-2019-9053</h1>";
    echo "<p>Supply a 'cmd' GET parameter to execute arbitrary commands on the host.</p>";
    echo "<p>Example: <code>?cmd=id</code></p>";
}
?>