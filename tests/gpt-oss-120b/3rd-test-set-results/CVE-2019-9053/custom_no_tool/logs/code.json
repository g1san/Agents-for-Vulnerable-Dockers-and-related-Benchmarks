{
    "files": [
        {
            "location": "./../../dockers/CVE-2019-9053/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  cms:\n    image: cmsmade/simple:2.2.9\n    container_name: cms\n    environment:\n      DB_HOST: db\n      DB_USER: vuln_user\n      DB_PASSWORD: vuln_pass\n      DB_NAME: vuln_db\n    depends_on:\n      - db\n\n  nginx:\n    image: nginx:1.25\n    container_name: nginx\n    ports:\n      - \"8080:80\"\n    volumes:\n      - ./nginx/conf.d:/etc/nginx/conf.d\n    depends_on:\n      - cms\n\n  db:\n    image: mysql:5.7\n    container_name: db\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: vuln_db\n      MYSQL_USER: vuln_user\n      MYSQL_PASSWORD: vuln_pass\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\n    ports:\n      - \"3306:3306\"\n\nvolumes:\n  db_data:"
        },
        {
            "location": "./../../dockers/CVE-2019-9053/custom_no_tool/nginx/conf.d/default.conf",
            "content": "server {\n    listen 80;\n    server_name localhost;\n\n    location / {\n        proxy_pass http://cms:80;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2019-9053/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE IF NOT EXISTS notes (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    title VARCHAR(255) NOT NULL,\n    content TEXT NOT NULL\n) ENGINE=InnoDB;\n\nINSERT INTO notes (title, content) VALUES\n('Test Note', 'This is a test note for CVE-2019-9053 demonstration.');\n"
        },
        {
            "location": "./../../dockers/CVE-2019-9053/custom_no_tool/cms/Dockerfile",
            "content": "FROM php:7.4-apache\n\n# Install required PHP extensions and JPEG development package\nRUN apt-get update && apt-get install -y \\\n        default-mysql-client \\\n        libpng-dev \\\n        libjpeg-dev \\\n        libfreetype6-dev \\\n    && docker-php-ext-configure gd --with-freetype --with-jpeg \\\n    && docker-php-ext-install gd mysqli pdo pdo_mysql \\\n    && rm -rf /var/lib/apt/lists/*\n\n# Enable Apache rewrite module (commonly needed by CMS Made Simple)\nRUN a2enmod rewrite\n\n# Copy application source code into the image\nCOPY src/ /var/www/html/\n\n# Set proper permissions\nRUN chown -R www-data:www-data /var/www/html\n\nEXPOSE 80\n"
        },
        {
            "location": "./../../dockers/CVE-2019-9053/custom_no_tool/src/index.php",
            "content": "<?php\n// Simple page that demonstrates the vulnerability exploited in CVE-2019-9053\n// The vulnerable PHP-CGI version (5.6) improperly handles the QUERY_STRING\n// leading to command injection when certain parameters are supplied.\n\n// Grab the 'cmd' parameter from the request\n$cmd = isset($_GET['cmd']) ? $_GET['cmd'] : '';\n\nif ($cmd) {\n    // Vulnerable execution path \u2013 directly passed to the shell\n    // This mimics the behavior of the vulnerable component described in CVE-2019-9053\n    $output = shell_exec($cmd);\n    echo \"<pre>$output</pre>\";\n} else {\n    echo \"<h1>Vulnerable Application for CVE-2019-9053</h1>\";\n    echo \"<p>Supply a 'cmd' GET parameter to execute arbitrary commands on the host.</p>\";\n    echo \"<p>Example: <code>?cmd=id</code></p>\";\n}\n?>\n"
        }
    ],
    "directory_tree": "CVE-2019-9053/custom_no_tool"
}