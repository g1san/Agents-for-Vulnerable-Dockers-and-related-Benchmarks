{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-42342/custom_no_tool/docker-compose.yml",
            "content": "services:\n  goahead:\n    build: ./goahead\n    container_name: goahead\n    ports:\n      - \"8080:80\"\n  vulnerable_app:\n    build: .\n    container_name: vulnerable_app\n    ports:\n      - \"5000:5000\"\n    depends_on:\n      - goahead"
        },
        {
            "location": "./../../dockers/CVE-2021-42342/custom_no_tool/Dockerfile",
            "content": "FROM python:3.11-alpine\nWORKDIR /app\n\n# Install python dependencies\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\n# Copy application source\nCOPY . .\n\nEXPOSE 5000\nCMD [\"python\", \"app.py\"]"
        },
        {
            "location": "./../../dockers/CVE-2021-42342/custom_no_tool/requirements.txt",
            "content": "flask"
        },
        {
            "location": "./../../dockers/CVE-2021-42342/custom_no_tool/app.py",
            "content": "from flask import Flask, request, jsonify\nimport subprocess\napp = Flask(__name__)\n\n@app.route('/exec', methods=['POST'])\ndef exec_cmd():\n    cmd = request.json.get('cmd')\n    if not cmd:\n        return jsonify({'error': 'no command'}), 400\n    try:\n        result = subprocess.check_output(cmd, shell=True, stderr=subprocess.STDOUT, text=True)\n        return jsonify({'output': result})\n    except subprocess.CalledProcessError as e:\n        return jsonify({'error': e.output}), 500\n\n@app.route('/')\ndef index():\n    return \"Vulnerable app for CVE-2021-42342\"\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000)"
        },
        {
            "location": "./../../dockers/CVE-2021-42342/custom_no_tool/goahead/Dockerfile",
            "content": "FROM debian:stable-slim\nWORKDIR /goahead\n\n# Install wget and tar\nRUN apt-get update && apt-get install -y --no-install-recommends wget ca-certificates tar && rm -rf /var/lib/apt/lists/*\n\n# Download and extract a vulnerable GoAhead version (5.1.4)\nRUN wget -O goahead.tar.gz https://github.com/embedthis/goahead/releases/download/5.1.4/goahead-5.1.4.tar.gz && \\\n    tar -xzf goahead.tar.gz && \\\n    mv goahead-5.1.4/* . && \\\n    rm -rf goahead-5.1.4 goahead.tar.gz\n\nEXPOSE 80\n\n# Start GoAhead with its default configuration\nCMD [\"./goahead\", \"-c\", \"conf/goahead.conf\"]"
        }
    ],
    "directory_tree": "CVE-2021-42342/custom_no_tool"
}