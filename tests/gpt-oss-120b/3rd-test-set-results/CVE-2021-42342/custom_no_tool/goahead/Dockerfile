FROM debian:stable-slim
WORKDIR /goahead

# Install wget and tar
RUN apt-get update && apt-get install -y --no-install-recommends wget ca-certificates tar && rm -rf /var/lib/apt/lists/*

# Download and extract a vulnerable GoAhead version (5.1.4)
RUN wget -O goahead.tar.gz https://github.com/embedthis/goahead/releases/download/5.1.4/goahead-5.1.4.tar.gz && \
    tar -xzf goahead.tar.gz && \
    mv goahead-5.1.4/* . && \
    rm -rf goahead-5.1.4 goahead.tar.gz

EXPOSE 80

# Start GoAhead with its default configuration
CMD ["./goahead", "-c", "conf/goahead.conf"]