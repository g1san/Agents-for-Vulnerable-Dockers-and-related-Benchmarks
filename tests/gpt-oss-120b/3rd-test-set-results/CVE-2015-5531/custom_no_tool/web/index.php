<?php
// Simple vulnerable script vulnerable to CVE-2015-5531 (example: unsafe unserialize)
if (isset($_GET['data'])) {
    $obj = unserialize($_GET['data']); // exploitable path
    echo "Object processed.";
}

$mysqli = new mysqli(getenv('DB_HOST'), getenv('DB_USER'), getenv('DB_PASSWORD'), getenv('DB_NAME'));
if ($mysqli->connect_error) {
    die('Connection error: ' . $mysqli->connect_error);
}
$result = $mysqli->query('SELECT * FROM test');
while ($row = $result->fetch_assoc()) {
    echo '<p>' . htmlspecialchars($row['name']) . '</p>';
}
?>