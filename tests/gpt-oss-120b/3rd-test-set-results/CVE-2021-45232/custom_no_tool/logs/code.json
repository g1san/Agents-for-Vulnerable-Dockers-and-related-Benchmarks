{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-45232/custom_no_tool/docker-compose.yml",
            "content": "services:\n  etcd:\n    image: bitnami/etcd:3.5.9\n    container_name: etcd\n    environment:\n      - ALLOW_NONE_AUTHENTICATION=yes\n      - ETCD_ADVERTISE_CLIENT_URLS=http://0.0.0.0:2379\n      - ETCD_LISTEN_CLIENT_URLS=http://0.0.0.0:2379\n    ports:\n      - \"2379:2379\"\n    restart: always\n\n  apisix-dashboard:\n    image: apache/apisix-dashboard:2.9.0\n    container_name: vulnerable_dashboard\n    ports:\n      - \"9000:9000\"\n    environment:\n      - ETCD_ENDPOINTS=http://etcd:2379\n    volumes:\n      - ./dashboard_config.yaml:/usr/local/apisix-dashboard/conf/config.yaml:ro\n    depends_on:\n      - etcd\n    restart: always"
        },
        {
            "location": "./../../dockers/CVE-2021-45232/custom_no_tool/dashboard_config.yaml",
            "content": "# Dashboard configuration that leaves authentication disabled\n# This matches the vulnerable default where Manager API endpoints are exposed without auth.\n# No authentication section is defined, so all API routes are accessible anonymously.\n# The dashboard will still listen on port 9000 (default).\n\napisix:\n  dashboard:\n    port: 9000\n    # auth: disabled (implicitly by omission)"
        },
        {
            "location": "./../../dockers/CVE-2021-45232/custom_no_tool/README.txt",
            "content": "This Docker setup reproduces CVE-2021-45232 by deploying the Apache APISIX Dashboard using a vulnerable version (2.9.0) with authentication disabled and an embedded etcd instance.\n\nTo start the vulnerable environment, run the following command from the repository root (or any directory you prefer):\n\n    sudo docker compose -f ./../../dockers/CVE-2021-45232/custom_no_tool/docker-compose.yml up -d\n\nThe dashboard's Manager API will be reachable on host port 9000. Because authentication is omitted, any client can call the API endpoints, read or modify gateway configuration objects, and inject malicious Lua code, leading to remote code execution as described in CVE-2021-45232.\n\nThe compose file also launches an etcd service (container name \"etcd\") listening on port 2379, which the dashboard uses for its configuration store. The etcd image tag has been set to a concrete `3.5.9` version to guarantee availability.\n\nThe dashboard configuration file is mounted using a relative path (`./dashboard_config.yaml`) which resolves correctly when the compose file is executed from its own directory or when the command is run from the repository root as shown above.\n\nNo additional manual steps are required. All services start automatically and are accessible on their default network ports."
        }
    ],
    "directory_tree": "CVE-2021-45232/custom_no_tool"
}