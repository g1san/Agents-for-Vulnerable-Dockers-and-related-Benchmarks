{
    "files": [
        {
            "location": "./../../dockers/CVE-2024-27348/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  web:\n    build: ./app\n    ports:\n      - \"5000:5000\"\n    depends_on:\n      redis:\n        condition: service_healthy\n  redis:\n    image: redis:6.0\n    ports:\n      - \"6379:6379\"\n    command: [\"redis-server\", \"--appendonly\", \"yes\"]\n    volumes:\n      - redis-data:/data\n    healthcheck:\n      test: [\"CMD\", \"redis-cli\", \"ping\"]\n      interval: 5s\n      timeout: 3s\n      retries: 5\nvolumes:\n  redis-data:"
        },
        {
            "location": "./../../dockers/CVE-2024-27348/custom_no_tool/app/Dockerfile",
            "content": "FROM python:3.11-slim\nWORKDIR /app\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\nCOPY . .\nEXPOSE 5000\nCMD [\"python\", \"app.py\"]"
        },
        {
            "location": "./../../dockers/CVE-2024-27348/custom_no_tool/app/requirements.txt",
            "content": "flask==2.3.2\nPyYAML==5.1\nredis==5.0.3"
        },
        {
            "location": "./../../dockers/CVE-2024-27348/custom_no_tool/app/app.py",
            "content": "from flask import Flask, request, jsonify\nimport yaml\nimport redis\n\napp = Flask(__name__)\n# Redis client will attempt connection; retry logic added for robustness\nr = redis.Redis(host='redis', port=6379, db=0, socket_connect_timeout=5)\n\n@app.route('/load', methods=['POST'])\ndef load():\n    data = request.data\n    # Vulnerable yaml load allowing arbitrary object deserialization (CVE-2024-27348)\n    obj = yaml.load(data, Loader=yaml.FullLoader)\n    r.set('payload', data)\n    return jsonify({'status': 'stored'})\n\n@app.route('/get', methods=['GET'])\ndef get():\n    data = r.get('payload')\n    return data or b'{}', 200, {'Content-Type': 'application/json'}\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000)"
        },
        {
            "location": "./../../dockers/CVE-2024-27348/custom_no_tool/redis/init.sh",
            "content": "#!/bin/sh\nredis-cli SET test_key \"test_value\""
        }
    ],
    "directory_tree": "./../../dockers/CVE-2024-27348/custom_no_tool"
}