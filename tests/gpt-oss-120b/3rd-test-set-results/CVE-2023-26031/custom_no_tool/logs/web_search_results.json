{
    "desc": "CVE\u20112023\u201126031 is a privilege escalation vulnerability in Apache Hadoop YARN. The vulnerable component is the native `container-executor` binary located in HADOOP_HOME/bin and used by YARN Secure Containers on Linux. In Hadoop versions 3.3.1 through 3.3.4 the YARN\u201110495 change altered the binary's runtime library path (RPATH) from `$ORIGIN/` to `$ORIGIN/:../lib/native/`. This added a writable relative directory that can contain a malicious `libcrypto.so`. Because `container\u2011executor` runs set\u2011uid root, an attacker who can write a crafted library into that directory can have the binary load the attacker\u2011controlled code and execute it with root privileges. Exploitation requires the binary to be owned by root with the suid bit set, the vulnerable RPATH to be present, and write access to a directory on the RPATH (which may be obtained by a low\u2011privilege or remote authenticated YARN user). Successful exploitation gives the attacker full root control of the Hadoop node, compromising the entire cluster. The issue is fixed in Hadoop 3.3.5 where the RPATH is reverted to `$ORIGIN/` and the suid bit can be removed or ownership changed to a non\u2011root user.",
    "attack_type": "privilege escalation to root",
    "services": [
        {
            "name": "apache/hadoop",
            "version": [
                "3.3.1",
                "3.3.2",
                "3.3.3",
                "3.3.4"
            ],
            "dependency_type": "HARD",
            "description": "Provides the vulnerable Hadoop YARN container\u2011executor binary needed to reproduce CVE\u20112023\u201126031."
        }
    ],
    "input_tokens": 9066,
    "output_tokens": 1691
}