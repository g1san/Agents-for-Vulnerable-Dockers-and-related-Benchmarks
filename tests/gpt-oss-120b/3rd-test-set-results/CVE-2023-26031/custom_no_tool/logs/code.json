{
    "files": [
        {
            "location": "./../../dockers/CVE-2023-26031/custom_no_tool/docker-compose.yml",
            "content": "services:\n  hadoop:\n    build: .\n    hostname: hadoop\n    container_name: hadoop\n    environment:\n      - HADOOP_HOME=/opt/hadoop\n    command: /bin/sh -c \"while true; do sleep 3600; done\"\n    ports:\n      - \"8088:8088\"\n      - \"8042:8042\"\n  web:\n    image: nginx:1.21-alpine\n    ports:\n      - \"80:80\"\n    volumes:\n      - ./html:/usr/share/nginx/html:ro\n      - ./nginx.conf:/etc/nginx/conf.d/default.conf:ro\n    depends_on:\n      - php\n      - hadoop\n  php:\n    image: php:8.2-fpm-alpine\n    volumes:\n      - ./html:/var/www/html\n    environment:\n      - PHP_DISPLAY_ERRORS=1\n    depends_on:\n      - db\n      - hadoop\n  db:\n    image: mysql:5.7\n    command: --default-authentication-plugin=mysql_native_password\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpassword\n      MYSQL_DATABASE: testdb\n      MYSQL_USER: testuser\n      MYSQL_PASSWORD: testpass\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./init.sql:/docker-entrypoint-initdb.d/init.sql\n    depends_on:\n      - hadoop\nvolumes:\n  db_data:\n"
        },
        {
            "location": "./../../dockers/CVE-2023-26031/custom_no_tool/Dockerfile",
            "content": "FROM ubuntu:22.04\nARG HADOOP_VERSION=3.3.4\nENV HADOOP_HOME=/opt/hadoop\n# Install prerequisites and Hadoop native dependencies\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends \\\n        wget gnupg openjdk-11-jdk \\\n        libssl3 libpam0g libprotobuf-lite23 ca-certificates && \\\n    rm -rf /var/lib/apt/lists/*\n# Download Hadoop binary from Apache archive (mirrors may be unavailable)\nRUN wget https://archive.apache.org/dist/hadoop/common/hadoop-${HADOOP_VERSION}/hadoop-${HADOOP_VERSION}.tar.gz -O /tmp/hadoop.tar.gz && \\\n    mkdir -p ${HADOOP_HOME} && \\\n    tar -xzf /tmp/hadoop.tar.gz -C ${HADOOP_HOME} --strip-components=1 && \\\n    rm /tmp/hadoop.tar.gz\n# Adjust permissions for the vulnerable container-executor binary (set\u2011uid root)\nRUN if [ -f \"${HADOOP_HOME}/bin/container-executor\" ]; then \\\n        chown root:root ${HADOOP_HOME}/bin/container-executor && \\\n        chmod 4755 ${HADOOP_HOME}/bin/container-executor; \\\n    fi\nWORKDIR ${HADOOP_HOME}\nEXPOSE 8088 8042"
        },
        {
            "location": "./../../dockers/CVE-2023-26031/custom_no_tool/nginx.conf",
            "content": "server {\n    listen 80;\n    server_name localhost;\n    root /usr/share/nginx/html;\n    index index.php index.html;\n    location / {\n        try_files $uri $uri/ =404;\n    }\n    location ~ \\.php$ {\n        fastcgi_pass php:9000;\n        fastcgi_index index.php;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        include fastcgi_params;\n    }\n}"
        },
        {
            "location": "./../../dockers/CVE-2023-26031/custom_no_tool/init.sql",
            "content": "CREATE TABLE users (id INT AUTO_INCREMENT PRIMARY KEY, username VARCHAR(50), password VARCHAR(255));\nINSERT INTO users (username, password) VALUES ('alice', 'password123'), ('bob', 'qwerty');"
        },
        {
            "location": "./../../dockers/CVE-2023-26031/custom_no_tool/html/index.php",
            "content": "<?php\n// Simple vulnerable script demonstrating unsanitized input execution\nif (isset($_GET['cmd'])) {\n    $output = shell_exec($_GET['cmd']);\n    echo \"<pre>$output</pre>\";\n} else {\n    echo \"<form method='GET'>\\n\";\n    echo \"Command: <input type='text' name='cmd'/> <input type='submit' value='Run'/><br/>\\n\";\n    echo \"</form>\";\n}\n?>"
        }
    ],
    "directory_tree": "CVE-2023-26031/custom_no_tool"
}