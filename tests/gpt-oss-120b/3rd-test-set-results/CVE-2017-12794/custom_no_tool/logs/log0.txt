time="2025-11-02T02:13:56+01:00" level=warning msg="/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2017-12794/custom_no_tool/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
 dind Pulling 
 14f69cd495a5 Pulling fs layer 
 f340e3680878 Pulling fs layer 
 faf624a6953e Pulling fs layer 
 4c0471383e89 Pulling fs layer 
 ca1ad863697c Pulling fs layer 
 0f73791e9dee Pulling fs layer 
 605ce1bd3f31 Pulling fs layer 
 c0f7fb6c5f12 Pulling fs layer 
 f966ecaebdf4 Pulling fs layer 
 83b95990d12b Pulling fs layer 
 14f69cd495a5 Download complete 
 f340e3680878 Download complete 
 605ce1bd3f31 Downloading [==========================>                        ]  1.049MB/1.992MB
 0f73791e9dee Download complete 
 ca1ad863697c Download complete 
 605ce1bd3f31 Download complete 
 faf624a6953e Download complete 
 605ce1bd3f31 Extracting 1 s
 605ce1bd3f31 Pull complete 
 83b95990d12b Downloading [=>                                                 ]  1.049MB/30.7MB
 4c0471383e89 Download complete 
 83b95990d12b Downloading [=>                                                 ]  1.049MB/30.7MB
 c0f7fb6c5f12 Downloading [=============>                                     ]  1.049MB/3.885MB
 f966ecaebdf4 Download complete 
 f966ecaebdf4 Extracting 1 s
 83b95990d12b Downloading [=>                                                 ]  1.049MB/30.7MB
 c0f7fb6c5f12 Downloading [=============>                                     ]  1.049MB/3.885MB
 f966ecaebdf4 Pull complete 
 83b95990d12b Downloading [===>                                               ]  2.097MB/30.7MB
 c0f7fb6c5f12 Downloading [=============>                                     ]  1.049MB/3.885MB
 ca1ad863697c Pull complete 
 83b95990d12b Downloading [===>                                               ]  2.097MB/30.7MB
 c0f7fb6c5f12 Downloading [=============>                                     ]  1.049MB/3.885MB
 83b95990d12b Downloading [=====>                                             ]  3.146MB/30.7MB
 c0f7fb6c5f12 Downloading [==========================>                        ]  2.097MB/3.885MB
 83b95990d12b Downloading [=====>                                             ]  3.146MB/30.7MB
 c0f7fb6c5f12 Downloading [==========================>                        ]  2.097MB/3.885MB
 83b95990d12b Downloading [======>                                            ]  4.194MB/30.7MB
 c0f7fb6c5f12 Downloading [==========================>                        ]  2.097MB/3.885MB
 83b95990d12b Downloading [======>                                            ]  4.194MB/30.7MB
 c0f7fb6c5f12 Downloading [========================================>          ]  3.146MB/3.885MB
 83b95990d12b Downloading [======>                                            ]  4.194MB/30.7MB
 c0f7fb6c5f12 Downloading [========================================>          ]  3.146MB/3.885MB
 83b95990d12b Downloading [========>                                          ]  5.243MB/30.7MB
 c0f7fb6c5f12 Download complete 
 83b95990d12b Downloading [========>                                          ]  5.243MB/30.7MB
 83b95990d12b Downloading [==========>                                        ]  6.291MB/30.7MB
 83b95990d12b Downloading [===========>                                       ]   7.34MB/30.7MB
 83b95990d12b Downloading [===========>                                       ]   7.34MB/30.7MB
 83b95990d12b Downloading [=============>                                     ]  8.389MB/30.7MB
 83b95990d12b Downloading [===============>                                   ]  9.437MB/30.7MB
 83b95990d12b Downloading [=================>                                 ]  10.49MB/30.7MB
 83b95990d12b Downloading [=================>                                 ]  10.49MB/30.7MB
 83b95990d12b Downloading [==================>                                ]  11.53MB/30.7MB
 83b95990d12b Downloading [====================>                              ]  12.58MB/30.7MB
 83b95990d12b Downloading [====================>                              ]  12.58MB/30.7MB
 83b95990d12b Downloading [======================>                            ]  13.63MB/30.7MB
 83b95990d12b Downloading [=======================>                           ]  14.68MB/30.7MB
 83b95990d12b Downloading [=========================>                         ]  15.73MB/30.7MB
 83b95990d12b Downloading [=========================>                         ]  15.73MB/30.7MB
 83b95990d12b Downloading [===========================>                       ]  16.78MB/30.7MB
 83b95990d12b Downloading [=============================>                     ]  17.83MB/30.7MB
 83b95990d12b Downloading [=============================>                     ]  17.83MB/30.7MB
 83b95990d12b Downloading [==============================>                    ]  18.87MB/30.7MB
 83b95990d12b Downloading [================================>                  ]  19.92MB/30.7MB
 83b95990d12b Downloading [==================================>                ]  20.97MB/30.7MB
 83b95990d12b Downloading [==================================>                ]  20.97MB/30.7MB
 83b95990d12b Downloading [===================================>               ]  22.02MB/30.7MB
 83b95990d12b Downloading [=====================================>             ]  23.07MB/30.7MB
 83b95990d12b Downloading [=====================================>             ]  23.07MB/30.7MB
 83b95990d12b Downloading [=======================================>           ]  24.12MB/30.7MB
 83b95990d12b Downloading [========================================>          ]  25.17MB/30.7MB
 83b95990d12b Downloading [==========================================>        ]  26.21MB/30.7MB
 83b95990d12b Downloading [==========================================>        ]  26.21MB/30.7MB
 83b95990d12b Downloading [============================================>      ]  27.26MB/30.7MB
 83b95990d12b Downloading [==============================================>    ]  28.31MB/30.7MB
 83b95990d12b Downloading [==============================================>    ]  28.31MB/30.7MB
 83b95990d12b Downloading [===============================================>   ]  29.36MB/30.7MB
 83b95990d12b Downloading [==================================================>]   30.7MB/30.7MB
 83b95990d12b Download complete 
 83b95990d12b Extracting 1 s
 83b95990d12b Extracting 1 s
 83b95990d12b Extracting 1 s
 83b95990d12b Extracting 1 s
 f340e3680878 Pull complete 
 0f73791e9dee Pull complete 
 c0f7fb6c5f12 Extracting 1 s
 83b95990d12b Pull complete 
 14f69cd495a5 Pull complete 
 faf624a6953e Pull complete 
 14f69cd495a5 Pull complete 
 faf624a6953e Pull complete 
 4c0471383e89 Pull complete 
 c0f7fb6c5f12 Pull complete 
 dind Pulled 
#1 [internal] load local bake definitions
#1 reading from stdin 711B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile: 185B done
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/library/alpine:3.14
#3 DONE 1.5s

#4 [internal] load .dockerignore
#4 transferring context: 2B done
#4 DONE 0.0s

#5 [internal] load build context
#5 transferring context: 680B 0.0s done
#5 DONE 0.0s

#6 [1/4] FROM docker.io/library/alpine:3.14@sha256:0f2d5c38dd7a4f4f733e688e3a6733cb5ab1ac6e3cb4603a5dd564e5bfb80eed
#6 resolve docker.io/library/alpine:3.14@sha256:0f2d5c38dd7a4f4f733e688e3a6733cb5ab1ac6e3cb4603a5dd564e5bfb80eed 0.0s done
#6 sha256:f7dab3ab2d6ec29aa28769bec35331fb485b5837501b1e8556413d8b5a79c9c8 0B / 2.83MB 0.2s
#6 sha256:f7dab3ab2d6ec29aa28769bec35331fb485b5837501b1e8556413d8b5a79c9c8 2.10MB / 2.83MB 0.6s
#6 sha256:f7dab3ab2d6ec29aa28769bec35331fb485b5837501b1e8556413d8b5a79c9c8 2.83MB / 2.83MB 0.7s done
#6 extracting sha256:f7dab3ab2d6ec29aa28769bec35331fb485b5837501b1e8556413d8b5a79c9c8 0.1s done
#6 DONE 0.8s

#7 [2/4] RUN apk add --no-cache docker-cli tar curl
#7 0.190 fetch https://dl-cdn.alpinelinux.org/alpine/v3.14/main/x86_64/APKINDEX.tar.gz
#7 0.362 fetch https://dl-cdn.alpinelinux.org/alpine/v3.14/community/x86_64/APKINDEX.tar.gz
#7 0.659 (1/8) Installing ca-certificates (20230506-r0)
#7 0.701 (2/8) Installing brotli-libs (1.0.9-r5)
#7 0.760 (3/8) Installing nghttp2-libs (1.43.0-r0)
#7 0.787 (4/8) Installing libcurl (8.0.1-r0)
#7 0.834 (5/8) Installing curl (8.0.1-r0)
#7 0.866 (6/8) Installing docker-cli (20.10.11-r1)
#7 2.845 (7/8) Installing libacl (2.2.53-r0)
#7 2.859 (8/8) Installing tar (1.34-r1)
#7 2.922 Executing busybox-1.33.1-r8.trigger
#7 2.926 Executing ca-certificates-20230506-r0.trigger
#7 2.966 OK: 60 MiB in 22 packages
#7 DONE 3.2s

#8 [3/4] COPY exploit.sh /exploit.sh
#8 DONE 0.0s

#9 [4/4] RUN chmod +x /exploit.sh
#9 DONE 0.2s

#10 exporting to image
#10 exporting layers
#10 exporting layers 2.0s done
#10 exporting manifest sha256:919c9692312bd98773609b2356c703be273194d7bb5bc8b578a020988ffdfad7 done
#10 exporting config sha256:c716c244deeacce99039b2f0fc98210f58008c848324e65ae8a09feebba824cd 0.0s done
#10 exporting attestation manifest sha256:5c61541ea58f15b13476b7bd03f94ed821e874514c18739a90f3a4888f5966bd 0.0s done
#10 exporting manifest list sha256:4174807aab8427a836fe1aa0fb0f783680e2a1ac740f48867a1ab9c68bcf7823 0.0s done
#10 naming to docker.io/library/custom_no_tool-exploit:latest done
#10 unpacking to docker.io/library/custom_no_tool-exploit:latest
#10 unpacking to docker.io/library/custom_no_tool-exploit:latest 0.3s done
#10 DONE 2.4s

#11 resolving provenance for metadata file
#11 DONE 0.0s
 custom_no_tool-exploit  Built
 Network custom_no_tool_default  Creating
 Network custom_no_tool_default  Created
 Container custom_no_tool-dind-1  Creating
 Container custom_no_tool-dind-1  Created
 Container custom_no_tool-exploit-1  Creating
 Container custom_no_tool-exploit-1  Created
 Container custom_no_tool-dind-1  Starting
 Container custom_no_tool-dind-1  Started
 Container custom_no_tool-exploit-1  Starting
 Container custom_no_tool-exploit-1  Started


sudo docker logs 975ad25067877c408a8038e776c3eec8cc31c1307312ee889a3b84beebfd313b --details
STDOUT: 
STDERR:  WARNING: the "devices" cgroup should be in its own hierarchy.
 WARNING: it looks like the "devices" cgroup is not mounted.
 time="2025-11-02T01:14:17.047716608Z" level=warning msg="could not change group /var/run/docker.sock to docker: group docker not found" 
 time="2025-11-02T01:14:17.047901242Z" level=warning msg="[!] DON'T BIND ON ANY IP ADDRESS WITHOUT setting --tlsverify IF YOU DON'T KNOW WHAT YOU'RE DOING [!]" 
 time="2025-11-02T01:14:17.049976365Z" level=info msg="libcontainerd: new containerd process, pid: 25" 
 time="2025-11-02T01:14:18.051221660Z" level=warning msg="failed to rename /var/lib/docker/tmp for background deletion: rename /var/lib/docker/tmp /var/lib/docker/tmp-old: no such file or directory. Deleting synchronously" 
 time="2025-11-02T01:14:18.092041808Z" level=info msg="Graph migration to content-addressability took 0.00 seconds" 
 time="2025-11-02T01:14:18.092216368Z" level=warning msg="Your kernel does not support cgroup memory limit" 
 time="2025-11-02T01:14:18.092243385Z" level=warning msg="Unable to find cpu cgroup in mounts" 
 time="2025-11-02T01:14:18.092249888Z" level=warning msg="Unable to find blkio cgroup in mounts" 
 time="2025-11-02T01:14:18.092253826Z" level=warning msg="Unable to find cpuset cgroup in mounts" 
 time="2025-11-02T01:14:18.092291284Z" level=warning msg="mountpoint for pids not found" 
 Error starting daemon: Devices cgroup isn't mounted




sudo docker inspect 975ad25067877c408a8038e776c3eec8cc31c1307312ee889a3b84beebfd313b[
    {
        "Id": "975ad25067877c408a8038e776c3eec8cc31c1307312ee889a3b84beebfd313b",
        "Created": "2025-11-02T01:14:16.602246631Z",
        "Path": "dockerd-entrypoint.sh",
        "Args": [],
        "State": {
            "Status": "exited",
            "Running": false,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 0,
            "ExitCode": 1,
            "Error": "",
            "StartedAt": "2025-11-02T01:14:16.85923314Z",
            "FinishedAt": "2025-11-02T01:14:18.09838999Z"
        },
        "Image": "sha256:a75d8f44af2df8a76bdb93d96f39bb98b83bfae5779c366a6bf57244db5e97fe",
        "ResolvConfPath": "/var/lib/docker/containers/975ad25067877c408a8038e776c3eec8cc31c1307312ee889a3b84beebfd313b/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/975ad25067877c408a8038e776c3eec8cc31c1307312ee889a3b84beebfd313b/hostname",
        "HostsPath": "/var/lib/docker/containers/975ad25067877c408a8038e776c3eec8cc31c1307312ee889a3b84beebfd313b/hosts",
        "LogPath": "/var/lib/docker/containers/975ad25067877c408a8038e776c3eec8cc31c1307312ee889a3b84beebfd313b/975ad25067877c408a8038e776c3eec8cc31c1307312ee889a3b84beebfd313b-json.log",
        "Name": "/custom_no_tool-dind-1",
        "RestartCount": 0,
        "Driver": "overlayfs",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": null,
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "custom_no_tool_default",
            "PortBindings": {
                "2375/tcp": [
                    {
                        "HostIp": "",
                        "HostPort": "2375"
                    }
                ]
            },
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "ConsoleSize": [
                0,
                0
            ],
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": null,
            "DnsOptions": null,
            "DnsSearch": null,
            "ExtraHosts": [],
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": true,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": [
                "label=disable"
            ],
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": null,
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": null,
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": null,
            "ReadonlyPaths": null
        },
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "Mounts": [
            {
                "Type": "volume",
                "Name": "0d54d89bfdb6dc41a5ea4fc200bb434bc3afbeeff32a2af56e57664b7246cd3d",
                "Source": "/var/lib/docker/volumes/0d54d89bfdb6dc41a5ea4fc200bb434bc3afbeeff32a2af56e57664b7246cd3d/_data",
                "Destination": "/var/lib/docker",
                "Driver": "local",
                "Mode": "",
                "RW": true,
                "Propagation": ""
            }
        ],
        "Config": {
            "Hostname": "975ad2506787",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": true,
            "AttachStderr": true,
            "ExposedPorts": {
                "2375/tcp": {}
            },
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "DOCKER_TLS_CERTDIR=",
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
                "DOCKER_CHANNEL=stable",
                "DOCKER_VERSION=17.09.1-ce",
                "DIND_COMMIT=3b5fac462d21ca164b3778647420016315289034"
            ],
            "Cmd": [],
            "Image": "docker:17.09-dind",
            "Volumes": {
                "/var/lib/docker": {}
            },
            "WorkingDir": "",
            "Entrypoint": [
                "dockerd-entrypoint.sh"
            ],
            "OnBuild": null,
            "Labels": {
                "com.docker.compose.config-hash": "a577527ac55ea97622e7b648ee20099a28ab90d268cf2931bb8c97a77c280850",
                "com.docker.compose.container-number": "1",
                "com.docker.compose.depends_on": "",
                "com.docker.compose.image": "sha256:a75d8f44af2df8a76bdb93d96f39bb98b83bfae5779c366a6bf57244db5e97fe",
                "com.docker.compose.oneoff": "False",
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.project.config_files": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2017-12794/custom_no_tool/docker-compose.yml",
                "com.docker.compose.project.working_dir": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2017-12794/custom_no_tool",
                "com.docker.compose.service": "dind",
                "com.docker.compose.version": "2.40.2",
                "desktop.docker.io/wsl-distro": "Ubuntu"
            },
            "StopTimeout": 1
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "",
            "SandboxKey": "",
            "Ports": {},
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "",
            "Gateway": "",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "",
            "IPPrefixLen": 0,
            "IPv6Gateway": "",
            "MacAddress": "",
            "Networks": {
                "custom_no_tool_default": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": [
                        "custom_no_tool-dind-1",
                        "dind"
                    ],
                    "MacAddress": "",
                    "DriverOpts": null,
                    "GwPriority": 0,
                    "NetworkID": "a8a25853655aa7ff925ab7fd5a12481eba070ffbf493bb855b48861e990fb3e1",
                    "EndpointID": "",
                    "Gateway": "",
                    "IPAddress": "",
                    "IPPrefixLen": 0,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "DNSNames": [
                        "custom_no_tool-dind-1",
                        "dind",
                        "975ad2506787"
                    ]
                }
            }
        },
        "ImageManifestDescriptor": {
            "mediaType": "application/vnd.docker.distribution.manifest.v2+json",
            "digest": "sha256:a373399357991bcb15896017cdf02bdd7fe104807bd289b0249ba2e5ab6ea3f6",
            "size": 2407,
            "platform": {
                "architecture": "amd64",
                "os": "linux"
            }
        }
    }
]