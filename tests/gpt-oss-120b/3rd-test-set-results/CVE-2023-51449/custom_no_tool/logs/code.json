{
    "files": [
        {
            "location": "./../../dockers/CVE-2023-51449/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  web:\n    build: ./web\n    ports:\n      - \"5000:5000\"\n    environment:\n      - FLASK_ENV=development"
        },
        {
            "location": "./../../dockers/CVE-2023-51449/custom_no_tool/web/Dockerfile",
            "content": "FROM python:3.11-slim\nWORKDIR /app\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\nCOPY app.py .\nEXPOSE 5000\nCMD [\"python\", \"app.py\"]"
        },
        {
            "location": "./../../dockers/CVE-2023-51449/custom_no_tool/web/requirements.txt",
            "content": "Flask==2.2.5"
        },
        {
            "location": "./../../dockers/CVE-2023-51449/custom_no_tool/web/app.py",
            "content": "from flask import Flask, request, abort, Response\nimport os\napp = Flask(__name__)\n\n@app.route('/')\ndef index():\n    return '<h1>Vulnerable File Reader</h1><p>Use /read?file=PATH to read a file.</p>'\n\n@app.route('/read')\ndef read_file():\n    # CVE-2023-51449: insecure file handling allowing path traversal\n    file_path = request.args.get('file')\n    if not file_path:\n        abort(400, 'Missing \"file\" parameter')\n    # No sanitization or validation performed \u2013 vulnerable to directory traversal\n    try:\n        with open(file_path, 'rb') as f:\n            data = f.read()\n        # Return file content as plain text\n        return Response(data, mimetype='text/plain')\n    except Exception as e:\n        return f'Error reading file: {e}', 500\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000, debug=True)"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2023-51449/custom_no_tool"
}