{
    "files": [
        {
            "location": "./../../dockers/CVE-2023-29300/custom_no_tool/docker-compose.yml",
            "content": "services:\n  coldfusion:\n    image: adobe/coldfusion:2023-ga-2023.0.0.330468\n    container_name: coldfusion\n    ports:\n      - \"8500:8500\"\n    environment:\n      - CF_INSTALL_EVAL=true\n    volumes:\n      - ./coldfusion/webroot:/opt/coldfusion/cfusion/wwwroot\n    depends_on:\n      - db\n  db:\n    image: mysql:5.7\n    container_name: cf_mysql\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: testdb\n      MYSQL_USER: user\n      MYSQL_PASSWORD: userpass\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./init.sql:/docker-entrypoint-initdb.d/init.sql\nvolumes:\n  db_data:\n    driver: local"
        },
        {
            "location": "./../../dockers/CVE-2023-29300/custom_no_tool/coldfusion/webroot/index.cfm",
            "content": "<cfoutput>ColdFusion instance ready for CVE-2023-29300 testing.</cfoutput>"
        },
        {
            "location": "./../../dockers/CVE-2023-29300/custom_no_tool/coldfusion/webroot/vulnerable.cfc",
            "content": "<cfcomponent>\n    <cffunction name=\"process\" access=\"remote\" returntype=\"string\">\n        <cfargument name=\"payload\" type=\"string\" required=\"yes\" />\n        <!--- WDDX deserialization vulnerable point ---\n              The payload is expected to be a WDDX string. The function blindly deserializes it,\n              allowing an attacker to supply a malicious WDDX that triggers JNDI lookup.\n        --->\n        <cfset var deserialized = deserializeWDDX(arguments.payload) />\n        <cfreturn \"Processed\" />\n    </cffunction>\n</cfcomponent>"
        },
        {
            "location": "./../../dockers/CVE-2023-29300/custom_no_tool/init.sql",
            "content": "CREATE DATABASE IF NOT EXISTS testdb;\nUSE testdb;\nCREATE TABLE IF NOT EXISTS users (id INT PRIMARY KEY, name VARCHAR(50));\nINSERT INTO users (id, name) VALUES (1, 'alice'), (2, 'bob');\n\n-- Create the application user and grant privileges\nCREATE USER IF NOT EXISTS 'user'@'%' IDENTIFIED BY 'userpass';\nGRANT ALL PRIVILEGES ON testdb.* TO 'user'@'%';\nFLUSH PRIVILEGES;"
        }
    ],
    "directory_tree": "CVE-2023-29300/custom_no_tool"
}