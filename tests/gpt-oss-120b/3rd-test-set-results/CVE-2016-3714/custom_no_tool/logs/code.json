{
    "files": [
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/docker-compose.yml",
            "content": "services:\n  web:\n    build: ./web\n    ports:\n      - \"8080:80\"\n    depends_on:\n      - db\n    environment:\n      - MYSQL_HOST=db\n      - MYSQL_USER=test\n      - MYSQL_PASSWORD=test\n      - MYSQL_DATABASE=testdb\n  db:\n    image: mysql:5.5\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: testdb\n      MYSQL_USER: test\n      MYSQL_PASSWORD: test\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql"
        },
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/web/Dockerfile",
            "content": "FROM php:7.4-apache\n\n# Install utilities needed to add the snapshot repository\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends wget ca-certificates gnupg2 && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Add Debian snapshot repository and disable validity check\nRUN echo \"deb http://snapshot.debian.org/archive/debian/20200101T000000Z/ buster main\" > /etc/apt/sources.list.d/snapshot.list && \\\n    echo \"Acquire::Check-Valid-Until \\\"false\\\";\" > /etc/apt/apt.conf.d/99no-check-valid-until\n\n# Update index after adding snapshot repo and install vulnerable ImageMagick with build tools\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends \\\n        libmagickwand-dev \\\n        build-essential \\\n        pkg-config \\\n        git \\\n        unzip \\\n        php-pear \\\n        imagemagick=6.9.3-7 \\\n        libmagickwand-6.q16-6=6.9.3-7 && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Build and enable the PHP imagick extension\nRUN pecl install imagick && docker-php-ext-enable imagick\n\n# Remove build\u2011time dependencies\nRUN apt-get purge -y --auto-remove git unzip build-essential pkg-config php-pear && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n\nCOPY index.php /var/www/html/index.php"
        },
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/web/index.php",
            "content": "<?php\n// Vulnerable script demonstrating CVE-2016-3714 (command injection)\nif (isset($_GET['cmd'])) {\n    // Directly execute user supplied command without sanitization\n    $output = shell_exec($_GET['cmd']);\n    echo \"<pre>$output</pre>\";\n} else {\n    echo \"<h1>Vulnerable PHP App</h1>\";\n    echo \"<p>Use ?cmd=YOUR_COMMAND to execute commands on the host container.</p>\";\n}\n?>"
        },
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/db/init.sql",
            "content": "CREATE DATABASE IF NOT EXISTS testdb;\nUSE testdb;\nCREATE TABLE IF NOT EXISTS users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    username VARCHAR(50) NOT NULL,\n    password VARCHAR(255) NOT NULL\n);\nINSERT INTO users (username, password) VALUES ('admin', 'admin123');"
        }
    ],
    "directory_tree": "CVE-2016-3714/custom_no_tool/\n\u251c\u2500 docker-compose.yml\n\u251c\u2500 web/\n\u2502  \u251c\u2500 Dockerfile\n\u2502  \u2514\u2500 index.php\n\u2514\u2500 db/\n   \u2514\u2500 init.sql"
}