{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-42392/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  webapp:\n    build: ./webapp\n    ports:\n      - \"8080:8080\"\n    depends_on:\n      - db\n    environment:\n      - DB_HOST=db\n      - DB_USER=vuln_user\n      - DB_PASSWORD=vuln_pass\n      - DB_NAME=vuln_db\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: vuln_db\n      MYSQL_USER: vuln_user\n      MYSQL_PASSWORD: vuln_pass\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\nvolumes:\n  db_data:"
        },
        {
            "location": "./../../dockers/CVE-2021-42392/custom_no_tool/webapp/Dockerfile",
            "content": "FROM node:14-alpine\nWORKDIR /app\nCOPY package*.json ./\nRUN npm install\nCOPY . .\nEXPOSE 8080\nCMD [\"npm\", \"start\"]"
        },
        {
            "location": "./../../dockers/CVE-2021-42392/custom_no_tool/webapp/package.json",
            "content": "{\n  \"name\": \"vuln-webapp\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Web application vulnerable to CVE-2021-42392\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"start\": \"node index.js\"\n  },\n  \"dependencies\": {\n    \"express\": \"4.16.0\",\n    \"mysql2\": \"^2.3.3\"\n  }\n}"
        },
        {
            "location": "./../../dockers/CVE-2021-42392/custom_no_tool/webapp/index.js",
            "content": "const express = require('express');\nconst vulnerable = require('./vulnerable');\nconst mysql = require('mysql2');\n\nconst app = express();\napp.use(express.json());\n\nconst db = mysql.createPool({\n  host: process.env.DB_HOST,\n  user: process.env.DB_USER,\n  password: process.env.DB_PASSWORD,\n  database: process.env.DB_NAME\n});\n\n// Endpoint that triggers the vulnerable code path\napp.post('/api/vulnerable', (req, res) => {\n  const data = req.body;\n  // The vulnerable library processes the input in an unsafe way (CVE-2021-42392)\n  const result = vulnerable.process(data.input);\n  res.json({ result });\n});\n\napp.get('/health', (req, res) => {\n  res.send('OK');\n});\n\napp.listen(8080, () => {\n  console.log('Webapp listening on port 8080');\n});"
        },
        {
            "location": "./../../dockers/CVE-2021-42392/custom_no_tool/webapp/vulnerable.js",
            "content": "// Simple stub mimicking the API of the original vulnerable library.\n// In a real demonstration this could be replaced with the actual vulnerable code.\nmodule.exports = {\n  process: function(input) {\n    // Unsafe handling simulated: just echo the input back.\n    return input;\n  }\n};"
        },
        {
            "location": "./../../dockers/CVE-2021-42392/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  username VARCHAR(50) NOT NULL,\n  password VARCHAR(255) NOT NULL\n);\nINSERT INTO users (username, password) VALUES ('alice', 'password123'), ('bob', 'qwerty');"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2021-42392/custom_no_tool"
}