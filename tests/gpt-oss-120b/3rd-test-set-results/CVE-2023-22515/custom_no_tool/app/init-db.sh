#!/bin/bash
# Wait for MySQL to be ready
timeout=30
while ! mysqladmin ping -h"${DATABASE_HOST}" -u"${DATABASE_USER}" -p"${DATABASE_PASSWORD}" --silent; do
  timeout=$((timeout-1))
  if [ $timeout -le 0 ]; then
    echo "MySQL did not become ready in time"
    exit 1
  fi
  sleep 1
done

# Load initial data
mysql -h"${DATABASE_HOST}" -u"${DATABASE_USER}" -p"${DATABASE_PASSWORD}" "${DATABASE_NAME}" < /var/www/html/initialize.sql
