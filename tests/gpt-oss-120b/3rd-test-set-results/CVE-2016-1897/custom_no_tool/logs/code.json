{
    "files": [
        {
            "location": "./../../dockers/CVE-2016-1897/custom_no_tool/docker-compose.yml",
            "content": "services:\n  web:\n    image: nginx:1.13-alpine\n    ports:\n      - \"80:80\"\n    volumes:\n      - ./app:/usr/share/nginx/html:ro\n    depends_on:\n      - app\n  app:\n    build:\n      context: ./app\n    image: vulnerable-php-app:5.6\n    volumes:\n      - ./app:/var/www/html\n    depends_on:\n      - db\n  db:\n    image: mysql:5.5\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: testdb\n      MYSQL_USER: testuser\n      MYSQL_PASSWORD: testpass\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql:ro\n  ffmpeg:\n    image: jrottenberg/ffmpeg:2.8.4-alpine\n    ports:\n      - \"8090:8090\"\n    command: [\"ffmpeg\", \"-version\"]\n  ubuntu:\n    image: ubuntu:22.04\n    command: [\"tail\", \"-f\", \"/dev/null\"]\n    depends_on: []\nvolumes:\n  db_data:"
        },
        {
            "location": "./../../dockers/CVE-2016-1897/custom_no_tool/app/Dockerfile",
            "content": "FROM php:5.6-fpm-alpine\n# Install build dependencies required for PHP MySQL extensions\nRUN apk add --no-cache mariadb-dev build-base openssl-dev \\\n    && docker-php-ext-install mysqli pdo pdo_mysql \\\n    && apk del mariadb-dev build-base openssl-dev\nCOPY index.php /var/www/html/\nWORKDIR /var/www/html"
        },
        {
            "location": "./../../dockers/CVE-2016-1897/custom_no_tool/app/index.php",
            "content": "<?php\n// Simple vulnerable PHP script deliberately using outdated practices\n$mysqli = new mysqli('db', 'testuser', 'testpass', 'testdb');\nif ($mysqli->connect_error) {\n    die('Connect Error (' . $mysqli->connect_errno . ') ' . $mysqli->connect_error);\n}\n// Vulnerable: no input sanitisation, SQL injection possible\n$q = $_GET['q'] ?? '';\n$result = $mysqli->query(\"SELECT * FROM users WHERE name = '$q'\");\nif ($result) {\n    while ($row = $result->fetch_assoc()) {\n        echo '<pre>' . htmlspecialchars(print_r($row, true)) . '</pre>';\n    }\n} else {\n    echo 'Query Error: ' . $mysqli->error;\n}\n?>"
        },
        {
            "location": "./../../dockers/CVE-2016-1897/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(50) NOT NULL,\n    email VARCHAR(100) NOT NULL\n);\nINSERT INTO users (name, email) VALUES\n('alice', 'alice@example.com'),\n('bob', 'bob@example.com'),\n('charlie', 'charlie@example.com');"
        },
        {
            "location": "./../../dockers/CVE-2016-1897/custom_no_tool/ffmpeg/Dockerfile",
            "content": "FROM jrottenberg/ffmpeg:2.8.4-alpine\n# The image already contains the vulnerable FFmpeg binary.\nCMD [\"ffmpeg\", \"-version\"]"
        }
    ],
    "directory_tree": "CVE-2016-1897/custom_no_tool/\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 app/\n\u2502   \u251c\u2500\u2500 Dockerfile\n\u2502   \u2514\u2500\u2500 index.php\n\u251c\u2500\u2500 db/\n\u2502   \u2514\u2500\u2500 init.sql\n\u2514\u2500\u2500 ffmpeg/\n    \u2514\u2500\u2500 Dockerfile"
}