{
    "files": [
        {
            "location": "./../../dockers/CVE-2020-14144/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  vulnerable_app:\n    build:\n      context: ./app\n    ports:\n      - \"5000:5000\"\n    restart: unless-stopped\n    # The host Docker socket mount removed \u2013 not needed for the Gitea vulnerability\n\n  mysql:\n    image: mysql:8.0\n    environment:\n      MYSQL_ROOT_PASSWORD: exampleRootPass\n      MYSQL_DATABASE: gitea\n      MYSQL_USER: gitea\n      MYSQL_PASSWORD: examplePass\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - mysql-data:/var/lib/mysql\n    restart: unless-stopped\n\n  gitea:\n    image: gitea/gitea:1.12.5\n    depends_on:\n      - mysql\n    environment:\n      USER_UID: '1000'\n      USER_GID: '1000'\n      DB_TYPE: mysql\n      DB_HOST: mysql:3306\n      DB_NAME: gitea\n      DB_USER: gitea\n      DB_PASS: examplePass\n    ports:\n      - \"3000:3000\"\n    volumes:\n      - gitea-data:/data\n    restart: unless-stopped\n\nvolumes:\n  mysql-data:\n  gitea-data:\n"
        },
        {
            "location": "./../../dockers/CVE-2020-14144/custom_no_tool/app/Dockerfile",
            "content": "FROM python:3.9-slim\nWORKDIR /usr/src/app\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\nCOPY app.py .\nEXPOSE 5000\nCMD [\"python\", \"app.py\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2020-14144/custom_no_tool/app/requirements.txt",
            "content": "Flask==2.3.2\n"
        },
        {
            "location": "./../../dockers/CVE-2020-14144/custom_no_tool/app/app.py",
            "content": "import subprocess\nfrom flask import Flask, jsonify, request\napp = Flask(__name__)\n\n@app.route('/')\ndef index():\n    return 'Vulnerable Flask app exposing Docker socket'\n\n@app.route('/run', methods=['GET'])\ndef run_docker_cmd():\n    cmd = request.args.get('cmd', 'docker ps')\n    try:\n        result = subprocess.check_output(cmd, shell=True, stderr=subprocess.STDOUT, text=True)\n        return jsonify({'output': result})\n    except subprocess.CalledProcessError as e:\n        return jsonify({'error': e.output}), 500\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000)\n"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2020-14144/custom_no_tool"
}