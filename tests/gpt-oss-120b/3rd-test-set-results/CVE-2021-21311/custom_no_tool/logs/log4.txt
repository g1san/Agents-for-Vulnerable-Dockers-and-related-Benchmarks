time="2025-11-01T21:57:17+01:00" level=warning msg="/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2021-21311/custom_no_tool/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
#1 [internal] load local bake definitions
#1 reading from stdin 730B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile: 598B done
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/library/python:3.9-slim
#3 DONE 0.4s

#4 [internal] load .dockerignore
#4 transferring context: 2B done
#4 DONE 0.0s

#5 [1/7] FROM docker.io/library/python:3.9-slim@sha256:2d97f6910b16bd338d3060f261f53f144965f755599aab1acda1e13cf1731b1b
#5 resolve docker.io/library/python:3.9-slim@sha256:2d97f6910b16bd338d3060f261f53f144965f755599aab1acda1e13cf1731b1b 0.0s done
#5 DONE 0.0s

#6 [internal] load build context
#6 transferring context: 2.68kB done
#6 DONE 0.0s

#7 [2/7] WORKDIR /app
#7 CACHED

#8 [3/7] COPY ./app /app
#8 DONE 0.0s

#9 [4/7] RUN apt-get update &&     apt-get install -y --no-install-recommends ca-certificates netcat-openbsd &&     rm -rf /var/lib/apt/lists/*
#9 0.298 Hit:1 http://deb.debian.org/debian trixie InRelease
#9 0.322 Get:2 http://deb.debian.org/debian trixie-updates InRelease [47.3 kB]
#9 0.393 Get:3 http://deb.debian.org/debian-security trixie-security InRelease [43.4 kB]
#9 0.461 Get:4 http://deb.debian.org/debian trixie/main amd64 Packages [9669 kB]
#9 31.50 Get:5 http://deb.debian.org/debian trixie-updates/main amd64 Packages [5412 B]
#9 31.54 Get:6 http://deb.debian.org/debian-security trixie-security/main amd64 Packages [69.0 kB]
#9 32.15 Fetched 9834 kB in 29s (338 kB/s)
#9 32.15 Reading package lists...
#9 32.63 Reading package lists...
#9 33.10 Building dependency tree...
#9 33.22 Reading state information...
#9 33.44 ca-certificates is already the newest version (20250419).
#9 33.44 The following NEW packages will be installed:
#9 33.44   netcat-openbsd
#9 33.54 0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
#9 33.54 Need to get 42.5 kB of archives.
#9 33.54 After this operation, 112 kB of additional disk space will be used.
#9 33.54 Get:1 http://deb.debian.org/debian trixie/main amd64 netcat-openbsd amd64 1.229-1 [42.5 kB]
#9 33.74 debconf: unable to initialize frontend: Dialog
#9 33.74 debconf: (TERM is not set, so the dialog frontend is not usable.)
#9 33.74 debconf: falling back to frontend: Readline
#9 33.74 debconf: unable to initialize frontend: Readline
#9 33.74 debconf: (Can't locate Term/ReadLine.pm in @INC (you may need to install the Term::ReadLine module) (@INC entries checked: /etc/perl /usr/local/lib/x86_64-linux-gnu/perl/5.40.1 /usr/local/share/perl/5.40.1 /usr/lib/x86_64-linux-gnu/perl5/5.40 /usr/share/perl5 /usr/lib/x86_64-linux-gnu/perl-base /usr/lib/x86_64-linux-gnu/perl/5.40 /usr/share/perl/5.40 /usr/local/lib/site_perl) at /usr/share/perl5/Debconf/FrontEnd/Readline.pm line 8, <STDIN> line 1.)
#9 33.74 debconf: falling back to frontend: Teletype
#9 33.75 debconf: unable to initialize frontend: Teletype
#9 33.75 debconf: (This frontend requires a controlling tty.)
#9 33.75 debconf: falling back to frontend: Noninteractive
#9 34.25 Fetched 42.5 kB in 0s (380 kB/s)
#9 34.28 Selecting previously unselected package netcat-openbsd.
#9 34.28 (Reading database ... 
(Reading database ... 5%
(Reading database ... 10%
(Reading database ... 15%
(Reading database ... 20%
(Reading database ... 25%
(Reading database ... 30%
(Reading database ... 35%
(Reading database ... 40%
(Reading database ... 45%
(Reading database ... 50%
(Reading database ... 55%
(Reading database ... 60%
(Reading database ... 65%
(Reading database ... 70%
(Reading database ... 75%
(Reading database ... 80%
(Reading database ... 85%
(Reading database ... 90%
(Reading database ... 95%
(Reading database ... 100%
(Reading database ... 5644 files and directories currently installed.)
#9 34.31 Preparing to unpack .../netcat-openbsd_1.229-1_amd64.deb ...
#9 34.31 Unpacking netcat-openbsd (1.229-1) ...
#9 34.34 Setting up netcat-openbsd (1.229-1) ...
#9 34.35 update-alternatives: using /bin/nc.openbsd to provide /bin/nc (nc) in auto mode
#9 34.35 update-alternatives: warning: skip creation of /usr/share/man/man1/nc.1.gz because associated file /usr/share/man/man1/nc_openbsd.1.gz (of link group nc) doesn't exist
#9 34.35 update-alternatives: warning: skip creation of /usr/share/man/man1/netcat.1.gz because associated file /usr/share/man/man1/nc_openbsd.1.gz (of link group nc) doesn't exist
#9 DONE 34.4s

#10 [5/7] RUN pip install --no-cache-dir -r requirements.txt
#10 1.693 Collecting Flask==2.0.3
#10 1.868   Downloading Flask-2.0.3-py3-none-any.whl (95 kB)
#10 1.936      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 95.6/95.6 kB 1.3 MB/s eta 0:00:00
#10 2.021 Collecting Werkzeug==2.0.3
#10 2.076   Downloading Werkzeug-2.0.3-py3-none-any.whl (289 kB)
#10 2.176      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 289.2/289.2 kB 2.9 MB/s eta 0:00:00
#10 2.420 Collecting psycopg2-binary==2.9.3
#10 2.475   Downloading psycopg2_binary-2.9.3-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.0 MB)
#10 2.896      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.0/3.0 MB 7.1 MB/s eta 0:00:00
#10 2.968 Collecting Jinja2>=3.0
#10 3.021   Downloading jinja2-3.1.6-py3-none-any.whl (134 kB)
#10 3.039      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 134.9/134.9 kB 8.5 MB/s eta 0:00:00
#10 3.108 Collecting click>=7.1.2
#10 3.187   Downloading click-8.1.8-py3-none-any.whl (98 kB)
#10 3.272      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 98.2/98.2 kB 1.1 MB/s eta 0:00:00
#10 3.359 Collecting itsdangerous>=2.0
#10 3.428   Downloading itsdangerous-2.2.0-py3-none-any.whl (16 kB)
#10 3.675 Collecting MarkupSafe>=2.0
#10 3.745   Downloading markupsafe-3.0.3-cp39-cp39-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (20 kB)
#10 3.803 Installing collected packages: Werkzeug, psycopg2-binary, MarkupSafe, itsdangerous, click, Jinja2, Flask
#10 4.158 Successfully installed Flask-2.0.3 Jinja2-3.1.6 MarkupSafe-3.0.3 Werkzeug-2.0.3 click-8.1.8 itsdangerous-2.2.0 psycopg2-binary-2.9.3
#10 4.158 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
#10 4.347 
#10 4.347 [notice] A new release of pip is available: 23.0.1 -> 25.3
#10 4.347 [notice] To update, run: pip install --upgrade pip
#10 DONE 4.5s

#11 [6/7] COPY ./app/wait_for_db.sh /app/wait_for_db.sh
#11 DONE 0.0s

#12 [7/7] RUN chmod +x /app/wait_for_db.sh
#12 DONE 0.3s

#13 exporting to image
#13 exporting layers
#13 exporting layers 0.9s done
#13 exporting manifest sha256:c970039a4310054ad08cef92ca21431ee63bf4330661ff584dbf6b1e16a26a72 done
#13 exporting config sha256:675d48f3b86994a08fc36c7c0e6bf35f529c9d025813323cf02204ab20bed300 0.0s done
#13 exporting attestation manifest sha256:e845f004dcd4249c29126d3252ad622c4afe6cec80c562bf566ace4a11b99be3 0.0s done
#13 exporting manifest list sha256:be02104309d6cba62024c68795ef89dd5fc823defa7b37103f7d742d2161870e 0.0s done
#13 naming to docker.io/vulnerable/app:1.0.0 done
#13 unpacking to docker.io/vulnerable/app:1.0.0
#13 unpacking to docker.io/vulnerable/app:1.0.0 0.3s done
#13 DONE 1.2s

#14 resolving provenance for metadata file
#14 DONE 0.0s
 vulnerable/app:1.0.0  Built
 Network custom_no_tool_default  Creating
 Network custom_no_tool_default  Created
 Volume custom_no_tool_db_data  Creating
 Volume custom_no_tool_db_data  Created
 Container vulnerable_db  Creating
 Container vulnerable_db  Created
 Container vulnerable_app  Creating
 Container vulnerable_app  Created
 Container vulnerable_db  Starting
 Container vulnerable_db  Started
 Container vulnerable_app  Starting
 Container vulnerable_app  Started


sudo docker logs 5bab14c6904876e256521d41cbcd3c745339fbc5672795f3f53c6b2a64990f16 --details
STDOUT:  Waiting for PostgreSQL at db:5432...
  * Serving Flask app 'app' (lazy loading)
  * Environment: production
    WARNING: This is a development server. Do not use it in a production deployment.
    Use a production WSGI server instead.
  * Debug mode: on

STDERR:  Connection to db (172.18.0.2) 5432 port [tcp/postgresql] succeeded!
  * Running on all addresses.
    WARNING: This is a development server. Do not use it in a production deployment.
  * Running on http://172.18.0.3:80/ (Press CTRL+C to quit)
  * Restarting with stat
  * Debugger is active!
  * Debugger PIN: 655-853-130




sudo docker inspect 5bab14c6904876e256521d41cbcd3c745339fbc5672795f3f53c6b2a64990f16[
    {
        "Id": "5bab14c6904876e256521d41cbcd3c745339fbc5672795f3f53c6b2a64990f16",
        "Created": "2025-11-01T20:57:59.170934212Z",
        "Path": "/app/wait_for_db.sh",
        "Args": [
            "python",
            "app.py"
        ],
        "State": {
            "Status": "running",
            "Running": true,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 9079,
            "ExitCode": 0,
            "Error": "",
            "StartedAt": "2025-11-01T20:57:59.550377026Z",
            "FinishedAt": "0001-01-01T00:00:00Z"
        },
        "Image": "sha256:be02104309d6cba62024c68795ef89dd5fc823defa7b37103f7d742d2161870e",
        "ResolvConfPath": "/var/lib/docker/containers/5bab14c6904876e256521d41cbcd3c745339fbc5672795f3f53c6b2a64990f16/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/5bab14c6904876e256521d41cbcd3c745339fbc5672795f3f53c6b2a64990f16/hostname",
        "HostsPath": "/var/lib/docker/containers/5bab14c6904876e256521d41cbcd3c745339fbc5672795f3f53c6b2a64990f16/hosts",
        "LogPath": "/var/lib/docker/containers/5bab14c6904876e256521d41cbcd3c745339fbc5672795f3f53c6b2a64990f16/5bab14c6904876e256521d41cbcd3c745339fbc5672795f3f53c6b2a64990f16-json.log",
        "Name": "/vulnerable_app",
        "RestartCount": 0,
        "Driver": "overlayfs",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": null,
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "custom_no_tool_default",
            "PortBindings": {
                "80/tcp": [
                    {
                        "HostIp": "",
                        "HostPort": "8080"
                    }
                ]
            },
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "ConsoleSize": [
                0,
                0
            ],
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": null,
            "DnsOptions": null,
            "DnsSearch": null,
            "ExtraHosts": [],
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": false,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": null,
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": null,
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": null,
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": [
                "/proc/asound",
                "/proc/acpi",
                "/proc/interrupts",
                "/proc/kcore",
                "/proc/keys",
                "/proc/latency_stats",
                "/proc/timer_list",
                "/proc/timer_stats",
                "/proc/sched_debug",
                "/proc/scsi",
                "/sys/firmware",
                "/sys/devices/virtual/powercap"
            ],
            "ReadonlyPaths": [
                "/proc/bus",
                "/proc/fs",
                "/proc/irq",
                "/proc/sys",
                "/proc/sysrq-trigger"
            ]
        },
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "Mounts": [],
        "Config": {
            "Hostname": "5bab14c69048",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": true,
            "AttachStderr": true,
            "ExposedPorts": {
                "80/tcp": {}
            },
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "VULN_MODE=exploit",
                "PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
                "LANG=C.UTF-8",
                "GPG_KEY=E3FF2839C048B25C084DEBE9B26995E310250568",
                "PYTHON_VERSION=3.9.25",
                "PYTHON_SHA256=00e07d7c0f2f0cc002432d1ee84d2a40dae404a99303e3f97701c10966c91834"
            ],
            "Cmd": [
                "python",
                "app.py"
            ],
            "Image": "vulnerable/app:1.0.0",
            "Volumes": null,
            "WorkingDir": "/app",
            "Entrypoint": [
                "/app/wait_for_db.sh"
            ],
            "OnBuild": null,
            "Labels": {
                "com.docker.compose.config-hash": "5caacc7c9923fd9445e04c5f831069899259c1637a688a222bee294597422a94",
                "com.docker.compose.container-number": "1",
                "com.docker.compose.depends_on": "db:service_started:false",
                "com.docker.compose.image": "sha256:be02104309d6cba62024c68795ef89dd5fc823defa7b37103f7d742d2161870e",
                "com.docker.compose.oneoff": "False",
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.project.config_files": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2021-21311/custom_no_tool/docker-compose.yml",
                "com.docker.compose.project.working_dir": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2021-21311/custom_no_tool",
                "com.docker.compose.service": "vulnerable_app",
                "com.docker.compose.version": "2.40.2",
                "desktop.docker.io/wsl-distro": "Ubuntu"
            },
            "StopTimeout": 1
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "f63a1a1a823f39e933db9664159b7132fc22cd01574022b9dad2d902db023c73",
            "SandboxKey": "/var/run/docker/netns/f63a1a1a823f",
            "Ports": {
                "80/tcp": [
                    {
                        "HostIp": "0.0.0.0",
                        "HostPort": "8080"
                    },
                    {
                        "HostIp": "::",
                        "HostPort": "8080"
                    }
                ]
            },
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "",
            "Gateway": "",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "",
            "IPPrefixLen": 0,
            "IPv6Gateway": "",
            "MacAddress": "",
            "Networks": {
                "custom_no_tool_default": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": [
                        "vulnerable_app",
                        "vulnerable_app"
                    ],
                    "MacAddress": "0e:55:e5:3e:b7:5c",
                    "DriverOpts": null,
                    "GwPriority": 0,
                    "NetworkID": "f004269f32c8694dfd37808d7a5d2341b03a6b90abc7ff4c3838870783acbce5",
                    "EndpointID": "8948fa89016d732f852991d6e7e067b31f92dd129ae55cc712c3fba98775bf74",
                    "Gateway": "172.18.0.1",
                    "IPAddress": "172.18.0.3",
                    "IPPrefixLen": 16,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "DNSNames": [
                        "vulnerable_app",
                        "5bab14c69048"
                    ]
                }
            }
        },
        "ImageManifestDescriptor": {
            "mediaType": "application/vnd.oci.image.manifest.v1+json",
            "digest": "sha256:c970039a4310054ad08cef92ca21431ee63bf4330661ff584dbf6b1e16a26a72",
            "size": 2188,
            "platform": {
                "architecture": "amd64",
                "os": "linux"
            }
        }
    }
]

sudo docker logs d88c9ff71e45b5f1cc7fe03f4f322a8a79fbe5f6d1daafc27eb87e6188329901 --details
STDOUT:  The files belonging to this database system will be owned by user "postgres".
 This user must also own the server process.
 
 The database cluster will be initialized with locale "en_US.utf8".
 The default database encoding has accordingly been set to "UTF8".
 The default text search configuration will be set to "english".
 
 Data page checksums are disabled.
 
 fixing permissions on existing directory /var/lib/postgresql/data ... ok
 creating subdirectories ... ok
 selecting dynamic shared memory implementation ... posix
 selecting default max_connections ... 100
 selecting default shared_buffers ... 128MB
 selecting default time zone ... UTC
 creating configuration files ... ok
 running bootstrap script ... ok
 performing post-bootstrap initialization ... ok
 syncing data to disk ... ok
 
 
 Success. You can now start the database server using:
 
     pg_ctl -D /var/lib/postgresql/data -l logfile start
 
 waiting for server to start....2025-11-01 20:58:00.360 UTC [41] LOG:  starting PostgreSQL 12.22 on x86_64-pc-linux-musl, compiled by gcc (Alpine 14.2.0) 14.2.0, 64-bit
 2025-11-01 20:58:00.362 UTC [41] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
 2025-11-01 20:58:00.377 UTC [42] LOG:  database system was shut down at 2025-11-01 20:58:00 UTC
 2025-11-01 20:58:00.382 UTC [41] LOG:  database system is ready to accept connections
  done
 server started
 CREATE DATABASE
 
 
 /usr/local/bin/docker-entrypoint.sh: running /docker-entrypoint-initdb.d/init-db.sql
 CREATE TABLE
 INSERT 0 2
 
 
 waiting for server to shut down...2025-11-01 20:58:00.562 UTC [41] LOG:  received fast shutdown request
 .2025-11-01 20:58:00.563 UTC [41] LOG:  aborting any active transactions
 2025-11-01 20:58:00.565 UTC [41] LOG:  background worker "logical replication launcher" (PID 48) exited with exit code 1
 2025-11-01 20:58:00.565 UTC [43] LOG:  shutting down
 2025-11-01 20:58:00.588 UTC [41] LOG:  database system is shut down
  done
 server stopped
 
 PostgreSQL init process complete; ready for start up.
 

STDERR:  sh: locale: not found
 2025-11-01 20:57:59.895 UTC [35] WARNING:  no usable system locales were found
 initdb: warning: enabling "trust" authentication for local connections
 You can change this by editing pg_hba.conf or using the option -A, or
 --auth-local and --auth-host, the next time you run initdb.
 2025-11-01 20:58:00.678 UTC [1] LOG:  starting PostgreSQL 12.22 on x86_64-pc-linux-musl, compiled by gcc (Alpine 14.2.0) 14.2.0, 64-bit
 2025-11-01 20:58:00.678 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
 2025-11-01 20:58:00.678 UTC [1] LOG:  listening on IPv6 address "::", port 5432
 2025-11-01 20:58:00.684 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
 2025-11-01 20:58:00.698 UTC [58] LOG:  database system was shut down at 2025-11-01 20:58:00 UTC
 2025-11-01 20:58:00.704 UTC [1] LOG:  database system is ready to accept connections




sudo docker inspect d88c9ff71e45b5f1cc7fe03f4f322a8a79fbe5f6d1daafc27eb87e6188329901[
    {
        "Id": "d88c9ff71e45b5f1cc7fe03f4f322a8a79fbe5f6d1daafc27eb87e6188329901",
        "Created": "2025-11-01T20:57:59.054944197Z",
        "Path": "docker-entrypoint.sh",
        "Args": [
            "postgres"
        ],
        "State": {
            "Status": "running",
            "Running": true,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 8991,
            "ExitCode": 0,
            "Error": "",
            "StartedAt": "2025-11-01T20:57:59.302335742Z",
            "FinishedAt": "0001-01-01T00:00:00Z"
        },
        "Image": "sha256:7c8f4870583184ebadf7f17a6513620aac5f365a7938dc6a6911c1d5df2f481a",
        "ResolvConfPath": "/var/lib/docker/containers/d88c9ff71e45b5f1cc7fe03f4f322a8a79fbe5f6d1daafc27eb87e6188329901/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/d88c9ff71e45b5f1cc7fe03f4f322a8a79fbe5f6d1daafc27eb87e6188329901/hostname",
        "HostsPath": "/var/lib/docker/containers/d88c9ff71e45b5f1cc7fe03f4f322a8a79fbe5f6d1daafc27eb87e6188329901/hosts",
        "LogPath": "/var/lib/docker/containers/d88c9ff71e45b5f1cc7fe03f4f322a8a79fbe5f6d1daafc27eb87e6188329901/d88c9ff71e45b5f1cc7fe03f4f322a8a79fbe5f6d1daafc27eb87e6188329901-json.log",
        "Name": "/vulnerable_db",
        "RestartCount": 0,
        "Driver": "overlayfs",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": [
                "custom_no_tool_db_data:/var/lib/postgresql/data:rw",
                "/run/desktop/mnt/host/wsl/docker-desktop-bind-mounts/Ubuntu/edc781cf32ee0b0b88c45b6b4a1152d407bfe0e4406a119c61c93e054b50a4ab:/docker-entrypoint-initdb.d/init-db.sql:rw"
            ],
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "custom_no_tool_default",
            "PortBindings": {
                "5432/tcp": [
                    {
                        "HostIp": "",
                        "HostPort": "5432"
                    }
                ]
            },
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "ConsoleSize": [
                0,
                0
            ],
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": null,
            "DnsOptions": null,
            "DnsSearch": null,
            "ExtraHosts": [],
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": false,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": null,
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": null,
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": null,
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": [
                "/proc/asound",
                "/proc/acpi",
                "/proc/interrupts",
                "/proc/kcore",
                "/proc/keys",
                "/proc/latency_stats",
                "/proc/timer_list",
                "/proc/timer_stats",
                "/proc/sched_debug",
                "/proc/scsi",
                "/sys/firmware",
                "/sys/devices/virtual/powercap"
            ],
            "ReadonlyPaths": [
                "/proc/bus",
                "/proc/fs",
                "/proc/irq",
                "/proc/sys",
                "/proc/sysrq-trigger"
            ]
        },
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "Mounts": [
            {
                "Type": "volume",
                "Name": "custom_no_tool_db_data",
                "Source": "/var/lib/docker/volumes/custom_no_tool_db_data/_data",
                "Destination": "/var/lib/postgresql/data",
                "Driver": "local",
                "Mode": "rw",
                "RW": true,
                "Propagation": ""
            },
            {
                "Type": "bind",
                "Source": "/run/desktop/mnt/host/wsl/docker-desktop-bind-mounts/Ubuntu/edc781cf32ee0b0b88c45b6b4a1152d407bfe0e4406a119c61c93e054b50a4ab",
                "Destination": "/docker-entrypoint-initdb.d/init-db.sql",
                "Mode": "rw",
                "RW": true,
                "Propagation": "rprivate"
            }
        ],
        "Config": {
            "Hostname": "d88c9ff71e45",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": true,
            "AttachStderr": true,
            "ExposedPorts": {
                "5432/tcp": {}
            },
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "POSTGRES_PASSWORD=testpass",
                "POSTGRES_DB=testdb",
                "POSTGRES_USER=testuser",
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
                "GOSU_VERSION=1.17",
                "LANG=en_US.utf8",
                "PG_MAJOR=12",
                "PG_VERSION=12.22",
                "PG_SHA256=8df3c0474782589d3c6f374b5133b1bd14d168086edbc13c6e72e67dd4527a3b",
                "DOCKER_PG_LLVM_DEPS=llvm19-dev \t\tclang19",
                "PGDATA=/var/lib/postgresql/data"
            ],
            "Cmd": [
                "postgres"
            ],
            "Image": "postgres:12-alpine",
            "Volumes": {
                "/var/lib/postgresql/data": {}
            },
            "WorkingDir": "/",
            "Entrypoint": [
                "docker-entrypoint.sh"
            ],
            "OnBuild": null,
            "Labels": {
                "com.docker.compose.config-hash": "ddfd98c640b48aba3c2c1b01d01e3341e539bacdc775f7365b4986f66c44740e",
                "com.docker.compose.container-number": "1",
                "com.docker.compose.depends_on": "",
                "com.docker.compose.image": "sha256:7c8f4870583184ebadf7f17a6513620aac5f365a7938dc6a6911c1d5df2f481a",
                "com.docker.compose.oneoff": "False",
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.project.config_files": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2021-21311/custom_no_tool/docker-compose.yml",
                "com.docker.compose.project.working_dir": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2021-21311/custom_no_tool",
                "com.docker.compose.service": "db",
                "com.docker.compose.version": "2.40.2",
                "desktop.docker.io/wsl-distro": "Ubuntu"
            },
            "StopSignal": "SIGINT",
            "StopTimeout": 1
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "377add0549ace5fcc45866a8143af66ad59ed4c29cd12384e26350e2c44a4bc4",
            "SandboxKey": "/var/run/docker/netns/377add0549ac",
            "Ports": {
                "5432/tcp": [
                    {
                        "HostIp": "0.0.0.0",
                        "HostPort": "5432"
                    },
                    {
                        "HostIp": "::",
                        "HostPort": "5432"
                    }
                ]
            },
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "",
            "Gateway": "",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "",
            "IPPrefixLen": 0,
            "IPv6Gateway": "",
            "MacAddress": "",
            "Networks": {
                "custom_no_tool_default": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": [
                        "vulnerable_db",
                        "db"
                    ],
                    "MacAddress": "a6:12:0e:31:6a:89",
                    "DriverOpts": null,
                    "GwPriority": 0,
                    "NetworkID": "f004269f32c8694dfd37808d7a5d2341b03a6b90abc7ff4c3838870783acbce5",
                    "EndpointID": "75218a567d724ddb7c25104f2cbb615776493d2934a96d80124dde9078f86c10",
                    "Gateway": "172.18.0.1",
                    "IPAddress": "172.18.0.2",
                    "IPPrefixLen": 16,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "DNSNames": [
                        "vulnerable_db",
                        "db",
                        "d88c9ff71e45"
                    ]
                }
            }
        },
        "ImageManifestDescriptor": {
            "mediaType": "application/vnd.oci.image.manifest.v1+json",
            "digest": "sha256:718460fcab54cca5730a09ec07e4f7d99b1d6c348bf47206fae4fd27d22e91fd",
            "size": 3055,
            "annotations": {
                "com.docker.official-images.bashbrew.arch": "amd64",
                "org.opencontainers.image.base.digest": "sha256:483f502c0e6aff6d80a807f25d3f88afa40439c29fdd2d21a0912e0f42db842a",
                "org.opencontainers.image.base.name": "alpine:3.21",
                "org.opencontainers.image.created": "2025-01-08T18:10:17Z",
                "org.opencontainers.image.revision": "17818f21dca10ccf02711476e138c219bd31b456",
                "org.opencontainers.image.source": "https://github.com/docker-library/postgres.git#17818f21dca10ccf02711476e138c219bd31b456:12/alpine3.21",
                "org.opencontainers.image.url": "https://hub.docker.com/_/postgres",
                "org.opencontainers.image.version": "12.22-alpine3.21"
            },
            "platform": {
                "architecture": "amd64",
                "os": "linux"
            }
        }
    }
]

sudo docker inspect be02104309d6[
    {
        "Id": "sha256:be02104309d6cba62024c68795ef89dd5fc823defa7b37103f7d742d2161870e",
        "RepoTags": [
            "vulnerable/app:1.0.0"
        ],
        "RepoDigests": [
            "vulnerable/app@sha256:be02104309d6cba62024c68795ef89dd5fc823defa7b37103f7d742d2161870e"
        ],
        "Parent": "",
        "Comment": "buildkit.dockerfile.v0",
        "Created": "2025-11-01T20:57:57.578092077Z",
        "DockerVersion": "",
        "Author": "",
        "Architecture": "amd64",
        "Os": "linux",
        "Size": 52034030,
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "RootFS": {
            "Type": "layers",
            "Layers": [
                "sha256:d7c97cb6f1fe7cae982649e9f55efe201212e8acaa64bd668c083b204e4efd4c",
                "sha256:4f237755fbae41472cb9e0f874fa97abb8d684f8fdcc6bd485edc8b6267a9c93",
                "sha256:298992e09a0315a8f26375a553f216f5fad3decf392956fd2de5ef7aa1f8dfea",
                "sha256:c8f6b54339a8b44071408bd33dd69a9dc7db2ed9cdbf7c533ba09efecda5f33f",
                "sha256:84e9f07ea3897ab0e67022639695ac97d79465f0638213c6fda3e7523671d5fe",
                "sha256:6d1e9d8404851590460b0f8b3dfb930d28e9cb193dbdc539065ea8a149c33229",
                "sha256:de72262d6c3d7b1f33983074e6a7f62fe9bddbbe407f63c3e15c7f0177ea7657",
                "sha256:e835e34e5b302de2450a950911a613eafeaa921f05fb8c6b3a0f8e83dfea5ea0",
                "sha256:5f70bf18a086007016e948b04aed3b82103a36bea41755b6cddfaf10ace3c6ef",
                "sha256:d650d4880e87a29bbf0db4c8d53553807f47a6d80b89bccd40bc09f54316c688"
            ]
        },
        "Metadata": {
            "LastTagTime": "2025-11-01T20:57:58.50857073Z"
        },
        "Descriptor": {
            "mediaType": "application/vnd.oci.image.index.v1+json",
            "digest": "sha256:be02104309d6cba62024c68795ef89dd5fc823defa7b37103f7d742d2161870e",
            "size": 856
        },
        "Config": {
            "ArgsEscaped": true,
            "Cmd": [
                "python",
                "app.py"
            ],
            "Entrypoint": [
                "/app/wait_for_db.sh"
            ],
            "Env": [
                "PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
                "LANG=C.UTF-8",
                "GPG_KEY=E3FF2839C048B25C084DEBE9B26995E310250568",
                "PYTHON_VERSION=3.9.25",
                "PYTHON_SHA256=00e07d7c0f2f0cc002432d1ee84d2a40dae404a99303e3f97701c10966c91834",
                "VULN_MODE=none"
            ],
            "ExposedPorts": {
                "80/tcp": {}
            },
            "Labels": {
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.service": "vulnerable_app",
                "com.docker.compose.version": "2.40.2"
            },
            "OnBuild": null,
            "User": "",
            "Volumes": null,
            "WorkingDir": "/app"
        }
    }
]

sudo docker inspect 7c8f48705831[
    {
        "Id": "sha256:7c8f4870583184ebadf7f17a6513620aac5f365a7938dc6a6911c1d5df2f481a",
        "RepoTags": [
            "postgres:12-alpine"
        ],
        "RepoDigests": [
            "postgres@sha256:7c8f4870583184ebadf7f17a6513620aac5f365a7938dc6a6911c1d5df2f481a"
        ],
        "Parent": "",
        "Comment": "buildkit.dockerfile.v0",
        "Created": "2024-12-06T00:14:30Z",
        "DockerVersion": "",
        "Author": "",
        "Architecture": "amd64",
        "Os": "linux",
        "Size": 106150162,
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "RootFS": {
            "Type": "layers",
            "Layers": [
                "sha256:a0904247e36a7726c03c71ee48f3e64462021c88dafeb13f37fdaf613b27f11c",
                "sha256:eed881aa67a38397e5c3fc2cddefcfd278af3c903c2d4cacc4f1740050db1efd",
                "sha256:1c61d6f3641246fa6c282bc486f39d2bfaa7cc48d7c1ed99873f0f72f8a7a842",
                "sha256:885c3ce475c0c9a2c80a6ecdfa49f778e6b83772350e55d9f8c80221ae32c9ab",
                "sha256:5d734390c0d3d2dd843653bfa1666e03812ecf35aa3033dee122887c90387107",
                "sha256:e055d217eebeda76505f04165c630e96816c0322ecabb308b3aba3cc01b5f129",
                "sha256:068b07de1e449f7e2be00733181af3687e796382a631a6b40a2b172e82250c14",
                "sha256:cadd09802cf8b38e436fc5c1082fd2b2c0a9d283bf1b10b74e103ffae6363c54",
                "sha256:58eadde8fd154ce2001e5f867e941b8084246b928bd1b77969c47395bfa16863",
                "sha256:1273478493a10ded1dbf7aa07d44ef49cd5d52e3387f60d28b67921ef5396d62",
                "sha256:e0f3dbc6874e94f50d7c9d4862cd1488fb0035385d9d62c19d8a07b00bef87e5"
            ]
        },
        "Metadata": {
            "LastTagTime": "2025-11-01T20:52:27.004627578Z"
        },
        "Descriptor": {
            "mediaType": "application/vnd.oci.image.index.v1+json",
            "digest": "sha256:7c8f4870583184ebadf7f17a6513620aac5f365a7938dc6a6911c1d5df2f481a",
            "size": 10301
        },
        "Config": {
            "Cmd": [
                "postgres"
            ],
            "Entrypoint": [
                "docker-entrypoint.sh"
            ],
            "Env": [
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
                "GOSU_VERSION=1.17",
                "LANG=en_US.utf8",
                "PG_MAJOR=12",
                "PG_VERSION=12.22",
                "PG_SHA256=8df3c0474782589d3c6f374b5133b1bd14d168086edbc13c6e72e67dd4527a3b",
                "DOCKER_PG_LLVM_DEPS=llvm19-dev \t\tclang19",
                "PGDATA=/var/lib/postgresql/data"
            ],
            "ExposedPorts": {
                "5432/tcp": {}
            },
            "Labels": null,
            "OnBuild": null,
            "StopSignal": "SIGINT",
            "User": "",
            "Volumes": {
                "/var/lib/postgresql/data": {}
            },
            "WorkingDir": "/"
        }
    }
]