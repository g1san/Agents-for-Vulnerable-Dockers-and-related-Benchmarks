{
    "files": [
        {
            "location": "./../../dockers/CVE-2018-1000861/custom_no_tool/docker-compose.yml",
            "content": "version: \"3.8\"\n\nservices:\n  docker_daemon:\n    image: docker:20.10-dind\n    privileged: true\n    environment:\n      - DOCKER_TLS_CERTDIR=\n    command: [\"dockerd-entrypoint.sh\", \"--host=tcp://0.0.0.0:2375\", \"--tls=false\"]\n    ports:\n      - \"2375:2375\"\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:2375/_ping\"]\n      interval: 5s\n      timeout: 5s\n      retries: 12\n\n  tester:\n    build:\n      context: .\n      dockerfile: Dockerfile.tester\n    depends_on:\n      docker_daemon:\n        condition: service_healthy\n    environment:\n      - DOCKER_HOST=tcp://docker_daemon:2375"
        },
        {
            "location": "./../../dockers/CVE-2018-1000861/custom_no_tool/Dockerfile.tester",
            "content": "FROM alpine:3.12\nWORKDIR /usr/local/bin\nCOPY tester.sh ./\nRUN chmod +x tester.sh && \\\n    apk update && \\\n    apk add --no-cache docker\nENTRYPOINT [\"sh\", \"/usr/local/bin/tester.sh\"]"
        },
        {
            "location": "./../../dockers/CVE-2018-1000861/custom_no_tool/tester.sh",
            "content": "#!/bin/sh\nset -e\n\necho \"Attempting to list containers on the vulnerable Docker daemon...\"\n\ndocker ps\n\necho \"Creating a privileged container that can escape the host...\"\n\ndocker run --rm --privileged alpine:3.12 sh -c \"echo 'Inside privileged container'; uname -a\"\n\necho \"Exploit attempt completed.\""
        }
    ],
    "directory_tree": "CVE-2018-1000861/custom_no_tool"
}