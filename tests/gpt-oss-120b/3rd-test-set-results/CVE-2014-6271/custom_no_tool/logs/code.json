{
    "files": [
        {
            "location": "./../../dockers/CVE-2014-6271/custom_no_tool/docker-compose.yml",
            "content": "services:\n  vulnerable:\n    build: .\n    ports:\n      - \"8080:80\"\n      - \"2222:22\"\n    restart: unless-stopped"
        },
        {
            "location": "./../../dockers/CVE-2014-6271/custom_no_tool/Dockerfile",
            "content": "FROM debian:stable-slim\nENV DEBIAN_FRONTEND=noninteractive\n\n# Install required packages (Bash, Apache with CGI, OpenSSH)\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends apache2 bash openssh-server && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Configure SSH and generate host keys\nRUN mkdir -p /var/run/sshd && echo 'root:toor' | chpasswd && \\\n    sed -i 's/^#*PermitRootLogin .*/PermitRootLogin yes/' /etc/ssh/sshd_config && \\\n    sed -i 's/^#*PasswordAuthentication .*/PasswordAuthentication yes/' /etc/ssh/sshd_config && \\\n    ssh-keygen -A\n\n# Enable CGI module (the correct module is \"cgid\")\nRUN a2enmod cgid\n\n# Copy Apache configuration\nCOPY 000-default.conf /etc/apache2/sites-available/000-default.conf\n\n# Add the vulnerable CGI script\nCOPY vulnerable.cgi /usr/lib/cgi-bin/vulnerable.cgi\nRUN chmod +x /usr/lib/cgi-bin/vulnerable.cgi\n\n# Expose required ports\nEXPOSE 80 22\n\n# Copy start script\nCOPY start.sh /start.sh\nRUN chmod +x /start.sh\n\nCMD [\"/start.sh\"]"
        },
        {
            "location": "./../../dockers/CVE-2014-6271/custom_no_tool/start.sh",
            "content": "#!/bin/bash\n# Start SSH daemon in background (host keys are generated during image build)\n/usr/sbin/sshd\n# Start Apache in foreground\nexec /usr/sbin/apache2ctl -D FOREGROUND"
        },
        {
            "location": "./../../dockers/CVE-2014-6271/custom_no_tool/000-default.conf",
            "content": "<VirtualHost *:80>\n    ServerAdmin webmaster@localhost\n    DocumentRoot /var/www/html\n\n    ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/\n    <Directory \"/usr/lib/cgi-bin\">\n        Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch\n        AddHandler cgi-script .cgi .sh\n        Require all granted\n    </Directory>\n\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n</VirtualHost>"
        },
        {
            "location": "./../../dockers/CVE-2014-6271/custom_no_tool/vulnerable.cgi",
            "content": "#!/bin/bash\n# Exploit the Shellshock vulnerability by executing any function definition in HTTP headers\n# The CGI receives the request and echoes back a simple page\n\n# The vulnerability is triggered by environment variables like:\n#   () { :;}; echo vulnerable\n\n# Output HTTP headers\nprintf \"Content-Type: text/html\\n\\n\"\n\n# Simple page\ncat <<'EOF'\n<html><body><h1>Shellshock Test</h1><p>If you see \"vulnerable\" in the output, the system is vulnerable.</p></body></html>\nEOF"
        }
    ],
    "directory_tree": "CVE-2014-6271/custom_no_tool"
}