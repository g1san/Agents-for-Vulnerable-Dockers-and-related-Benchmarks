{
    "files": [
        {
            "location": "./../../dockers/CVE-2023-22515/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  web:\n    build:\n      context: ./web\n    environment:\n      REDIS_HOST: redis\n      REDIS_PORT: 6379\n      MYSQL_HOST: mysql\n      MYSQL_USER: user\n      MYSQL_PASSWORD: pass\n      MYSQL_DATABASE: testdb\n    depends_on:\n      - redis\n      - mysql\n  redis:\n    image: redis:6.0.9\n    command: [\"redis-server\", \"--appendonly\", \"yes\"]\n    ports:\n      - \"6379:6379\"\n    volumes:\n      - redis-data:/data\n  mysql:\n    image: mysql:8.0.33\n    environment:\n      MYSQL_ROOT_PASSWORD: root\n      MYSQL_DATABASE: testdb\n      MYSQL_USER: user\n      MYSQL_PASSWORD: pass\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - mysql-data:/var/lib/mysql\n  nginx:\n    image: nginx:1.25.3\n    ports:\n      - \"8080:80\"\n    volumes:\n      - ./nginx/conf:/etc/nginx/conf.d\n    depends_on:\n      - web\nvolumes:\n  redis-data:\n  mysql-data:"
        },
        {
            "location": "./../../dockers/CVE-2023-22515/custom_no_tool/web/Dockerfile",
            "content": "FROM php:7.4-apache\nWORKDIR /var/www/html\nRUN apt-get update && \\\n    apt-get install -y git && \\\n    docker-php-ext-install mysqli && \\\n    pecl install redis && \\\n    docker-php-ext-enable redis && \\\n    rm -rf /var/lib/apt/lists/*\nCOPY . /var/www/html/\nEXPOSE 80"
        },
        {
            "location": "./../../dockers/CVE-2023-22515/custom_no_tool/web/index.php",
            "content": "<?php\n$redis = new Redis();\n$redis->connect($_ENV['REDIS_HOST'], $_ENV['REDIS_PORT']);\n// Simple command that can be abused via CVE-2023-22515 when crafted malicious input is sent\nif (isset($_GET['cmd'])) {\n    $redis->eval($_GET['cmd']);\n}\necho \"Web service ready. Use ?cmd=YOUR_LUA_PAYLOAD to test the vulnerability.\";\n?>"
        },
        {
            "location": "./../../dockers/CVE-2023-22515/custom_no_tool/web/.htaccess",
            "content": "DirectoryIndex index.php"
        },
        {
            "location": "./../../dockers/CVE-2023-22515/custom_no_tool/nginx/conf/default.conf",
            "content": "server {\n    listen 80;\n    location / {\n        proxy_pass http://web:80;\n    }\n}"
        }
    ],
    "directory_tree": "CVE-2023-22515/custom_no_tool"
}