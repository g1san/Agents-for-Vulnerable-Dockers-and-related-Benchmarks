{
    "files": [
        {
            "location": "./../../dockers/CVE-2015-5531/custom_no_tool/docker-compose.yml",
            "content": "services:\n  docker:\n    image: docker:23.0-dind\n    privileged: true\n    ports:\n      - \"2375:2375\"\n    volumes:\n      - docker-data:/var/lib/docker\n  elasticsearch:\n    build:\n      context: ./elasticsearch\n    container_name: elasticsearch\n    environment:\n      - discovery.type=single-node\n    ports:\n      - \"9200:9200\"\n    volumes:\n      - es-data:/usr/share/elasticsearch/data\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:9200\"]\n      interval: 30s\n      timeout: 5s\n      retries: 5\nvolumes:\n  docker-data:\n  es-data:"
        },
        {
            "location": "./../../dockers/CVE-2015-5531/custom_no_tool/elasticsearch/Dockerfile",
            "content": "FROM openjdk:8-jdk-slim\n\nENV DEBIAN_FRONTEND=noninteractive\nENV ES_VERSION=1.5.4 \\\n    JAVA_HOME=/usr/local/openjdk-8 \\\n    PATH=$PATH:/usr/share/elasticsearch/bin\n\n# Install required utilities, locales and clean up\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends \\\n        wget gnupg ca-certificates \\\n        procps locales && \\\n    echo \"en_US.UTF-8 UTF-8\" > /etc/locale.gen && \\\n    locale-gen en_US.UTF-8 && \\\n    update-locale LANG=en_US.UTF-8 && \\\n    wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-${ES_VERSION}.tar.gz && \\\n    tar -xzf elasticsearch-${ES_VERSION}.tar.gz -C /usr/share && \\\n    mv /usr/share/elasticsearch-${ES_VERSION} /usr/share/elasticsearch && \\\n    chmod -R +x /usr/share/elasticsearch/bin && \\\n    rm elasticsearch-${ES_VERSION}.tar.gz && \\\n    apt-get clean && rm -rf /var/lib/apt/lists/*\n\nWORKDIR /usr/share/elasticsearch\n\nEXPOSE 9200 9300\n\nCMD [\"bin/elasticsearch\", \"-Des.default.path.home=/usr/share/elasticsearch\"]"
        },
        {
            "location": "./../../dockers/CVE-2015-5531/custom_no_tool/README.txt",
            "content": "This Docker Compose configuration sets up two services needed to reproduce CVE-2015-5531:\n\n1. **Docker-in-Docker (DinD)** \u2013 Runs Docker Engine version 23.0 inside a privileged container. The Docker daemon is exposed on host port 2375 without TLS for easy interaction. You can connect to it with any Docker client, e.g., `docker -H tcp://localhost:2375 ps`.\n\n2. **Elasticsearch** \u2013 Uses a custom\u2011built Elasticsearch 1.5.4 image that includes the required Java\u00a08 runtime, necessary system utilities (procps, locales) and proper locale configuration. The service listens on the default HTTP port 9200, which is mapped to the host.\n\nBoth services are started on the same Docker network automatically created by Docker Compose, so no manual linking is required. To launch the environment, simply run:\n\n    docker compose up -d\n\nThe stack will start the DinD container and the Elasticsearch container. Once the Elasticsearch healthcheck reports `healthy`, you can test the vulnerability against the Elasticsearch instance (e.g., using `curl` against `http://localhost:9200`). No additional configuration or manual steps are needed."
        }
    ],
    "directory_tree": "./../../dockers/CVE-2015-5531/custom_no_tool"
}