FROM openjdk:8-jdk-slim

ENV DEBIAN_FRONTEND=noninteractive
ENV ES_VERSION=1.5.4 \
    JAVA_HOME=/usr/local/openjdk-8 \
    PATH=$PATH:/usr/share/elasticsearch/bin

# Install required utilities, locales and clean up
RUN apt-get update && \
    apt-get install -y --no-install-recommends \
        wget gnupg ca-certificates \
        procps locales && \
    echo "en_US.UTF-8 UTF-8" > /etc/locale.gen && \
    locale-gen en_US.UTF-8 && \
    update-locale LANG=en_US.UTF-8 && \
    wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-${ES_VERSION}.tar.gz && \
    tar -xzf elasticsearch-${ES_VERSION}.tar.gz -C /usr/share && \
    mv /usr/share/elasticsearch-${ES_VERSION} /usr/share/elasticsearch && \
    chmod -R +x /usr/share/elasticsearch/bin && \
    rm elasticsearch-${ES_VERSION}.tar.gz && \
    apt-get clean && rm -rf /var/lib/apt/lists/*

WORKDIR /usr/share/elasticsearch

EXPOSE 9200 9300

CMD ["bin/elasticsearch", "-Des.default.path.home=/usr/share/elasticsearch"]