{
    "desc": "CVE\u20112017\u201112635 is a privilege escalation vulnerability in Apache CouchDB versions up to 1.7.0 and in the 2.x series prior to 2.1.1.  CouchDB stores user accounts in the special *_users* system database.  When a user document is created, the JSON payload is processed by two independent parsers: an Erlang\u2011based JSON parser (used for internal storage and later authorisation) and a JavaScript\u2011based JSON parser (used for request validation).  If the payload contains duplicate keys named \"roles\", the two parsers handle the duplicates inconsistently \u2013 the JavaScript parser keeps the last occurrence while the Erlang parser retains the first.  An attacker can therefore submit a document that includes two \"roles\" fields, placing the privileged role \"_admin\" in the first field and a benign value (or an empty array) in the second field.  The validation step sees only the second field and therefore allows the write, but when the document is later used for authorisation the Erlang parser reads the first field and grants the user administrative privileges.  As a result, a non\u2011admin user can create an account that authenticates as an administrator, gaining full control over the CouchDB instance (the ability to create or delete databases, modify configuration, and read or write any data).  The issue can be chained with CVE\u20112017\u201112636 to achieve remote code execution.  The vulnerability is fixed in Apache CouchDB 1.7.1 and in the 2.x series from version 2.1.1 onward.",
    "attack_type": "privilege escalation",
    "services": [
        {
            "name": "couchdb",
            "version": [
                "1.0.0",
                "1.1.0",
                "1.2.0",
                "1.3.0",
                "1.4.0",
                "1.5.0",
                "1.5.1",
                "1.5.2",
                "1.6.0",
                "1.6.1",
                "1.7.0",
                "2.0.0",
                "2.0.1",
                "2.1.0"
            ],
            "dependency_type": "HARD",
            "description": "Apache CouchDB image containing a version vulnerable to CVE\u20112017\u201112635. This service provides the JSON database where the duplicate\u2011key parsing flaw exists, making the container vulnerable to privilege escalation."
        }
    ],
    "input_tokens": 7261,
    "output_tokens": 1958
}