FROM alpine:3.12

ENV GHOSTSCRIPT_VERSION=9.26

# Install build tools, dependencies, perl (required by configure) and Docker client
RUN apk add --no-cache curl tar build-base libpng-dev freetype-dev perl docker-cli && \
    curl -fSL https://github.com/ArtifexSoftware/ghostpdl-downloads/releases/download/gs${GHOSTSCRIPT_VERSION}/ghostscript-${GHOSTSCRIPT_VERSION}.tar.gz -o /tmp/gs.tar.gz && \
    tar -xzf /tmp/gs.tar.gz -C /tmp && \
    cd /tmp/ghostscript-${GHOSTSCRIPT_VERSION} && \
    ./configure --without-x && \
    make -j$(nproc) && \
    make install && \
    cd / && rm -rf /tmp/ghostscript-${GHOSTSCRIPT_VERSION} /tmp/gs.tar.gz && \
    apk del build-base curl tar perl

COPY exploit.sh /exploit.sh
RUN chmod +x /exploit.sh

CMD ["sh","/exploit.sh"]