{
    "desc": "CVE\u20112021\u201126120 is a critical vulnerability in the Smarty\u202f3 template engine (versions\u202f3.1.0 through\u202f3.1.38). The flaw resides in the handling of the `{function}` tag: the parser inserts the supplied function name directly into the generated PHP code without proper quoting or validation. An attacker who can influence the template content or the name of a template that is rendered can provide a malicious function name such as `rce(){};system(\"id\");function`. When Smarty compiles the template, the injected PHP code becomes part of the compiled template file and is executed with the privileges of the web\u2011server process. This results in arbitrary PHP code execution, enabling full compromise of the affected host (confidentiality, integrity and availability are all broken). The vulnerability can be triggered remotely without authentication, requires only low\u2011complexity attacker interaction (supplying a crafted template or template name), and is exploitable even when Smarty\u2019s sandbox mode is enabled because the code injection bypasses sandbox restrictions. The issue was fixed in Smarty version\u202f3.1.39, where the function\u2011name handling was hardened to reject unexpected characters and to quote the name safely.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "php",
            "version": [
                "8.0-apache",
                "8.1-apache",
                "8.2-apache"
            ],
            "dependency_type": "HARD",
            "description": "Official PHP image with Apache web server. The application code installed in this container includes the Smarty library versions 3.1.0 through 3.1.38, which are vulnerable to CVE\u20112021\u201126120. Running the vulnerable Smarty version inside this container provides the necessary environment to reproduce the code\u2011injection flaw."
        },
        {
            "name": "composer",
            "version": [
                "2.5"
            ],
            "dependency_type": "SOFT-DB",
            "description": "Composer is used to install the specific vulnerable Smarty versions into the PHP container. It is required only to set up the application dependencies and does not itself affect the vulnerability."
        }
    ],
    "input_tokens": 8734,
    "output_tokens": 1722
}