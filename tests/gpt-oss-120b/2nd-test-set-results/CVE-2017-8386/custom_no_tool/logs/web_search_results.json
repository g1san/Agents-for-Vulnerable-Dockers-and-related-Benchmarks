{
    "desc": "CVE\u20112017\u20118386 is a vulnerability in the **git\u2011shell** program that is used as a restricted login shell for SSH\u2011based Git access. git\u2011shell is supposed to limit users to only three built\u2011in Git commands (git\u2011receive\u2011pack, git\u2011upload\u2011pack and git\u2011upload\u2011archive) and any custom scripts placed in a git\u2011shell\u2011commands directory. When any of these commands is invoked with the `--help` option, git\u2011shell launches the system **man** pager to display the manual page. The pager defaults to **less**, which, when run in an interactive pseudo\u2011terminal (PTY), offers shell\u2011escape capabilities such as `!cmd`, `|cmd`, `v` and others. By forcing a PTY (for example with `ssh -t`) an attacker can cause less to enter interactive mode and execute arbitrary commands in the context of the Git user. This bypasses the git\u2011shell command whitelist and provides a remote code execution vector. The flaw affects all Git versions prior to the patches released in 2.4.12, 2.5.6, 2.6.7, 2.7.5, 2.8.5, 2.9.4, 2.10.3, 2.11.2, 2.12.3 and 2.13.0. Impact includes arbitrary command execution, file read, and potential full host compromise for any account that is allowed to log in via SSH with git\u2011shell as its login shell.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "git",
            "version": [
                "2.4.0",
                "2.4.1",
                "2.4.2",
                "2.4.3",
                "2.4.4",
                "2.4.5",
                "2.4.6",
                "2.4.7",
                "2.4.8",
                "2.4.9",
                "2.4.10",
                "2.4.11",
                "2.5.0",
                "2.5.1",
                "2.5.2",
                "2.5.3",
                "2.5.4",
                "2.5.5",
                "2.6.0",
                "2.6.1",
                "2.6.2",
                "2.6.3",
                "2.6.4",
                "2.6.5",
                "2.6.6",
                "2.7.0",
                "2.7.1",
                "2.7.2",
                "2.7.3",
                "2.7.4",
                "2.8.0",
                "2.8.1",
                "2.8.2",
                "2.8.3",
                "2.8.4",
                "2.9.0",
                "2.9.1",
                "2.9.2",
                "2.9.3",
                "2.10.0",
                "2.10.1",
                "2.10.2",
                "2.11.0",
                "2.11.1",
                "2.12.0",
                "2.12.1",
                "2.12.2"
            ],
            "dependency_type": "HARD",
            "description": "Provides the git\u2011shell program that contains the vulnerable code allowing the less pager escape."
        },
        {
            "name": "openssh-server",
            "version": [
                "latest"
            ],
            "dependency_type": "SOFT",
            "description": "Runs the SSH service required to expose git\u2011shell to remote users."
        }
    ],
    "input_tokens": 12486,
    "output_tokens": 2590
}