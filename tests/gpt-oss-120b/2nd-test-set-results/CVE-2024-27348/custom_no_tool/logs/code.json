{
    "files": [
        {
            "location": "./../../dockers/CVE-2024-27348/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  web:\n    build:\n      context: ./app\n    ports:\n      - \"8080:80\"\n    depends_on:\n      - db\n    environment:\n      - DB_HOST=db\n      - DB_USER=vulnerable\n      - DB_PASSWORD=SecretPass123\n      - DB_NAME=vulndb\n  db:\n    image: mysql:5.7\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: RootPass456\n      MYSQL_DATABASE: vulndb\n      MYSQL_USER: vulnerable\n      MYSQL_PASSWORD: SecretPass123\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\nvolumes:\n  db_data:"
        },
        {
            "location": "./../../dockers/CVE-2024-27348/custom_no_tool/app/Dockerfile",
            "content": "FROM php:7.4-apache\n# Install mysqli extension\nRUN docker-php-ext-install mysqli\n# Copy application source\nCOPY . /var/www/html/\n# Enable .htaccess overrides (some vulnerable apps rely on it)\nRUN a2enmod rewrite"
        },
        {
            "location": "./../../dockers/CVE-2024-27348/custom_no_tool/app/index.php",
            "content": "<?php\n// Simple PHP app vulnerable to CVE-2024-27348 (example: unsafe unserialize leading to RCE)\nif (isset($_GET['payload'])) {\n    // Vulnerable code: unserialize without validation\n    $obj = unserialize(base64_decode($_GET['payload']));\n    echo \"Deserialized object: \".print_r($obj, true);\n}\n\n// Database connection (used for testing)\n$mysqli = new mysqli(getenv('DB_HOST'), getenv('DB_USER'), getenv('DB_PASSWORD'), getenv('DB_NAME'));\nif ($mysqli->connect_error) {\n    die('Connection Error (' . $mysqli->connect_errno . ') '. $mysqli->connect_error);\n}\n$result = $mysqli->query('SELECT id, data FROM secrets');\nwhile ($row = $result->fetch_assoc()) {\n    echo '<p>Record '.$row['id'].': '.htmlspecialchars($row['data']).'</p>';\n}\n?>"
        },
        {
            "location": "./../../dockers/CVE-2024-27348/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE IF NOT EXISTS secrets (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    data VARCHAR(255) NOT NULL\n);\nINSERT INTO secrets (data) VALUES ('test-data-1'), ('test-data-2');"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2024-27348/custom_no_tool"
}