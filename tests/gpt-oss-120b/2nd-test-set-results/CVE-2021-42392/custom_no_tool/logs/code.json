{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-42392/custom_no_tool/docker-compose.yml",
            "content": "services:\n  web:\n    build:\n      context: ./web\n    ports:\n      - \"8080:80\"\n    depends_on:\n      - db\n      - h2db\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: testdb\n      MYSQL_USER: testuser\n      MYSQL_PASSWORD: testpass\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\n  h2db:\n    image: ghcr.io/h2database/h2:2.0.205\n    environment:\n      H2_OPTIONS: \"-web -tcp\"\n    ports:\n      - \"8082:8082\"\n      - \"9092:9092\"\nvolumes:\n  db_data:"
        },
        {
            "location": "./../../dockers/CVE-2021-42392/custom_no_tool/web/Dockerfile",
            "content": "FROM php:8.2-apache\nCOPY . /var/www/html/\nEXPOSE 80"
        },
        {
            "location": "./../../dockers/CVE-2021-42392/custom_no_tool/web/src/index.php",
            "content": "<?php\n$whitelist = ['home.php', 'info.php'];\nif (isset($_GET['file'])) {\n    $file = basename($_GET['file']);\n    if (in_array($file, $whitelist)) {\n        include __DIR__ . '/' . $file;\n    } else {\n        echo \"Invalid file.\";\n    }\n} else {\n    echo \"Provide file parameter.\";\n}\n?>"
        },
        {
            "location": "./../../dockers/CVE-2021-42392/custom_no_tool/web/src/home.php",
            "content": "<?php\necho \"<h1>Home Page</h1>\";\n?>"
        },
        {
            "location": "./../../dockers/CVE-2021-42392/custom_no_tool/web/src/info.php",
            "content": "<?php\necho \"<h1>Info Page</h1>\";\n?>"
        },
        {
            "location": "./../../dockers/CVE-2021-42392/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE users (id INT AUTO_INCREMENT PRIMARY KEY, username VARCHAR(50), password VARCHAR(50));\nINSERT INTO users (username, password) VALUES ('admin', 'admin123');"
        }
    ],
    "directory_tree": "dockers/CVE-2021-42392/custom_no_tool/\n\u251c\u2500 docker-compose.yml\n\u251c\u2500 web/\n\u2502  \u251c\u2500 Dockerfile\n\u2502  \u2514\u2500 src/\n\u2502     \u251c\u2500 index.php\n\u2502     \u251c\u2500 home.php\n\u2502     \u2514\u2500 info.php\n\u2514\u2500 db/\n   \u2514\u2500 init.sql"
}