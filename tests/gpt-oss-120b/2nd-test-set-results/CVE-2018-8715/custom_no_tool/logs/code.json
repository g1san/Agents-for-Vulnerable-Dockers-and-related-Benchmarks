{
    "files": [
        {
            "location": "./../../dockers/CVE-2018-8715/custom_no_tool/docker-compose.yml",
            "content": "services:\n  vulnerable_app:\n    build:\n      context: ./vulnerable_app\n    container_name: vulnerable_app\n    privileged: true\n    volumes:\n      - ./host_shared:/host_shared\n    networks:\n      - vulnnet\nnetworks:\n  vulnnet:\n    driver: bridge"
        },
        {
            "location": "./../../dockers/CVE-2018-8715/custom_no_tool/vulnerable_app/Dockerfile",
            "content": "FROM ubuntu:20.04\nENV DEBIAN_FRONTEND=noninteractive\nRUN apt-get update && apt-get install -y \\\n    wget \\\n    build-essential \\\n    autoconf \\\n    automake \\\n    libtool \\\n    libssl-dev \\\n    libpcre3-dev \\\n    libexpat1-dev \\\n    zlib1g-dev \\\n    libpam0g-dev \\\n    ca-certificates \\\n    && rm -rf /var/lib/apt/lists/*\nWORKDIR /opt\n# Download the AppWeb 6.0.5 source archive (correct tag with leading 'v')\nRUN wget -O appweb.tar.gz https://github.com/embedthis/appweb/archive/refs/tags/v6.0.5.tar.gz \\\n    && tar xzf appweb.tar.gz \\\n    && mv appweb-6.0.5 appweb\nWORKDIR /opt/appweb\n# Build AppWeb: use existing configure script or generate one with autoreconf\nRUN if [ -x ./configure ]; then \\\n        ./configure; \\\n    else \\\n        autoreconf -i && ./configure; \\\n    fi && \\\n    make && \\\n    make install\nEXPOSE 80\nWORKDIR /usr/src/app\nCOPY entrypoint.sh .\nRUN chmod +x entrypoint.sh\nENTRYPOINT [\"/usr/src/app/entrypoint.sh\"]"
        },
        {
            "location": "./../../dockers/CVE-2018-8715/custom_no_tool/vulnerable_app/entrypoint.sh",
            "content": "#!/bin/sh\n# Create a symlink inside the mounted directory that points to a sensitive host file\n# This mimics the condition exploited by CVE-2018-8715\nif [ -d \"/host_shared\" ]; then\n  ln -sf /etc/shadow /host_shared/secret_link\n  echo \"[+] Symlink created: /host_shared/secret_link -> /etc/shadow\"\n  echo \"[+] Attempting to read the linked file from inside the container:\"\n  cat /host_shared/secret_link || echo \"[!] Unable to read the file (expected on non\u2011vulnerable hosts)\"\nfi\n# Keep container alive for manual testing\nwhile true; do sleep 3600; done"
        },
        {
            "location": "./../../dockers/CVE-2018-8715/custom_no_tool/vulnerable_app/host_shared/.gitkeep",
            "content": ""
        }
    ],
    "directory_tree": "CVE-2018-8715"
}