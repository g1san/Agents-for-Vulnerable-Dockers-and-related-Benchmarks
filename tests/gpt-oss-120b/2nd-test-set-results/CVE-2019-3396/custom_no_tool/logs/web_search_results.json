{
    "desc": "CVE\u20112019\u20113396 is a critical vulnerability in Atlassian Confluence Server and Data Center that resides in the Widget Connector macro (com.atlassian.confluence.extra.widgetconnector). The macro\u2019s render method accepts a `_template` parameter that specifies a Velocity template to load. The code fails to restrict the value of `_template`, allowing an attacker to supply an arbitrary template path such as `file:///etc/passwd` or a remote URL (e.g., `ftp://attacker.com/malicious.vm`). When the template is processed by Confluence\u2019s Velocity engine, the attacker can execute arbitrary Java code, invoke reflection, and ultimately run operating\u2011system commands via `java.lang.Runtime.exec`. This server\u2011side template injection gives the attacker full remote code execution without any authentication. The impact includes reading confidential files, installing back\u2011doors, lateral movement, and complete takeover of the Confluence host. The vulnerability affects all Confluence Server/Data Center releases prior to the March\u202f20\u202f2019 security update, specifically versions before 6.6.12, 6.12.3, 6.13.3, 6.14.2 and 6.15.1. No additional services are required beyond the vulnerable Confluence application itself; the exploit can be performed simply by sending a crafted HTTP POST request to the REST endpoint `/rest/tinymce/1/macro/preview` with a malicious JSON payload.",
    "attack_type": "unauthenticated remote code execution",
    "services": [
        {
            "name": "atlassian/confluence",
            "version": [
                "6.6.0",
                "6.6.1",
                "6.6.2",
                "6.6.3",
                "6.6.4",
                "6.6.5",
                "6.6.6",
                "6.6.7",
                "6.6.8",
                "6.6.9",
                "6.6.10",
                "6.6.11",
                "6.7.0",
                "6.7.1",
                "6.7.2",
                "6.7.3",
                "6.7.4",
                "6.8.0",
                "6.8.1",
                "6.8.2",
                "6.8.3",
                "6.8.4",
                "6.8.5",
                "6.9.0",
                "6.9.1",
                "6.9.2",
                "6.9.3",
                "6.9.4",
                "6.9.5",
                "6.10.0",
                "6.10.1",
                "6.10.2",
                "6.10.3",
                "6.11.0",
                "6.11.1",
                "6.11.2",
                "6.11.3",
                "6.12.0",
                "6.12.1",
                "6.12.2",
                "6.13.0",
                "6.13.1",
                "6.13.2",
                "6.14.0",
                "6.14.1"
            ],
            "dependency_type": "HARD",
            "description": "Core Confluence application containing the vulnerable Widget Connector macro; required to demonstrate the CVE\u20112019\u20113396 server\u2011side template injection and remote code execution."
        }
    ],
    "input_tokens": 10591,
    "output_tokens": 2004
}