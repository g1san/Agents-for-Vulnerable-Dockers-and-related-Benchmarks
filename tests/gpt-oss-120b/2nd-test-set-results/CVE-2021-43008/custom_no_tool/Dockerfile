FROM php:8.0-apache

ENV VULN_MODE=exploitable

# Install wget for downloading Adminer
RUN apt-get update && apt-get install -y wget && rm -rf /var/lib/apt/lists/*

# Download a vulnerable version of Adminer (4.6.2) into the web root
RUN wget -O /var/www/html/adminer.php https://github.com/vrana/adminer/releases/download/v4.6.2/adminer-4.6.2.php

# Simple landing page
RUN echo '<!DOCTYPE html><html><head><title>CVE-2021-43008 Demo</title></head><body><h1>CVE-2021-43008 Demo</h1><p>If you can see this page, the container is running.</p><p>Access <a href="/adminer.php">adminer.php</a> to test the vulnerability.</p></body></html>' > /var/www/html/index.html

EXPOSE 80
CMD ["apache2-foreground"]