{
    "files": [
        {
            "location": "./../../dockers/CVE-2023-29300/custom_no_tool/docker-compose.yml",
            "content": "services:\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: vulnerabledb\n      MYSQL_USER: user\n      MYSQL_PASSWORD: userpass\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./init.sql:/docker-entrypoint-initdb.d/init.sql\n    ports:\n      - \"3306:3306\"\n  coldfusion:\n    # Updated to a tag that exists on Docker Hub for ColdFusion 2023 Update 1\n    image: adobecoldfusion/coldfusion:2023-update-1\n    environment:\n      DB_HOST: db\n      DB_USER: user\n      DB_PASSWORD: userpass\n      DB_NAME: vulnerabledb\n    ports:\n      - \"8500:80\"\n    depends_on:\n      - db\n  app:\n    build: ./app\n    depends_on:\n      - db\n      - coldfusion\n    environment:\n      DB_HOST: db\n      DB_USER: user\n      DB_PASSWORD: userpass\n      DB_NAME: vulnerabledb\n    ports:\n      - \"8080:80\"\nvolumes:\n  db_data:"
        },
        {
            "location": "./../../dockers/CVE-2023-29300/custom_no_tool/app/Dockerfile",
            "content": "FROM php:8.1-apache\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends \\\n        libzip-dev zlib1g-dev default-libmysqlclient-dev && \\\n    docker-php-ext-configure zip --with-libzip && \\\n    docker-php-ext-install mysqli zip && \\\n    rm -rf /var/lib/apt/lists/*\nCOPY src/ /var/www/html/\nEXPOSE 80"
        },
        {
            "location": "./../../dockers/CVE-2023-29300/custom_no_tool/app/src/index.php",
            "content": "<?php\n$mysqli = new mysqli($_ENV['DB_HOST'], $_ENV['DB_USER'], $_ENV['DB_PASSWORD'], $_ENV['DB_NAME']);\nif ($mysqli->connect_error) {\n    die('Connection Error (' . $mysqli->connect_errno . ') ' . $mysqli->connect_error);\n}\n// Vulnerable: raw GET parameter used directly in query (SQL Injection)\n$id = $_GET['id'];\n$result = $mysqli->query(\"SELECT name, email FROM users WHERE id = $id\");\nif ($result && $row = $result->fetch_assoc()) {\n    echo \"<h1>User Info</h1>\";\n    echo \"Name: \" . htmlspecialchars($row['name']) . \"<br>\";\n    echo \"Email: \" . htmlspecialchars($row['email']) . \"<br>\";\n} else {\n    echo \"No user found or query error.\";\n}\n?>"
        },
        {
            "location": "./../../dockers/CVE-2023-29300/custom_no_tool/init.sql",
            "content": "CREATE TABLE users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  name VARCHAR(100) NOT NULL,\n  email VARCHAR(100) NOT NULL\n);\nINSERT INTO users (name, email) VALUES\n('Alice', 'alice@example.com'),\n('Bob', 'bob@example.com'),\n('Charlie', 'charlie@example.com');"
        }
    ],
    "directory_tree": "CVE-2023-29300/custom_no_tool"
}