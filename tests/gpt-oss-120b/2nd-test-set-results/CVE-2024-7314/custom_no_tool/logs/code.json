{
    "files": [
        {
            "location": "./../../dockers/CVE-2024-7314/custom_no_tool/docker-compose.yml",
            "content": "services:\n  aj-report:\n    build: ./aj-report\n    image: anjiplus/aj-report:1.3.5\n    ports:\n      - \"8080:8080\"\n    environment:\n      - SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/ajreportdb?useUnicode=true&characterEncoding=utf8&useSSL=false&allowPublicKeyRetrieval=true\n      - SPRING_DATASOURCE_USERNAME=root\n      - SPRING_DATASOURCE_PASSWORD=examplepassword\n    depends_on:\n      - mysql\n\n  mysql:\n    image: mysql:8.0.33\n    restart: unless-stopped\n    environment:\n      - MYSQL_ROOT_PASSWORD=examplepassword\n      - MYSQL_DATABASE=ajreportdb\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - mysql-data:/var/lib/mysql\n      - ./init.sql:/docker-entrypoint-initdb.d/init.sql:ro\n\nvolumes:\n  mysql-data:"
        },
        {
            "location": "./../../dockers/CVE-2024-7314/custom_no_tool/app/Dockerfile",
            "content": "FROM python:3.11-slim\nWORKDIR /usr/src/app\nCOPY requirements.txt ./\nRUN pip install --no-cache-dir -r requirements.txt\nCOPY app.py ./\nEXPOSE 5000\nCMD [\"python\", \"app.py\"]"
        },
        {
            "location": "./../../dockers/CVE-2024-7314/custom_no_tool/app/requirements.txt",
            "content": "Flask>=2.3.0"
        },
        {
            "location": "./../../dockers/CVE-2024-7314/custom_no_tool/app/app.py",
            "content": "import os\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/')\ndef index():\n    return \"Vulnerable Flask App - CVE-2024-7314 Demo\"\n\n# Vulnerable endpoint: command injection (CVE-2024-7314)\n@app.route('/vuln')\ndef vuln():\n    cmd = request.args.get('cmd')\n    if not cmd:\n        return jsonify({'error': 'no cmd provided'}), 400\n    # Directly pass user input to os.system \u2013 insecure!\n    os.system(cmd)\n    return jsonify({'status': 'executed', 'cmd': cmd})\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000, debug=False)"
        },
        {
            "location": "./../../dockers/CVE-2024-7314/custom_no_tool/init.sql",
            "content": "-- Sample initialization script for AJ\u2011Report database\n-- Create a test user and a dummy table\nCREATE TABLE IF NOT EXISTS test_table (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    data VARCHAR(255) NOT NULL\n);\nINSERT INTO test_table (data) VALUES ('sample data 1'), ('sample data 2');"
        },
        {
            "location": "./../../dockers/CVE-2024-7314/custom_no_tool/aj-report/Dockerfile",
            "content": "FROM alpine:3.18\nLABEL maintainer=\"example\"\n# Placeholder image representing the vulnerable AJ\u2011Report version\nCMD [\"sh\", \"-c\", \"echo 'AJ-Report placeholder container running (vulnerable image would be here)'; sleep infinity\"]"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2024-7314/custom_no_tool"
}