#!/bin/sh
# Wait for the PostgreSQL service to become reachable
while ! pg_isready -h "$POSTGRES_HOST" -p 5432 > /dev/null 2>&1; do
  echo "Waiting for PostgreSQL..."
  sleep 1
done
echo "PostgreSQL is ready. Applying migrations..."
python manage.py migrate --noinput
echo "Loading initial data..."
python manage.py loaddata initial_data.json || true
# Execute the command passed to the container (runserver)
exec "$@"
