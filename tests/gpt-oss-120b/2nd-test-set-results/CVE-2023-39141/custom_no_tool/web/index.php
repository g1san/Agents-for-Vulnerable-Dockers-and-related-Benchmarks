<?php
// Simple page that exposes Docker socket to demonstrate CVE-2023-39141 exploitation
if (isset($_GET['cmd'])) {
    $cmd = $_GET['cmd'];
    // Unsafe execution of commands inside the host Docker engine via the mounted socket
    $output = shell_exec("docker $cmd 2>&1");
    echo "<pre>$output</pre>";
} else {
    echo "<h1>Vulnerable Demo</h1>";
    echo "<p>Use ?cmd=YOUR_DOCKER_COMMAND to execute commands on the host Docker daemon.</p>";
}
?>