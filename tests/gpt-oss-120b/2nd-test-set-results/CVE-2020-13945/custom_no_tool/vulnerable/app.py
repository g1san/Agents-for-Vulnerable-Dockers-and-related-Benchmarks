from flask import Flask, request, jsonify
app = Flask(__name__)

# Vulnerable endpoint that simulates the CVE-2020-13945 issue
@app.route('/vuln', methods=['GET'])
def vulnerable_endpoint():
    # The vulnerability is triggered by passing a crafted "path" parameter
    path = request.args.get('path', '')
    # In a real vulnerable version this would lead to unauthorized file access
    # Here we simply echo the received value to illustrate the exploit vector
    return jsonify({"received_path": path})

@app.route('/')
def index():
    return "Vulnerable app ready"

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=80)