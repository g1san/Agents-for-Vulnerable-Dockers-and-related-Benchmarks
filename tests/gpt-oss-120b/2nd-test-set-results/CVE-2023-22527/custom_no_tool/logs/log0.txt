time="2025-10-31T11:53:45+01:00" level=warning msg="/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2023-22527/custom_no_tool/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
 docker Pulling 
 c236b952b946 Pulling fs layer 
 a2e96caeccfc Pulling fs layer 
 dcfbb4c499a0 Pulling fs layer 
 01e53e995f19 Pulling fs layer 
 3aa4d0bbde19 Pulling fs layer 
 2580f7437ec4 Pulling fs layer 
 b410477bf81b Pulling fs layer 
 43bf02f7e7ba Pulling fs layer 
 0ce146c1b1e3 Pulling fs layer 
 b14191ab5ed9 Pulling fs layer 
 7649ff060972 Pulling fs layer 
 01e53e995f19 Download complete 
 2580f7437ec4 Download complete 
 c236b952b946 Downloading [==========================>                        ]  1.049MB/1.97MB
 c236b952b946 Download complete 
 b14191ab5ed9 Download complete 
 3aa4d0bbde19 Downloading [==================>                                ]  1.049MB/2.813MB
 a2e96caeccfc Download complete 
 0ce146c1b1e3 Download complete 
 3aa4d0bbde19 Downloading [==================>                                ]  1.049MB/2.813MB
 43bf02f7e7ba Download complete 
 3aa4d0bbde19 Downloading [=====================================>             ]  2.097MB/2.813MB
 dcfbb4c499a0 Download complete 
 7649ff060972 Downloading [>                                                  ]  1.049MB/64.61MB
 b410477bf81b Downloading [=======>                                           ]  1.049MB/6.735MB
 7649ff060972 Downloading [=>                                                 ]  2.097MB/64.61MB
 3aa4d0bbde19 Download complete 
 3aa4d0bbde19 Extracting 1 s
 b410477bf81b Downloading [===============>                                   ]  2.097MB/6.735MB
 7649ff060972 Downloading [=>                                                 ]  2.097MB/64.61MB
 c236b952b946 Extracting 1 s
 3aa4d0bbde19 Pull complete 
 b410477bf81b Downloading [=======================>                           ]  3.146MB/6.735MB
 7649ff060972 Downloading [==>                                                ]  3.146MB/64.61MB
 c236b952b946 Extracting 1 s
 b410477bf81b Downloading [======================================>            ]  5.243MB/6.735MB
 7649ff060972 Downloading [===>                                               ]  4.194MB/64.61MB
 2580f7437ec4 Pull complete 
 c236b952b946 Pull complete 
 b410477bf81b Downloading [==============================================>    ]  6.291MB/6.735MB
 7649ff060972 Downloading [===>                                               ]  4.194MB/64.61MB
 b410477bf81b Download complete 
 7649ff060972 Downloading [====>                                              ]  6.291MB/64.61MB
 7649ff060972 Downloading [=====>                                             ]   7.34MB/64.61MB
 7649ff060972 Downloading [=======>                                           ]  9.437MB/64.61MB
 7649ff060972 Downloading [========>                                          ]  11.53MB/64.61MB
 7649ff060972 Downloading [==========>                                        ]  13.63MB/64.61MB
 7649ff060972 Downloading [===========>                                       ]  14.68MB/64.61MB
 7649ff060972 Downloading [============>                                      ]  15.73MB/64.61MB
 7649ff060972 Downloading [=============>                                     ]  17.83MB/64.61MB
 7649ff060972 Downloading [==============>                                    ]  18.87MB/64.61MB
 7649ff060972 Downloading [================>                                  ]  20.97MB/64.61MB
 7649ff060972 Downloading [=================>                                 ]  22.02MB/64.61MB
 7649ff060972 Downloading [=================>                                 ]  23.07MB/64.61MB
 7649ff060972 Downloading [===================>                               ]  25.17MB/64.61MB
 7649ff060972 Downloading [====================>                              ]  26.21MB/64.61MB
 7649ff060972 Downloading [=====================>                             ]  27.26MB/64.61MB
 7649ff060972 Downloading [======================>                            ]  29.36MB/64.61MB
 7649ff060972 Downloading [=======================>                           ]  30.41MB/64.61MB
 7649ff060972 Downloading [=========================>                         ]  32.51MB/64.61MB
 7649ff060972 Downloading [=========================>                         ]  33.55MB/64.61MB
 7649ff060972 Downloading [==========================>                        ]   34.6MB/64.61MB
 7649ff060972 Downloading [===========================>                       ]  35.65MB/64.61MB
 7649ff060972 Downloading [=============================>                     ]  37.75MB/64.61MB
 7649ff060972 Downloading [==============================>                    ]  39.85MB/64.61MB
 7649ff060972 Downloading [================================>                  ]  41.94MB/64.61MB
 7649ff060972 Downloading [=================================>                 ]  42.99MB/64.61MB
 7649ff060972 Downloading [==================================>                ]  45.09MB/64.61MB
 7649ff060972 Downloading [===================================>               ]  46.14MB/64.61MB
 7649ff060972 Downloading [====================================>              ]  47.19MB/64.61MB
 7649ff060972 Downloading [======================================>            ]  49.28MB/64.61MB
 7649ff060972 Downloading [=======================================>           ]  51.38MB/64.61MB
 7649ff060972 Downloading [========================================>          ]  52.43MB/64.61MB
 7649ff060972 Downloading [=========================================>         ]  53.48MB/64.61MB
 7649ff060972 Downloading [=========================================>         ]  53.48MB/64.61MB
 7649ff060972 Downloading [=========================================>         ]  53.48MB/64.61MB
 7649ff060972 Downloading [=========================================>         ]  53.48MB/64.61MB
 7649ff060972 Downloading [=========================================>         ]  53.48MB/64.61MB
 7649ff060972 Downloading [===========================================>       ]  55.57MB/64.61MB
 7649ff060972 Downloading [===========================================>       ]  56.62MB/64.61MB
 7649ff060972 Downloading [=============================================>     ]  58.72MB/64.61MB
 7649ff060972 Downloading [==============================================>    ]  59.77MB/64.61MB
 7649ff060972 Downloading [===============================================>   ]  61.87MB/64.61MB
 7649ff060972 Downloading [=================================================> ]  63.96MB/64.61MB
 7649ff060972 Download complete 
 7649ff060972 Extracting 1 s
 7649ff060972 Extracting 1 s
 7649ff060972 Extracting 1 s
 7649ff060972 Extracting 1 s
 7649ff060972 Extracting 1 s
 7649ff060972 Extracting 1 s
 7649ff060972 Extracting 1 s
 7649ff060972 Extracting 1 s
 7649ff060972 Extracting 1 s
 7649ff060972 Extracting 1 s
 01e53e995f19 Pull complete 
 0ce146c1b1e3 Pull complete 
 43bf02f7e7ba Pull complete 
 b410477bf81b Extracting 1 s
 7649ff060972 Pull complete 
 b410477bf81b Extracting 1 s
 b14191ab5ed9 Pull complete 
 a2e96caeccfc Pull complete 
 dcfbb4c499a0 Pull complete 
 b410477bf81b Pull complete 
 docker Pulled 
#1 [internal] load local bake definitions
#1 reading from stdin 727B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile: 142B done
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/library/python:3.9-slim
#3 DONE 0.8s

#4 [internal] load .dockerignore
#4 transferring context: 2B done
#4 DONE 0.0s

#5 [1/4] FROM docker.io/library/python:3.9-slim@sha256:545badebace9a958b98d3e272f0f0d46c0a1a389ac77e24c33f2e7b548ce1b6b
#5 resolve docker.io/library/python:3.9-slim@sha256:545badebace9a958b98d3e272f0f0d46c0a1a389ac77e24c33f2e7b548ce1b6b 0.0s done
#5 DONE 0.0s

#6 [2/4] WORKDIR /app
#6 CACHED

#7 [internal] load build context
#7 transferring context: 982B done
#7 DONE 0.0s

#8 [3/4] COPY exploit.py .
#8 DONE 0.4s

#9 [4/4] RUN pip install requests
#9 1.814 Collecting requests
#9 1.895   Downloading requests-2.32.5-py3-none-any.whl (64 kB)
#9 1.971      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 64.7/64.7 kB 749.7 kB/s eta 0:00:00
#9 2.419 Collecting urllib3<3,>=1.21.1
#9 2.434   Downloading urllib3-2.5.0-py3-none-any.whl (129 kB)
#9 2.479      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 129.8/129.8 kB 3.4 MB/s eta 0:00:00
#9 2.518 Collecting idna<4,>=2.5
#9 2.531   Downloading idna-3.11-py3-none-any.whl (71 kB)
#9 2.545      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 71.0/71.0 kB 8.6 MB/s eta 0:00:00
#9 2.593 Collecting certifi>=2017.4.17
#9 2.608   Downloading certifi-2025.10.5-py3-none-any.whl (163 kB)
#9 2.636      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 163.3/163.3 kB 6.4 MB/s eta 0:00:00
#9 2.874 Collecting charset_normalizer<4,>=2
#9 2.890   Downloading charset_normalizer-3.4.4-cp39-cp39-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (153 kB)
#9 2.910      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 154.0/154.0 kB 8.3 MB/s eta 0:00:00
#9 2.981 Installing collected packages: urllib3, idna, charset_normalizer, certifi, requests
#9 3.252 Successfully installed certifi-2025.10.5 charset_normalizer-3.4.4 idna-3.11 requests-2.32.5 urllib3-2.5.0
#9 3.252 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
#9 3.357 
#9 3.357 [notice] A new release of pip is available: 23.0.1 -> 25.3
#9 3.357 [notice] To update, run: pip install --upgrade pip
#9 DONE 3.5s

#10 exporting to image
#10 exporting layers
#10 exporting layers 0.5s done
#10 exporting manifest sha256:94f47516211e279df8e5ead64fe3be9b01a78b574cb85f4d2c93c5553c778ff0 0.0s done
#10 exporting config sha256:38186d41bbe8b7990e4ac78faaa1375b5d56c66fa7be19a23186bc48cadc064c 0.0s done
#10 exporting attestation manifest sha256:d9def738907abcf1513f0b090588458555b3644e7517f1d0d24a9f4f4742eae3 0.0s done
#10 exporting manifest list sha256:0377b62610e5662cbe3099f1677e1d65705152b20fc508b5f78a7203c99c48a5 0.0s done
#10 naming to docker.io/library/custom_no_tool-testapp:latest done
#10 unpacking to docker.io/library/custom_no_tool-testapp:latest
#10 unpacking to docker.io/library/custom_no_tool-testapp:latest 0.2s done
#10 DONE 0.9s

#11 resolving provenance for metadata file
#11 DONE 0.0s
 custom_no_tool-testapp  Built
 Network custom_no_tool_default  Creating
 Network custom_no_tool_default  Created
 Container custom_no_tool-docker-1  Creating
 Container custom_no_tool-docker-1  Created
 Container custom_no_tool-testapp-1  Creating
 Container custom_no_tool-testapp-1  Created
 Container custom_no_tool-docker-1  Starting
 Container custom_no_tool-docker-1  Started
 Container custom_no_tool-testapp-1  Starting
 Container custom_no_tool-testapp-1  Started


sudo docker logs b7230f9a7e5f4670c1f6579d52cdb563b4693d8eb4edd8c94892b3ba5f61d5b1 --details
STDOUT: 
STDERR:  time="2025-10-31T10:54:04.139920737Z" level=info msg="Starting up"
 time="2025-10-31T10:54:04.142437458Z" level=warning msg="could not change group /var/run/docker.sock to docker: group docker not found"
 time="2025-10-31T10:54:04.142798602Z" level=warning msg="Binding to IP address without --tlsverify is insecure and gives root access on this machine to everyone who has access to your network." host="tcp://0.0.0.0:2375"
 time="2025-10-31T10:54:04.142834562Z" level=warning msg="Binding to an IP address, even on localhost, can also give access to scripts run in a browser. Be safe out there!" host="tcp://0.0.0.0:2375"
 time="2025-10-31T10:54:05.143521109Z" level=warning msg="Binding to an IP address without --tlsverify is deprecated. Startup is intentionally being slowed down to show this message" host="tcp://0.0.0.0:2375"
 time="2025-10-31T10:54:05.143576005Z" level=warning msg="Please consider generating tls certificates with client validation to prevent exposing unauthenticated root access to your network" host="tcp://0.0.0.0:2375"
 time="2025-10-31T10:54:05.143584835Z" level=warning msg="You can override this by explicitly specifying '--tls=false' or '--tlsverify=false'" host="tcp://0.0.0.0:2375"
 time="2025-10-31T10:54:05.143589478Z" level=warning msg="Support for listening on TCP without authentication or explicit intent to run without authentication will be removed in the next release" host="tcp://0.0.0.0:2375"
 time="2025-10-31T10:54:20.145410124Z" level=info msg="libcontainerd: started new containerd process" pid=44
 time="2025-10-31T10:54:20.145501396Z" level=info msg="parsed scheme: \"unix\"" module=grpc
 time="2025-10-31T10:54:20.145510220Z" level=info msg="scheme \"unix\" not registered, fallback to default scheme" module=grpc
 time="2025-10-31T10:54:20.145532095Z" level=info msg="ccResolverWrapper: sending update to cc: {[{unix:///var/run/docker/containerd/containerd.sock  <nil> 0 <nil>}] <nil> <nil>}" module=grpc
 time="2025-10-31T10:54:20.145577318Z" level=info msg="ClientConn switching balancer to \"pick_first\"" module=grpc
 time="2025-10-31T10:54:20Z" level=warning msg="deprecated version : `1`, please switch to version `2`"
 time="2025-10-31T10:54:20.158630221Z" level=info msg="starting containerd" revision=2a1d4dbdb2a1030dc5b01e96fb110a9d9f150ecc version=v1.5.10
 time="2025-10-31T10:54:20.174435345Z" level=info msg="loading plugin \"io.containerd.content.v1.content\"..." type=io.containerd.content.v1
 time="2025-10-31T10:54:20.175021766Z" level=info msg="loading plugin \"io.containerd.snapshotter.v1.aufs\"..." type=io.containerd.snapshotter.v1
 time="2025-10-31T10:54:20.179653290Z" level=info msg="skip loading plugin \"io.containerd.snapshotter.v1.aufs\"..." error="aufs is not supported (modprobe aufs failed: exit status 1 \"ip: can't find device 'aufs'\\nmodprobe: can't change directory to '/lib/modules': No such file or directory\\n\"): skip plugin" type=io.containerd.snapshotter.v1
 time="2025-10-31T10:54:20.179689780Z" level=info msg="loading plugin \"io.containerd.snapshotter.v1.btrfs\"..." type=io.containerd.snapshotter.v1
 time="2025-10-31T10:54:20.180046320Z" level=info msg="skip loading plugin \"io.containerd.snapshotter.v1.btrfs\"..." error="path /var/lib/docker/containerd/daemon/io.containerd.snapshotter.v1.btrfs (ext4) must be a btrfs filesystem to be used with the btrfs snapshotter: skip plugin" type=io.containerd.snapshotter.v1
 time="2025-10-31T10:54:20.180073343Z" level=info msg="loading plugin \"io.containerd.snapshotter.v1.devmapper\"..." type=io.containerd.snapshotter.v1
 time="2025-10-31T10:54:20.180093013Z" level=warning msg="failed to load plugin io.containerd.snapshotter.v1.devmapper" error="devmapper not configured"
 time="2025-10-31T10:54:20.180100182Z" level=info msg="loading plugin \"io.containerd.snapshotter.v1.native\"..." type=io.containerd.snapshotter.v1
 time="2025-10-31T10:54:20.180378594Z" level=info msg="loading plugin \"io.containerd.snapshotter.v1.overlayfs\"..." type=io.containerd.snapshotter.v1
 time="2025-10-31T10:54:20.180786055Z" level=info msg="loading plugin \"io.containerd.snapshotter.v1.zfs\"..." type=io.containerd.snapshotter.v1
 time="2025-10-31T10:54:20.180900305Z" level=info msg="skip loading plugin \"io.containerd.snapshotter.v1.zfs\"..." error="path /var/lib/docker/containerd/daemon/io.containerd.snapshotter.v1.zfs must be a zfs filesystem to be used with the zfs snapshotter: skip plugin" type=io.containerd.snapshotter.v1
 time="2025-10-31T10:54:20.180927880Z" level=info msg="loading plugin \"io.containerd.metadata.v1.bolt\"..." type=io.containerd.metadata.v1
 time="2025-10-31T10:54:20.181079908Z" level=warning msg="could not use snapshotter devmapper in metadata plugin" error="devmapper not configured"
 time="2025-10-31T10:54:20.181101784Z" level=info msg="metadata content store policy set" policy=shared
 time="2025-10-31T10:54:20.188714951Z" level=info msg="loading plugin \"io.containerd.differ.v1.walking\"..." type=io.containerd.differ.v1
 time="2025-10-31T10:54:20.188759806Z" level=info msg="loading plugin \"io.containerd.gc.v1.scheduler\"..." type=io.containerd.gc.v1
 time="2025-10-31T10:54:20.188804752Z" level=info msg="loading plugin \"io.containerd.service.v1.introspection-service\"..." type=io.containerd.service.v1
 time="2025-10-31T10:54:20.188851261Z" level=info msg="loading plugin \"io.containerd.service.v1.containers-service\"..." type=io.containerd.service.v1
 time="2025-10-31T10:54:20.188878468Z" level=info msg="loading plugin \"io.containerd.service.v1.content-service\"..." type=io.containerd.service.v1
 time="2025-10-31T10:54:20.188902182Z" level=info msg="loading plugin \"io.containerd.service.v1.diff-service\"..." type=io.containerd.service.v1
 time="2025-10-31T10:54:20.188913396Z" level=info msg="loading plugin \"io.containerd.service.v1.images-service\"..." type=io.containerd.service.v1
 time="2025-10-31T10:54:20.188921209Z" level=info msg="loading plugin \"io.containerd.service.v1.leases-service\"..." type=io.containerd.service.v1
 time="2025-10-31T10:54:20.188929941Z" level=info msg="loading plugin \"io.containerd.service.v1.namespaces-service\"..." type=io.containerd.service.v1
 time="2025-10-31T10:54:20.188953747Z" level=info msg="loading plugin \"io.containerd.service.v1.snapshots-service\"..." type=io.containerd.service.v1
 time="2025-10-31T10:54:20.188965145Z" level=info msg="loading plugin \"io.containerd.runtime.v1.linux\"..." type=io.containerd.runtime.v1
 time="2025-10-31T10:54:20.189514523Z" level=info msg="loading plugin \"io.containerd.runtime.v2.task\"..." type=io.containerd.runtime.v2
 time="2025-10-31T10:54:20.189883103Z" level=info msg="loading plugin \"io.containerd.monitor.v1.cgroups\"..." type=io.containerd.monitor.v1
 time="2025-10-31T10:54:20.190097174Z" level=info msg="loading plugin \"io.containerd.service.v1.tasks-service\"..." type=io.containerd.service.v1
 time="2025-10-31T10:54:20.190128058Z" level=info msg="loading plugin \"io.containerd.internal.v1.restart\"..." type=io.containerd.internal.v1
 time="2025-10-31T10:54:20.190175394Z" level=info msg="loading plugin \"io.containerd.grpc.v1.containers\"..." type=io.containerd.grpc.v1
 time="2025-10-31T10:54:20.190201682Z" level=info msg="loading plugin \"io.containerd.grpc.v1.content\"..." type=io.containerd.grpc.v1
 time="2025-10-31T10:54:20.190211517Z" level=info msg="loading plugin \"io.containerd.grpc.v1.diff\"..." type=io.containerd.grpc.v1
 time="2025-10-31T10:54:20.190218595Z" level=info msg="loading plugin \"io.containerd.grpc.v1.events\"..." type=io.containerd.grpc.v1
 time="2025-10-31T10:54:20.190229624Z" level=info msg="loading plugin \"io.containerd.grpc.v1.healthcheck\"..." type=io.containerd.grpc.v1
 time="2025-10-31T10:54:20.190245618Z" level=info msg="loading plugin \"io.containerd.grpc.v1.images\"..." type=io.containerd.grpc.v1
 time="2025-10-31T10:54:20.190270802Z" level=info msg="loading plugin \"io.containerd.grpc.v1.leases\"..." type=io.containerd.grpc.v1
 time="2025-10-31T10:54:20.190280270Z" level=info msg="loading plugin \"io.containerd.grpc.v1.namespaces\"..." type=io.containerd.grpc.v1
 time="2025-10-31T10:54:20.190288634Z" level=info msg="loading plugin \"io.containerd.internal.v1.opt\"..." type=io.containerd.internal.v1
 time="2025-10-31T10:54:20.190944175Z" level=info msg="loading plugin \"io.containerd.grpc.v1.snapshots\"..." type=io.containerd.grpc.v1
 time="2025-10-31T10:54:20.190977540Z" level=info msg="loading plugin \"io.containerd.grpc.v1.tasks\"..." type=io.containerd.grpc.v1
 time="2025-10-31T10:54:20.190987926Z" level=info msg="loading plugin \"io.containerd.grpc.v1.version\"..." type=io.containerd.grpc.v1
 time="2025-10-31T10:54:20.190994728Z" level=info msg="loading plugin \"io.containerd.grpc.v1.introspection\"..." type=io.containerd.grpc.v1
 time="2025-10-31T10:54:20.191184901Z" level=info msg=serving... address=/var/run/docker/containerd/containerd-debug.sock
 time="2025-10-31T10:54:20.191267992Z" level=info msg=serving... address=/var/run/docker/containerd/containerd.sock.ttrpc
 time="2025-10-31T10:54:20.191352187Z" level=info msg=serving... address=/var/run/docker/containerd/containerd.sock
 time="2025-10-31T10:54:20.191392354Z" level=info msg="containerd successfully booted in 0.034340s"
 time="2025-10-31T10:54:20.200275056Z" level=info msg="parsed scheme: \"unix\"" module=grpc
 time="2025-10-31T10:54:20.200313477Z" level=info msg="scheme \"unix\" not registered, fallback to default scheme" module=grpc
 time="2025-10-31T10:54:20.200329194Z" level=info msg="ccResolverWrapper: sending update to cc: {[{unix:///var/run/docker/containerd/containerd.sock  <nil> 0 <nil>}] <nil> <nil>}" module=grpc
 time="2025-10-31T10:54:20.200334709Z" level=info msg="ClientConn switching balancer to \"pick_first\"" module=grpc
 time="2025-10-31T10:54:20.202905582Z" level=info msg="parsed scheme: \"unix\"" module=grpc
 time="2025-10-31T10:54:20.202959996Z" level=info msg="scheme \"unix\" not registered, fallback to default scheme" module=grpc
 time="2025-10-31T10:54:20.202983159Z" level=info msg="ccResolverWrapper: sending update to cc: {[{unix:///var/run/docker/containerd/containerd.sock  <nil> 0 <nil>}] <nil> <nil>}" module=grpc
 time="2025-10-31T10:54:20.202990144Z" level=info msg="ClientConn switching balancer to \"pick_first\"" module=grpc
 time="2025-10-31T10:54:20.227863824Z" level=info msg="Loading containers: start."
 time="2025-10-31T10:54:20.282818926Z" level=info msg="Default bridge (docker0) is assigned with an IP address 172.17.0.0/16. Daemon option --bip can be used to set a preferred IP address"
 time="2025-10-31T10:54:20.312139747Z" level=info msg="Loading containers: done."
 time="2025-10-31T10:54:20.322753675Z" level=info msg="Docker daemon" commit=906f57f graphdriver(s)=overlay2 version=20.10.13
 time="2025-10-31T10:54:20.323191560Z" level=info msg="Daemon has completed initialization"
 time="2025-10-31T10:54:20.349190836Z" level=info msg="API listen on /var/run/docker.sock"
 time="2025-10-31T10:54:20.351929087Z" level=info msg="API listen on [::]:2375"




sudo docker inspect b7230f9a7e5f4670c1f6579d52cdb563b4693d8eb4edd8c94892b3ba5f61d5b1[
    {
        "Id": "b7230f9a7e5f4670c1f6579d52cdb563b4693d8eb4edd8c94892b3ba5f61d5b1",
        "Created": "2025-10-31T10:54:03.552334736Z",
        "Path": "dockerd-entrypoint.sh",
        "Args": [],
        "State": {
            "Status": "running",
            "Running": true,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 99156,
            "ExitCode": 0,
            "Error": "",
            "StartedAt": "2025-10-31T10:54:03.804328913Z",
            "FinishedAt": "0001-01-01T00:00:00Z"
        },
        "Image": "sha256:fcbd7cae41740db4877d404a03c5807450dee8b82c38f9ba0aadebb9140a00d7",
        "ResolvConfPath": "/var/lib/docker/containers/b7230f9a7e5f4670c1f6579d52cdb563b4693d8eb4edd8c94892b3ba5f61d5b1/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/b7230f9a7e5f4670c1f6579d52cdb563b4693d8eb4edd8c94892b3ba5f61d5b1/hostname",
        "HostsPath": "/var/lib/docker/containers/b7230f9a7e5f4670c1f6579d52cdb563b4693d8eb4edd8c94892b3ba5f61d5b1/hosts",
        "LogPath": "/var/lib/docker/containers/b7230f9a7e5f4670c1f6579d52cdb563b4693d8eb4edd8c94892b3ba5f61d5b1/b7230f9a7e5f4670c1f6579d52cdb563b4693d8eb4edd8c94892b3ba5f61d5b1-json.log",
        "Name": "/custom_no_tool-docker-1",
        "RestartCount": 0,
        "Driver": "overlayfs",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": null,
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "custom_no_tool_default",
            "PortBindings": {
                "2375/tcp": [
                    {
                        "HostIp": "",
                        "HostPort": "2375"
                    }
                ]
            },
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "ConsoleSize": [
                0,
                0
            ],
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": null,
            "DnsOptions": null,
            "DnsSearch": null,
            "ExtraHosts": [],
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": true,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": [
                "label=disable"
            ],
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": null,
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": null,
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": null,
            "ReadonlyPaths": null
        },
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "Mounts": [
            {
                "Type": "volume",
                "Name": "040b509fec604798a2d9720e3e8ed3b69f21f6e538c807f57ea2cc25f8635cc8",
                "Source": "/var/lib/docker/volumes/040b509fec604798a2d9720e3e8ed3b69f21f6e538c807f57ea2cc25f8635cc8/_data",
                "Destination": "/var/lib/docker",
                "Driver": "local",
                "Mode": "",
                "RW": true,
                "Propagation": ""
            }
        ],
        "Config": {
            "Hostname": "b7230f9a7e5f",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": true,
            "AttachStderr": true,
            "ExposedPorts": {
                "2375/tcp": {},
                "2376/tcp": {}
            },
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "DOCKER_TLS_CERTDIR=",
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
                "DOCKER_VERSION=20.10.13",
                "DIND_COMMIT=42b1175eda071c0e9121e1d64345928384a93df1"
            ],
            "Cmd": [],
            "Image": "docker:20.10.13-dind",
            "Volumes": {
                "/var/lib/docker": {}
            },
            "WorkingDir": "",
            "Entrypoint": [
                "dockerd-entrypoint.sh"
            ],
            "OnBuild": null,
            "Labels": {
                "com.docker.compose.config-hash": "966aaed839f89fe011942f95e13d0cca51537f6c431be6fffcc9542af3273406",
                "com.docker.compose.container-number": "1",
                "com.docker.compose.depends_on": "",
                "com.docker.compose.image": "sha256:fcbd7cae41740db4877d404a03c5807450dee8b82c38f9ba0aadebb9140a00d7",
                "com.docker.compose.oneoff": "False",
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.project.config_files": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2023-22527/custom_no_tool/docker-compose.yml",
                "com.docker.compose.project.working_dir": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2023-22527/custom_no_tool",
                "com.docker.compose.service": "docker",
                "com.docker.compose.version": "2.40.2",
                "desktop.docker.io/wsl-distro": "Ubuntu"
            },
            "StopTimeout": 1
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "d3bf639a6283fc200eb3aefffecb665c3f2b7816898ceb822a68734a22dd1ab2",
            "SandboxKey": "/var/run/docker/netns/d3bf639a6283",
            "Ports": {
                "2375/tcp": [
                    {
                        "HostIp": "0.0.0.0",
                        "HostPort": "2375"
                    },
                    {
                        "HostIp": "::",
                        "HostPort": "2375"
                    }
                ]
            },
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "",
            "Gateway": "",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "",
            "IPPrefixLen": 0,
            "IPv6Gateway": "",
            "MacAddress": "",
            "Networks": {
                "custom_no_tool_default": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": [
                        "custom_no_tool-docker-1",
                        "docker"
                    ],
                    "MacAddress": "ba:58:76:b1:5d:d5",
                    "DriverOpts": null,
                    "GwPriority": 0,
                    "NetworkID": "2207d328a4e4bed5e0cbdfb2147f81c65939d82323a43ae795a5ff7940bed076",
                    "EndpointID": "d580be7486a601abcba069b730b2e477ed361db2e6086987b8992654b556bba2",
                    "Gateway": "172.18.0.1",
                    "IPAddress": "172.18.0.2",
                    "IPPrefixLen": 16,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "DNSNames": [
                        "custom_no_tool-docker-1",
                        "docker",
                        "b7230f9a7e5f"
                    ]
                }
            }
        },
        "ImageManifestDescriptor": {
            "mediaType": "application/vnd.docker.distribution.manifest.v2+json",
            "digest": "sha256:ec5878c9db35767e5ff292c496c07c67b0932c59596dc0e35816594edde1e87e",
            "size": 2614,
            "platform": {
                "architecture": "amd64",
                "os": "linux"
            }
        }
    }
]

sudo docker logs f089ffaf28eee74b18bb8734ee1ed4e25349468ae9c8bf62ba789d712b6c0d1d --details
STDOUT: 
STDERR:  Traceback (most recent call last):
   File "/usr/local/lib/python3.9/site-packages/urllib3/connection.py", line 198, in _new_conn
     sock = connection.create_connection(
   File "/usr/local/lib/python3.9/site-packages/urllib3/util/connection.py", line 85, in create_connection
     raise err
   File "/usr/local/lib/python3.9/site-packages/urllib3/util/connection.py", line 73, in create_connection
     sock.connect(sa)
 ConnectionRefusedError: [Errno 111] Connection refused
 
 The above exception was the direct cause of the following exception:
 
 Traceback (most recent call last):
   File "/usr/local/lib/python3.9/site-packages/urllib3/connectionpool.py", line 787, in urlopen
     response = self._make_request(
   File "/usr/local/lib/python3.9/site-packages/urllib3/connectionpool.py", line 493, in _make_request
     conn.request(
   File "/usr/local/lib/python3.9/site-packages/urllib3/connection.py", line 494, in request
     self.endheaders()
   File "/usr/local/lib/python3.9/http/client.py", line 1280, in endheaders
     self._send_output(message_body, encode_chunked=encode_chunked)
   File "/usr/local/lib/python3.9/http/client.py", line 1040, in _send_output
     self.send(msg)
   File "/usr/local/lib/python3.9/http/client.py", line 980, in send
     self.connect()
   File "/usr/local/lib/python3.9/site-packages/urllib3/connection.py", line 325, in connect
     self.sock = self._new_conn()
   File "/usr/local/lib/python3.9/site-packages/urllib3/connection.py", line 213, in _new_conn
     raise NewConnectionError(
 urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x79314f1ef0a0>: Failed to establish a new connection: [Errno 111] Connection refused
 
 The above exception was the direct cause of the following exception:
 
 Traceback (most recent call last):
   File "/usr/local/lib/python3.9/site-packages/requests/adapters.py", line 644, in send
     resp = conn.urlopen(
   File "/usr/local/lib/python3.9/site-packages/urllib3/connectionpool.py", line 841, in urlopen
     retries = retries.increment(
   File "/usr/local/lib/python3.9/site-packages/urllib3/util/retry.py", line 519, in increment
     raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
 urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='docker', port=2375): Max retries exceeded with url: /images/create?fromImage=alpine&tag=latest (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x79314f1ef0a0>: Failed to establish a new connection: [Errno 111] Connection refused'))
 
 During handling of the above exception, another exception occurred:
 
 Traceback (most recent call last):
   File "/app/exploit.py", line 9, in <module>
     resp = requests.post(f'{docker_host}/images/create', params={'fromImage': 'alpine', 'tag': 'latest'})
   File "/usr/local/lib/python3.9/site-packages/requests/api.py", line 115, in post
     return request("post", url, data=data, json=json, **kwargs)
   File "/usr/local/lib/python3.9/site-packages/requests/api.py", line 59, in request
     return session.request(method=method, url=url, **kwargs)
   File "/usr/local/lib/python3.9/site-packages/requests/sessions.py", line 589, in request
     resp = self.send(prep, **send_kwargs)
   File "/usr/local/lib/python3.9/site-packages/requests/sessions.py", line 703, in send
     r = adapter.send(request, **kwargs)
   File "/usr/local/lib/python3.9/site-packages/requests/adapters.py", line 677, in send
     raise ConnectionError(e, request=request)
 requests.exceptions.ConnectionError: HTTPConnectionPool(host='docker', port=2375): Max retries exceeded with url: /images/create?fromImage=alpine&tag=latest (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x79314f1ef0a0>: Failed to establish a new connection: [Errno 111] Connection refused'))




sudo docker inspect f089ffaf28eee74b18bb8734ee1ed4e25349468ae9c8bf62ba789d712b6c0d1d[
    {
        "Id": "f089ffaf28eee74b18bb8734ee1ed4e25349468ae9c8bf62ba789d712b6c0d1d",
        "Created": "2025-10-31T10:54:03.665878767Z",
        "Path": "python",
        "Args": [
            "exploit.py"
        ],
        "State": {
            "Status": "exited",
            "Running": false,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 0,
            "ExitCode": 1,
            "Error": "",
            "StartedAt": "2025-10-31T10:54:04.042139781Z",
            "FinishedAt": "2025-10-31T10:54:09.380369747Z"
        },
        "Image": "sha256:0377b62610e5662cbe3099f1677e1d65705152b20fc508b5f78a7203c99c48a5",
        "ResolvConfPath": "/var/lib/docker/containers/f089ffaf28eee74b18bb8734ee1ed4e25349468ae9c8bf62ba789d712b6c0d1d/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/f089ffaf28eee74b18bb8734ee1ed4e25349468ae9c8bf62ba789d712b6c0d1d/hostname",
        "HostsPath": "/var/lib/docker/containers/f089ffaf28eee74b18bb8734ee1ed4e25349468ae9c8bf62ba789d712b6c0d1d/hosts",
        "LogPath": "/var/lib/docker/containers/f089ffaf28eee74b18bb8734ee1ed4e25349468ae9c8bf62ba789d712b6c0d1d/f089ffaf28eee74b18bb8734ee1ed4e25349468ae9c8bf62ba789d712b6c0d1d-json.log",
        "Name": "/custom_no_tool-testapp-1",
        "RestartCount": 0,
        "Driver": "overlayfs",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": null,
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "custom_no_tool_default",
            "PortBindings": {},
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "ConsoleSize": [
                0,
                0
            ],
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": null,
            "DnsOptions": null,
            "DnsSearch": null,
            "ExtraHosts": [],
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": false,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": null,
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": null,
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": null,
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": [
                "/proc/asound",
                "/proc/acpi",
                "/proc/interrupts",
                "/proc/kcore",
                "/proc/keys",
                "/proc/latency_stats",
                "/proc/timer_list",
                "/proc/timer_stats",
                "/proc/sched_debug",
                "/proc/scsi",
                "/sys/firmware",
                "/sys/devices/virtual/powercap"
            ],
            "ReadonlyPaths": [
                "/proc/bus",
                "/proc/fs",
                "/proc/irq",
                "/proc/sys",
                "/proc/sysrq-trigger"
            ]
        },
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "Mounts": [],
        "Config": {
            "Hostname": "f089ffaf28ee",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": true,
            "AttachStderr": true,
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "DOCKER_HOST=tcp://docker:2375",
                "PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
                "LANG=C.UTF-8",
                "GPG_KEY=E3FF2839C048B25C084DEBE9B26995E310250568",
                "PYTHON_VERSION=3.9.24",
                "PYTHON_SHA256=668391afabd5083faafa4543753d190f82f33ce6ba22d6e9ac728b43644b278a"
            ],
            "Cmd": [
                "python",
                "exploit.py"
            ],
            "Image": "custom_no_tool-testapp",
            "Volumes": null,
            "WorkingDir": "/app",
            "Entrypoint": null,
            "OnBuild": null,
            "Labels": {
                "com.docker.compose.config-hash": "d5a533e685e48a8e50d4b3001ae8f10141ed70d6863262fdd0abc89b73779f49",
                "com.docker.compose.container-number": "1",
                "com.docker.compose.depends_on": "docker:service_started:false",
                "com.docker.compose.image": "sha256:0377b62610e5662cbe3099f1677e1d65705152b20fc508b5f78a7203c99c48a5",
                "com.docker.compose.oneoff": "False",
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.project.config_files": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2023-22527/custom_no_tool/docker-compose.yml",
                "com.docker.compose.project.working_dir": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2023-22527/custom_no_tool",
                "com.docker.compose.service": "testapp",
                "com.docker.compose.version": "2.40.2",
                "desktop.docker.io/wsl-distro": "Ubuntu"
            },
            "StopTimeout": 1
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "",
            "SandboxKey": "",
            "Ports": {},
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "",
            "Gateway": "",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "",
            "IPPrefixLen": 0,
            "IPv6Gateway": "",
            "MacAddress": "",
            "Networks": {
                "custom_no_tool_default": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": [
                        "custom_no_tool-testapp-1",
                        "testapp"
                    ],
                    "MacAddress": "",
                    "DriverOpts": null,
                    "GwPriority": 0,
                    "NetworkID": "2207d328a4e4bed5e0cbdfb2147f81c65939d82323a43ae795a5ff7940bed076",
                    "EndpointID": "",
                    "Gateway": "",
                    "IPAddress": "",
                    "IPPrefixLen": 0,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "DNSNames": [
                        "custom_no_tool-testapp-1",
                        "testapp",
                        "f089ffaf28ee"
                    ]
                }
            }
        },
        "ImageManifestDescriptor": {
            "mediaType": "application/vnd.oci.image.manifest.v1+json",
            "digest": "sha256:94f47516211e279df8e5ead64fe3be9b01a78b574cb85f4d2c93c5553c778ff0",
            "size": 1622,
            "platform": {
                "architecture": "amd64",
                "os": "linux"
            }
        }
    }
]