{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/docker-compose.yml",
            "content": "services:\n  db:\n    image: mysql:5.7\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: vulndb\n      MYSQL_USER: test\n      MYSQL_PASSWORD: test123\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\n    healthcheck:\n      test: [\"CMD\",\"mysqladmin\",\"ping\",\"-h\",\"localhost\",\"-u\",\"root\",\"-p${MYSQL_ROOT_PASSWORD}\"]\n      interval: 5s\n      timeout: 2s\n      retries: 10\n\n  ecshop:\n    build:\n      context: ./ecshop\n    environment:\n      DB_HOST: db\n      DB_USER: test\n      DB_PASSWORD: test123\n      DB_NAME: vulndb\n    depends_on:\n      db:\n        condition: service_healthy\n    ports:\n      - \"8080:80\"\n\n  httpd:\n    build:\n      context: ./httpd\n    ports:\n      - \"80:80\"\n\n  web:\n    build:\n      context: ./web\n    ports:\n      - \"3000:3000\"\n    environment:\n      - DB_HOST=db\n      - DB_USER=test\n      - DB_PASSWORD=test123\n      - DB_NAME=vulndb\n    depends_on:\n      db:\n        condition: service_healthy\n\nvolumes:\n  db_data:"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/.env",
            "content": "MYSQL_ROOT_PASSWORD=rootpass\nMYSQL_DATABASE=vulndb\nMYSQL_USER=test\nMYSQL_PASSWORD=test123"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/httpd/Dockerfile",
            "content": "FROM httpd:2.4.46\nCOPY ./conf/httpd.conf /usr/local/apache2/conf/httpd.conf"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/httpd/conf/httpd.conf",
            "content": "ServerRoot \"/usr/local/apache2\"\nListen 80\nLoadModule mpm_event_module modules/mod_mpm_event.so\nLoadModule authz_core_module modules/mod_authz_core.so\nLoadModule authz_host_module modules/mod_authz_host.so\nLoadModule authz_groupfile_module modules/mod_authz_groupfile.so\nLoadModule authz_user_module modules/mod_authz_user.so\nLoadModule alias_module modules/mod_alias.so\nLoadModule dir_module modules/mod_dir.so\nLoadModule rewrite_module modules/mod_rewrite.so\nLoadModule setenvif_module modules/mod_setenvif.so\nLoadModule mime_module modules/mod_mime.so\nLoadModule headers_module modules/mod_headers.so\nLoadModule proxy_module modules/mod_proxy.so\nLoadModule proxy_http_module modules/mod_proxy_http.so\nLoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so\nLoadModule proxy_wstunnel_module modules/mod_proxy_wstunnel.so\nLoadModule proxy_ajp_module modules/mod_proxy_ajp.so\nLoadModule deflate_module modules/mod_deflate.so\nLoadModule filter_module modules/mod_filter.so\nLoadModule log_config_module modules/mod_log_config.so\nLoadModule logio_module modules/mod_logio.so\nLoadModule env_module modules/mod_env.so\nLoadModule setenvif_module modules/mod_setenvif.so\nLoadModule rewrite_module modules/mod_rewrite.so\nServerName localhost\nDocumentRoot \"/usr/local/apache2/htdocs\"\n<Directory \"/usr/local/apache2/htdocs\">\n    Options Indexes FollowSymLinks\n    AllowOverride All\n    Require all granted\n</Directory>\nErrorLog /proc/self/fd/2\nCustomLog /proc/self/fd/1 combined"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/web/Dockerfile",
            "content": "FROM node:14-alpine\nWORKDIR /app\nCOPY package.json .\nRUN npm install\nCOPY . .\nEXPOSE 3000\nCMD [\"node\", \"app.js\"]"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/web/package.json",
            "content": "{\n  \"name\": \"vulnerable-web\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Node app for CVE-2021-41460\",\n  \"main\": \"app.js\",\n  \"scripts\": {\n    \"start\": \"node app.js\"\n  },\n  \"author\": \"\",\n  \"license\": \"MIT\",\n  \"dependencies\": {\n    \"mysql\": \"^2.18.1\"\n  }\n}"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/web/app.js",
            "content": "const http = require('http');\nconst mysql = require('mysql');\n\nfunction connectWithRetry() {\n  const connection = mysql.createConnection({\n    host: process.env.DB_HOST || 'db',\n    user: process.env.DB_USER || 'test',\n    password: process.env.DB_PASSWORD || 'test123',\n    database: process.env.DB_NAME || 'vulndb'\n  });\n\n  connection.connect(err => {\n    if (err) {\n      console.error('DB connection failed, retrying in 2 seconds:', err.message);\n      setTimeout(connectWithRetry, 2000);\n    } else {\n      console.log('Connected to MySQL');\n    }\n  });\n  return connection;\n}\n\nconst db = connectWithRetry();\n\nconst server = http.createServer((req, res) => {\n  if (req.url === '/secret') {\n    res.writeHead(200, { 'Content-Type': 'text/plain' });\n    res.end('Secret data');\n  } else {\n    db.query('SELECT 1', (err, rows) => {\n      if (err) {\n        res.writeHead(500);\n        res.end('DB error');\n        return;\n      }\n      res.writeHead(200, { 'Content-Type': 'text/plain' });\n      res.end('OK');\n    });\n  }\n});\n\nserver.listen(3000, () => {\n  console.log('Web server listening on port 3000');\n});"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/web/public/secret.txt",
            "content": "This is a test secret for the vulnerable application."
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE IF NOT EXISTS users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  username VARCHAR(50) NOT NULL,\n  password VARCHAR(255) NOT NULL\n) ENGINE=InnoDB;\n\nINSERT INTO users (username, password) VALUES ('alice', 'password1'), ('bob', 'password2');"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/ecshop/Dockerfile",
            "content": "FROM php:7.4-apache\nRUN apt-get update && apt-get install -y \\\n    unzip \\\n    git \\\n    libpng-dev \\\n    libjpeg-dev \\\n    libzip-dev \\\n    php-mysql && rm -rf /var/lib/apt/lists/*\nWORKDIR /var/www/html\n# Clone the ECShop source at the specific vulnerable tag\nRUN git clone --depth 1 --branch v4.1.0 https://github.com/ecshop/ecshop.git . && rm -rf .git\nRUN a2enmod rewrite"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE IF NOT EXISTS users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  username VARCHAR(50) NOT NULL,\n  password VARCHAR(255) NOT NULL\n) ENGINE=InnoDB;\n\nINSERT INTO users (username, password) VALUES ('alice', 'password1'), ('bob', 'password2');"
        }
    ],
    "directory_tree": "CVE-2021-41460/custom_no_tool"
}