{
    "desc": "CVE\u20112020\u201117518 is a directory\u2011traversal and arbitrary file\u2011upload vulnerability in the Apache Flink REST API. The vulnerable component is the FileUploadHandler used by the POST /jars/upload endpoint. The handler builds the destination path with `currentUploadDir.resolve(fileUpload.getFilename())` without sanitising the filename supplied by the client. By supplying a filename that contains traversal sequences such as \"../../../\", an attacker can cause Flink to write the uploaded file to any writable location on the host filesystem. This enables an attacker to place malicious JARs, scripts, or configuration files that can later be executed, leading to full host compromise. The flaw exists in all Flink releases from 1.5.1 (when the handler was introduced) through 1.11.2. The issue was fixed in Flink 1.11.3, where the filename is stripped of any path information before resolution. Exploitation consists of sending a crafted multipart\u2011POST request with a malicious `filename` value, which results in the file being written (e.g., to /tmp/poc.txt) even if the HTTP response indicates an error.",
    "attack_type": "arbitrary file write on the server filesystem",
    "services": [
        {
            "name": "apache/flink",
            "version": [
                "1.5.1",
                "1.5.2",
                "1.6.0",
                "1.6.1",
                "1.6.2",
                "1.6.3",
                "1.6.4",
                "1.7.0",
                "1.7.1",
                "1.7.2",
                "1.8.0",
                "1.8.1",
                "1.8.2",
                "1.9.0",
                "1.9.1",
                "1.9.2",
                "1.10.0",
                "1.10.1",
                "1.10.2",
                "1.11.0",
                "1.11.1",
                "1.11.2"
            ],
            "dependency_type": "HARD",
            "description": "Apache Flink container provides the vulnerable REST API (FileUploadHandler) needed to demonstrate CVE\u20112020\u201117518. Each listed version is vulnerable because it predates the fix introduced in 1.11.3."
        },
        {
            "name": "docker/compose",
            "version": [
                "2.20.2"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Docker Compose is used to orchestrate the Flink container and expose its REST port for testing the vulnerable upload endpoint."
        }
    ],
    "input_tokens": 7329,
    "output_tokens": 1545
}