FROM openjdk:8-jdk-slim
ENV JBOSS_VERSION=4.2.3.GA
ENV JBOSS_HOME=/opt/jbossas
ENV JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64

# Install utilities and CA certificates needed for HTTP download
RUN apt-get update && apt-get install -y curl unzip ca-certificates && rm -rf /var/lib/apt/lists/*

# Download JBoss AS 4.2.3 from the official JBoss archive, unpack and set up
RUN curl -f -L -o /tmp/jboss.zip http://download.jboss.org/jbossas/4.2.3.GA/jboss-4.2.3.GA.zip \
    && unzip /tmp/jboss.zip -d /opt/ \
    && mv /opt/jboss-4.2.3.GA $JBOSS_HOME \
    && rm /tmp/jboss.zip \
    && chmod +x $JBOSS_HOME/bin/run.sh

WORKDIR $JBOSS_HOME

# Expose the default HTTP port used by the HTTPServerILServlet
EXPOSE 8080

# Start JBoss in the foreground
CMD ["/opt/jbossas/bin/run.sh", "-b", "0.0.0.0"]