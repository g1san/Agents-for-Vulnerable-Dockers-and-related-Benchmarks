## CVE‑2020‑29599 Test Environment

This repository provides a self‑contained Docker Compose setup that reproduces the vulnerable ImageMagick configuration required for CVE‑2020‑29599 while also keeping the original vulnerable Jenkins instance.

### Services
- **jenkins** – Vulnerable Jenkins (2.176.1) pre‑configured with default admin credentials.
- **nginx** – Simple web server listening on host port **80**. It serves a minimal upload page and forwards conversion requests to the ImageMagick service.
- **imagemagick** – Container built from Alpine **3.9**. It installs the historic ImageMagick package **6.9.9‑0**, which contains the vulnerable `-authenticate` and `clip‑path` handling. The container runs a tiny Flask API (`/convert`) that invokes `convert` directly, exposing the flaw.

All containers share a Docker network (`cve_net`) and a common named volume (`shared_data`) for temporary files.

### Quick Start
```bash
# From the repository root:
cd ./../../dockers/CVE-2020-29599/custom_no_tool
docker compose up -d --build
```
The services become available immediately:
- Jenkins UI: http://localhost:8080   (admin / admin)
- Upload page: http://localhost:80  (simple HTML form to POST a file to `/convert`)

### Testing the Vulnerability
1. Prepare a malicious PDF or SVG that exploits the `-authenticate` or `clip‑path` issue.
2. Use the upload form (or `curl`) to send the file:
```bash
curl -F "file=@malicious.svg" http://localhost/convert -o output.png
```
If the ImageMagick version is vulnerable, the container may execute arbitrary commands as the `root` user inside the container, demonstrating the CVE.

### Cleanup
```bash
docker compose down -v
```
All data is stored in Docker volumes, so no manual configuration is required beyond the `docker compose up` command.
