{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-40822/custom_no_tool/docker-compose.yml",
            "content": "services:\n  web:\n    build: ./app\n    ports:\n      - \"8080:80\"\n    depends_on:\n      - db\n      - geoserver\n  db:\n    image: postgres:13\n    environment:\n      POSTGRES_PASSWORD: mypassword\n      POSTGRES_USER: postgres\n      POSTGRES_DB: testdb\n    ports:\n      - \"5432:5432\"\n    volumes:\n      - db_data:/var/lib/postgresql/data\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql:ro\n  geoserver:\n    image: geoserver/geoserver:2.23.4\n    ports:\n      - \"8081:8080\"\nvolumes:\n  db_data:\n"
        },
        {
            "location": "./../../dockers/CVE-2021-40822/custom_no_tool/app/Dockerfile",
            "content": "FROM php:8.2-apache\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends \\\n        build-essential \\\n        libpq-dev \\\n        libssl-dev \\\n        postgresql-client && \\\n    docker-php-ext-install pdo_pgsql && \\\n    a2enmod rewrite && \\\n    rm -rf /var/lib/apt/lists/*\nCOPY index.php /var/www/html/\n"
        },
        {
            "location": "./../../dockers/CVE-2021-40822/custom_no_tool/app/index.php",
            "content": "<?php\n$host = 'db';\n$user = 'postgres';\n$pass = 'mypassword';\n$db   = 'testdb';\n\n$dsn = \"pgsql:host=$host;port=5432;dbname=$db;\";\n\ntry {\n    $conn = new PDO($dsn, $user, $pass, [PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION]);\n} catch (PDOException $e) {\n    die('Connection failed: ' . $e->getMessage());\n}\n\n$id = isset($_GET['id']) ? (int)$_GET['id'] : 0;\n$stmt = $conn->prepare('SELECT username, email FROM users WHERE id = :id');\n$stmt->execute(['id' => $id]);\n\n$rows = $stmt->fetchAll(PDO::FETCH_ASSOC);\nif ($rows) {\n    foreach ($rows as $row) {\n        echo 'User: ' . htmlspecialchars($row['username']) .\n             ' Email: ' . htmlspecialchars($row['email']) . \"<br>\";\n    }\n} else {\n    echo 'No results found';\n}\n\n$conn = null;\n?>\n"
        },
        {
            "location": "./../../dockers/CVE-2021-40822/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE IF NOT EXISTS users (\n  id SERIAL PRIMARY KEY,\n  username VARCHAR(50) NOT NULL,\n  email VARCHAR(100) NOT NULL\n);\nINSERT INTO users (username, email) VALUES\n('alice', 'alice@example.com'),\n('bob', 'bob@example.com'),\n('carol', 'carol@example.com');\n"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2021-40822/custom_no_tool"
}