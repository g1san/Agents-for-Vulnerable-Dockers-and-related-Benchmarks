time="2025-10-31T19:52:08+01:00" level=warning msg="/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2021-42342/custom_no_tool/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
 vulnerable-docker Pulling 
 7f8d570be227 Pulling fs layer 
 540db60ca938 Pulling fs layer 
 918595a0e69b Pulling fs layer 
 e5fa5deb3340 Pulling fs layer 
 5a38b3726f4b Pulling fs layer 
 c521bbbd9945 Pulling fs layer 
 59707d521c45 Pulling fs layer 
 3b0522a0264f Pulling fs layer 
 eaf6f33d26f8 Pulling fs layer 
 26abe223b186 Pulling fs layer 
 9d806bc20361 Pulling fs layer 
 7f8d570be227 Download complete 
 eaf6f33d26f8 Download complete 
 e5fa5deb3340 Download complete 
 3b0522a0264f Download complete 
 9d806bc20361 Download complete 
 26abe223b186 Download complete 
 59707d521c45 Download complete 
 918595a0e69b Downloading [=======>                                           ]  1.049MB/6.611MB
 540db60ca938 Downloading [==================>                                ]  1.049MB/2.812MB
 918595a0e69b Downloading [=======>                                           ]  1.049MB/6.611MB
 540db60ca938 Downloading [==================>                                ]  1.049MB/2.812MB
 918595a0e69b Downloading [=======>                                           ]  1.049MB/6.611MB
 918595a0e69b Downloading [===============>                                   ]  2.097MB/6.611MB
 540db60ca938 Downloading [=====================================>             ]  2.097MB/2.812MB
 918595a0e69b Downloading [===============>                                   ]  2.097MB/6.611MB
 540db60ca938 Downloading [=====================================>             ]  2.097MB/2.812MB
 918595a0e69b Downloading [=======================>                           ]  3.146MB/6.611MB
 5a38b3726f4b Downloading [=========================>                         ]  1.049MB/2.05MB
 540db60ca938 Downloading [==================================================>]  2.812MB/2.812MB
 918595a0e69b Downloading [=======================>                           ]  3.146MB/6.611MB
 5a38b3726f4b Downloading [=========================>                         ]  1.049MB/2.05MB
 540db60ca938 Download complete 
 540db60ca938 Extracting 1 s
 c521bbbd9945 Downloading [>                                                  ]  1.049MB/70.25MB
 918595a0e69b Downloading [=======================>                           ]  3.146MB/6.611MB
 5a38b3726f4b Download complete 
 540db60ca938 Pull complete 
 5a38b3726f4b Extracting 1 s
 c521bbbd9945 Downloading [>                                                  ]  1.049MB/70.25MB
 918595a0e69b Downloading [===============================>                   ]  4.194MB/6.611MB
 5a38b3726f4b Extracting 1 s
 c521bbbd9945 Downloading [>                                                  ]  1.049MB/70.25MB
 918595a0e69b Downloading [=======================================>           ]  5.243MB/6.611MB
 e5fa5deb3340 Pull complete 
 5a38b3726f4b Pull complete 
 c521bbbd9945 Downloading [>                                                  ]  1.049MB/70.25MB
 918595a0e69b Downloading [=======================================>           ]  5.243MB/6.611MB
 918595a0e69b Downloading [==================================================>]  6.611MB/6.611MB
 c521bbbd9945 Downloading [=>                                                 ]  2.097MB/70.25MB
 c521bbbd9945 Downloading [=>                                                 ]  2.097MB/70.25MB
 918595a0e69b Download complete 
 c521bbbd9945 Downloading [==>                                                ]  3.146MB/70.25MB
 c521bbbd9945 Downloading [==>                                                ]  3.146MB/70.25MB
 c521bbbd9945 Downloading [==>                                                ]  4.194MB/70.25MB
 c521bbbd9945 Downloading [==>                                                ]  4.194MB/70.25MB
 c521bbbd9945 Downloading [===>                                               ]  5.243MB/70.25MB
 c521bbbd9945 Downloading [====>                                              ]  6.291MB/70.25MB
 c521bbbd9945 Downloading [=====>                                             ]   7.34MB/70.25MB
 c521bbbd9945 Downloading [=====>                                             ]  8.389MB/70.25MB
 c521bbbd9945 Downloading [======>                                            ]  9.437MB/70.25MB
 c521bbbd9945 Downloading [=======>                                           ]  10.49MB/70.25MB
 c521bbbd9945 Downloading [=======>                                           ]  10.49MB/70.25MB
 c521bbbd9945 Downloading [========>                                          ]  11.53MB/70.25MB
 c521bbbd9945 Downloading [========>                                          ]  11.53MB/70.25MB
 c521bbbd9945 Downloading [========>                                          ]  11.53MB/70.25MB
 c521bbbd9945 Downloading [=========>                                         ]  13.63MB/70.25MB
 c521bbbd9945 Downloading [===========>                                       ]  16.75MB/70.25MB
 c521bbbd9945 Downloading [============>                                      ]  17.83MB/70.25MB
 c521bbbd9945 Downloading [=============>                                     ]  18.87MB/70.25MB
 c521bbbd9945 Downloading [==============>                                    ]  19.92MB/70.25MB
 c521bbbd9945 Downloading [==============>                                    ]  20.97MB/70.25MB
 c521bbbd9945 Downloading [===============>                                   ]  22.02MB/70.25MB
 c521bbbd9945 Downloading [================>                                  ]  23.07MB/70.25MB
 c521bbbd9945 Downloading [=================>                                 ]  24.12MB/70.25MB
 c521bbbd9945 Downloading [==================>                                ]  26.21MB/70.25MB
 c521bbbd9945 Downloading [===================>                               ]  27.26MB/70.25MB
 c521bbbd9945 Downloading [====================>                              ]  28.31MB/70.25MB
 c521bbbd9945 Downloading [====================>                              ]  29.36MB/70.25MB
 c521bbbd9945 Downloading [=====================>                             ]  30.41MB/70.25MB
 c521bbbd9945 Downloading [=====================>                             ]  30.41MB/70.25MB
 c521bbbd9945 Downloading [=======================>                           ]  32.51MB/70.25MB
 c521bbbd9945 Downloading [=======================>                           ]  32.51MB/70.25MB
 c521bbbd9945 Downloading [=======================>                           ]  33.55MB/70.25MB
 c521bbbd9945 Downloading [========================>                          ]   34.6MB/70.25MB
 c521bbbd9945 Downloading [========================>                          ]   34.6MB/70.25MB
 c521bbbd9945 Downloading [========================>                          ]   34.6MB/70.25MB
 c521bbbd9945 Downloading [==========================>                        ]  37.75MB/70.25MB
 c521bbbd9945 Downloading [===========================>                       ]   38.8MB/70.25MB
 c521bbbd9945 Downloading [============================>                      ]  39.85MB/70.25MB
 c521bbbd9945 Downloading [=============================>                     ]  40.89MB/70.25MB
 c521bbbd9945 Downloading [==============================>                    ]  42.99MB/70.25MB
 c521bbbd9945 Downloading [===============================>                   ]  44.04MB/70.25MB
 c521bbbd9945 Downloading [================================>                  ]  45.09MB/70.25MB
 c521bbbd9945 Downloading [================================>                  ]  45.09MB/70.25MB
 c521bbbd9945 Downloading [================================>                  ]  46.14MB/70.25MB
 c521bbbd9945 Downloading [=================================>                 ]  47.19MB/70.25MB
 c521bbbd9945 Downloading [==================================>                ]  48.23MB/70.25MB
 c521bbbd9945 Downloading [===================================>               ]  50.33MB/70.25MB
 c521bbbd9945 Downloading [====================================>              ]  51.38MB/70.25MB
 c521bbbd9945 Downloading [=====================================>             ]  52.43MB/70.25MB
 c521bbbd9945 Downloading [======================================>            ]  53.48MB/70.25MB
 c521bbbd9945 Downloading [=======================================>           ]  55.57MB/70.25MB
 c521bbbd9945 Downloading [========================================>          ]  56.62MB/70.25MB
 c521bbbd9945 Downloading [=========================================>         ]  57.67MB/70.25MB
 c521bbbd9945 Downloading [=========================================>         ]  57.67MB/70.25MB
 c521bbbd9945 Downloading [=========================================>         ]  58.72MB/70.25MB
 c521bbbd9945 Downloading [===========================================>       ]  60.82MB/70.25MB
 c521bbbd9945 Downloading [============================================>      ]  61.87MB/70.25MB
 c521bbbd9945 Downloading [============================================>      ]  62.91MB/70.25MB
 c521bbbd9945 Downloading [=============================================>     ]  63.96MB/70.25MB
 c521bbbd9945 Downloading [==============================================>    ]  65.01MB/70.25MB
 c521bbbd9945 Downloading [===============================================>   ]  66.06MB/70.25MB
 c521bbbd9945 Downloading [===============================================>   ]  67.11MB/70.25MB
 c521bbbd9945 Downloading [================================================>  ]  68.16MB/70.25MB
 c521bbbd9945 Downloading [=================================================> ]  69.21MB/70.25MB
 c521bbbd9945 Downloading [==================================================>]  70.25MB/70.25MB
 c521bbbd9945 Download complete 
 c521bbbd9945 Extracting 1 s
 c521bbbd9945 Extracting 1 s
 c521bbbd9945 Extracting 1 s
 c521bbbd9945 Extracting 1 s
 c521bbbd9945 Extracting 1 s
 c521bbbd9945 Extracting 1 s
 c521bbbd9945 Extracting 1 s
 c521bbbd9945 Extracting 1 s
 c521bbbd9945 Extracting 1 s
 c521bbbd9945 Extracting 1 s
 c521bbbd9945 Extracting 1 s
 9d806bc20361 Pull complete 
 26abe223b186 Pull complete 
 59707d521c45 Pull complete 
 918595a0e69b Extracting 1 s
 c521bbbd9945 Pull complete 
 918595a0e69b Extracting 1 s
 7f8d570be227 Pull complete 
 eaf6f33d26f8 Pull complete 
 3b0522a0264f Pull complete 
 918595a0e69b Pull complete 
 vulnerable-docker Pulled 
#1 [internal] load local bake definitions
#1 reading from stdin 769B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile: 209B done
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/library/alpine:3.14
#3 DONE 1.8s

#4 [internal] load .dockerignore
#4 transferring context: 2B done
#4 DONE 0.0s

#5 [internal] load build context
#5 transferring context: 505B done
#5 DONE 0.0s

#6 [1/4] FROM docker.io/library/alpine:3.14@sha256:0f2d5c38dd7a4f4f733e688e3a6733cb5ab1ac6e3cb4603a5dd564e5bfb80eed
#6 resolve docker.io/library/alpine:3.14@sha256:0f2d5c38dd7a4f4f733e688e3a6733cb5ab1ac6e3cb4603a5dd564e5bfb80eed 0.0s done
#6 sha256:f7dab3ab2d6ec29aa28769bec35331fb485b5837501b1e8556413d8b5a79c9c8 0B / 2.83MB 0.2s
#6 sha256:f7dab3ab2d6ec29aa28769bec35331fb485b5837501b1e8556413d8b5a79c9c8 1.05MB / 2.83MB 0.6s
#6 sha256:f7dab3ab2d6ec29aa28769bec35331fb485b5837501b1e8556413d8b5a79c9c8 2.83MB / 2.83MB 0.7s done
#6 extracting sha256:f7dab3ab2d6ec29aa28769bec35331fb485b5837501b1e8556413d8b5a79c9c8 0.1s done
#6 DONE 0.9s

#7 [2/4] RUN apk add --no-cache curl docker-cli
#7 0.380 fetch https://dl-cdn.alpinelinux.org/alpine/v3.14/main/x86_64/APKINDEX.tar.gz
#7 0.624 fetch https://dl-cdn.alpinelinux.org/alpine/v3.14/community/x86_64/APKINDEX.tar.gz
#7 0.862 (1/6) Installing ca-certificates (20230506-r0)
#7 0.938 (2/6) Installing brotli-libs (1.0.9-r5)
#7 0.989 (3/6) Installing nghttp2-libs (1.43.0-r0)
#7 1.013 (4/6) Installing libcurl (8.0.1-r0)
#7 1.060 (5/6) Installing curl (8.0.1-r0)
#7 1.093 (6/6) Installing docker-cli (20.10.11-r1)
#7 2.651 Executing busybox-1.33.1-r8.trigger
#7 2.656 Executing ca-certificates-20230506-r0.trigger
#7 2.698 OK: 60 MiB in 20 packages
#7 DONE 3.3s

#8 [3/4] COPY exploit.sh /usr/local/bin/exploit.sh
#8 DONE 0.0s

#9 [4/4] RUN chmod +x /usr/local/bin/exploit.sh
#9 DONE 0.2s

#10 exporting to image
#10 exporting layers
#10 exporting layers 2.1s done
#10 exporting manifest sha256:cf1db0dd73124a2aa6edece8b09d93a41d2628d179e78fe09dcb1495956ed9c7 0.0s done
#10 exporting config sha256:8b3cb5495db1fce3885ae8758f4537abacf4b8ea5581db50b024fc14b49a1acd 0.0s done
#10 exporting attestation manifest sha256:c86f014a35de0caa267049e265c9d726a2461be0bd6bb12c33f62c894f73ad65 0.0s done
#10 exporting manifest list sha256:7bab13d5500dcaa9fe405406f82bb0c8eb2a811762c74fe169dde681e74379e5 0.0s done
#10 naming to docker.io/library/custom_no_tool-exploit-client:latest done
#10 unpacking to docker.io/library/custom_no_tool-exploit-client:latest
#10 unpacking to docker.io/library/custom_no_tool-exploit-client:latest 0.3s done
#10 DONE 2.5s

#11 resolving provenance for metadata file
#11 DONE 0.0s
 custom_no_tool-exploit-client  Built
 Network custom_no_tool_default  Creating
 Network custom_no_tool_default  Created
 Volume custom_no_tool_docker-data  Creating
 Volume custom_no_tool_docker-data  Created
 Container vulnerable_docker_engine  Creating
 Container vulnerable_docker_engine  Created
 Container exploit_client  Creating
 Container exploit_client  Created
 Container vulnerable_docker_engine  Starting
 Container vulnerable_docker_engine  Started
 Container exploit_client  Starting
 Container exploit_client  Started


sudo docker logs 02f62cd4826f4bc5e0d843614e43288c2e92226794eb416bd0072e28eb820f66 --details
STDOUT: 
STDERR:  Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?
 docker: Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?.
 See 'docker run --help'.
 Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?
 docker: Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?.
 See 'docker run --help'.
 Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?
 docker: Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?.
 See 'docker run --help'.
 Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?
 docker: Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?.
 See 'docker run --help'.
 Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?
 docker: Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?.
 See 'docker run --help'.
 Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?
 docker: Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?.
 See 'docker run --help'.
 Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?
 docker: Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?.
 See 'docker run --help'.
 Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?
 docker: Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?.
 See 'docker run --help'.
 Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?
 docker: Cannot connect to the Docker daemon at tcp://vulnerable-docker:2375. Is the docker daemon running?.
 See 'docker run --help'.




sudo docker inspect 02f62cd4826f4bc5e0d843614e43288c2e92226794eb416bd0072e28eb820f66[
    {
        "Id": "02f62cd4826f4bc5e0d843614e43288c2e92226794eb416bd0072e28eb820f66",
        "Created": "2025-10-31T18:52:31.341077343Z",
        "Path": "/usr/local/bin/exploit.sh",
        "Args": [],
        "State": {
            "Status": "restarting",
            "Running": true,
            "Paused": false,
            "Restarting": true,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 0,
            "ExitCode": 125,
            "Error": "",
            "StartedAt": "2025-10-31T18:52:58.678051306Z",
            "FinishedAt": "2025-10-31T18:52:58.85441178Z"
        },
        "Image": "sha256:7bab13d5500dcaa9fe405406f82bb0c8eb2a811762c74fe169dde681e74379e5",
        "ResolvConfPath": "/var/lib/docker/containers/d22b13e6cd45b4018dd207a18cf17670864682f66fbdab2c21c160a7ccbbc190/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/d22b13e6cd45b4018dd207a18cf17670864682f66fbdab2c21c160a7ccbbc190/hostname",
        "HostsPath": "/var/lib/docker/containers/d22b13e6cd45b4018dd207a18cf17670864682f66fbdab2c21c160a7ccbbc190/hosts",
        "LogPath": "/var/lib/docker/containers/02f62cd4826f4bc5e0d843614e43288c2e92226794eb416bd0072e28eb820f66/02f62cd4826f4bc5e0d843614e43288c2e92226794eb416bd0072e28eb820f66-json.log",
        "Name": "/exploit_client",
        "RestartCount": 9,
        "Driver": "overlayfs",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": null,
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "container:d22b13e6cd45b4018dd207a18cf17670864682f66fbdab2c21c160a7ccbbc190",
            "PortBindings": {},
            "RestartPolicy": {
                "Name": "unless-stopped",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "ConsoleSize": [
                0,
                0
            ],
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": null,
            "DnsOptions": null,
            "DnsSearch": null,
            "ExtraHosts": [],
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": false,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": null,
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": null,
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": null,
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": [
                "/proc/asound",
                "/proc/acpi",
                "/proc/interrupts",
                "/proc/kcore",
                "/proc/keys",
                "/proc/latency_stats",
                "/proc/timer_list",
                "/proc/timer_stats",
                "/proc/sched_debug",
                "/proc/scsi",
                "/sys/firmware",
                "/sys/devices/virtual/powercap"
            ],
            "ReadonlyPaths": [
                "/proc/bus",
                "/proc/fs",
                "/proc/irq",
                "/proc/sys",
                "/proc/sysrq-trigger"
            ]
        },
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "Mounts": [],
        "Config": {
            "Hostname": "d22b13e6cd45",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": true,
            "AttachStderr": true,
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "DOCKER_HOST=tcp://vulnerable-docker:2375",
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
            ],
            "Cmd": [
                "/usr/local/bin/exploit.sh"
            ],
            "Image": "custom_no_tool-exploit-client",
            "Volumes": null,
            "WorkingDir": "",
            "Entrypoint": null,
            "OnBuild": null,
            "Labels": {
                "com.docker.compose.config-hash": "6a0491366a02de5e2a34c2f2484c1811c3914f3e754582751600d8c0f9cc6f77",
                "com.docker.compose.container-number": "1",
                "com.docker.compose.depends_on": "vulnerable-docker:service_started:false",
                "com.docker.compose.image": "sha256:7bab13d5500dcaa9fe405406f82bb0c8eb2a811762c74fe169dde681e74379e5",
                "com.docker.compose.oneoff": "False",
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.project.config_files": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2021-42342/custom_no_tool/docker-compose.yml",
                "com.docker.compose.project.working_dir": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2021-42342/custom_no_tool",
                "com.docker.compose.service": "exploit-client",
                "com.docker.compose.version": "2.40.2",
                "desktop.docker.io/wsl-distro": "Ubuntu"
            },
            "StopTimeout": 1
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "",
            "SandboxKey": "",
            "Ports": {},
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "",
            "Gateway": "",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "",
            "IPPrefixLen": 0,
            "IPv6Gateway": "",
            "MacAddress": "",
            "Networks": {}
        },
        "ImageManifestDescriptor": {
            "mediaType": "application/vnd.oci.image.manifest.v1+json",
            "digest": "sha256:cf1db0dd73124a2aa6edece8b09d93a41d2628d179e78fe09dcb1495956ed9c7",
            "size": 1050,
            "platform": {
                "architecture": "amd64",
                "os": "linux"
            }
        }
    }
]