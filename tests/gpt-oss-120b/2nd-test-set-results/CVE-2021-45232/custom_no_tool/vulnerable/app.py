from flask import Flask, request, abort
app = Flask(__name__)

SAFE_COMMANDS = {
    "ls": ["ls", "-la"],
    "date": ["date"]
}

@app.route('/')
def index():
    cmd = request.args.get('cmd')
    if cmd:
        # Allow only predefined safe commands; otherwise reject
        if cmd not in SAFE_COMMANDS:
            abort(400, description="Invalid command")
        try:
            result = __import__('subprocess').run(
                SAFE_COMMANDS[cmd],
                capture_output=True,
                text=True,
                check=True
            )
            return f"<pre>{result.stdout}</pre>"
        except Exception as e:
            return f"Error executing command: {e}", 500
    return "Send a 'cmd' parameter with an allowed command (ls, date)."

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=80)
