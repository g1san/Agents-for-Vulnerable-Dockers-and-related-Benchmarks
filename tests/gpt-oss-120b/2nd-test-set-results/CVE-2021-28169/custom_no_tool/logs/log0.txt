time="2025-10-31T23:28:15+01:00" level=warning msg="/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2021-28169/custom_no_tool/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
 vulnerable_engine Pulling 
 37729eca12b0 Pulling fs layer 
 a10a29983da5 Pulling fs layer 
 ecf4fd0ec94f Pulling fs layer 
 9d603731314a Pulling fs layer 
 ba3557a56b15 Pulling fs layer 
 9c15410a69ce Pulling fs layer 
 20125e43a11b Pulling fs layer 
 ea357db94c21 Pulling fs layer 
 481567dc4673 Pulling fs layer 
 4888bd216d89 Pulling fs layer 
 94caa5d1da70 Pulling fs layer 
 37729eca12b0 Download complete 
 ba3557a56b15 Downloading [==================>                                ]  1.049MB/2.812MB
 ba3557a56b15 Downloading [==================>                                ]  1.049MB/2.812MB
 a10a29983da5 Download complete 
 481567dc4673 Download complete 
 4888bd216d89 Download complete 
 ba3557a56b15 Downloading [=====================================>             ]  2.097MB/2.812MB
 9d603731314a Download complete 
 9c15410a69ce Download complete 
 ea357db94c21 Download complete 
 ba3557a56b15 Download complete 
 ba3557a56b15 Extracting 1 s
 ba3557a56b15 Pull complete 
 94caa5d1da70 Downloading [=========================>                         ]  1.049MB/2.051MB
 20125e43a11b Downloading [=======>                                           ]  1.049MB/6.61MB
 94caa5d1da70 Downloading [=========================>                         ]  1.049MB/2.051MB
 ecf4fd0ec94f Downloading [>                                                  ]  950.3kB/69.69MB
 20125e43a11b Downloading [=======>                                           ]  1.049MB/6.61MB
 94caa5d1da70 Download complete 
 ecf4fd0ec94f Downloading [>                                                  ]  1.049MB/69.69MB
 94caa5d1da70 Extracting 1 s
 20125e43a11b Downloading [===============>                                   ]  2.097MB/6.61MB
 ecf4fd0ec94f Downloading [>                                                  ]  1.049MB/69.69MB
 94caa5d1da70 Pull complete 
 20125e43a11b Downloading [===============>                                   ]  2.097MB/6.61MB
 ecf4fd0ec94f Downloading [=>                                                 ]  2.097MB/69.69MB
 a10a29983da5 Pull complete 
 20125e43a11b Downloading [=======================>                           ]  3.146MB/6.61MB
 ecf4fd0ec94f Downloading [=>                                                 ]  2.097MB/69.69MB
 ecf4fd0ec94f Downloading [==>                                                ]  3.146MB/69.69MB
 20125e43a11b Downloading [=======================>                           ]  3.146MB/6.61MB
 20125e43a11b Downloading [===============================>                   ]  4.194MB/6.61MB
 ecf4fd0ec94f Downloading [==>                                                ]  3.146MB/69.69MB
 ecf4fd0ec94f Downloading [===>                                               ]  4.194MB/69.69MB
 20125e43a11b Downloading [===============================>                   ]  4.194MB/6.61MB
 20125e43a11b Downloading [=======================================>           ]  5.243MB/6.61MB
 ecf4fd0ec94f Downloading [===>                                               ]  4.194MB/69.69MB
 ecf4fd0ec94f Downloading [===>                                               ]  5.243MB/69.69MB
 20125e43a11b Downloading [=======================================>           ]  5.243MB/6.61MB
 ecf4fd0ec94f Downloading [===>                                               ]  5.243MB/69.69MB
 20125e43a11b Downloading [===============================================>   ]  6.291MB/6.61MB
 20125e43a11b Download complete 
 ecf4fd0ec94f Downloading [====>                                              ]  6.291MB/69.69MB
 ecf4fd0ec94f Downloading [=====>                                             ]   7.34MB/69.69MB
 ecf4fd0ec94f Downloading [======>                                            ]  8.389MB/69.69MB
 ecf4fd0ec94f Downloading [======>                                            ]  9.437MB/69.69MB
 ecf4fd0ec94f Downloading [=======>                                           ]  10.49MB/69.69MB
 ecf4fd0ec94f Downloading [========>                                          ]  11.53MB/69.69MB
 ecf4fd0ec94f Downloading [========>                                          ]  11.53MB/69.69MB
 ecf4fd0ec94f Downloading [=========>                                         ]  13.63MB/69.69MB
 ecf4fd0ec94f Downloading [==========>                                        ]  14.68MB/69.69MB
 ecf4fd0ec94f Downloading [===========>                                       ]  15.73MB/69.69MB
 ecf4fd0ec94f Downloading [===========>                                       ]  15.73MB/69.69MB
 ecf4fd0ec94f Downloading [============>                                      ]  16.78MB/69.69MB
 ecf4fd0ec94f Downloading [============>                                      ]  17.83MB/69.69MB
 ecf4fd0ec94f Downloading [=============>                                     ]  18.87MB/69.69MB
 ecf4fd0ec94f Downloading [==============>                                    ]  19.92MB/69.69MB
 ecf4fd0ec94f Downloading [===============>                                   ]  20.97MB/69.69MB
 ecf4fd0ec94f Downloading [===============>                                   ]  22.02MB/69.69MB
 ecf4fd0ec94f Downloading [================>                                  ]  23.07MB/69.69MB
 ecf4fd0ec94f Downloading [==================>                                ]  25.17MB/69.69MB
 ecf4fd0ec94f Downloading [==================>                                ]  26.21MB/69.69MB
 ecf4fd0ec94f Downloading [===================>                               ]  27.26MB/69.69MB
 ecf4fd0ec94f Downloading [====================>                              ]  28.31MB/69.69MB
 ecf4fd0ec94f Downloading [=====================>                             ]  29.36MB/69.69MB
 ecf4fd0ec94f Downloading [=====================>                             ]  30.41MB/69.69MB
 ecf4fd0ec94f Downloading [======================>                            ]  31.46MB/69.69MB
 ecf4fd0ec94f Downloading [=======================>                           ]  32.51MB/69.69MB
 ecf4fd0ec94f Downloading [========================>                          ]  33.55MB/69.69MB
 ecf4fd0ec94f Downloading [========================>                          ]   34.6MB/69.69MB
 ecf4fd0ec94f Downloading [=========================>                         ]  35.65MB/69.69MB
 ecf4fd0ec94f Downloading [==========================>                        ]   36.7MB/69.69MB
 ecf4fd0ec94f Downloading [===========================>                       ]  37.75MB/69.69MB
 ecf4fd0ec94f Downloading [===========================>                       ]   38.8MB/69.69MB
 ecf4fd0ec94f Downloading [============================>                      ]  39.85MB/69.69MB
 ecf4fd0ec94f Downloading [=============================>                     ]  40.89MB/69.69MB
 ecf4fd0ec94f Downloading [==============================>                    ]  41.94MB/69.69MB
 ecf4fd0ec94f Downloading [==============================>                    ]  42.99MB/69.69MB
 ecf4fd0ec94f Downloading [===============================>                   ]  44.04MB/69.69MB
 ecf4fd0ec94f Downloading [================================>                  ]  45.09MB/69.69MB
 ecf4fd0ec94f Downloading [================================>                  ]  45.09MB/69.69MB
 ecf4fd0ec94f Downloading [=================================>                 ]  46.14MB/69.69MB
 ecf4fd0ec94f Downloading [=================================>                 ]  47.19MB/69.69MB
 ecf4fd0ec94f Downloading [==================================>                ]  48.23MB/69.69MB
 ecf4fd0ec94f Downloading [===================================>               ]  49.28MB/69.69MB
 ecf4fd0ec94f Downloading [===================================>               ]  49.28MB/69.69MB
 ecf4fd0ec94f Downloading [====================================>              ]  50.33MB/69.69MB
 ecf4fd0ec94f Downloading [====================================>              ]  51.38MB/69.69MB
 ecf4fd0ec94f Downloading [=====================================>             ]  52.43MB/69.69MB
 ecf4fd0ec94f Downloading [======================================>            ]  53.48MB/69.69MB
 ecf4fd0ec94f Downloading [=======================================>           ]  54.53MB/69.69MB
 ecf4fd0ec94f Downloading [========================================>          ]  56.62MB/69.69MB
 ecf4fd0ec94f Downloading [=========================================>         ]  57.67MB/69.69MB
 ecf4fd0ec94f Downloading [==========================================>        ]  58.72MB/69.69MB
 ecf4fd0ec94f Downloading [==========================================>        ]  58.72MB/69.69MB
 ecf4fd0ec94f Downloading [===========================================>       ]  60.82MB/69.69MB
 ecf4fd0ec94f Downloading [============================================>      ]  61.87MB/69.69MB
 ecf4fd0ec94f Downloading [=============================================>     ]  62.91MB/69.69MB
 ecf4fd0ec94f Downloading [=============================================>     ]  63.96MB/69.69MB
 ecf4fd0ec94f Downloading [==============================================>    ]  65.01MB/69.69MB
 ecf4fd0ec94f Downloading [===============================================>   ]  66.06MB/69.69MB
 ecf4fd0ec94f Downloading [================================================>  ]  67.11MB/69.69MB
 ecf4fd0ec94f Downloading [================================================>  ]  68.16MB/69.69MB
 ecf4fd0ec94f Downloading [=================================================> ]  69.21MB/69.69MB
 ecf4fd0ec94f Downloading [==================================================>]  69.69MB/69.69MB
 ecf4fd0ec94f Download complete 
 ecf4fd0ec94f Extracting 1 s
 ecf4fd0ec94f Extracting 1 s
 ecf4fd0ec94f Extracting 1 s
 ecf4fd0ec94f Extracting 1 s
 ecf4fd0ec94f Extracting 1 s
 ecf4fd0ec94f Extracting 1 s
 ecf4fd0ec94f Extracting 1 s
 ecf4fd0ec94f Extracting 1 s
 ecf4fd0ec94f Extracting 1 s
 ecf4fd0ec94f Extracting 1 s
 ecf4fd0ec94f Extracting 1 s
 ecf4fd0ec94f Pull complete 
 37729eca12b0 Pull complete 
 481567dc4673 Pull complete 
 4888bd216d89 Pull complete 
 20125e43a11b Extracting 1 s
 20125e43a11b Pull complete 
 9d603731314a Pull complete 
 9c15410a69ce Pull complete 
 ea357db94c21 Pull complete 
 vulnerable_engine Pulled 
#1 [internal] load local bake definitions
#1 reading from stdin 727B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile: 175B done
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/library/alpine:3.14
#3 DONE 1.0s

#4 [internal] load .dockerignore
#4 transferring context: 2B done
#4 DONE 0.0s

#5 [1/4] FROM docker.io/library/alpine:3.14@sha256:0f2d5c38dd7a4f4f733e688e3a6733cb5ab1ac6e3cb4603a5dd564e5bfb80eed
#5 resolve docker.io/library/alpine:3.14@sha256:0f2d5c38dd7a4f4f733e688e3a6733cb5ab1ac6e3cb4603a5dd564e5bfb80eed 0.0s done
#5 CACHED

#6 [internal] load build context
#6 transferring context: 533B done
#6 DONE 0.0s

#7 [2/4] RUN apk add --no-cache docker-cli
#7 0.363 fetch https://dl-cdn.alpinelinux.org/alpine/v3.14/main/x86_64/APKINDEX.tar.gz
#7 0.661 fetch https://dl-cdn.alpinelinux.org/alpine/v3.14/community/x86_64/APKINDEX.tar.gz
#7 0.942 (1/2) Installing ca-certificates (20230506-r0)
#7 0.993 (2/2) Installing docker-cli (20.10.11-r1)
#7 4.178 Executing busybox-1.33.1-r8.trigger
#7 4.187 Executing ca-certificates-20230506-r0.trigger
#7 4.227 OK: 58 MiB in 16 packages
#7 DONE 4.8s

#8 [3/4] COPY trigger.sh /trigger.sh
#8 DONE 0.0s

#9 [4/4] RUN chmod +x /trigger.sh
#9 DONE 0.2s

#10 exporting to image
#10 exporting layers
#10 exporting layers 2.0s done
#10 exporting manifest sha256:b87d284fd8433cd29bec4f0fa3283280bc305ee45ce1452e6cb690ef004d8933 0.0s done
#10 exporting config sha256:e6a94d37fc46677649605254a621663406feefefd3d91f9f61b45fbc58a61515 0.0s done
#10 exporting attestation manifest sha256:3c37862ebc0f304729c430f9e21022e72a59dd40d1ce99bfb3ee7c11d3f859e1 0.0s done
#10 exporting manifest list sha256:67b156047a9652b2eaed6d3ef027e36a19454b7f23a1212f81f256af59e67cf5 0.0s done
#10 naming to docker.io/library/custom_no_tool-exploiter:latest done
#10 unpacking to docker.io/library/custom_no_tool-exploiter:latest
#10 unpacking to docker.io/library/custom_no_tool-exploiter:latest 0.4s done
#10 DONE 2.5s

#11 resolving provenance for metadata file
#11 DONE 0.0s
 custom_no_tool-exploiter  Built
 Network custom_no_tool_default  Creating
 Network custom_no_tool_default  Created
 Container custom_no_tool-vulnerable_engine-1  Creating
 Container custom_no_tool-vulnerable_engine-1  Created
 Container custom_no_tool-exploiter-1  Creating
 Container custom_no_tool-exploiter-1  Created
 Container custom_no_tool-vulnerable_engine-1  Starting
 Container custom_no_tool-vulnerable_engine-1  Started
 Container custom_no_tool-exploiter-1  Starting
 Container custom_no_tool-exploiter-1  Started


sudo docker logs 61d33d20594ef562767f86fbe5c9eb05e935da02e5102c31354ef26ede72f3eb --details
STDOUT:  Exploit attempt finished. If you see host filesystem listings above, the vulnerability is present.

STDERR:  docker: Cannot connect to the Docker daemon at tcp://vulnerable_engine:2375. Is the docker daemon running?.
 See 'docker run --help'.




sudo docker inspect 61d33d20594ef562767f86fbe5c9eb05e935da02e5102c31354ef26ede72f3eb[
    {
        "Id": "61d33d20594ef562767f86fbe5c9eb05e935da02e5102c31354ef26ede72f3eb",
        "Created": "2025-10-31T22:28:37.524894566Z",
        "Path": "sh",
        "Args": [
            "/trigger.sh",
            "sh",
            "/trigger.sh"
        ],
        "State": {
            "Status": "exited",
            "Running": false,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 0,
            "ExitCode": 0,
            "Error": "",
            "StartedAt": "2025-10-31T22:28:37.857455742Z",
            "FinishedAt": "2025-10-31T22:28:38.026334321Z"
        },
        "Image": "sha256:67b156047a9652b2eaed6d3ef027e36a19454b7f23a1212f81f256af59e67cf5",
        "ResolvConfPath": "/var/lib/docker/containers/61d33d20594ef562767f86fbe5c9eb05e935da02e5102c31354ef26ede72f3eb/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/61d33d20594ef562767f86fbe5c9eb05e935da02e5102c31354ef26ede72f3eb/hostname",
        "HostsPath": "/var/lib/docker/containers/61d33d20594ef562767f86fbe5c9eb05e935da02e5102c31354ef26ede72f3eb/hosts",
        "LogPath": "/var/lib/docker/containers/61d33d20594ef562767f86fbe5c9eb05e935da02e5102c31354ef26ede72f3eb/61d33d20594ef562767f86fbe5c9eb05e935da02e5102c31354ef26ede72f3eb-json.log",
        "Name": "/custom_no_tool-exploiter-1",
        "RestartCount": 0,
        "Driver": "overlayfs",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": null,
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "custom_no_tool_default",
            "PortBindings": {},
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "ConsoleSize": [
                0,
                0
            ],
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": null,
            "DnsOptions": null,
            "DnsSearch": null,
            "ExtraHosts": [],
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": false,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": null,
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": null,
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": null,
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": [
                "/proc/asound",
                "/proc/acpi",
                "/proc/interrupts",
                "/proc/kcore",
                "/proc/keys",
                "/proc/latency_stats",
                "/proc/timer_list",
                "/proc/timer_stats",
                "/proc/sched_debug",
                "/proc/scsi",
                "/sys/firmware",
                "/sys/devices/virtual/powercap"
            ],
            "ReadonlyPaths": [
                "/proc/bus",
                "/proc/fs",
                "/proc/irq",
                "/proc/sys",
                "/proc/sysrq-trigger"
            ]
        },
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "Mounts": [],
        "Config": {
            "Hostname": "61d33d20594e",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": true,
            "AttachStderr": true,
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "DOCKER_HOST=tcp://vulnerable_engine:2375",
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
            ],
            "Cmd": [
                "sh",
                "/trigger.sh"
            ],
            "Image": "custom_no_tool-exploiter",
            "Volumes": null,
            "WorkingDir": "",
            "Entrypoint": [
                "sh",
                "/trigger.sh"
            ],
            "OnBuild": null,
            "Labels": {
                "com.docker.compose.config-hash": "3541e795e8b7a678b306f162d8af46d25a7071ccfd9794c3948d06f3c2f01369",
                "com.docker.compose.container-number": "1",
                "com.docker.compose.depends_on": "vulnerable_engine:service_started:false",
                "com.docker.compose.image": "sha256:67b156047a9652b2eaed6d3ef027e36a19454b7f23a1212f81f256af59e67cf5",
                "com.docker.compose.oneoff": "False",
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.project.config_files": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2021-28169/custom_no_tool/docker-compose.yml",
                "com.docker.compose.project.working_dir": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2021-28169/custom_no_tool",
                "com.docker.compose.service": "exploiter",
                "com.docker.compose.version": "2.40.2",
                "desktop.docker.io/wsl-distro": "Ubuntu"
            },
            "StopTimeout": 1
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "",
            "SandboxKey": "",
            "Ports": {},
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "",
            "Gateway": "",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "",
            "IPPrefixLen": 0,
            "IPv6Gateway": "",
            "MacAddress": "",
            "Networks": {
                "custom_no_tool_default": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": [
                        "custom_no_tool-exploiter-1",
                        "exploiter"
                    ],
                    "MacAddress": "",
                    "DriverOpts": null,
                    "GwPriority": 0,
                    "NetworkID": "1abb38f283697ddbe3181a04503e5226e809033b440ebf3d892d3ced7bee1916",
                    "EndpointID": "",
                    "Gateway": "",
                    "IPAddress": "",
                    "IPPrefixLen": 0,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "DNSNames": [
                        "custom_no_tool-exploiter-1",
                        "exploiter",
                        "61d33d20594e"
                    ]
                }
            }
        },
        "ImageManifestDescriptor": {
            "mediaType": "application/vnd.oci.image.manifest.v1+json",
            "digest": "sha256:b87d284fd8433cd29bec4f0fa3283280bc305ee45ce1452e6cb690ef004d8933",
            "size": 1050,
            "platform": {
                "architecture": "amd64",
                "os": "linux"
            }
        }
    }
]