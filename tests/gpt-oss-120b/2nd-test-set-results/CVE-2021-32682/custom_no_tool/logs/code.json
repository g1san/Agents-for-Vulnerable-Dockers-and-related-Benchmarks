{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-32682/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  vulnerable-app:\n    build: ./app\n    ports:\n      - \"5000:5000\"\n    environment:\n      - FLASK_APP=app.py\n  elfinder:\n    build: ./elfinder\n    ports:\n      - \"8080:80\"\n"
        },
        {
            "location": "./../../dockers/CVE-2021-32682/custom_no_tool/app/Dockerfile",
            "content": "FROM python:3.8-slim\nWORKDIR /usr/src/app\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\nCOPY . .\nENV FLASK_APP=app.py\nEXPOSE 5000\nCMD [\"python\",\"-m\",\"flask\",\"run\",\"--host=0.0.0.0\",\"--port=5000\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2021-32682/custom_no_tool/app/requirements.txt",
            "content": "flask==2.2.5\n"
        },
        {
            "location": "./../../dockers/CVE-2021-32682/custom_no_tool/app/app.py",
            "content": "from flask import Flask, request, abort, send_file\nimport os\napp = Flask(__name__)\n\n@app.route('/')\ndef index():\n    return 'Vulnerable Flask app ready.'\n\n# Vulnerable endpoint illustrating the kind of issue tracked by CVE-2021-32682\n# It reads a file path from the query parameter 'path' and returns its content\n# without proper validation, leading to arbitrary file read.\n@app.route('/read')\ndef read_file():\n    file_path = request.args.get('path')\n    if not file_path:\n        abort(400, 'Missing \"path\" parameter')\n    # NOTE: No sanitization \u2013 this is intentional for the CVE demonstration.\n    try:\n        # Resolve to absolute path to mimic typical vulnerable behavior\n        abs_path = os.path.abspath(file_path)\n        return send_file(abs_path)\n    except Exception as e:\n        abort(404, str(e))\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000)\n"
        },
        {
            "location": "./../../dockers/CVE-2021-32682/custom_no_tool/elfinder/Dockerfile",
            "content": "FROM php:8.0-apache\n# Install unzip and curl for fetching elFinder source\nRUN apt-get update && apt-get install -y unzip curl && rm -rf /var/lib/apt/lists/*\n# Download a vulnerable version of elFinder (2.1.57) and extract it\nRUN curl -L -o /tmp/elfinder.zip https://github.com/Studio-42/elFinder/archive/refs/tags/2.1.57.zip \\\n    && unzip /tmp/elfinder.zip -d /var/www/html \\\n    && mv /var/www/html/elFinder-2.1.57 /var/www/html/elfinder \\\n    && chown -R www-data:www-data /var/www/html/elfinder \\\n    && rm /tmp/elfinder.zip\n# Enable Apache rewrite module (optional, but common for elFinder)\nRUN a2enmod rewrite\nEXPOSE 80\n"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2021-32682/custom_no_tool"
}