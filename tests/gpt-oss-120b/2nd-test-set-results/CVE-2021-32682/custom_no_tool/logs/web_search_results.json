{
    "desc": "CVE\u20112021\u201132682 is a critical vulnerability in the elFinder web\u2011based file manager. The flaw resides in the default PHP connector (e.g., `connector.minimal.php` or `connector.php`) that ships with elFinder versions up to 2.1.58. The connector mishandles user\u2011controlled parameters in several commands \u2013 notably the `upload`, `mkfile`, and `archive` commands. It fails to properly validate uploaded file names, MIME types, and path components, allowing an attacker to:\n1. Upload a file with a `.php` (or other executable) extension disguised as an allowed type and execute it directly via a web request.\n2. Perform directory\u2011traversal and arbitrary file\u2011move/rename operations, enabling replacement of critical configuration files.\n3. Inject arguments into the system `zip` utility through the `archive` command, leading to execution of arbitrary shell commands.\nThese primitives can be chained to achieve unauthenticated remote code execution with the privileges of the web\u2011server process, resulting in full server compromise, data theft, and persistence. The vulnerability is present in all releases of elFinder prior to 2.1.59; patches released in 2.1.59 address path validation, block `.phar` uploads, and harden the archive command.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "elfinder",
            "version": [
                "2.1.57",
                "2.1.58"
            ],
            "dependency_type": "HARD",
            "description": "Vulnerable PHP connector for elFinder; provides the file\u2011manager endpoint that contains the insecure upload and archive handling allowing exploitation of CVE\u20112021\u201132682."
        },
        {
            "name": "php",
            "version": [
                "8.0-apache"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Web server with PHP interpreter required to run the elFinder connector; serves the vulnerable PHP files and executes uploaded payloads."
        }
    ],
    "input_tokens": 11576,
    "output_tokens": 2481
}