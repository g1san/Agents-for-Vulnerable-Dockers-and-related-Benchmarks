{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-21311/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  docker:\n    image: docker:20.10.5-dind\n    privileged: true\n    environment:\n      - DOCKER_TLS_CERTDIR=\n    ports:\n      - \"2375:2375\"\n    command: [\"dockerd\", \"-H\", \"tcp://0.0.0.0:2375\", \"-H\", \"unix:///var/run/docker.sock\"]\n  php:\n    image: php:8.2-apache\n    ports:\n      - \"80:80\"\n    volumes:\n      - adminer_www:/var/www/html\n  adminer:\n    build: ./adminer\n    depends_on:\n      - php\n    ports:\n      - \"8080:80\"\n    volumes:\n      - adminer_www:/var/www/html\n  vulnerable-app:\n    build: ./vulnerable-app\n    depends_on:\n      - docker\n      - php\n      - adminer\n    ports:\n      - \"5000:5000\"\n    environment:\n      - DOCKER_HOST=tcp://docker:2375\nvolumes:\n  adminer_www:\n"
        },
        {
            "location": "./../../dockers/CVE-2021-21311/custom_no_tool/vulnerable-app/Dockerfile",
            "content": "FROM python:3.9-slim\nWORKDIR /app\nCOPY app.py .\nRUN apt-get update && apt-get install -y docker-cli \\\n    && pip install --no-cache-dir flask \\\n    && rm -rf /var/lib/apt/lists/*\nENV DOCKER_HOST=tcp://docker:2375\nCMD [\"python\", \"app.py\"]"
        },
        {
            "location": "./../../dockers/CVE-2021-21311/custom_no_tool/vulnerable-app/app.py",
            "content": "from flask import Flask, request, jsonify\nimport subprocess, time\n\napp = Flask(__name__)\n\ndef wait_for_docker():\n    for _ in range(10):\n        try:\n            subprocess.check_output([\"docker\", \"info\"], stderr=subprocess.STDOUT)\n            return True\n        except Exception:\n            time.sleep(1)\n    return False\n\n@app.route('/')\ndef index():\n    return \"Vulnerable App Running\"\n\n@app.route('/exploit', methods=['POST'])\ndef exploit():\n    server = request.form.get('server')\n    # Placeholder for SSRF exploitation logic\n    return jsonify({\"message\": \"Received\", \"server\": server})\n\nif __name__ == '__main__':\n    wait_for_docker()\n    app.run(host='0.0.0.0', port=5000)\n"
        },
        {
            "location": "./../../dockers/CVE-2021-21311/custom_no_tool/adminer/Dockerfile",
            "content": "FROM php:8.2-apache\nWORKDIR /var/www/html\nCOPY adminer-4.7.8.php index.php\nEXPOSE 80\nCMD [\"apache2-foreground\"]"
        },
        {
            "location": "./../../dockers/CVE-2021-21311/custom_no_tool/adminer/adminer-4.7.8.php",
            "content": "<?php\n// Vulnerable Adminer version 4.7.8 placeholder\necho \"Adminer 4.7.8\";\n?>"
        }
    ],
    "directory_tree": "CVE-2021-21311/custom_no_tool/"
}