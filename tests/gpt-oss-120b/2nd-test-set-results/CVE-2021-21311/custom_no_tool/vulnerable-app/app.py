from flask import Flask, request, jsonify
import subprocess, time

app = Flask(__name__)

def wait_for_docker():
    for _ in range(10):
        try:
            subprocess.check_output(["docker", "info"], stderr=subprocess.STDOUT)
            return True
        except Exception:
            time.sleep(1)
    return False

@app.route('/')
def index():
    return "Vulnerable App Running"

@app.route('/exploit', methods=['POST'])
def exploit():
    server = request.form.get('server')
    # Placeholder for SSRF exploitation logic
    return jsonify({"message": "Received", "server": server})

if __name__ == '__main__':
    wait_for_docker()
    app.run(host='0.0.0.0', port=5000)
