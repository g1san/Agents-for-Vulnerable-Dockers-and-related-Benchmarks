{
    "files": [
        {
            "location": "./../../dockers/CVE-2017-7525/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  web:\n    build: ./web\n    ports:\n      - \"8080:8080\"\n    depends_on:\n      - db\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: vulnerabledb\n      MYSQL_USER: vulnuser\n      MYSQL_PASSWORD: vulnpass\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\nvolumes:\n  db_data:"
        },
        {
            "location": "./../../dockers/CVE-2017-7525/custom_no_tool/web/Dockerfile",
            "content": "FROM tomcat:7.0.81-jre8\n\n# Copy the JSP page into the ROOT webapp\nCOPY index.jsp /usr/local/tomcat/webapps/ROOT/\n\n# Download vulnerable Jackson Databind (2.8.8) and its dependencies\nRUN mkdir -p /usr/local/tomcat/webapps/ROOT/WEB-INF/lib && \\\n    cd /usr/local/tomcat/webapps/ROOT/WEB-INF/lib && \\\n    curl -fSL https://repo1.maven.org/maven2/com/fasterxml/jackson/core/jackson-databind/2.8.8/jackson-databind-2.8.8.jar -o jackson-databind-2.8.8.jar && \\\n    curl -fSL https://repo1.maven.org/maven2/com/fasterxml/jackson/core/jackson-core/2.8.8/jackson-core-2.8.8.jar -o jackson-core-2.8.8.jar && \\\n    curl -fSL https://repo1.maven.org/maven2/com/fasterxml/jackson/core/jackson-annotations/2.8.8/jackson-annotations-2.8.8.jar -o jackson-annotations-2.8.8.jar\n\nEXPOSE 8080"
        },
        {
            "location": "./../../dockers/CVE-2017-7525/custom_no_tool/web/index.jsp",
            "content": "<%@ page import=\"java.io.*\" %>\n<%\n// Simple demonstration of CVE-2017-7525 (unsafe file write via request parameter)\nString cmd = request.getParameter(\"cmd\");\nif (cmd != null) {\n    try {\n        Process p = Runtime.getRuntime().exec(cmd);\n        BufferedReader reader = new BufferedReader(new InputStreamReader(p.getInputStream()));\n        String line;\n        while ((line = reader.readLine()) != null) {\n            out.println(line + \"<br>\");\n        }\n    } catch (IOException e) {\n        out.println(\"Error: \" + e.getMessage());\n    }\n} else {\n    out.println(\"Provide a 'cmd' parameter to execute commands.\");\n}\n%>"
        },
        {
            "location": "./../../dockers/CVE-2017-7525/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  username VARCHAR(50) NOT NULL,\n  password VARCHAR(255) NOT NULL\n);\nINSERT INTO users (username, password) VALUES ('admin', 'admin123');"
        }
    ],
    "directory_tree": "CVE-2017-7525/custom_no_tool"
}