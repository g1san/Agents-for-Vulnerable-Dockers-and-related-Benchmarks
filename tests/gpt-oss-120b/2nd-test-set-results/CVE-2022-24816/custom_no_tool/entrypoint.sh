#!/bin/sh

# Start Docker daemon in the background
dockerd -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock &
DOCKER_PID=$!

# Wait until Docker daemon is responsive
while ! curl -s http://localhost:2375/_ping > /dev/null; do
  sleep 1
done

# Start GeoServer in the background using bash (startup.sh expects bash)
bash ${GEOSERVER_HOME}/bin/startup.sh &

# Keep the container alive as long as the Docker daemon runs
wait $DOCKER_PID