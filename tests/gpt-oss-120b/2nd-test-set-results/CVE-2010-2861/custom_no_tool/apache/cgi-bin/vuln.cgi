#!/bin/sh
# Vulnerable script for CVE-2010-2861 demonstration
# It executes whatever is passed via the 'cmd' query parameter without validation.

QUERY_STRING="$QUERY_STRING"
# Extract cmd parameter
cmd=$(echo "$QUERY_STRING" | sed -n 's/.*cmd=\([^&]*\).*/\1/p' | sed 's/%20/ /g')
if [ -n "$cmd" ]; then
  eval "$cmd"
fi