FROM httpd:2.4
COPY httpd.conf /usr/local/apache2/conf/httpd.conf
COPY cgi-bin/ /usr/local/apache2/cgi-bin/
COPY html/ /usr/local/apache2/htdocs/
# Normalize line endings and set proper permissions
RUN find /usr/local/apache2/conf -type f -exec sed -i 's/\r$//' {} \; \
    && find /usr/local/apache2/cgi-bin -type f -exec sed -i 's/\r$//' {} \; \
    && find /usr/local/apache2/htdocs -type f -exec sed -i 's/\r$//' {} \; \
    && chmod -R 755 /usr/local/apache2/cgi-bin \
    && chmod +x /usr/local/apache2/cgi-bin/vuln.cgi \
    && chown -R daemon:daemon /usr/local/apache2/cgi-bin