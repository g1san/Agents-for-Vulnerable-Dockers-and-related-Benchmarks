{
    "files": [
        {
            "location": "./../../dockers/CVE-2010-2861/custom_no_tool/docker-compose.yml",
            "content": "services:\n  vulnerable-apache:\n    build: ./apache\n    ports:\n      - \"8080:80\"\n    volumes:\n      - ./apache/html:/usr/local/apache2/htdocs"
        },
        {
            "location": "./../../dockers/CVE-2010-2861/custom_no_tool/apache/Dockerfile",
            "content": "FROM httpd:2.4\nCOPY httpd.conf /usr/local/apache2/conf/httpd.conf\nCOPY cgi-bin/ /usr/local/apache2/cgi-bin/\nCOPY html/ /usr/local/apache2/htdocs/\n# Normalize line endings and set proper permissions\nRUN find /usr/local/apache2/conf -type f -exec sed -i 's/\\r$//' {} \\; \\\n    && find /usr/local/apache2/cgi-bin -type f -exec sed -i 's/\\r$//' {} \\; \\\n    && find /usr/local/apache2/htdocs -type f -exec sed -i 's/\\r$//' {} \\; \\\n    && chmod -R 755 /usr/local/apache2/cgi-bin \\\n    && chmod +x /usr/local/apache2/cgi-bin/vuln.cgi \\\n    && chown -R daemon:daemon /usr/local/apache2/cgi-bin"
        },
        {
            "location": "./../../dockers/CVE-2010-2861/custom_no_tool/apache/httpd.conf",
            "content": "ServerRoot \"/usr/local/apache2\"\nListen 80\nLoadModule mpm_prefork_module modules/mod_mpm_prefork.so\nLoadModule cgi_module modules/mod_cgi.so\nLoadModule mime_module modules/mod_mime.so\nLoadModule alias_module modules/mod_alias.so\nLoadModule dir_module modules/mod_dir.so\nLoadModule authz_core_module modules/mod_authz_core.so\nLoadModule authz_host_module modules/mod_authz_host.so\nServerName localhost\nAddHandler cgi-script .cgi\nScriptAlias /cgi-bin/ /usr/local/apache2/cgi-bin/\nDirectoryIndex index.html\nDocumentRoot \"/usr/local/apache2/htdocs\"\n<Directory \"/usr/local/apache2/cgi-bin\">\n    Options +ExecCGI\n    AllowOverride None\n    Require all granted\n</Directory>"
        },
        {
            "location": "./../../dockers/CVE-2010-2861/custom_no_tool/apache/cgi-bin/vuln.cgi",
            "content": "#!/bin/sh\n# Vulnerable script for CVE-2010-2861 demonstration\n# It executes whatever is passed via the 'cmd' query parameter without validation.\n\nQUERY_STRING=\"$QUERY_STRING\"\n# Extract cmd parameter\ncmd=$(echo \"$QUERY_STRING\" | sed -n 's/.*cmd=\\([^&]*\\).*/\\1/p' | sed 's/%20/ /g')\nif [ -n \"$cmd\" ]; then\n  eval \"$cmd\"\nfi"
        },
        {
            "location": "./../../dockers/CVE-2010-2861/custom_no_tool/apache/html/index.html",
            "content": "<html>\n<head><title>Vulnerable Apache Service</title></head>\n<body>\n<h1>Apache Service vulnerable to CVE-2010-2861</h1>\n<p>Use the /cgi-bin/vuln.cgi endpoint with a <code>cmd</code> query parameter to trigger command execution.</p>\n</body>\n</html>"
        }
    ],
    "directory_tree": "custom_no_tool/\n\u251c\u2500 docker-compose.yml\n\u2514\u2500 apache/\n   \u251c\u2500 Dockerfile\n   \u251c\u2500 httpd.conf\n   \u251c\u2500 cgi-bin/\n   \u2502   \u2514\u2500 vuln.cgi\n   \u2514\u2500 html/\n       \u2514\u2500 index.html"
}