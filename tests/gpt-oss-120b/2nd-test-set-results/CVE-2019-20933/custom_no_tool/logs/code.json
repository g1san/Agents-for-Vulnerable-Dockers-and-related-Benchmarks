{
    "files": [
        {
            "location": "./../../dockers/CVE-2019-20933/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  web:\n    build: ./app\n    ports:\n      - \"5000:5000\"\n    environment:\n      - FLASK_APP=app.py\n    restart: unless-stopped"
        },
        {
            "location": "./../../dockers/CVE-2019-20933/custom_no_tool/app/Dockerfile",
            "content": "FROM python:3.9-slim\nWORKDIR /app\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\nCOPY . .\nCMD [\"python\", \"app.py\"]"
        },
        {
            "location": "./../../dockers/CVE-2019-20933/custom_no_tool/app/requirements.txt",
            "content": "Flask==2.0.1\nWerkzeug==2.0.3\nPyYAML==3.12"
        },
        {
            "location": "./../../dockers/CVE-2019-20933/custom_no_tool/app/app.py",
            "content": "from flask import Flask, request, jsonify\nimport yaml\n\napp = Flask(__name__)\n\n@app.route('/load', methods=['POST'])\ndef load_yaml():\n    data = request.get_data(as_text=True)\n    # Safe yaml loading to avoid RCE\n    try:\n        loaded = yaml.safe_load(data)\n        return jsonify({\"status\": \"success\", \"data\": loaded})\n    except Exception as e:\n        return jsonify({\"status\": \"error\", \"error\": str(e)}), 400\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000)\n"
        }
    ],
    "directory_tree": "CVE-2019-20933/custom_no_tool"
}