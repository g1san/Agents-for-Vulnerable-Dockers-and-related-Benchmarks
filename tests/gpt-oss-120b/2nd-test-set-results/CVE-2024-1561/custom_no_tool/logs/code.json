{
    "files": [
        {
            "location": "./../../dockers/CVE-2024-1561/custom_no_tool/docker-compose.yml",
            "content": "services:\n  web:\n    build: ./app\n    ports:\n      - \"5000:5000\"\n    environment:\n      - FLASK_APP=app.py\n      - FLASK_ENV=development"
        },
        {
            "location": "./../../dockers/CVE-2024-1561/custom_no_tool/app/Dockerfile",
            "content": "FROM python:3.11-slim\nWORKDIR /app\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\nCOPY . .\nCMD [\"flask\", \"run\", \"--host=0.0.0.0\", \"--port=5000\"]"
        },
        {
            "location": "./../../dockers/CVE-2024-1561/custom_no_tool/app/requirements.txt",
            "content": "flask\ngradio==4.12.0"
        },
        {
            "location": "./../../dockers/CVE-2024-1561/custom_no_tool/app/app.py",
            "content": "from flask import Flask, request, abort, send_file\nfrom werkzeug.utils import safe_join\nimport os\n\napp = Flask(__name__)\n\n# Define a safe directory from which files can be served\nSAFE_DIR = os.path.abspath(os.path.join(os.path.dirname(__file__), \"static\"))\n\n@app.route('/')\ndef index():\n    # Simple welcome message\n    return \"Flask app is running. Use /file?name=yourfile.txt to download files from the safe directory.\", 200\n\n@app.route('/file')\ndef get_file():\n    filename = request.args.get('name')\n    if not filename:\n        return 'Specify name parameter', 400\n    # Ensure the filename does not contain path traversal characters\n    if '/' in filename or '\\\\' in filename:\n        return 'Invalid filename', 400\n    # Build safe absolute path within SAFE_DIR\n    file_path = safe_join(SAFE_DIR, filename)\n    if not file_path:\n        return 'Invalid path', 400\n    if not os.path.isfile(file_path):\n        return 'File not found', 404\n    return send_file(file_path, as_attachment=True)\n\nif __name__ == '__main__':\n    # Listen on all interfaces for easy testing\n    app.run(host='0.0.0.0', port=5000)"
        },
        {
            "location": "./../../dockers/CVE-2024-1561/custom_no_tool/app/static/hello.txt",
            "content": "Hello, this is a safe test file."
        }
    ],
    "directory_tree": "CVE-2024-1561/custom_no_tool"
}