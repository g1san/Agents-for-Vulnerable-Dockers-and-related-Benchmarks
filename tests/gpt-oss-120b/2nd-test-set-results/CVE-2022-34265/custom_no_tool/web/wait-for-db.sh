#!/bin/sh
# Simple script to wait for PostgreSQL to become available
set -e

HOST=${DB_HOST:-db}
PORT=${DB_PORT:-5432}
USER=${DB_USER:-django_user}
DB=${DB_NAME:-django_db}

until pg_isready -h "$HOST" -p "$PORT" -U "$USER" -d "$DB" >/dev/null 2>&1; do
  echo "Waiting for PostgreSQL at $HOST:$PORT..."
  sleep 2
done

echo "PostgreSQL is ready."
exec "$@"