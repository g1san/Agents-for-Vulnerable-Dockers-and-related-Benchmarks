{
    "desc": "CVE\u20112019\u20113396 is a critical server\u2011side template injection vulnerability in Atlassian Confluence Server and Data Center. The flaw resides in the Widget Connector macro (also used by the TinyMCE macro preview endpoint). The macro accepts a parameter named `_template` that specifies a Velocity template to be rendered. The value of this parameter is not validated, allowing an attacker to supply a file, FTP or HTTP URL that points to a malicious Velocity template. When the template is processed by Confluence's Velocity engine, the attacker can inject OGNL/Velocity code that executes arbitrary Java commands via `java.lang.Runtime.getRuntime().exec(...)`. Because the macro can be invoked without authentication (any remote user can send a crafted JSON payload to the `/rest/tinymce/1/macro/preview` endpoint or embed the macro in a page), the vulnerability permits unauthenticated remote code execution, arbitrary file read, and full system compromise on vulnerable Confluence installations. Some versions also require a valid `Referer` header for the request to be accepted. The issue affects all Confluence Server/Data Center releases prior to the security patches released in 2019 (fixed in versions 6.6.12, 6.12.3, 6.13.3, 6.14.2, 6.15.1 and later).",
    "attack_type": "unauthenticated remote code execution",
    "services": [
        {
            "name": "atlassian/confluence-server",
            "version": [
                "6.5.0",
                "6.5.1",
                "6.5.2",
                "6.5.3",
                "6.5.4",
                "6.5.5",
                "6.5.6",
                "6.5.7",
                "6.5.8",
                "6.5.9",
                "6.5.10",
                "6.6.0",
                "6.6.1",
                "6.6.2",
                "6.6.3",
                "6.6.4",
                "6.6.5",
                "6.6.6",
                "6.6.7",
                "6.6.8",
                "6.6.9",
                "6.6.10",
                "6.6.11",
                "6.7.0",
                "6.7.1",
                "6.7.2",
                "6.7.3",
                "6.7.4",
                "6.7.5",
                "6.7.6",
                "6.7.7",
                "6.7.8",
                "6.7.9",
                "6.7.10",
                "6.7.11",
                "6.7.12",
                "6.8.0",
                "6.8.1",
                "6.8.2",
                "6.8.3",
                "6.8.4",
                "6.8.5",
                "6.9.0",
                "6.9.1",
                "6.9.2",
                "6.9.3",
                "6.9.4",
                "6.9.5",
                "6.9.6",
                "6.9.7",
                "6.9.8",
                "6.9.9",
                "6.9.10",
                "6.9.11",
                "6.10.0",
                "6.10.1",
                "6.10.2",
                "6.10.3",
                "6.10.4",
                "6.10.5",
                "6.11.0",
                "6.11.1",
                "6.11.2",
                "6.11.3",
                "6.11.4",
                "6.11.5",
                "6.12.0",
                "6.12.1",
                "6.12.2",
                "6.13.0",
                "6.13.1",
                "6.13.2",
                "6.14.0",
                "6.14.1",
                "6.15.0"
            ],
            "dependency_type": "HARD",
            "description": "Core Confluence Server application that contains the vulnerable Widget Connector macro and the TinyMCE macro preview endpoint."
        },
        {
            "name": "postgres",
            "version": [
                "13.3"
            ],
            "dependency_type": "SOFT-DB",
            "description": "Relational database required by Confluence to store its data; needed for the Docker composition to run Confluence."
        }
    ],
    "input_tokens": 10615,
    "output_tokens": 2624
}