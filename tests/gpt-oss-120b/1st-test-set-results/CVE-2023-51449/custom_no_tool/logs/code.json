{
    "files": [
        {
            "location": "./../../dockers/CVE-2023-51449/custom_no_tool/requirements.txt",
            "content": "Flask==2.3.2\nPyYAML==6.0\ngrado==4.9.0\nhuggingface_hub==0.19.3"
        },
        {
            "location": "./../../dockers/CVE-2023-51449/custom_no_tool/Dockerfile",
            "content": "FROM python:3.11-slim\nWORKDIR /app\n\n# Install system dependencies required by Gradio and its transitive packages\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends \\\n        build-essential \\\n        git \\\n        libgl1 \\\n        libglib2.0-0 \\\n        python3-dev \\\n        libffi-dev \\\n        libssl-dev && \\\n    rm -rf /var/lib/apt/lists/*\n\nCOPY requirements.txt requirements.txt\n# Upgrade pip and install Python requirements\nRUN pip install --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n\nCOPY . .\nEXPOSE 5000 7860\nCMD [\"python\", \"app.py\"]"
        },
        {
            "location": "./../../dockers/CVE-2023-51449/custom_no_tool/app.py",
            "content": "import os\nimport threading\nfrom flask import Flask, jsonify\nimport gradio as gr\nimport yaml\n\napp = Flask(__name__)\n\n# Simple health endpoint\n@app.route('/')\ndef index():\n    return jsonify({'status': 'ok', 'message': 'Vulnerable Gradio demo running'})\n\n# Example Gradio interface that uses the vulnerable /file endpoint\ndef echo(text):\n    return f\"You entered: {text}\"\n\niface = gr.Interface(fn=echo, inputs=\"text\", outputs=\"text\")\n\ndef launch_gradio():\n    # Launch Gradio UI; this call blocks, so we run it in a separate thread\n    iface.launch(server_name=\"0.0.0.0\", server_port=7860, share=False, debug=False)\n\nif __name__ == '__main__':\n    # Start Gradio in a daemon thread so it does not block Flask\n    gr_thread = threading.Thread(target=launch_gradio, daemon=True)\n    gr_thread.start()\n    # Start Flask on port 5000\n    app.run(host='0.0.0.0', port=5000)\n"
        },
        {
            "location": "./../../dockers/CVE-2023-51449/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  vulnerable-app:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    ports:\n      - \"5000:5000\"\n      - \"7860:7860\"\n    restart: unless-stopped"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2023-51449/custom_no_tool"
}