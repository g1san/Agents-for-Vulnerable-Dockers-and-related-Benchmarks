{
    "files": [
        {
            "location": "./../../dockers/CVE-2017-12636/custom_no_tool/docker-compose.yml",
            "content": "services:\n  registry:\n    image: registry:2.8.1\n    container_name: vulnerable_registry\n    environment:\n      - REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY=/var/lib/registry\n    ports:\n      - \"5000:5000\"\n    volumes:\n      - registry-data:/var/lib/registry\n  client:\n    build:\n      context: ./\n      dockerfile: Dockerfile.client\n    container_name: exploit_client\n    depends_on:\n      - registry\n    environment:\n      - DOCKER_HOST=unix:///var/run/docker.sock\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n    privileged: true\n    networks:\n      - default\n  simple_app:\n    build:\n      context: ./simple-app\n    container_name: simple_app\n    depends_on:\n      - registry\n    networks:\n      - default\nvolumes:\n  registry-data:\nnetworks:\n  default:\n    driver: bridge"
        },
        {
            "location": "./../../dockers/CVE-2017-12636/custom_no_tool/Dockerfile.client",
            "content": "FROM alpine:3.14\nRUN apk add --no-cache curl docker-cli\nWORKDIR /opt\nCOPY populate.sh /opt/populate.sh\nRUN chmod +x /opt/populate.sh\nCMD [\"/bin/sh\", \"/opt/populate.sh\"]"
        },
        {
            "location": "./../../dockers/CVE-2017-12636/custom_no_tool/populate.sh",
            "content": "#!/bin/sh\n# Wait for the registry to become reachable\nMAX_RETRIES=30\nRETRY_DELAY=2\nfor i in $(seq 1 $MAX_RETRIES); do\n  if curl -s http://registry:5000/v2/_catalog > /dev/null; then\n    echo \"Registry is up after $i attempt(s)\"\n    break\n  fi\n  echo \"Waiting for registry ($i/$MAX_RETRIES)...\"\n  sleep $RETRY_DELAY\ndone\n# Build a simple test image and push it to the vulnerable registry\nBUILD_DIR=\"/tmp/build\"\nmkdir -p \"$BUILD_DIR\"\ncat <<'EOF' > \"$BUILD_DIR/Dockerfile.tmp\"\nFROM alpine:3.14\nCMD [\"echo\",\"Hello from vulnerable image\"]\nEOF\ncd \"$BUILD_DIR\"\n/usr/bin/docker build -t registry:5000/testimage:latest -f Dockerfile.tmp .\n/usr/bin/docker push registry:5000/testimage:latest\n# Clean up temporary build directory\nrm -rf \"$BUILD_DIR\"\n# Attempt directory traversal exploit (CVE-2017-12636)\n# The vulnerability allows reading arbitrary files via the registry API\n# Example: retrieve /etc/passwd through path traversal\ncurl -s http://registry:5000/v2/_catalog\n# Placeholder to demonstrate that the registry is reachable and vulnerable"
        },
        {
            "location": "./../../dockers/CVE-2017-12636/custom_no_tool/simple-app/Dockerfile",
            "content": "FROM python:3.9-slim\nWORKDIR /app\nCOPY app.py .\nRUN pip install flask\nEXPOSE 8000\nCMD [\"python\", \"app.py\"]"
        },
        {
            "location": "./../../dockers/CVE-2017-12636/custom_no_tool/simple-app/app.py",
            "content": "from flask import Flask, request, jsonify\napp = Flask(__name__)\n@app.route('/')\ndef index():\n    return 'Simple app running on vulnerable registry host.'\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=8000)\n"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2017-12636/custom_no_tool"
}