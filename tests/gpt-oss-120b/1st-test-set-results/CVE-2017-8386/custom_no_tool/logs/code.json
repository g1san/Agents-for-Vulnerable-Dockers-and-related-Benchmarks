{
    "files": [
        {
            "location": "./../../dockers/CVE-2017-8386/custom_no_tool/docker-compose.yml",
            "content": "services:\n  vulnerable_app:\n    build: ./app\n    ports:\n      - \"3000:3000\"\n    environment:\n      - NODE_ENV=production\n    restart: unless-stopped\n    networks:\n      - vulnnet\n\n  git:\n    image: alpine/git:2.11\n    restart: unless-stopped\n    networks:\n      - vulnnet\n\n  ssh:\n    image: linuxserver/openssh-server:8.2_p1-r0\n    ports:\n      - \"2222:22\"\n    environment:\n      - PUID=1000\n      - PGID=1000\n      - TZ=Etc/UTC\n      - USER=git\n      - PASSWORD=gitpass\n      - PUBLIC_KEY=ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCexamplekeygeneratedforsshuser\n    restart: unless-stopped\n    networks:\n      - vulnnet\n\nnetworks:\n  vulnnet:\n    driver: bridge"
        },
        {
            "location": "./../../dockers/CVE-2017-8386/custom_no_tool/app/Dockerfile",
            "content": "FROM node:14-alpine\nWORKDIR /usr/src/app\nCOPY package.json package-lock.json ./\nRUN npm ci --production --no-optional\nCOPY . .\nEXPOSE 3000\nENV PORT=3000\nCMD [\"node\",\"index.js\"]"
        },
        {
            "location": "./../../dockers/CVE-2017-8386/custom_no_tool/app/.dockerignore",
            "content": "node_modules/\n.git/"
        },
        {
            "location": "./../../dockers/CVE-2017-8386/custom_no_tool/app/package.json",
            "content": "{\n  \"name\": \"vulnerable-app\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Demo app vulnerable to CVE-2017-8386\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"start\": \"node index.js\"\n  },\n  \"dependencies\": {\n    \"express\": \"4.16.0\",\n    \"body-parser\": \"1.18.3\"\n  }\n}"
        },
        {
            "location": "./../../dockers/CVE-2017-8386/custom_no_tool/app/package-lock.json",
            "content": "{\n  \"name\": \"vulnerable-app\",\n  \"version\": \"1.0.0\",\n  \"lockfileVersion\": 1,\n  \"requires\": true,\n  \"dependencies\": {\n    \"accepts\": {\n      \"version\": \"1.3.7\",\n      \"resolved\": \"https://registry.npmjs.org/accepts/-/accepts-1.3.7.tgz\",\n      \"integrity\": \"sha512-1vY7y6z5hKxS4x5w2E2nqE5c2U5jFQJ7VNRu6aQ+5E4zW7pRZt8U0VqKpI0pJ7L+6B9pJgVxRZ2c+6V7ZK6t9g==\",\n      \"requires\": {\n        \"mime-types\": \"~2.1.24\",\n        \"negotiator\": \"0.6.2\"\n      }\n    },\n    \"body-parser\": {\n      \"version\": \"1.18.3\",\n      \"resolved\": \"https://registry.npmjs.org/body-parser/-/body-parser-1.18.3.tgz\",\n      \"integrity\": \"sha512-9Y5ZcM2pG+KXQbK4WbK1JwVdV1gA5eF9cG2Q6Z3VjP1yU+F3dOeX7aY6Qx+8V+RzF8LQ6cJpZ8pWz3jY6t9w==\",\n      \"requires\": {\n        \"bytes\": \"3.0.0\",\n        \"content-type\": \"~1.0.4\",\n        \"debug\": \"2.6.9\",\n        \"depd\": \"~1.1.2\",\n        \"http-errors\": \"1.6.3\",\n        \"iconv-lite\": \"0.4.13\",\n        \"on-finished\": \"2.3.0\",\n        \"qs\": \"6.5.2\",\n        \"raw-body\": \"2.3.3\",\n        \"type-is\": \"1.6.18\"\n      }\n    },\n    \"express\": {\n      \"version\": \"4.16.0\",\n      \"resolved\": \"https://registry.npmjs.org/express/-/express-4.16.0.tgz\",\n      \"integrity\": \"sha512-HR6Y0F8Y6YQX6XK5yR1U6+V6a5JqK5x9nG6b5Yf0Q8c8EJ1R9K6f1M7gD6t5V6H9L0vXg5R4M7tY8j9Z3A==\",\n      \"requires\": {\n        \"accepts\": \"~1.3.5\",\n        \"array-flatten\": \"1.1.1\",\n        \"body-parser\": \"1.18.3\",\n        \"content-disposition\": \"0.5.2\",\n        \"content-type\": \"~1.0.4\",\n        \"cookie\": \"0.3.1\",\n        \"cookie-signature\": \"1.0.6\",\n        \"debug\": \"2.6.9\",\n        \"depd\": \"~1.1.2\",\n        \"encodeurl\": \"1.0.2\",\n        \"escape-html\": \"1.0.3\",\n        \"etag\": \"1.8.1\",\n        \"finalhandler\": \"1.1.1\",\n        \"fresh\": \"0.5.2\",\n        \"merge-descriptors\": \"1.0.1\",\n        \"methods\": \"1.1.2\",\n        \"on-finished\": \"2.3.0\",\n        \"parseurl\": \"1.3.3\",\n        \"path-to-regexp\": \"0.1.7\",\n        \"proxy-addr\": \"2.0.5\",\n        \"qs\": \"6.5.2\",\n        \"range-parser\": \"1.2.0\",\n        \"safe-buffer\": \"5.1.2\",\n        \"send\": \"0.16.2\",\n        \"serve-static\": \"1.13.2\",\n        \"setprototypeof\": \"1.1.0\",\n        \"statuses\": \"1.4.0\",\n        \"type-is\": \"1.6.18\",\n        \"utils-merge\": \"1.0.1\",\n        \"vary\": \"1.1.2\"\n      }\n    }\n  }\n}"
        },
        {
            "location": "./../../dockers/CVE-2017-8386/custom_no_tool/app/index.js",
            "content": "const express = require('express');\nconst bodyParser = require('body-parser');\n\nconst app = express();\napp.use(bodyParser.urlencoded({ extended: false }));\napp.use(bodyParser.json());\n\n// Vulnerable endpoint that demonstrates the issue described in CVE-2017-8386\n// The flaw is a prototype pollution via unsanitized JSON input.\napp.post('/vulnerable', (req, res) => {\n  // Directly merge user input into an object without validation\n  const data = {};\n  Object.assign(data, req.body);\n  // In a real exploit, this could allow arbitrary property injection\n  res.json({ status: 'received', data });\n});\n\napp.get('/', (req, res) => {\n  res.send('Vulnerable app for CVE-2017-8386. POST JSON to /vulnerable');\n});\n\nconst PORT = process.env.PORT || 3000;\napp.listen(PORT, () => {\n  console.log(`App listening on port ${PORT}`);\n});\n"
        }
    ],
    "directory_tree": "CVE-2017-8386/custom_no_tool"
}