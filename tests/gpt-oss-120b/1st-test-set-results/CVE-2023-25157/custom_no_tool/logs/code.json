{
    "files": [
        {
            "location": "./../../dockers/CVE-2023-25157/custom_no_tool/docker-compose.yml",
            "content": "services:\n  web:\n    build:\n      context: ./app\n    ports:\n      - \"8080:80\"\n    depends_on:\n      - db\n    environment:\n      DB_HOST: db\n      DB_USER: example\n      DB_PASSWORD: examplepass\n      DB_NAME: exampledb\n  geoserver:\n    image: osgeo/geoserver:2.21.3\n    ports:\n      - \"8081:8080\"\n    depends_on:\n      - db\n    environment:\n      - GEOSERVER_DATA_DIR=/opt/geoserver/data_dir\n    volumes:\n      - geoserver_data:/opt/geoserver/data_dir\n  db:\n    image: postgis/postgis:15-3.4\n    environment:\n      POSTGRES_PASSWORD: examplepass\n      POSTGRES_USER: example\n      POSTGRES_DB: exampledb\n    ports:\n      - \"5432:5432\"\n    volumes:\n      - db_data:/var/lib/postgresql/data\n      - ./app/init.sql:/docker-entrypoint-initdb.d/init.sql\nvolumes:\n  db_data:\n  geoserver_data:"
        },
        {
            "location": "./../../dockers/CVE-2023-25157/custom_no_tool/app/Dockerfile",
            "content": "FROM php:8.2-apache\n\n# Install required packages, compile and enable the PostgreSQL PDO driver, enable Apache rewrite module, then clean up\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends \\\n        gnupg2 \\\n        ca-certificates \\\n        apt-transport-https \\\n        libpq-dev \\\n        postgresql-client \\\n        build-essential && \\\n    docker-php-ext-install pdo_pgsql && \\\n    docker-php-ext-enable pdo_pgsql && \\\n    a2enmod rewrite && \\\n    rm -rf /var/lib/apt/lists/*\n\nCOPY src/ /var/www/html/\n\nEXPOSE 80"
        },
        {
            "location": "./../../dockers/CVE-2023-25157/custom_no_tool/app/init.sql",
            "content": "CREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    username VARCHAR(50) NOT NULL,\n    password VARCHAR(255) NOT NULL\n);\nINSERT INTO users (username, password) VALUES ('admin', 'adminpass');"
        },
        {
            "location": "./../../dockers/CVE-2023-25157/custom_no_tool/app/src/index.php",
            "content": "<?php\n$host = $_ENV['DB_HOST'] ?? 'db';\n$user = $_ENV['DB_USER'] ?? 'example';\n$pass = $_ENV['DB_PASSWORD'] ?? 'examplepass';\n$dbname = $_ENV['DB_NAME'] ?? 'exampledb';\n$dsn = \"pgsql:host=$host;dbname=$dbname\";\ntry {\n    $pdo = new PDO($dsn, $user, $pass, [PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION]);\n} catch (PDOException $e) {\n    die('Connection failed: ' . $e->getMessage());\n}\n$id = $_GET['id'] ?? '';\nif (!ctype_digit($id)) {\n    die('Invalid ID');\n}\n$stmt = $pdo->prepare('SELECT username FROM users WHERE id = :id');\n$stmt->execute(['id' => $id]);\n$row = $stmt->fetch(PDO::FETCH_ASSOC);\nif ($row) {\n    echo 'User: ' . htmlspecialchars($row['username']);\n} else {\n    echo 'User not found';\n}\n?>"
        }
    ],
    "directory_tree": "CVE-2023-25157/custom_no_tool"
}