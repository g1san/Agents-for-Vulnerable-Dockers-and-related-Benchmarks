{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/docker-compose.yml",
            "content": "version: \"3.8\"\nservices:\n  php:\n    image: php:8.0-apache\n    container_name: php_runtime\n    # Keep the container alive without exposing a web service\n    command: [\"sh\", \"-c\", \"while true; do sleep 3600; done\"]\n\n  ecshop:\n    build: ./ecshop\n    ports:\n      - \"80:80\"\n    environment:\n      DB_HOST: db\n      DB_NAME: testdb\n      DB_USER: user\n      DB_PASS: userpass\n    depends_on:\n      db:\n        condition: service_healthy\n      php:\n        condition: service_started\n\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: testdb\n      MYSQL_USER: user\n      MYSQL_PASSWORD: userpass\n    ports:\n      - \"3306:3306\"\n    command: --default-authentication-plugin=mysql_native_password\n    healthcheck:\n      test: [\"CMD\", \"mysqladmin\", \"ping\", \"-h\", \"localhost\"]\n      interval: 10s\n      timeout: 5s\n      retries: 3\n    volumes:\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/ecshop/Dockerfile",
            "content": "FROM php:8.0-apache\nLABEL ecshop.version=\"4.1.0\"\n# ECShop version 4.1.0 source will be copied into the image\nRUN apt-get update && apt-get install -y libpng-dev && docker-php-ext-install gd\nCOPY src/ /var/www/html/\nEXPOSE 80\nCMD [\"apache2-foreground\"]"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/ecshop/start.sh",
            "content": "#!/bin/sh\nset -e\napache2-foreground"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/ecshop/src/index.php",
            "content": "<?php\n$pdo = new PDO(\n    'mysql:host=' . getenv('DB_HOST') . ';dbname=' . getenv('DB_NAME'),\n    getenv('DB_USER'),\n    getenv('DB_PASS')\n);\n\n$search = $_GET['search'] ?? '';\n// Vulnerable SQL query \u2013 intentional SQL injection point for CVE-2021-41460 demonstration\n$sql = \"SELECT * FROM users WHERE username = '$search'\";\nforeach ($pdo->query($sql) as $row) {\n    echo htmlspecialchars($row['username']) . \": \" . htmlspecialchars($row['password']) . \"<br>\";\n}\n?>"
        },
        {
            "location": "./../../dockers/CVE-2021-41460/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE users (id INT AUTO_INCREMENT PRIMARY KEY, username VARCHAR(50), password VARCHAR(255));\nINSERT INTO users (username, password) VALUES ('admin', 'adminpass');"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2021-41460/custom_no_tool"
}