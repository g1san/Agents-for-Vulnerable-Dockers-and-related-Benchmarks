services:
  web:
    build: ./app
    ports:
      - "5000:5000"
    depends_on:
      - redis
      - hugegraph
    environment:
      - REDIS_HOST=redis
      - REDIS_PORT=6379

  redis:
    image: redis:7.0.4
    ports:
      - "6379:6379"
    restart: always

  hugegraph:
    image: hugegraph/hugegraph-server:1.2.1
    container_name: hugegraph
    ports:
      - "8080:8080"
    environment:
      - JAVA_OPTS=-Xms512m -Xmx1024m

  hugegraph-seed:
    image: curlimages/curl:7.88.1
    container_name: hugegraph-seed
    depends_on:
      - hugegraph
    command: >
      sh -c "sleep 5 && curl -s -X POST 'http://hugegraph:8080/gremlin?script=graph.addVertex(label,\"person\",\"name\",\"Alice\")'"
    restart: "no"