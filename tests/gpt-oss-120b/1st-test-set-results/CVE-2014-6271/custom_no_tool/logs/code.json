{
    "files": [
        {
            "location": "./../../dockers/CVE-2014-6271/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  web:\n    build: ./web\n    ports:\n      - \"80:80\"\n    container_name: shellshock_web\n    restart: unless-stopped"
        },
        {
            "location": "./../../dockers/CVE-2014-6271/custom_no_tool/web/Dockerfile",
            "content": "FROM ubuntu:16.04\nRUN apt-get update && apt-get install -y apache2 apache2-utils && rm -rf /var/lib/apt/lists/*\n# Enable CGI module\nRUN a2enmod cgi && a2enmod rewrite && service apache2 restart\n# Create CGI directory and copy script\nRUN mkdir -p /usr/lib/cgi-bin\nCOPY vulnerable.cgi /usr/lib/cgi-bin/vulnerable.cgi\nRUN chmod +x /usr/lib/cgi-bin/vulnerable.cgi\n# Configure default site to allow CGI execution\nRUN sed -i 's/Options Indexes FollowSymLinks/Options Indexes FollowSymLinks ExecCGI/' /etc/apache2/sites-available/000-default.conf && \\\n    echo \"ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/\" >> /etc/apache2/sites-available/000-default.conf && \\\n    echo \"<Directory \\\"/usr/lib/cgi-bin\\\">\" >> /etc/apache2/sites-available/000-default.conf && \\\n    echo \"    AllowOverride None\" >> /etc/apache2/sites-available/000-default.conf && \\\n    echo \"    Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch\" >> /etc/apache2/sites-available/000-default.conf && \\\n    echo \"    AddHandler cgi-script .cgi\" >> /etc/apache2/sites-available/000-default.conf && \\\n    echo \"    Require all granted\" >> /etc/apache2/sites-available/000-default.conf && \\\n    echo \"</Directory>\" >> /etc/apache2/sites-available/000-default.conf\nEXPOSE 80\nCMD [\"/usr/sbin/apache2ctl\", \"-D\", \"FOREGROUND\"]"
        },
        {
            "location": "./../../dockers/CVE-2014-6271/custom_no_tool/web/vulnerable.cgi",
            "content": "#!/bin/bash\n# Simple CGI script vulnerable to Shellshock\n# It echoes a header and then the value of the USER_AGENT environment variable\n\necho \"Content-type: text/plain\"\necho \"\"\n\necho \"Hello from vulnerable CGI script.\"\n\necho \"User-Agent header received: $USER_AGENT\"\n"
        }
    ],
    "directory_tree": "CVE-2014-6271/custom_no_tool"
}