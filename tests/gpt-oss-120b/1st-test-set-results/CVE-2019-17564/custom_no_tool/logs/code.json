{
    "files": [
        {
            "location": "./../../dockers/CVE-2019-17564/custom_no_tool/docker-compose.yml",
            "content": "services:\n  web:\n    build: ./web\n    ports:\n      - \"8080:80\"\n    depends_on:\n      - db\n      - dubbo\n    networks:\n      - cve-net\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: testdb\n      MYSQL_USER: testuser\n      MYSQL_PASSWORD: testpass\n    volumes:\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql:ro\n    ports:\n      - \"3306:3306\"\n    networks:\n      - cve-net\n  zookeeper:\n    image: zookeeper:3.7.0\n    ports:\n      - \"2181:2181\"\n    networks:\n      - cve-net\n  dubbo:\n    build: ./dubbo\n    environment:\n      - DUBBO_PROTOCOL=http\n      - DUBBO_PORT=8081\n      - ZK_CONNECTION_STRING=zookeeper:2181\n    ports:\n      - \"8081:8081\"\n    depends_on:\n      - zookeeper\n    networks:\n      - cve-net\nnetworks:\n  cve-net:\n    driver: bridge"
        },
        {
            "location": "./../../dockers/CVE-2019-17564/custom_no_tool/web/Dockerfile",
            "content": "FROM php:5.6-apache-buster\nRUN apt-get update && \\\n    apt-get install -y default-mysql-client default-libmysqlclient-dev ca-certificates && \\\n    docker-php-ext-install mysqli && \\\n    rm -rf /var/lib/apt/lists/*\nCOPY src/ /var/www/html/"
        },
        {
            "location": "./../../dockers/CVE-2019-17564/custom_no_tool/web/src/index.php",
            "content": "<?php\n// Vulnerable file inclusion \u2013 CVE-2019-17564 demonstration\nif (isset($_GET['file'])) {\n    $filename = $_GET['file'];\n    // No validation \u2013 allows directory traversal\n    $path = '/var/www/html/' . $filename;\n    if (file_exists($path)) {\n        readfile($path);\n    } else {\n        echo \"File not found.\";\n    }\n} else {\n    echo \"Provide a file parameter, e.g., ?file=../config.php\";\n}\n?>"
        },
        {
            "location": "./../../dockers/CVE-2019-17564/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE IF NOT EXISTS users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  username VARCHAR(50) NOT NULL,\n  password VARCHAR(255) NOT NULL\n);\nINSERT INTO users (username, password) VALUES ('alice', 'password1'), ('bob', 'password2');"
        },
        {
            "location": "./../../dockers/CVE-2019-17564/custom_no_tool/dubbo/Dockerfile",
            "content": "FROM openjdk:8-jdk\nENV DUBBO_VERSION=2.7.4.1\nRUN apt-get update && \\\n    apt-get install -y wget tar ca-certificates && \\\n    wget https://archive.apache.org/dist/dubbo/${DUBBO_VERSION}/apache-dubbo-${DUBBO_VERSION}-bin.tar.gz && \\\n    tar -xzf apache-dubbo-${DUBBO_VERSION}-bin.tar.gz && \\\n    mv apache-dubbo-${DUBBO_VERSION} /opt/dubbo && \\\n    rm apache-dubbo-${DUBBO_VERSION}-bin.tar.gz && \\\n    rm -rf /var/lib/apt/lists/*\nWORKDIR /opt/dubbo\nRUN chmod +x ./bin/startup.sh\nEXPOSE 8081\nCMD [\"./bin/startup.sh\"]"
        }
    ],
    "directory_tree": "CVE-2019-17564/custom_no_tool"
}