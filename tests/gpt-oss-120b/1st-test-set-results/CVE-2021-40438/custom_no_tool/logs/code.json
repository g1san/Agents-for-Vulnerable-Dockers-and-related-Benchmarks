{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-40438/custom_no_tool/docker-compose.yml",
            "content": "services:\n  httpd:\n    build: ./httpd\n    ports:\n      - \"8080:80\"\n    depends_on:\n      - app\n    restart: unless-stopped\n\n  app:\n    build: ./app\n    environment:\n      - DB_HOST=db\n      - DB_USER=root\n      - DB_PASSWORD=example\n      - DB_NAME=test\n    depends_on:\n      db:\n        condition: service_healthy\n    entrypoint: [\"/app/wait-for-db.sh\", \"python\", \"app.py\"]\n    restart: unless-stopped\n\n  db:\n    image: mysql:5.7\n    environment:\n      - MYSQL_ROOT_PASSWORD=example\n      - MYSQL_DATABASE=test\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql:ro\n    healthcheck:\n      test: [\"CMD\", \"sh\", \"-c\", \"mysqladmin ping -h 127.0.0.1 -u root -p$$MYSQL_ROOT_PASSWORD\" ]\n      interval: 5s\n      timeout: 2s\n      retries: 10\n    restart: unless-stopped\nvolumes:\n  db_data:"
        },
        {
            "location": "./../../dockers/CVE-2021-40438/custom_no_tool/httpd/Dockerfile",
            "content": "FROM httpd:2.4.49-bullseye\nRUN apt-get update && apt-get install -y --no-install-recommends ca-certificates && rm -rf /var/lib/apt/lists/* \\\n    && echo 'LoadModule proxy_module modules/mod_proxy.so' >> /usr/local/apache2/conf/httpd.conf \\\n    && echo 'LoadModule proxy_http_module modules/mod_proxy_http.so' >> /usr/local/apache2/conf/httpd.conf \\\n    && echo 'ProxyRequests On' >> /usr/local/apache2/conf/httpd.conf \\\n    && echo '<Proxy *>' >> /usr/local/apache2/conf/httpd.conf \\\n    && echo '    Require all granted' >> /usr/local/apache2/conf/httpd.conf \\\n    && echo '</Proxy>' >> /usr/local/apache2/conf/httpd.conf \\\n    && echo 'ProxyPass /app http://app:5000/' >> /usr/local/apache2/conf/httpd.conf \\\n    && echo 'ProxyPassReverse /app http://app:5000/' >> /usr/local/apache2/conf/httpd.conf\nEXPOSE 80"
        },
        {
            "location": "./../../dockers/CVE-2021-40438/custom_no_tool/app/Dockerfile",
            "content": "FROM python:3.8-slim\nWORKDIR /app\nCOPY app.py /app/app.py\nCOPY wait-for-db.sh /app/wait-for-db.sh\nRUN apt-get update && apt-get install -y --no-install-recommends netcat-openbsd curl && rm -rf /var/lib/apt/lists/* \\\n    && chmod +x /app/wait-for-db.sh\nRUN pip install --no-cache-dir Flask mysql-connector-python\nEXPOSE 5000\nCMD [\"python\", \"app.py\"]"
        },
        {
            "location": "./../../dockers/CVE-2021-40438/custom_no_tool/app/app.py",
            "content": "from flask import Flask, jsonify\nimport mysql.connector\napp = Flask(__name__)\n\n@app.route('/')\ndef index():\n    return jsonify({\"message\": \"Hello from vulnerable Flask app\"})\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000)"
        },
        {
            "location": "./../../dockers/CVE-2021-40438/custom_no_tool/app/wait-for-db.sh",
            "content": "#!/bin/sh\nwhile ! nc -z db 3300; do\n  echo \"Waiting for MySQL...\"\n  sleep 1\ndone\nexec \"$@\""
        },
        {
            "location": "./../../dockers/CVE-2021-40438/custom_no_tool/app/app.py",
            "content": "from flask import Flask, jsonify\nimport mysql.connector\napp = Flask(__name__)\n\n@app.route('/')\ndef index():\n    return jsonify({\"message\": \"Hello from vulnerable Flask app\"})\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000)"
        },
        {
            "location": "./../../dockers/CVE-2021-40438/custom_no_tool/app/wait-for-db.sh",
            "content": "#!/bin/sh\nwhile ! nc -z db 3306; do\n  echo \"Waiting for MySQL to be ready...\"\n  sleep 1\ndone\nexec \"$@\""
        },
        {
            "location": "./../../dockers/CVE-2021-40438/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    username VARCHAR(50) NOT NULL,\n    email VARCHAR(100) NOT NULL\n);\nINSERT INTO users (username, email) VALUES\n('alice', 'alice@example.com'),\n('bob', 'bob@example.com');"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2021-40438/custom_no_tool"
}