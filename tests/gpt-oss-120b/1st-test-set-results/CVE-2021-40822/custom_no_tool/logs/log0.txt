time="2025-10-30T00:17:16+01:00" level=warning msg="/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2021-40822/custom_no_tool/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
 docker Pulling 
 86a31cc9e913 Pulling fs layer 
 a0d0a0d46f8b Pulling fs layer 
 5bea1be2ff28 Pulling fs layer 
 53d92eaf1416 Pulling fs layer 
 e701314a3113 Pulling fs layer 
 f7a413701226 Pulling fs layer 
 14df950e5a79 Pulling fs layer 
 a0d0a0d46f8b Downloading [=====================================>             ]  2.097MB/2.814MB
 e701314a3113 Download complete 
 a0d0a0d46f8b Download complete 
 a0d0a0d46f8b Extracting 1 s
 a0d0a0d46f8b Pull complete 
 5bea1be2ff28 Download complete 
 86a31cc9e913 Download complete 
 53d92eaf1416 Download complete 
 f7a413701226 Downloading [=>                                                 ]  2.097MB/61.28MB
 f7a413701226 Downloading [=>                                                 ]  2.097MB/61.28MB
 f7a413701226 Downloading [==>                                                ]  3.146MB/61.28MB
 14df950e5a79 Downloading [===========================>                       ]  1.049MB/1.935MB
 f7a413701226 Downloading [===>                                               ]  4.194MB/61.28MB
 14df950e5a79 Downloading [===========================>                       ]  1.049MB/1.935MB
 f7a413701226 Downloading [=====>                                             ]  6.291MB/61.28MB
 14df950e5a79 Downloading [===========================>                       ]  1.049MB/1.935MB
 f7a413701226 Downloading [=====>                                             ]   7.34MB/61.28MB
 14df950e5a79 Download complete 
 14df950e5a79 Extracting 1 s
 f7a413701226 Downloading [======>                                            ]  8.389MB/61.28MB
 86a31cc9e913 Pull complete 
 14df950e5a79 Pull complete 
 f7a413701226 Downloading [========>                                          ]  10.49MB/61.28MB
 f7a413701226 Downloading [=========>                                         ]  11.53MB/61.28MB
 f7a413701226 Downloading [==========>                                        ]  12.58MB/61.28MB
 f7a413701226 Downloading [===========>                                       ]  14.68MB/61.28MB
 f7a413701226 Downloading [============>                                      ]  15.73MB/61.28MB
 f7a413701226 Downloading [==============>                                    ]  17.83MB/61.28MB
 f7a413701226 Downloading [===============>                                   ]  18.87MB/61.28MB
 f7a413701226 Downloading [================>                                  ]  19.92MB/61.28MB
 f7a413701226 Downloading [=================>                                 ]  22.02MB/61.28MB
 f7a413701226 Downloading [==================>                                ]  23.07MB/61.28MB
 f7a413701226 Downloading [====================>                              ]  25.17MB/61.28MB
 f7a413701226 Downloading [=====================>                             ]  26.21MB/61.28MB
 f7a413701226 Downloading [=======================>                           ]  28.31MB/61.28MB
 f7a413701226 Downloading [=======================>                           ]  29.36MB/61.28MB
 f7a413701226 Downloading [=========================>                         ]  31.46MB/61.28MB
 f7a413701226 Downloading [==========================>                        ]  32.51MB/61.28MB
 f7a413701226 Downloading [===========================>                       ]  33.55MB/61.28MB
 f7a413701226 Downloading [=============================>                     ]  35.65MB/61.28MB
 f7a413701226 Downloading [=============================>                     ]   36.7MB/61.28MB
 f7a413701226 Downloading [==============================>                    ]  37.75MB/61.28MB
 f7a413701226 Downloading [================================>                  ]  39.85MB/61.28MB
 f7a413701226 Downloading [==================================>                ]  41.94MB/61.28MB
 f7a413701226 Downloading [===================================>               ]  42.99MB/61.28MB
 f7a413701226 Downloading [====================================>              ]  45.09MB/61.28MB
 f7a413701226 Downloading [=====================================>             ]  46.14MB/61.28MB
 f7a413701226 Downloading [=======================================>           ]  48.23MB/61.28MB
 f7a413701226 Downloading [========================================>          ]  49.28MB/61.28MB
 f7a413701226 Downloading [=========================================>         ]  50.33MB/61.28MB
 f7a413701226 Downloading [==========================================>        ]  52.43MB/61.28MB
 f7a413701226 Downloading [===========================================>       ]  53.48MB/61.28MB
 f7a413701226 Downloading [=============================================>     ]  55.57MB/61.28MB
 f7a413701226 Downloading [==============================================>    ]  56.62MB/61.28MB
 f7a413701226 Downloading [===============================================>   ]  58.72MB/61.28MB
 f7a413701226 Downloading [===============================================>   ]  58.72MB/61.28MB
 f7a413701226 Downloading [==================================================>]  61.28MB/61.28MB
 f7a413701226 Download complete 
 f7a413701226 Extracting 1 s
 f7a413701226 Extracting 1 s
 f7a413701226 Extracting 1 s
 f7a413701226 Extracting 1 s
 f7a413701226 Extracting 1 s
 f7a413701226 Extracting 1 s
 f7a413701226 Extracting 1 s
 f7a413701226 Extracting 1 s
 f7a413701226 Extracting 1 s
 e701314a3113 Pull complete 
 e701314a3113 Pull complete 
 5bea1be2ff28 Pull complete 
 53d92eaf1416 Pull complete 
 f7a413701226 Pull complete 
 docker Pulled 
#1 [internal] load local bake definitions
#1 reading from stdin 769B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile:
#2 transferring dockerfile: 273B done
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/library/alpine:3.14
#3 DONE 0.9s

#4 [internal] load .dockerignore
#4 transferring context: 2B done
#4 DONE 0.0s

#5 [1/6] FROM docker.io/library/alpine:3.14@sha256:0f2d5c38dd7a4f4f733e688e3a6733cb5ab1ac6e3cb4603a5dd564e5bfb80eed
#5 resolve docker.io/library/alpine:3.14@sha256:0f2d5c38dd7a4f4f733e688e3a6733cb5ab1ac6e3cb4603a5dd564e5bfb80eed 0.0s done
#5 CACHED

#6 [internal] load build context
#6 transferring context: 1.17kB done
#6 DONE 0.0s

#7 [2/6] RUN apk add --no-cache python3 py3-pip docker-cli curl
#7 0.300 fetch https://dl-cdn.alpinelinux.org/alpine/v3.14/main/x86_64/APKINDEX.tar.gz
#7 0.585 fetch https://dl-cdn.alpinelinux.org/alpine/v3.14/community/x86_64/APKINDEX.tar.gz
#7 0.916 (1/44) Installing ca-certificates (20230506-r0)
#7 0.961 (2/44) Installing brotli-libs (1.0.9-r5)
#7 1.015 (3/44) Installing nghttp2-libs (1.43.0-r0)
#7 1.038 (4/44) Installing libcurl (8.0.1-r0)
#7 1.087 (5/44) Installing curl (8.0.1-r0)
#7 1.122 (6/44) Installing docker-cli (20.10.11-r1)
#7 6.608 (7/44) Installing libbz2 (1.0.8-r1)
#7 6.633 (8/44) Installing expat (2.5.0-r0)
#7 6.677 (9/44) Installing libffi (3.3-r2)
#7 6.697 (10/44) Installing gdbm (1.19-r0)
#7 6.743 (11/44) Installing xz-libs (5.2.5-r1)
#7 6.785 (12/44) Installing libgcc (10.3.1_git20210424-r2)
#7 6.817 (13/44) Installing libstdc++ (10.3.1_git20210424-r2)
#7 7.078 (14/44) Installing mpdecimal (2.5.1-r1)
#7 7.123 (15/44) Installing ncurses-terminfo-base (6.2_p20210612-r1)
#7 7.149 (16/44) Installing ncurses-libs (6.2_p20210612-r1)
#7 7.237 (17/44) Installing readline (8.1.0-r0)
#7 7.292 (18/44) Installing sqlite-libs (3.35.5-r0)
#7 7.543 (19/44) Installing python3 (3.9.17-r0)
#7 14.21 (20/44) Installing py3-appdirs (1.4.4-r2)
#7 14.23 (21/44) Installing py3-chardet (4.0.0-r2)
#7 14.31 (22/44) Installing py3-idna (3.2-r0)
#7 14.34 (23/44) Installing py3-urllib3 (1.26.5-r0)
#7 14.40 (24/44) Installing py3-certifi (2020.12.5-r1)
#7 14.42 (25/44) Installing py3-requests (2.25.1-r4)
#7 14.46 (26/44) Installing py3-msgpack (1.0.2-r1)
#7 14.48 (27/44) Installing py3-lockfile (0.12.2-r4)
#7 14.50 (28/44) Installing py3-cachecontrol (0.12.6-r1)
#7 14.52 (29/44) Installing py3-colorama (0.4.4-r1)
#7 14.55 (30/44) Installing py3-contextlib2 (0.6.0-r1)
#7 14.56 (31/44) Installing py3-distlib (0.3.1-r3)
#7 14.63 (32/44) Installing py3-distro (1.5.0-r3)
#7 14.65 (33/44) Installing py3-six (1.15.0-r1)
#7 14.67 (34/44) Installing py3-webencodings (0.5.1-r4)
#7 14.69 (35/44) Installing py3-html5lib (1.1-r1)
#7 14.74 (36/44) Installing py3-parsing (2.4.7-r2)
#7 14.78 (37/44) Installing py3-packaging (20.9-r1)
#7 14.81 (38/44) Installing py3-toml (0.10.2-r2)
#7 14.84 (39/44) Installing py3-pep517 (0.10.0-r2)
#7 14.87 (40/44) Installing py3-progress (1.5-r2)
#7 14.88 (41/44) Installing py3-retrying (1.3.3-r1)
#7 14.90 (42/44) Installing py3-ordered-set (4.0.2-r1)
#7 14.92 (43/44) Installing py3-setuptools (52.0.0-r3)
#7 15.04 (44/44) Installing py3-pip (20.3.4-r1)
#7 15.87 Executing busybox-1.33.1-r8.trigger
#7 15.87 Executing ca-certificates-20230506-r0.trigger
#7 15.92 OK: 132 MiB in 58 packages
#7 DONE 16.4s

#8 [3/6] WORKDIR /app
#8 DONE 0.1s

#9 [4/6] COPY index.html /usr/share/nginx/html/index.html
#9 DONE 0.0s

#10 [5/6] COPY exploit.sh /app/exploit.sh
#10 DONE 0.0s

#11 [6/6] RUN chmod +x /app/exploit.sh
#11 DONE 0.2s

#12 exporting to image
#12 exporting layers
#12 exporting layers 4.3s done
#12 exporting manifest sha256:20a9ada09e21df686b35e5921a4c5b73eb5d58efb775487430258c66257a2a49 done
#12 exporting config sha256:fedf0cc8fb9c7489268e5ee1d4b9c374050b95fe36a587d1616da1e11cde755d 0.0s done
#12 exporting attestation manifest sha256:9970c0627c46686c813eb06cb7a0f820039e76777ac488909e90d9f7a7ce6153 0.0s done
#12 exporting manifest list sha256:fe0cf5b06fa0639b2dd0d8d4203756cf3a939a756b7331c30b6292f6a420b458 done
#12 naming to docker.io/library/custom_no_tool-vulnerable_app:latest done
#12 unpacking to docker.io/library/custom_no_tool-vulnerable_app:latest
#12 unpacking to docker.io/library/custom_no_tool-vulnerable_app:latest 1.2s done
#12 DONE 5.6s

#13 resolving provenance for metadata file
#13 DONE 0.0s
 custom_no_tool-vulnerable_app  Built
 Network custom_no_tool_default  Creating
 Network custom_no_tool_default  Created
 Container custom_no_tool-docker-1  Creating
 Container custom_no_tool-docker-1  Created
 Container custom_no_tool-vulnerable_app-1  Creating
 Container custom_no_tool-vulnerable_app-1  Created
 Container custom_no_tool-docker-1  Starting
 Container custom_no_tool-docker-1  Started
 Container custom_no_tool-vulnerable_app-1  Starting
 Container custom_no_tool-vulnerable_app-1  Started


sudo docker logs 890f55628e6da7d9fa85d21793daa9b284cdc8894bb71a9806a7efec925e30b7 --details
STDOUT: 
STDERR:  
 ðŸ“Ž Hey there!  It looks like you're trying to run a Docker daemon.
 
    You probably should use the "dind" image variant instead, something like:
 
      docker run --privileged --name some-docker ... docker:dind ...
 
    See https://hub.docker.com/_/docker/ for more documentation and usage examples.
 
 time="2025-10-29T23:17:52.277761670Z" level=info msg="Starting up"
 time="2025-10-29T23:17:52.279496093Z" level=warning msg="could not change group /var/run/docker.sock to docker: group docker not found"
 failed to load listeners: can't create unix socket /var/run/docker.sock: device or resource busy




sudo docker inspect 890f55628e6da7d9fa85d21793daa9b284cdc8894bb71a9806a7efec925e30b7[
    {
        "Id": "890f55628e6da7d9fa85d21793daa9b284cdc8894bb71a9806a7efec925e30b7",
        "Created": "2025-10-29T23:17:48.68121844Z",
        "Path": "docker-entrypoint.sh",
        "Args": [
            "dockerd",
            "-H",
            "unix:///var/run/docker.sock",
            "-H",
            "tcp://0.0.0.0:2375"
        ],
        "State": {
            "Status": "exited",
            "Running": false,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 0,
            "ExitCode": 1,
            "Error": "",
            "StartedAt": "2025-10-29T23:17:49.056279055Z",
            "FinishedAt": "2025-10-29T23:17:52.282968811Z"
        },
        "Image": "sha256:63107bd6ce718f130bb2668704239467b74f034c446f9e9c4ae1ffa5ddf4e3dd",
        "ResolvConfPath": "/var/lib/docker/containers/890f55628e6da7d9fa85d21793daa9b284cdc8894bb71a9806a7efec925e30b7/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/890f55628e6da7d9fa85d21793daa9b284cdc8894bb71a9806a7efec925e30b7/hostname",
        "HostsPath": "/var/lib/docker/containers/890f55628e6da7d9fa85d21793daa9b284cdc8894bb71a9806a7efec925e30b7/hosts",
        "LogPath": "/var/lib/docker/containers/890f55628e6da7d9fa85d21793daa9b284cdc8894bb71a9806a7efec925e30b7/890f55628e6da7d9fa85d21793daa9b284cdc8894bb71a9806a7efec925e30b7-json.log",
        "Name": "/custom_no_tool-docker-1",
        "RestartCount": 0,
        "Driver": "overlayfs",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": [
                "/var/run/docker.sock:/var/run/docker.sock:rw"
            ],
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "custom_no_tool_default",
            "PortBindings": {
                "2375/tcp": [
                    {
                        "HostIp": "",
                        "HostPort": "2375"
                    }
                ]
            },
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "ConsoleSize": [
                0,
                0
            ],
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": null,
            "DnsOptions": null,
            "DnsSearch": null,
            "ExtraHosts": [],
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": true,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": [
                "label=disable"
            ],
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": null,
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": null,
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": null,
            "ReadonlyPaths": null
        },
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "Mounts": [
            {
                "Type": "bind",
                "Source": "/var/run/docker.sock",
                "Destination": "/var/run/docker.sock",
                "Mode": "rw",
                "RW": true,
                "Propagation": "rprivate"
            }
        ],
        "Config": {
            "Hostname": "890f55628e6d",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": true,
            "AttachStderr": true,
            "ExposedPorts": {
                "2375/tcp": {}
            },
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
                "DOCKER_VERSION=20.10.8",
                "DOCKER_TLS_CERTDIR=/certs"
            ],
            "Cmd": [
                "dockerd",
                "-H",
                "unix:///var/run/docker.sock",
                "-H",
                "tcp://0.0.0.0:2375"
            ],
            "Image": "docker:20.10.8",
            "Volumes": null,
            "WorkingDir": "",
            "Entrypoint": [
                "docker-entrypoint.sh"
            ],
            "OnBuild": null,
            "Labels": {
                "com.docker.compose.config-hash": "3996a18824bc514123dc2c1d61ddff5f36f7076f035e562a90430a5bec6ae368",
                "com.docker.compose.container-number": "1",
                "com.docker.compose.depends_on": "",
                "com.docker.compose.image": "sha256:63107bd6ce718f130bb2668704239467b74f034c446f9e9c4ae1ffa5ddf4e3dd",
                "com.docker.compose.oneoff": "False",
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.project.config_files": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2021-40822/custom_no_tool/docker-compose.yml",
                "com.docker.compose.project.working_dir": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2021-40822/custom_no_tool",
                "com.docker.compose.service": "docker",
                "com.docker.compose.version": "2.40.2",
                "desktop.docker.io/wsl-distro": "Ubuntu"
            },
            "StopTimeout": 1
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "",
            "SandboxKey": "",
            "Ports": {},
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "",
            "Gateway": "",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "",
            "IPPrefixLen": 0,
            "IPv6Gateway": "",
            "MacAddress": "",
            "Networks": {
                "custom_no_tool_default": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": [
                        "custom_no_tool-docker-1",
                        "docker"
                    ],
                    "MacAddress": "",
                    "DriverOpts": null,
                    "GwPriority": 0,
                    "NetworkID": "d4cab854eccf72a96676e9bd9a9f939f1dee9a51d0e2f72b9c25b389cb293698",
                    "EndpointID": "",
                    "Gateway": "",
                    "IPAddress": "",
                    "IPPrefixLen": 0,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "DNSNames": [
                        "custom_no_tool-docker-1",
                        "docker",
                        "890f55628e6d"
                    ]
                }
            }
        },
        "ImageManifestDescriptor": {
            "mediaType": "application/vnd.docker.distribution.manifest.v2+json",
            "digest": "sha256:6ac2f3862aa1353a5fe6bf12439f3e56e695e56d7c3098898c96ef33eae78bf9",
            "size": 1780,
            "platform": {
                "architecture": "amd64",
                "os": "linux"
            }
        }
    }
]