services:
  docker:
    container_name: docker
    image: docker:dind
    privileged: true
    environment:
      DOCKER_TLS_CERTDIR: ''
    command: ["dockerd", "-H", "unix:///var/run/docker.sock", "-H", "tcp://0.0.0.0:2375"]
    ports:
      - "2375:2375"
    networks:
      default:
        aliases:
          - docker
  geoserver:
    image: osgeo/geoserver:2.19.2
    container_name: geoserver
    ports:
      - "8081:8080"
    environment:
      - GEOSERVER_ADMIN_PASSWORD=geoserver
    depends_on:
      - docker
  vulnerable_app:
    build: ./vulnerable_app
    container_name: vulnerable_app
    privileged: true
    depends_on:
      - docker
      - geoserver
    ports:
      - "8080:80"