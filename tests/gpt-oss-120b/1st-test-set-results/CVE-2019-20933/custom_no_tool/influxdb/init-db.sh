#!/bin/bash
# This script runs automatically on container start via the influxdb image entrypoint.
# It creates a sample database and populates it with test data.

set -e

# Wait for InfluxDB to be ready
until curl -s http://localhost:8086/ping; do
  echo "Waiting for InfluxDB to start..."
  sleep 1
done

echo "InfluxDB is up, creating sample data..."

# Create a sample measurement with a few points
time now=$(date +%s)s

curl -i -XPOST "http://localhost:8086/write?db=demo" --data-binary "temperature,location=room1 value=22.5 $now"
curl -i -XPOST "http://localhost:8086/write?db=demo" --data-binary "temperature,location=room2 value=23.1 $now"

echo "Sample data inserted."
