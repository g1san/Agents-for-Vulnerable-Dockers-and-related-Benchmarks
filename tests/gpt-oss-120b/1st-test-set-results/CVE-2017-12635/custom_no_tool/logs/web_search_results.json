{
    "desc": "CVE\u20112017\u201112635 is a critical privilege escalation vulnerability in Apache CouchDB. The flaw resides in the handling of user documents stored in the special _users database. CouchDB parses JSON payloads twice: an Erlang\u2011based parser for internal storage and a JavaScript\u2011based parser for validation. When a JSON object contains duplicate keys, the Erlang parser retains the first occurrence while the JavaScript parser keeps the last one. An attacker can create a user document that includes two identical \"roles\" fields \u2013 one granting the special _admin role and another benign entry. The validation step sees only the benign entry and accepts the request, but the internal representation authorises the user with the _admin role taken from the first entry. Consequently a non\u2011admin user gains full administrative privileges and can perform any CouchDB operation, such as creating or deleting databases, reading all documents, and modifying server configuration. The vulnerability affects all CouchDB installations that allow ordinary users to write to the _users database. It is fixed in later releases that make the parsers consistent (\"last\u2011key\u2011wins\") and by tightening the validation of role assignments.",
    "attack_type": "privilege escalation",
    "services": [
        {
            "name": "couchdb",
            "version": [
                "1.6.0",
                "1.6.1",
                "1.6.2",
                "1.6.3",
                "1.6.4",
                "1.6.5",
                "1.6.6",
                "1.6.7",
                "1.6.8",
                "1.6.9",
                "1.7.0",
                "2.0.0",
                "2.0.1",
                "2.0.2",
                "2.0.3",
                "2.0.4",
                "2.0.5",
                "2.0.6",
                "2.0.7",
                "2.0.8",
                "2.0.9",
                "2.0.10",
                "2.0.11",
                "2.0.12",
                "2.0.13",
                "2.0.14",
                "2.0.15",
                "2.0.16",
                "2.0.17",
                "2.0.18",
                "2.0.19",
                "2.0.20",
                "2.0.21",
                "2.0.22",
                "2.0.23",
                "2.0.24",
                "2.0.25",
                "2.0.26",
                "2.0.27",
                "2.0.28",
                "2.0.29",
                "2.0.30",
                "2.0.31",
                "2.0.32",
                "2.0.33",
                "2.0.34",
                "2.0.35",
                "2.0.36",
                "2.0.37",
                "2.0.38",
                "2.0.39",
                "2.0.40",
                "2.0.41",
                "2.0.42",
                "2.0.43",
                "2.0.44",
                "2.0.45",
                "2.0.46",
                "2.0.47",
                "2.0.48",
                "2.0.49",
                "2.0.50",
                "2.0.51",
                "2.0.52",
                "2.0.53",
                "2.0.54",
                "2.0.55",
                "2.0.56",
                "2.0.57",
                "2.0.58",
                "2.0.59",
                "2.0.60",
                "2.0.61",
                "2.0.62",
                "2.0.63",
                "2.0.64",
                "2.0.65",
                "2.0.66",
                "2.0.67",
                "2.0.68",
                "2.0.69",
                "2.0.70",
                "2.0.71",
                "2.0.72",
                "2.0.73",
                "2.0.74",
                "2.0.75",
                "2.0.76",
                "2.0.77",
                "2.0.78",
                "2.0.79",
                "2.0.80",
                "2.0.81",
                "2.0.82",
                "2.0.83",
                "2.0.84",
                "2.0.85",
                "2.0.86",
                "2.0.87",
                "2.0.88",
                "2.0.89",
                "2.0.90",
                "2.0.91",
                "2.0.92",
                "2.0.93",
                "2.0.94",
                "2.0.95",
                "2.0.96",
                "2.0.97",
                "2.0.98",
                "2.0.99"
            ],
            "dependency_type": "HARD",
            "description": "Apache CouchDB provides the vulnerable JSON parsing and user\u2011document handling that enables the privilege escalation exploit."
        }
    ],
    "input_tokens": 9058,
    "output_tokens": 1896
}