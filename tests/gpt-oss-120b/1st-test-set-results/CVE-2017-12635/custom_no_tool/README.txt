This Docker setup reproduces CVE-2017-12635 (Apache CouchDB privilege escalation).

It builds a CouchDB container (version 2.0.99, which is vulnerable) with a custom validation function that allows a user document containing duplicate "roles" keys. The first occurrence grants the _admin role, while the validation step only sees the last (benign) entry, resulting in administrative privileges for a non‑admin user.

The compose file builds the image from the provided Dockerfile, starts CouchDB on the default port 5984, and automatically creates a test user with the crafted payload via a helper service.

To run:
  cd ./../../dockers/CVE-2017-12635/custom_no_tool
  sudo docker compose up --build -d

After the containers are up, you can verify the privilege escalation by querying the created user:
  curl -u admin:secret http://localhost:5984/_users/org.couchdb.user:eviluser

You should see that the "roles" array includes "_admin".

All services start automatically; no manual configuration is required.

The malicious payload is sent as a raw JSON string directly to CouchDB (via curl) to preserve the duplicate‑key structure required for the exploit, bypassing Docker‑level JSON validation.