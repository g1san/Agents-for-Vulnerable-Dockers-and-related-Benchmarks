services:
  goahead:
    build: ./goahead
    image: custom_goahead:3.5
    container_name: goahead
    ports:
      - "8080:80"
    volumes:
      - ./solr/configsets/vulnerable/templates:/var/www/cgi-bin
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost/"]
      interval: 30s
      timeout: 5s
      retries: 3
  solr:
    image: solr:5.5.5
    container_name: solr
    ports:
      - "8983:8983"
    depends_on:
      - goahead
    volumes:
      - ./solr/configsets:/opt/solr/server/solr/configsets
    command: solr-precreate vulnerable /opt/solr/server/solr/configsets/vulnerable