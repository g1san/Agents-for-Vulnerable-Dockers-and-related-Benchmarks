FROM node:14-alpine
WORKDIR /usr/src/app
COPY package*.json ./
# Install build tools required for native modules (e.g., pg), then install production dependencies, and finally remove the build tools to keep the image lightweight.
RUN apk add --no-cache python3 make g++ \
    && npm install --only=production \
    && apk del python3 make g++
COPY . .
EXPOSE 8080
CMD ["node", "index.js"]