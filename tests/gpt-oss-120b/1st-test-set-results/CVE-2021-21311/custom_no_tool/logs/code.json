{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-21311/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  vulnerable-web:\n    build:\n      context: ./app\n    ports:\n      - \"8081:80\"\n    restart: unless-stopped\n\n  adminer:\n    image: adminer:4.7.8\n    environment:\n      - ADMINER_DEFAULT_SERVER=vulnerable-web\n    ports:\n      - \"8080:8080\"\n    restart: unless-stopped\n"
        },
        {
            "location": "./../../dockers/CVE-2021-21311/custom_no_tool/app/Dockerfile",
            "content": "FROM httpd:2.4.46-alpine\n# Install vulnerable mod_cgi (simulated by adding a simple CGI script)\nRUN apk add --no-cache perl\nCOPY cgi-bin/ /usr/local/apache2/cgi-bin/\nRUN chmod +x /usr/local/apache2/cgi-bin/vuln.cgi\n# Enable CGI module\nRUN echo 'LoadModule cgi_module modules/mod_cgi.so' >> /usr/local/apache2/conf/httpd.conf\nRUN echo 'AddHandler cgi-script .cgi' >> /usr/local/apache2/conf/httpd.conf\nRUN echo 'ScriptAlias /cgi-bin/ \"/usr/local/apache2/cgi-bin/\"' >> /usr/local/apache2/conf/httpd.conf\n"
        },
        {
            "location": "./../../dockers/CVE-2021-21311/custom_no_tool/app/cgi-bin/vuln.cgi",
            "content": "#!/usr/bin/perl\nuse strict;\nuse warnings;\nprint \"Content-type: text/html\\n\\n\";\nmy $cmd = $ENV{'CMD'} || '';\nif ($cmd) {\n    print \"<pre>\" . qx($cmd) . \"</pre>\";\n} else {\n    print \"<form method='GET'>Command: <input name='CMD'/> <input type='submit'/></form>\\n\";\n}\n"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2021-21311/custom_no_tool"
}