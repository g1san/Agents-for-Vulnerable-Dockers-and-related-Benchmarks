{
    "desc": "CVE\u20112020\u201111981 is a remote code execution vulnerability in Apache Airflow versions up to and including 1.10.10 when the CeleryExecutor is used. The Airflow scheduler and workers receive task payloads from an external message broker (Redis or RabbitMQ). Because the payloads are not properly validated, an attacker who can connect to the broker can publish a malicious message that is deserialized by a Celery worker. The worker then executes arbitrary operating\u2011system commands with the privileges of the Airflow process, allowing full compromise of the host running the Celflow worker and, consequently, the entire Airflow deployment.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "apache/airflow",
            "version": [
                "1.10.0",
                "1.10.1",
                "1.10.2",
                "1.10.3",
                "1.10.4",
                "1.10.5",
                "1.10.6",
                "1.10.7",
                "1.10.8",
                "1.10.9",
                "1.10.10"
            ],
            "dependency_type": "HARD",
            "description": "Core Airflow service using CeleryExecutor; contains the vulnerable code path that deserializes broker messages."
        },
        {
            "name": "redis",
            "version": [
                "5.0.9"
            ],
            "dependency_type": "SOFT-CACHE",
            "description": "Message broker used by Airflow CeleryExecutor; required for task queueing and to reproduce the vulnerability scenario."
        },
        {
            "name": "rabbitmq",
            "version": [
                "3.8.9"
            ],
            "dependency_type": "SOFT-CACHE",
            "description": "Alternative message broker for Airflow CeleryExecutor; also needed to provide the queue that can be accessed by an attacker."
        },
        {
            "name": "nginx",
            "version": [
                "1.21.6"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Web server that can front the Airflow web UI; required to run a complete Docker\u2011Compose deployment of Airflow."
        }
    ],
    "input_tokens": 13872,
    "output_tokens": 3880
}