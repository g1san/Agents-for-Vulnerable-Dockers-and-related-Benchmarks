time="2025-10-30T01:43:34+01:00" level=warning msg="/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2019-6116/custom_no_tool/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
#1 [internal] load local bake definitions
#1 reading from stdin 759B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile:
#2 transferring dockerfile: 732B done
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/library/alpine:3.12
#3 DONE 2.1s

#4 [internal] load .dockerignore
#4 transferring context: 2B done
#4 DONE 0.0s

#5 [1/7] FROM docker.io/library/alpine:3.12@sha256:c75ac27b49326926b803b9ed43bf088bc220d22556de1bc5f72d742c91398f69
#5 resolve docker.io/library/alpine:3.12@sha256:c75ac27b49326926b803b9ed43bf088bc220d22556de1bc5f72d742c91398f69 0.0s done
#5 ...

#6 [internal] load build context
#6 transferring context: 1.11kB done
#6 DONE 0.0s

#5 [1/7] FROM docker.io/library/alpine:3.12@sha256:c75ac27b49326926b803b9ed43bf088bc220d22556de1bc5f72d742c91398f69
#5 sha256:1b7ca6aea1ddfe716f3694edb811ab35114db9e93f3ce38d7dab6b4d9270cb0c 0B / 2.81MB 0.2s
#5 sha256:1b7ca6aea1ddfe716f3694edb811ab35114db9e93f3ce38d7dab6b4d9270cb0c 2.10MB / 2.81MB 0.5s
#5 sha256:1b7ca6aea1ddfe716f3694edb811ab35114db9e93f3ce38d7dab6b4d9270cb0c 2.81MB / 2.81MB 0.5s done
#5 extracting sha256:1b7ca6aea1ddfe716f3694edb811ab35114db9e93f3ce38d7dab6b4d9270cb0c 0.1s done
#5 DONE 0.7s

#7 [2/7] RUN apk add --no-cache curl tar &&     curl -L -o /tmp/docker.tgz https://download.docker.com/linux/static/stable/x86_64/docker-18.09.7.tgz &&     tar -xzvf /tmp/docker.tgz -C /usr/local/bin --strip-components=1 docker/docker &&     chmod +x /usr/local/bin/docker &&     rm -rf /tmp/docker.tgz &&     apk del curl tar
#7 0.209 fetch http://dl-cdn.alpinelinux.org/alpine/v3.12/main/x86_64/APKINDEX.tar.gz
#7 0.434 fetch http://dl-cdn.alpinelinux.org/alpine/v3.12/community/x86_64/APKINDEX.tar.gz
#7 0.637 (1/6) Installing ca-certificates (20220614-r0)
#7 0.681 (2/6) Installing nghttp2-libs (1.41.0-r0)
#7 0.704 (3/6) Installing libcurl (7.79.1-r1)
#7 0.737 (4/6) Installing curl (7.79.1-r1)
#7 0.770 (5/6) Installing libacl (2.2.53-r0)
#7 0.787 (6/6) Installing tar (1.32-r2)
#7 0.842 Executing busybox-1.31.1-r22.trigger
#7 0.846 Executing ca-certificates-20220614-r0.trigger
#7 0.884 OK: 8 MiB in 20 packages
#7 0.903   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
#7 0.903                                  Dload  Upload   Total   Spent    Left  Speed
#7 0.903 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0 45.8M    0 41528    0     0  52675      0  0:15:12 --:--:--  0:15:12 52633
 19 45.8M   19 9127k    0     0  5269k      0  0:00:08  0:00:01  0:00:07 5269k
 52 45.8M   52 23.9M    0     0  8978k      0  0:00:05  0:00:02  0:00:03 8977k
 84 45.8M   84 38.7M    0     0  10.3M      0  0:00:04  0:00:03  0:00:01 10.3M
100 45.8M  100 45.8M    0     0  10.8M      0  0:00:04  0:00:04 --:--:-- 10.8M
#7 5.114 docker/docker
#7 6.259 WARNING: Ignoring http://dl-cdn.alpinelinux.org/alpine/v3.12/main: No such file or directory
#7 6.259 WARNING: Ignoring http://dl-cdn.alpinelinux.org/alpine/v3.12/community: No such file or directory
#7 6.259 (1/6) Purging curl (7.79.1-r1)
#7 6.259 (2/6) Purging tar (1.32-r2)
#7 6.259 (3/6) Purging libcurl (7.79.1-r1)
#7 6.259 (4/6) Purging ca-certificates (20220614-r0)
#7 6.262 Executing ca-certificates-20220614-r0.post-deinstall
#7 6.269 (5/6) Purging nghttp2-libs (1.41.0-r0)
#7 6.269 (6/6) Purging libacl (2.2.53-r0)
#7 6.269 Executing busybox-1.31.1-r22.trigger
#7 6.272 OK: 6 MiB in 14 packages
#7 DONE 6.4s

#8 [3/7] RUN apk add --no-cache python3 py3-pip &&     pip3 install flask
#8 0.200 fetch http://dl-cdn.alpinelinux.org/alpine/v3.12/main/x86_64/APKINDEX.tar.gz
#8 0.330 fetch http://dl-cdn.alpinelinux.org/alpine/v3.12/community/x86_64/APKINDEX.tar.gz
#8 0.479 (1/36) Installing libbz2 (1.0.8-r1)
#8 0.503 (2/36) Installing expat (2.2.10-r4)
#8 0.534 (3/36) Installing libffi (3.3-r2)
#8 0.563 (4/36) Installing gdbm (1.13-r1)
#8 0.594 (5/36) Installing xz-libs (5.2.5-r1)
#8 0.626 (6/36) Installing ncurses-terminfo-base (6.2_p20200523-r1)
#8 0.657 (7/36) Installing ncurses-libs (6.2_p20200523-r1)
#8 0.700 (8/36) Installing readline (8.0.4-r0)
#8 0.729 (9/36) Installing sqlite-libs (3.32.1-r1)
#8 0.780 (10/36) Installing python3 (3.8.10-r0)
#8 1.712 (11/36) Installing py3-appdirs (1.4.4-r1)
#8 1.733 (12/36) Installing py3-ordered-set (4.0.1-r0)
#8 1.753 (13/36) Installing py3-parsing (2.4.7-r0)
#8 1.782 (14/36) Installing py3-six (1.15.0-r0)
#8 1.802 (15/36) Installing py3-packaging (20.4-r0)
#8 1.828 (16/36) Installing py3-setuptools (47.0.0-r0)
#8 1.873 (17/36) Installing py3-chardet (3.0.4-r4)
#8 1.914 (18/36) Installing py3-idna (2.9-r0)
#8 1.942 (19/36) Installing py3-certifi (2020.4.5.1-r0)
#8 1.988 (20/36) Installing py3-urllib3 (1.25.9-r0)
#8 2.124 (21/36) Installing py3-requests (2.23.0-r0)
#8 2.154 (22/36) Installing py3-msgpack (1.0.0-r0)
#8 2.197 (23/36) Installing py3-lockfile (0.12.2-r3)
#8 2.236 (24/36) Installing py3-cachecontrol (0.12.6-r0)
#8 2.281 (25/36) Installing py3-colorama (0.4.3-r0)
#8 2.788 (26/36) Installing py3-distlib (0.3.0-r0)
#8 3.373 (27/36) Installing py3-distro (1.5.0-r1)
#8 3.416 (28/36) Installing py3-webencodings (0.5.1-r3)
#8 3.454 (29/36) Installing py3-html5lib (1.0.1-r4)
#8 3.511 (30/36) Installing py3-pytoml (0.1.21-r0)
#8 3.550 (31/36) Installing py3-pep517 (0.8.2-r0)
#8 3.588 (32/36) Installing py3-progress (1.5-r0)
#8 3.625 (33/36) Installing py3-toml (0.10.1-r0)
#8 3.649 (34/36) Installing py3-retrying (1.3.3-r0)
#8 3.684 (35/36) Installing py3-contextlib2 (0.6.0-r0)
#8 3.720 (36/36) Installing py3-pip (20.1.1-r0)
#8 3.834 Executing busybox-1.31.1-r22.trigger
#8 3.840 OK: 66 MiB in 50 packages
#8 4.320 Collecting flask
#8 4.414   Downloading flask-3.0.3-py3-none-any.whl (101 kB)
#8 4.626 Collecting importlib-metadata>=3.6.0; python_version < "3.10"
#8 4.644   Downloading importlib_metadata-8.5.0-py3-none-any.whl (26 kB)
#8 4.734 Collecting blinker>=1.6.2
#8 4.750   Downloading blinker-1.8.2-py3-none-any.whl (9.5 kB)
#8 4.858 Collecting Werkzeug>=3.0.0
#8 4.877   Downloading werkzeug-3.0.6-py3-none-any.whl (227 kB)
#8 4.977 Collecting itsdangerous>=2.1.2
#8 4.993   Downloading itsdangerous-2.2.0-py3-none-any.whl (16 kB)
#8 5.081 Collecting click>=8.1.3
#8 5.323   Downloading click-8.1.8-py3-none-any.whl (98 kB)
#8 5.411 Collecting Jinja2>=3.1.2
#8 5.471   Downloading jinja2-3.1.6-py3-none-any.whl (134 kB)
#8 5.585 Collecting zipp>=3.20
#8 5.603   Downloading zipp-3.20.2-py3-none-any.whl (9.2 kB)
#8 5.946 Collecting MarkupSafe>=2.1.1
#8 5.965   Downloading MarkupSafe-2.1.5.tar.gz (19 kB)
#8 6.187 Using legacy setup.py install for MarkupSafe, since package 'wheel' is not installed.
#8 6.266 Installing collected packages: zipp, importlib-metadata, blinker, MarkupSafe, Werkzeug, itsdangerous, click, Jinja2, flask
#8 6.327     Running setup.py install for MarkupSafe: started
#8 6.577     Running setup.py install for MarkupSafe: finished with status 'done'
#8 6.978 Successfully installed Jinja2-3.1.6 MarkupSafe-2.1.5 Werkzeug-3.0.6 blinker-1.8.2 click-8.1.8 flask-3.0.3 importlib-metadata-8.5.0 itsdangerous-2.2.0 zipp-3.20.2
#8 DONE 7.4s

#9 [4/7] WORKDIR /app
#9 DONE 0.1s

#10 [5/7] COPY app.py /app/app.py
#10 DONE 0.0s

#11 [6/7] COPY entrypoint.sh /app/entrypoint.sh
#11 DONE 0.0s

#12 [7/7] RUN chmod +x /app/entrypoint.sh
#12 DONE 0.2s

#13 exporting to image
#13 exporting layers
#13 exporting layers 2.3s done
#13 exporting manifest sha256:5606ca6e362a33cdb14fba071eaaddd29537b304cf2b34edcd30dce5da412c2e 0.0s done
#13 exporting config sha256:2461dc4ae8c058df6f7c43ded4728aa2575432e7ecaaad612a71cb68c3d6d90f done
#13 exporting attestation manifest sha256:5de16796c0c5a5ef4adb037b01ca990f8e67478db087d788dc57565c4f2207cc 0.0s done
#13 exporting manifest list sha256:023c1bda7d8a9a1fcf1c78e97ce5bb0b811a88d414a742a655c83285a5403f10 0.0s done
#13 naming to docker.io/library/custom_no_tool-vulnerable_app:latest done
#13 unpacking to docker.io/library/custom_no_tool-vulnerable_app:latest
#13 unpacking to docker.io/library/custom_no_tool-vulnerable_app:latest 1.1s done
#13 DONE 3.4s

#14 resolving provenance for metadata file
#14 DONE 0.0s
 custom_no_tool-vulnerable_app  Built
 Network custom_no_tool_default  Creating
 Network custom_no_tool_default  Created
 Container custom_no_tool-vulnerable_app-1  Creating
 Container custom_no_tool-vulnerable_app-1  Created
 Container custom_no_tool-vulnerable_app-1  Starting
 Container custom_no_tool-vulnerable_app-1  Started


sudo docker logs 6a7f06a45374515106d1ee2bf00bca31f7c963e4fff95a39d09e9b3dbba0d25b --details
STDOUT:   * Serving Flask app 'app'
  * Debug mode: off

STDERR:  WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
  * Running on all addresses (0.0.0.0)
  * Running on http://127.0.0.1:8080
  * Running on http://172.18.0.2:8080
 Press CTRL+C to quit




sudo docker inspect 6a7f06a45374515106d1ee2bf00bca31f7c963e4fff95a39d09e9b3dbba0d25b[
    {
        "Id": "6a7f06a45374515106d1ee2bf00bca31f7c963e4fff95a39d09e9b3dbba0d25b",
        "Created": "2025-10-30T00:43:55.638310439Z",
        "Path": "/app/entrypoint.sh",
        "Args": [],
        "State": {
            "Status": "running",
            "Running": true,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 15049,
            "ExitCode": 0,
            "Error": "",
            "StartedAt": "2025-10-30T00:43:56.007307536Z",
            "FinishedAt": "0001-01-01T00:00:00Z"
        },
        "Image": "sha256:023c1bda7d8a9a1fcf1c78e97ce5bb0b811a88d414a742a655c83285a5403f10",
        "ResolvConfPath": "/var/lib/docker/containers/6a7f06a45374515106d1ee2bf00bca31f7c963e4fff95a39d09e9b3dbba0d25b/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/6a7f06a45374515106d1ee2bf00bca31f7c963e4fff95a39d09e9b3dbba0d25b/hostname",
        "HostsPath": "/var/lib/docker/containers/6a7f06a45374515106d1ee2bf00bca31f7c963e4fff95a39d09e9b3dbba0d25b/hosts",
        "LogPath": "/var/lib/docker/containers/6a7f06a45374515106d1ee2bf00bca31f7c963e4fff95a39d09e9b3dbba0d25b/6a7f06a45374515106d1ee2bf00bca31f7c963e4fff95a39d09e9b3dbba0d25b-json.log",
        "Name": "/custom_no_tool-vulnerable_app-1",
        "RestartCount": 0,
        "Driver": "overlayfs",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": [
                "/var/run/docker.sock:/var/run/docker.sock:rw"
            ],
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "custom_no_tool_default",
            "PortBindings": {
                "8080/tcp": [
                    {
                        "HostIp": "",
                        "HostPort": "8080"
                    }
                ]
            },
            "RestartPolicy": {
                "Name": "unless-stopped",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "ConsoleSize": [
                0,
                0
            ],
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": null,
            "DnsOptions": null,
            "DnsSearch": null,
            "ExtraHosts": [],
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": true,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": [
                "label=disable"
            ],
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": null,
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": null,
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": null,
            "ReadonlyPaths": null
        },
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "Mounts": [
            {
                "Type": "bind",
                "Source": "/var/run/docker.sock",
                "Destination": "/var/run/docker.sock",
                "Mode": "rw",
                "RW": true,
                "Propagation": "rprivate"
            }
        ],
        "Config": {
            "Hostname": "6a7f06a45374",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": true,
            "AttachStderr": true,
            "ExposedPorts": {
                "8080/tcp": {}
            },
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "VULN_MODE=exploit",
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
            ],
            "Cmd": null,
            "Image": "custom_no_tool-vulnerable_app",
            "Volumes": null,
            "WorkingDir": "/app",
            "Entrypoint": [
                "/app/entrypoint.sh"
            ],
            "OnBuild": null,
            "Labels": {
                "com.docker.compose.config-hash": "2a4477d1ee3c309e9eb2c428869e75d9e9e58be7c9406b97c5bc28d42bd847b7",
                "com.docker.compose.container-number": "1",
                "com.docker.compose.depends_on": "",
                "com.docker.compose.image": "sha256:023c1bda7d8a9a1fcf1c78e97ce5bb0b811a88d414a742a655c83285a5403f10",
                "com.docker.compose.oneoff": "False",
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.project.config_files": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2019-6116/custom_no_tool/docker-compose.yml",
                "com.docker.compose.project.working_dir": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2019-6116/custom_no_tool",
                "com.docker.compose.service": "vulnerable_app",
                "com.docker.compose.version": "2.40.2",
                "desktop.docker.io/wsl-distro": "Ubuntu"
            },
            "StopTimeout": 1
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "5201fb0a83f7c0a6b6bd3b0a32677cf11e0a247c0b7b154579bab8ac2d538c8b",
            "SandboxKey": "/var/run/docker/netns/5201fb0a83f7",
            "Ports": {
                "8080/tcp": [
                    {
                        "HostIp": "0.0.0.0",
                        "HostPort": "8080"
                    },
                    {
                        "HostIp": "::",
                        "HostPort": "8080"
                    }
                ]
            },
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "",
            "Gateway": "",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "",
            "IPPrefixLen": 0,
            "IPv6Gateway": "",
            "MacAddress": "",
            "Networks": {
                "custom_no_tool_default": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": [
                        "custom_no_tool-vulnerable_app-1",
                        "vulnerable_app"
                    ],
                    "MacAddress": "62:62:cf:ba:e6:62",
                    "DriverOpts": null,
                    "GwPriority": 0,
                    "NetworkID": "c23460bf3eb3da3cfd2e5522fa14a24f2f5ef4913c2f0fd2b05838d25d94ec28",
                    "EndpointID": "b80a0bbf3fef3cad3513e72e1982c830130bbf7ce23c4096127f4d2429b67458",
                    "Gateway": "172.18.0.1",
                    "IPAddress": "172.18.0.2",
                    "IPPrefixLen": 16,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "DNSNames": [
                        "custom_no_tool-vulnerable_app-1",
                        "vulnerable_app",
                        "6a7f06a45374"
                    ]
                }
            }
        },
        "ImageManifestDescriptor": {
            "mediaType": "application/vnd.oci.image.manifest.v1+json",
            "digest": "sha256:5606ca6e362a33cdb14fba071eaaddd29537b304cf2b34edcd30dce5da412c2e",
            "size": 1618,
            "platform": {
                "architecture": "amd64",
                "os": "linux"
            }
        }
    }
]

sudo docker inspect 023c1bda7d8a[
    {
        "Id": "sha256:023c1bda7d8a9a1fcf1c78e97ce5bb0b811a88d414a742a655c83285a5403f10",
        "RepoTags": [
            "custom_no_tool-vulnerable_app:latest"
        ],
        "RepoDigests": [
            "custom_no_tool-vulnerable_app@sha256:023c1bda7d8a9a1fcf1c78e97ce5bb0b811a88d414a742a655c83285a5403f10"
        ],
        "Parent": "",
        "Comment": "buildkit.dockerfile.v0",
        "Created": "2025-10-30T00:43:51.998966365Z",
        "DockerVersion": "",
        "Author": "",
        "Architecture": "amd64",
        "Os": "linux",
        "Size": 36246505,
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "RootFS": {
            "Type": "layers",
            "Layers": [
                "sha256:1ad27bdd166b922492031b1938a4fb2f775e3d98c8f1b72051dad0570a4dd1b5",
                "sha256:8fd5cc4d95a75611b20a17766bb345ea0366636b71d33b62d32cb762d542f962",
                "sha256:f218fce63ecf5b8a28a4c45fcb6f8df402c1e15b7c6e021d0aee589d51704ed5",
                "sha256:775593a23844a52a9be8da4604cfd1ddc4c7e9ecf6888e975a34f85dc3ee1acf",
                "sha256:284b986c74bb1fa542ad777dff872b9926dd43a6f5b2df5132089a4a05cf5626",
                "sha256:0d675a2da12f0f5b74291d8139792b31b75a0c32beda6f94c9ee49f24d6aab60",
                "sha256:6a801a87a8a3b25471d56fd36bab61239fd8c08990d5896fe8cbcbee2b4f42a0"
            ]
        },
        "Metadata": {
            "LastTagTime": "2025-10-30T00:43:54.326254143Z"
        },
        "Descriptor": {
            "mediaType": "application/vnd.oci.image.index.v1+json",
            "digest": "sha256:023c1bda7d8a9a1fcf1c78e97ce5bb0b811a88d414a742a655c83285a5403f10",
            "size": 856
        },
        "Config": {
            "Cmd": null,
            "Entrypoint": [
                "/app/entrypoint.sh"
            ],
            "Env": [
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
            ],
            "ExposedPorts": {
                "8080/tcp": {}
            },
            "Labels": {
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.service": "vulnerable_app",
                "com.docker.compose.version": "2.40.2"
            },
            "OnBuild": null,
            "User": "",
            "Volumes": null,
            "WorkingDir": "/app"
        }
    }
]