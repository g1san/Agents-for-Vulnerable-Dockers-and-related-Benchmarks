{
    "files": [
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/docker-compose.yml",
            "content": "services:\n  vulnerable_app:\n    build: ./vulnerable\n    privileged: true\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n    ports:\n      - \"8080:8080\"\n    environment:\n      - VULN_MODE=exploit\n    restart: unless-stopped"
        },
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/vulnerable/Dockerfile",
            "content": "FROM artifex/ghostscript:9.25\n\n# Install dependencies: CA certificates, Python, Flask, curl, tar, Docker client, and wheel package\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends ca-certificates python3 python3-pip curl tar docker.io && \\\n    rm -rf /var/lib/apt/lists/* && \\\n    pip3 install --no-cache-dir flask\n\nWORKDIR /app\nCOPY app.py /app/app.py\nCOPY entrypoint.sh /app/entrypoint.sh\nRUN chmod +x /app/entrypoint.sh\n\nEXPOSE 8080\nENTRYPOINT [\"/app/entrypoint.sh\"]"
        },
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/vulnerable/app.py",
            "content": "from flask import Flask, request, jsonify\nimport subprocess\n\napp = Flask(__name__)\n\n@app.route('/run', methods=['POST'])\ndef run_command():\n    data = request.get_json()\n    cmd = data.get('cmd')\n    if not cmd:\n        return jsonify({'error': 'No command provided'}), 400\n    try:\n        result = subprocess.check_output(cmd, shell=True, stderr=subprocess.STDOUT, timeout=5)\n        return jsonify({'output': result.decode()})\n    except subprocess.CalledProcessError as e:\n        return jsonify({'error': e.output.decode()}), 500\n    except Exception as e:\n        return jsonify({'error': str(e)}), 500\n\n@app.route('/')\ndef index():\n    return 'Vulnerable app for CVE-2019-6116 testing'\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=8080)"
        },
        {
            "location": "./../../dockers/CVE-2019-6116/custom_no_tool/vulnerable/entrypoint.sh",
            "content": "#!/bin/sh\nexec python3 /app/app.py"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2019-6116/custom_no_tool"
}