FROM artifex/ghostscript:9.25

# Install dependencies: CA certificates, Python, Flask, curl, tar, Docker client, and wheel package
RUN apt-get update && \
    apt-get install -y --no-install-recommends ca-certificates python3 python3-pip curl tar docker.io && \
    rm -rf /var/lib/apt/lists/* && \
    pip3 install --no-cache-dir flask

WORKDIR /app
COPY app.py /app/app.py
COPY entrypoint.sh /app/entrypoint.sh
RUN chmod +x /app/entrypoint.sh

EXPOSE 8080
ENTRYPOINT ["/app/entrypoint.sh"]