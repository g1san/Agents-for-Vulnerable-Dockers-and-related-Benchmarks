FROM ubuntu:16.04

ENV ES_VERSION=1.4.2
ENV ES_HOME=/usr/share/elasticsearch
ENV ES_DATA=/usr/share/elasticsearch/data
ENV ES_CONF=/usr/share/elasticsearch/config
ENV ES_LOGS=/usr/share/elasticsearch/logs

RUN apt-get update && \
    DEBIAN_FRONTEND=noninteractive apt-get install -y wget gnupg openjdk-8-jre && \
    mkdir -p $ES_HOME && \
    wget -q https://download.elasticsearch.org/elasticsearch/elasticsearch/elasticsearch-${ES_VERSION}.tar.gz -O /tmp/elasticsearch.tar.gz && \
    tar -xzf /tmp/elasticsearch.tar.gz -C $ES_HOME --strip-components=1 && \
    rm /tmp/elasticsearch.tar.gz && \
    chown -R root:root $ES_HOME && \
    mkdir -p $ES_DATA && \
    mkdir -p $ES_CONF && \
    mkdir -p $ES_LOGS && \
    apt-get clean && rm -rf /var/lib/apt/lists/*

ENV PATH=$ES_HOME/bin:$PATH

EXPOSE 9200 9300

WORKDIR $ES_HOME

CMD ["elasticsearch", "-Des.default.path.data=/usr/share/elasticsearch/data", "-Des.default.path.logs=/usr/share/elasticsearch/logs"]
