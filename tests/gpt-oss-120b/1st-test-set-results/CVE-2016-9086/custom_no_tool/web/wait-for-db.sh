#!/bin/sh
set -e
HOST="${DATABASE_HOST}"
PORT=5432
# Wait until pg_isready reports the server is accepting connections
until pg_isready -h "$HOST" -p "$PORT" > /dev/null 2>&1; do
  echo "Waiting for PostgreSQL at $HOST:$PORT..."
  sleep 2
done
# Exec the command passed to the script (gunicorn)
exec "$@"