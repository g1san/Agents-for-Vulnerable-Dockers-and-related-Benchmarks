#!/bin/sh

# Run initialization SQL script if it exists
if [ -f /opt/init.sql ]; then
  java -cp /opt/h2.jar org.h2.tools.RunScript \
    -url jdbc:h2:/opt/h2-data/test \
    -script /opt/init.sql \
    -user sa \
    -password ''
fi

# Build the option list for the H2 Server
OPTIONS="-web -tcp -baseDir /opt/h2-data"

if [ "$WEB_ALLOW_OTHERS" = "true" ]; then
  OPTIONS="$OPTIONS -webAllowOthers"
fi

if [ "$TCP_ALLOW_OTHERS" = "true" ]; then
  OPTIONS="$OPTIONS -tcpAllowOthers"
fi

# Start the H2 Server with the computed options
exec java -cp /opt/h2.jar org.h2.tools.Server $OPTIONS