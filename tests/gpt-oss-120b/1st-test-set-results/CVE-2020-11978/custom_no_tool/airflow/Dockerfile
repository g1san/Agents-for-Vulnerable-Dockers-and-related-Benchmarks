FROM apache/airflow:1.10.10

# Switch to root to create the directory that will hold the SQLite DB and set correct permissions
USER root
RUN mkdir -p /usr/local/airflow && chown -R airflow:airflow /usr/local/airflow

# Copy the custom entrypoint script and make it executable
COPY entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh \
    && chown airflow:airflow /entrypoint.sh

# Return to the default nonâ€‘root airflow user provided by the base image
USER airflow