services:
  airflow:
    build: ./airflow
    environment:
      - AIRFLOW__CORE__LOAD_EXAMPLES=False
      - AIRFLOW__CORE__EXECUTOR=SequentialExecutor
      - AIRFLOW__CORE__SQL_ALCHEMY_CONN=sqlite:////usr/local/airflow/airflow.db
    ports:
      - "8080:8080"
    entrypoint: ["sh", "/entrypoint.sh"]
    command: ["webserver"]
    volumes:
      - airflow_data:/usr/local/airflow
  scheduler:
    build: ./airflow
    environment:
      - AIRFLOW__CORE__LOAD_EXAMPLES=False
      - AIRFLOW__CORE__EXECUTOR=SequentialExecutor
      - AIRFLOW__CORE__SQL_ALCHEMY_CONN=sqlite:////usr/local/airflow/airflow.db
    entrypoint: ["sh", "/entrypoint.sh"]
    command: ["scheduler"]
    depends_on:
      - airflow
    volumes:
      - airflow_data:/usr/local/airflow
volumes:
  airflow_data: