{
    "files": [
        {
            "location": "./../../dockers/CVE-2016-5385/custom_no_tool/docker-compose.yml",
            "content": "services:\n  httpd:\n    build: ./httpd\n    ports:\n      - \"8080:80\"\n    depends_on:\n      php:\n        condition: service_healthy\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost/\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n  php:\n    build: ./php\n    expose:\n      - \"9000\"\n    healthcheck:\n      test: [\"CMD\", \"php-fpm-healthcheck\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5"
        },
        {
            "location": "./../../dockers/CVE-2016-5385/custom_no_tool/httpd/Dockerfile",
            "content": "FROM httpd:2.4.54\n\n# Install curl (required for healthcheck and wait\u2011for\u2011it script)\nRUN apt-get update && \\\n    apt-get install -y curl && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Download wait\u2011for\u2011it script at build time\nRUN curl -fsSL https://raw.githubusercontent.com/vishnubob/wait-for-it/master/wait-for-it.sh -o /usr/local/bin/wait-for-it.sh && \\\n    chmod +x /usr/local/bin/wait-for-it.sh\n\n# Apache configuration to proxy PHP requests to php\u2011fpm\nRUN echo 'LoadModule proxy_module modules/mod_proxy.so' >> /usr/local/apache2/conf/httpd.conf && \\\n    echo 'LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so' >> /usr/local/apache2/conf/httpd.conf && \\\n    echo 'ProxyPassMatch ^/(.*\\\\.php)$ fcgi://php:9000/var/www/html/\\\\$1' >> /usr/local/apache2/conf/httpd.conf && \\\n    echo 'ProxyPassReverse ^/(.*\\\\.php)$ fcgi://php:9000/var/www/html/\\\\$1' >> /usr/local/apache2/conf/httpd.conf && \\\n    echo 'DirectoryIndex index.php index.html' >> /usr/local/apache2/conf/httpd.conf && \\\n    echo 'DocumentRoot /usr/local/apache2/htdocs' >> /usr/local/apache2/conf/httpd.conf && \\\n    echo 'ServerName localhost' >> /usr/local/apache2/conf/httpd.conf && \\\n    echo '<Directory \"/usr/local/apache2/htdocs\">' >> /usr/local/apache2/conf/httpd.conf && \\\n    echo '    Options Indexes FollowSymLinks' >> /usr/local/apache2/conf/httpd.conf && \\\n    echo '    AllowOverride All' >> /usr/local/apache2/conf/httpd.conf && \\\n    echo '    Require all granted' >> /usr/local/apache2/conf/httpd.conf && \\\n    echo '</Directory>' >> /usr/local/apache2/conf/httpd.conf && \\\n    echo 'DirectoryIndex index.php index.html' >> /usr/local/apache2/conf/httpd.conf\n\n# Copy web content (index.php) into the container\nCOPY public/ /usr/local/apache2/htdocs/\n\n# Entry point waits for PHP\u2011FPM to be ready before starting Apache\nENTRYPOINT [\"/usr/local/bin/wait-for-it.sh\", \"php:9000\", \"--\", \"httpd-foreground\"]"
        },
        {
            "location": "./../../dockers/CVE-2016-5385/custom_no_tool/httpd/public/index.php",
            "content": "<?php\n// Simple PHP script that triggers an outbound HTTP request to demonstrate the httpd\u2011php\u2011fpm setup.\n// It also allows us to observe the HTTP_PROXY environment variable handling.\n\n// Perform an outbound request (this will go through the proxy if set).\n$ch = curl_init('https://httpbin.org/get');\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n$response = curl_exec($ch);\ncurl_close($ch);\n\nheader('Content-Type: text/plain');\necho \"CVE\u20112016\u20115385 demo \u2013 httpd container\\n\";\necho \"Outbound request response snippet: \\n\";\necho substr($response, 0, 200);\n?>"
        },
        {
            "location": "./../../dockers/CVE-2016-5385/custom_no_tool/php/Dockerfile",
            "content": "FROM php:5.6-fpm-buster\n\n# Install required packages and PHP extensions (including MySQL client dev headers for mysqli)\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends \\\n        curl \\\n        build-essential \\\n        libpng-dev \\\n        libjpeg-dev \\\n        libfreetype6-dev \\\n        default-mysql-client \\\n        default-libmysqlclient-dev \\\n        pkg-config && \\\n    docker-php-ext-install mysqli && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Add health\u2011check script\nRUN echo \"#!/bin/sh\\nphp-fpm -t\" > /usr/local/bin/php-fpm-healthcheck && \\\n    chmod +x /usr/local/bin/php-fpm-healthcheck"
        },
        {
            "location": "./../../dockers/CVE-2016-5385/custom_no_tool/php/public/index.php",
            "content": "<?php\n// Simple PHP script to demonstrate the httpd\u2011php\u2011fpm integration.\n// When accessed via Apache it will be forwarded to this container.\n\nheader('Content-Type: text/plain');\necho \"CVE\u20112016\u20115385 demo \u2013 php\u2011fpm container\\n\";\n?>"
        }
    ],
    "directory_tree": "CVE-2016-5385/custom_no_tool"
}