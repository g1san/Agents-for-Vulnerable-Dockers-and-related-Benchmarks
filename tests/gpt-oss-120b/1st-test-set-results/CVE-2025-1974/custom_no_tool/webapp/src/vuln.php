<?php
/*
 * Demo vulnerable endpoint for CVE-2025-1974.
 * The vulnerability allows remote command execution when VULN_MODE=unsafe.
 */
if (getenv('VULN_MODE') === 'unsafe') {
    $cmd = $_GET['cmd'] ?? '';
    // Dangerous function: passes user-supplied data directly to shell execution
    $output = shell_exec($cmd);
    echo "<pre>$output</pre>";
} else {
    echo 'Vulnerability disabled.';
}
?>