{
    "files": [
        {
            "location": "./../../dockers/CVE-2018-1000533/custom_no_tool/docker-compose.yml",
            "content": "services:\n  dockerd:\n    image: docker:18.09.7-dind\n    privileged: true\n    environment:\n      - DOCKER_TLS_CERTDIR=\n    ports:\n      - \"2375:2375\"\n    volumes:\n      - dockerd-data:/var/lib/docker\n\n  registry:\n    image: registry:2\n    ports:\n      - \"5000:5000\"\n    environment:\n      - REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY=/var/lib/registry\n    volumes:\n      - registry-data:/var/lib/registry\n\n  malicious:\n    build: ./malicious\n    environment:\n      - DOCKER_HOST=tcp://dockerd:2375\n    command: >\n      sh -c \"docker tag custom_no_tool-malicious registry:5000/malicious && docker push registry:5000/malicious\"\n    depends_on:\n      - dockerd\n      - registry\n    restart: \"no\"\n\n  vulnerable_app:\n    build: ./vulnerable_app\n    environment:\n      - DOCKER_HOST=tcp://dockerd:2375\n    depends_on:\n      - dockerd\n      - registry\n      - malicious\n\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: testdb\n      MYSQL_USER: tester\n      MYSQL_PASSWORD: testpass\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - ./db_init:/docker-entrypoint-initdb.d\n\nvolumes:\n  dockerd-data:\n  registry-data:"
        },
        {
            "location": "./../../dockers/CVE-2018-1000533/custom_no_tool/malicious/Dockerfile",
            "content": "FROM docker:20.10-cli\nRUN echo \"Malicious container for CVE-2018-1000533 demonstration\" > /malicious.txt\nCMD [\"cat\",\"/malicious.txt\"]"
        },
        {
            "location": "./../../dockers/CVE-2018-1000533/custom_no_tool/vulnerable_app/Dockerfile",
            "content": "FROM docker:20.10-cli\nRUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*\nRUN mkdir -p /app\nCOPY entrypoint.sh /app/entrypoint.sh\nRUN chmod +x /app/entrypoint.sh\nENTRYPOINT [\"/app/entrypoint.sh\"]"
        },
        {
            "location": "./../../dockers/CVE-2018-1000533/custom_no_tool/vulnerable_app/entrypoint.sh",
            "content": "#!/bin/sh\n# Wait until the local registry is ready\nwhile ! curl -s http://registry:5000/v2/_catalog > /dev/null; do\n  echo \"Waiting for registry to become available...\"\n  sleep 2\ndone\n\necho \"Registry is up. Pulling malicious image...\"\n# Pull the malicious image from the registry service\ndocker pull registry:5000/malicious\n\nif [ $? -ne 0 ]; then\n  echo \"Failed to pull malicious image. Exiting.\"\n  exit 1\nfi\n\necho \"Running malicious container...\"\n# Run the image (remove container after it exits)\ndocker run --rm registry:5000/malicious"
        },
        {
            "location": "./../../dockers/CVE-2018-1000533/custom_no_tool/db_init/init.sql",
            "content": "CREATE TABLE users (id INT AUTO_INCREMENT PRIMARY KEY, username VARCHAR(50), password VARCHAR(50));\nINSERT INTO users (username, password) VALUES ('alice','password1'),('bob','password2');"
        }
    ],
    "directory_tree": "custom_no_tool"
}