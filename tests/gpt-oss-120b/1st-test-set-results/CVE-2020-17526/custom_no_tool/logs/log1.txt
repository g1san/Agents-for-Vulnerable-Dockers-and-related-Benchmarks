time="2025-10-29T15:05:22+01:00" level=warning msg="/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2020-17526/custom_no_tool/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
 postgres Pulling 
 a0448fbfd5a3 Pulling fs layer 
 32b11818cae3 Pulling fs layer 
 bad2b1f0e9bd Pulling fs layer 
 f30287ef02b9 Pulling fs layer 
 e051487b101d Pulling fs layer 
 dc1f0e9024d8 Pulling fs layer 
 75a54e59e691 Pulling fs layer 
 7f0a68628bce Pulling fs layer 
 20a002889a9a Pulling fs layer 
 48111fe612c1 Pulling fs layer 
 b37effddbb9c Pulling fs layer 
 3ce7f8df2b36 Pulling fs layer 
 32b11818cae3 Download complete 
 e051487b101d Download complete 
 3ce7f8df2b36 Download complete 
 a0448fbfd5a3 Download complete 
 bad2b1f0e9bd Download complete 
 b37effddbb9c Download complete 
 48111fe612c1 Download complete 
 f30287ef02b9 Downloading [===================================>               ]  1.049MB/1.471MB
 f30287ef02b9 Downloading [===================================>               ]  1.049MB/1.471MB
 75a54e59e691 Downloading [===========>                                       ]  1.049MB/4.415MB
 f30287ef02b9 Download complete 
 75a54e59e691 Downloading [===========>                                       ]  1.049MB/4.415MB
 20a002889a9a Downloading [>                                                  ]  1.049MB/90.1MB
 75a54e59e691 Downloading [===========>                                       ]  1.049MB/4.415MB
 20a002889a9a Downloading [>                                                  ]  1.049MB/90.1MB
 75a54e59e691 Downloading [===========>                                       ]  1.049MB/4.415MB
 20a002889a9a Downloading [=>                                                 ]  2.097MB/90.1MB
 dc1f0e9024d8 Downloading [======>                                            ]  1.049MB/8.045MB
 20a002889a9a Downloading [=>                                                 ]  3.146MB/90.1MB
 dc1f0e9024d8 Downloading [======>                                            ]  1.049MB/8.045MB
 75a54e59e691 Downloading [=======================>                           ]  2.097MB/4.415MB
 75a54e59e691 Downloading [=======================>                           ]  2.097MB/4.415MB
 20a002889a9a Downloading [=>                                                 ]  3.146MB/90.1MB
 dc1f0e9024d8 Downloading [======>                                            ]  1.049MB/8.045MB
 75a54e59e691 Downloading [=======================>                           ]  2.097MB/4.415MB
 20a002889a9a Downloading [==>                                                ]  4.194MB/90.1MB
 dc1f0e9024d8 Downloading [======>                                            ]  1.049MB/8.045MB
 dc1f0e9024d8 Downloading [======>                                            ]  1.049MB/8.045MB
 75a54e59e691 Downloading [===================================>               ]  3.146MB/4.415MB
 7f0a68628bce Downloading [=========================================>         ]  1.049MB/1.261MB
 20a002889a9a Downloading [==>                                                ]  4.194MB/90.1MB
 75a54e59e691 Downloading [===================================>               ]  3.146MB/4.415MB
 7f0a68628bce Downloading [=========================================>         ]  1.049MB/1.261MB
 20a002889a9a Downloading [==>                                                ]  5.243MB/90.1MB
 dc1f0e9024d8 Downloading [=============>                                     ]  2.097MB/8.045MB
 75a54e59e691 Downloading [===================================>               ]  3.146MB/4.415MB
 7f0a68628bce Download complete 
 20a002889a9a Downloading [==>                                                ]  5.243MB/90.1MB
 dc1f0e9024d8 Downloading [=============>                                     ]  2.097MB/8.045MB
 20a002889a9a Downloading [===>                                               ]  6.291MB/90.1MB
 dc1f0e9024d8 Downloading [=============>                                     ]  2.097MB/8.045MB
 75a54e59e691 Downloading [===============================================>   ]  4.194MB/4.415MB
 20a002889a9a Downloading [====>                                              ]   7.34MB/90.1MB
 dc1f0e9024d8 Downloading [=============>                                     ]  2.097MB/8.045MB
 75a54e59e691 Download complete 
 75a54e59e691 Extracting 1 s
 20a002889a9a Downloading [====>                                              ]   7.34MB/90.1MB
 dc1f0e9024d8 Downloading [=============>                                     ]  2.097MB/8.045MB
 3ce7f8df2b36 Pull complete 
 f30287ef02b9 Pull complete 
 75a54e59e691 Pull complete 
 dc1f0e9024d8 Downloading [===================>                               ]  3.146MB/8.045MB
 20a002889a9a Downloading [====>                                              ]  8.389MB/90.1MB
 20a002889a9a Downloading [====>                                              ]  8.389MB/90.1MB
 dc1f0e9024d8 Downloading [===================>                               ]  3.146MB/8.045MB
 20a002889a9a Downloading [====>                                              ]  8.389MB/90.1MB
 dc1f0e9024d8 Downloading [===================>                               ]  3.146MB/8.045MB
 20a002889a9a Downloading [=====>                                             ]  9.437MB/90.1MB
 dc1f0e9024d8 Downloading [===================>                               ]  3.146MB/8.045MB
 20a002889a9a Downloading [=====>                                             ]  9.437MB/90.1MB
 dc1f0e9024d8 Downloading [==========================>                        ]  4.194MB/8.045MB
 20a002889a9a Downloading [=====>                                             ]  10.49MB/90.1MB
 dc1f0e9024d8 Downloading [==========================>                        ]  4.194MB/8.045MB
 dc1f0e9024d8 Downloading [==========================>                        ]  4.194MB/8.045MB
 20a002889a9a Downloading [=====>                                             ]  10.49MB/90.1MB
 20a002889a9a Downloading [=====>                                             ]  10.49MB/90.1MB
 dc1f0e9024d8 Downloading [==========================>                        ]  4.194MB/8.045MB
 20a002889a9a Downloading [======>                                            ]  11.53MB/90.1MB
 dc1f0e9024d8 Downloading [================================>                  ]  5.243MB/8.045MB
 20a002889a9a Downloading [======>                                            ]  11.53MB/90.1MB
 dc1f0e9024d8 Downloading [================================>                  ]  5.243MB/8.045MB
 20a002889a9a Downloading [======>                                            ]  12.58MB/90.1MB
 dc1f0e9024d8 Downloading [================================>                  ]  5.243MB/8.045MB
 20a002889a9a Downloading [======>                                            ]  12.58MB/90.1MB
 dc1f0e9024d8 Downloading [=======================================>           ]  6.291MB/8.045MB
 dc1f0e9024d8 Downloading [=======================================>           ]  6.291MB/8.045MB
 20a002889a9a Downloading [======>                                            ]  12.58MB/90.1MB
 dc1f0e9024d8 Downloading [=======================================>           ]  6.291MB/8.045MB
 20a002889a9a Downloading [=======>                                           ]  13.63MB/90.1MB
 20a002889a9a Downloading [=======>                                           ]  13.63MB/90.1MB
 dc1f0e9024d8 Downloading [=============================================>     ]   7.34MB/8.045MB
 20a002889a9a Downloading [========>                                          ]  15.73MB/90.1MB
 dc1f0e9024d8 Download complete 
 dc1f0e9024d8 Extracting 1 s
 20a002889a9a Downloading [=========>                                         ]  16.78MB/90.1MB
 dc1f0e9024d8 Extracting 1 s
 20a002889a9a Downloading [==========>                                        ]  18.87MB/90.1MB
 dc1f0e9024d8 Extracting 1 s
 20a002889a9a Downloading [===========>                                       ]  19.92MB/90.1MB
 7f0a68628bce Extracting 1 s
 dc1f0e9024d8 Pull complete 
 20a002889a9a Downloading [============>                                      ]  22.02MB/90.1MB
 7f0a68628bce Pull complete 
 20a002889a9a Downloading [============>                                      ]  23.07MB/90.1MB
 32b11818cae3 Pull complete 
 48111fe612c1 Pull complete 
 20a002889a9a Downloading [=============>                                     ]  24.12MB/90.1MB
 20a002889a9a Downloading [==============>                                    ]  26.21MB/90.1MB
 20a002889a9a Downloading [===============>                                   ]  27.26MB/90.1MB
 20a002889a9a Downloading [===============>                                   ]  27.26MB/90.1MB
 20a002889a9a Downloading [===============>                                   ]  28.31MB/90.1MB
 20a002889a9a Downloading [===============>                                   ]  28.31MB/90.1MB
 20a002889a9a Downloading [================>                                  ]  29.36MB/90.1MB
 20a002889a9a Downloading [================>                                  ]  29.36MB/90.1MB
 20a002889a9a Downloading [================>                                  ]  30.41MB/90.1MB
 20a002889a9a Downloading [==================>                                ]  32.51MB/90.1MB
 20a002889a9a Downloading [===================>                               ]   34.6MB/90.1MB
 20a002889a9a Downloading [====================>                              ]   36.7MB/90.1MB
 20a002889a9a Downloading [=====================>                             ]   38.8MB/90.1MB
 20a002889a9a Downloading [======================>                            ]  39.85MB/90.1MB
 20a002889a9a Downloading [======================>                            ]  40.89MB/90.1MB
 20a002889a9a Downloading [=======================>                           ]  41.94MB/90.1MB
 20a002889a9a Downloading [=======================>                           ]  42.99MB/90.1MB
 20a002889a9a Downloading [========================>                          ]  44.04MB/90.1MB
 20a002889a9a Downloading [=========================>                         ]  46.14MB/90.1MB
 20a002889a9a Downloading [==========================>                        ]  47.96MB/90.1MB
 20a002889a9a Downloading [===========================>                       ]  49.28MB/90.1MB
 20a002889a9a Downloading [============================>                      ]  51.38MB/90.1MB
 20a002889a9a Downloading [=============================>                     ]  52.43MB/90.1MB
 20a002889a9a Downloading [==============================>                    ]  55.57MB/90.1MB
 20a002889a9a Downloading [===============================>                   ]  56.62MB/90.1MB
 20a002889a9a Downloading [================================>                  ]  57.67MB/90.1MB
 20a002889a9a Downloading [=================================>                 ]  59.77MB/90.1MB
 20a002889a9a Downloading [=================================>                 ]  59.77MB/90.1MB
 20a002889a9a Downloading [=================================>                 ]  60.82MB/90.1MB
 20a002889a9a Downloading [==================================>                ]  61.87MB/90.1MB
 20a002889a9a Downloading [===================================>               ]  63.96MB/90.1MB
 20a002889a9a Downloading [===================================>               ]  63.96MB/90.1MB
 20a002889a9a Downloading [====================================>              ]  65.01MB/90.1MB
 20a002889a9a Downloading [====================================>              ]  65.01MB/90.1MB
 20a002889a9a Downloading [====================================>              ]  66.06MB/90.1MB
 20a002889a9a Downloading [====================================>              ]  66.06MB/90.1MB
 20a002889a9a Downloading [=====================================>             ]  67.11MB/90.1MB
 20a002889a9a Downloading [=====================================>             ]  67.11MB/90.1MB
 20a002889a9a Downloading [=====================================>             ]  68.16MB/90.1MB
 20a002889a9a Downloading [=====================================>             ]  68.16MB/90.1MB
 20a002889a9a Downloading [======================================>            ]  69.21MB/90.1MB
 20a002889a9a Downloading [======================================>            ]  69.21MB/90.1MB
 20a002889a9a Downloading [======================================>            ]  70.25MB/90.1MB
 20a002889a9a Downloading [======================================>            ]  70.25MB/90.1MB
 20a002889a9a Downloading [=======================================>           ]   71.3MB/90.1MB
 20a002889a9a Downloading [=======================================>           ]   71.3MB/90.1MB
 20a002889a9a Downloading [========================================>          ]  72.35MB/90.1MB
 20a002889a9a Downloading [========================================>          ]  72.35MB/90.1MB
 20a002889a9a Downloading [========================================>          ]   73.4MB/90.1MB
 20a002889a9a Downloading [=========================================>         ]  74.45MB/90.1MB
 20a002889a9a Downloading [==========================================>        ]  76.55MB/90.1MB
 20a002889a9a Downloading [===========================================>       ]  77.59MB/90.1MB
 20a002889a9a Downloading [============================================>      ]  79.69MB/90.1MB
 20a002889a9a Downloading [=============================================>     ]  81.79MB/90.1MB
 20a002889a9a Downloading [==============================================>    ]  83.89MB/90.1MB
 20a002889a9a Downloading [===============================================>   ]  85.98MB/90.1MB
 20a002889a9a Downloading [================================================>  ]  87.03MB/90.1MB
 20a002889a9a Downloading [================================================>  ]  88.08MB/90.1MB
 20a002889a9a Downloading [================================================>  ]  88.08MB/90.1MB
 20a002889a9a Downloading [=================================================> ]  89.13MB/90.1MB
 20a002889a9a Downloading [=================================================> ]  89.13MB/90.1MB
 20a002889a9a Downloading [==================================================>]   90.1MB/90.1MB
 20a002889a9a Download complete 
 20a002889a9a Extracting 1 s
 20a002889a9a Extracting 1 s
 20a002889a9a Extracting 1 s
 20a002889a9a Extracting 1 s
 20a002889a9a Extracting 1 s
 20a002889a9a Extracting 1 s
 20a002889a9a Extracting 1 s
 20a002889a9a Extracting 1 s
 20a002889a9a Extracting 1 s
 20a002889a9a Extracting 1 s
 20a002889a9a Extracting 1 s
 20a002889a9a Extracting 2 s
 20a002889a9a Extracting 2 s
 20a002889a9a Extracting 2 s
 20a002889a9a Extracting 2 s
 20a002889a9a Extracting 2 s
 20a002889a9a Extracting 2 s
 20a002889a9a Extracting 2 s
 20a002889a9a Extracting 2 s
 bad2b1f0e9bd Pull complete 
 b37effddbb9c Extracting 1 s
 20a002889a9a Pull complete 
 e051487b101d Pull complete 
 a0448fbfd5a3 Pull complete 
 b37effddbb9c Pull complete 
 postgres Pulled 
#1 [internal] load local bake definitions
#1 reading from stdin 723B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile: 148B done
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/library/python:3.10-slim
#3 DONE 0.4s

#4 [internal] load .dockerignore
#4 transferring context: 2B done
#4 DONE 0.0s

#5 [1/4] FROM docker.io/library/python:3.10-slim@sha256:e0c4fae70d550834a40f6c3e0326e02cfe239c2351d922e1fb1577a3c6ebde02
#5 resolve docker.io/library/python:3.10-slim@sha256:e0c4fae70d550834a40f6c3e0326e02cfe239c2351d922e1fb1577a3c6ebde02 0.0s done
#5 DONE 0.0s

#6 [internal] load build context
#6 transferring context: 1.02kB done
#6 DONE 0.0s

#7 [2/4] WORKDIR /app
#7 CACHED

#8 [3/4] COPY exploit.py .
#8 DONE 0.5s

#9 [4/4] RUN pip install docker
#9 1.562 Collecting docker
#9 1.626   Downloading docker-7.1.0-py3-none-any.whl (147 kB)
#9 1.671      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 147.8/147.8 kB 3.7 MB/s eta 0:00:00
#9 1.758 Collecting requests>=2.26.0
#9 1.773   Downloading requests-2.32.5-py3-none-any.whl (64 kB)
#9 1.792      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 64.7/64.7 kB 3.3 MB/s eta 0:00:00
#9 1.869 Collecting urllib3>=1.26.0
#9 1.887   Downloading urllib3-2.5.0-py3-none-any.whl (129 kB)
#9 1.906      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 129.8/129.8 kB 7.1 MB/s eta 0:00:00
#9 2.163 Collecting charset_normalizer<4,>=2
#9 2.180   Downloading charset_normalizer-3.4.4-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (153 kB)
#9 2.211      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 153.6/153.6 kB 5.2 MB/s eta 0:00:00
#9 2.255 Collecting idna<4,>=2.5
#9 2.282   Downloading idna-3.11-py3-none-any.whl (71 kB)
#9 2.289      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 71.0/71.0 kB 12.3 MB/s eta 0:00:00
#9 2.344 Collecting certifi>=2017.4.17
#9 2.374   Downloading certifi-2025.10.5-py3-none-any.whl (163 kB)
#9 2.397      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 163.3/163.3 kB 13.1 MB/s eta 0:00:00
#9 2.473 Installing collected packages: urllib3, idna, charset_normalizer, certifi, requests, docker
#9 2.802 Successfully installed certifi-2025.10.5 charset_normalizer-3.4.4 docker-7.1.0 idna-3.11 requests-2.32.5 urllib3-2.5.0
#9 2.802 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
#9 2.928 
#9 2.928 [notice] A new release of pip is available: 23.0.1 -> 25.3
#9 2.928 [notice] To update, run: pip install --upgrade pip
#9 DONE 3.0s

#10 exporting to image
#10 exporting layers
#10 exporting layers 0.6s done
#10 exporting manifest sha256:c94c182ef89a563aa8ae8a88be0d44fee6a95e5967a1972f41f552730b399e4e 0.0s done
#10 exporting config sha256:6d0a85cded5a1b5efcae94f4cb9874d93f64551b55e19d542e37301c96be9a81 0.0s done
#10 exporting attestation manifest sha256:f9a570e648770b501d177b54b759a6de30a9ada10a63ed6e6090fbae5b6dcea5 0.0s done
#10 exporting manifest list sha256:8f6fc653b36a264b9554226d2eb1d3df94641bdca83be335f39b85ce10696e86 0.0s done
#10 naming to docker.io/library/custom_no_tool-vulnerable:latest done
#10 unpacking to docker.io/library/custom_no_tool-vulnerable:latest
#10 unpacking to docker.io/library/custom_no_tool-vulnerable:latest 0.3s done
#10 DONE 0.9s

#11 resolving provenance for metadata file
#11 DONE 0.0s
 custom_no_tool-vulnerable  Built
 Network custom_no_tool_default  Creating
 Network custom_no_tool_default  Created
 Container custom_no_tool-postgres-1  Creating
 Container custom_no_tool-postgres-1  Created
 Container custom_no_tool-vulnerable-1  Creating
 Container custom_no_tool-vulnerable-1  Created
 Container custom_no_tool-postgres-1  Starting
 Container custom_no_tool-postgres-1  Started
 Container custom_no_tool-postgres-1  Waiting
 Container custom_no_tool-postgres-1  Healthy
 Container custom_no_tool-vulnerable-1  Starting
 Container custom_no_tool-vulnerable-1  Started


sudo docker logs 6178a8f7cde729c6525ea9b388e4a24bb4f3a12554a2f3f2698fa142bbf69ad4 --details
STDOUT:  The files belonging to this database system will be owned by user "postgres".
 This user must also own the server process.
 
 The database cluster will be initialized with locale "en_US.utf8".
 The default database encoding has accordingly been set to "UTF8".
 The default text search configuration will be set to "english".
 
 Data page checksums are disabled.
 
 fixing permissions on existing directory /var/lib/postgresql/data ... ok
 creating subdirectories ... ok
 selecting dynamic shared memory implementation ... posix
 selecting default max_connections ... 100
 selecting default shared_buffers ... 128MB
 selecting default time zone ... Etc/UTC
 creating configuration files ... ok
 running bootstrap script ... ok
 performing post-bootstrap initialization ... ok
 syncing data to disk ... ok
 
 
 Success. You can now start the database server using:
 
     pg_ctl -D /var/lib/postgresql/data -l logfile start
 
 waiting for server to start....2025-10-29 14:05:44.556 UTC [48] LOG:  starting PostgreSQL 13.9 (Debian 13.9-1.pgdg110+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 10.2.1-6) 10.2.1 20210110, 64-bit
 2025-10-29 14:05:44.560 UTC [48] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
 2025-10-29 14:05:44.569 UTC [49] LOG:  database system was shut down at 2025-10-29 14:05:44 UTC
 2025-10-29 14:05:44.576 UTC [48] LOG:  database system is ready to accept connections
  done
 server started
 CREATE DATABASE
 
 
 /usr/local/bin/docker-entrypoint.sh: ignoring /docker-entrypoint-initdb.d/*
 
 2025-10-29 14:05:44.826 UTC [48] LOG:  received fast shutdown request
 waiting for server to shut down....2025-10-29 14:05:44.828 UTC [48] LOG:  aborting any active transactions
 2025-10-29 14:05:44.830 UTC [48] LOG:  background worker "logical replication launcher" (PID 55) exited with exit code 1
 2025-10-29 14:05:44.831 UTC [50] LOG:  shutting down
 2025-10-29 14:05:44.845 UTC [48] LOG:  database system is shut down
  done
 server stopped
 
 PostgreSQL init process complete; ready for start up.
 

STDERR:  initdb: warning: enabling "trust" authentication for local connections
 You can change this by editing pg_hba.conf or using the option -A, or
 --auth-local and --auth-host, the next time you run initdb.
 2025-10-29 14:05:44.948 UTC [1] LOG:  starting PostgreSQL 13.9 (Debian 13.9-1.pgdg110+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 10.2.1-6) 10.2.1 20210110, 64-bit
 2025-10-29 14:05:44.948 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
 2025-10-29 14:05:44.948 UTC [1] LOG:  listening on IPv6 address "::", port 5432
 2025-10-29 14:05:44.954 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
 2025-10-29 14:05:44.960 UTC [63] LOG:  database system was shut down at 2025-10-29 14:05:44 UTC
 2025-10-29 14:05:44.965 UTC [1] LOG:  database system is ready to accept connections




sudo docker inspect 6178a8f7cde729c6525ea9b388e4a24bb4f3a12554a2f3f2698fa142bbf69ad4[
    {
        "Id": "6178a8f7cde729c6525ea9b388e4a24bb4f3a12554a2f3f2698fa142bbf69ad4",
        "Created": "2025-10-29T14:05:43.323239325Z",
        "Path": "docker-entrypoint.sh",
        "Args": [
            "postgres"
        ],
        "State": {
            "Status": "running",
            "Running": true,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 45865,
            "ExitCode": 0,
            "Error": "",
            "StartedAt": "2025-10-29T14:05:43.577817669Z",
            "FinishedAt": "0001-01-01T00:00:00Z",
            "Health": {
                "Status": "healthy",
                "FailingStreak": 0,
                "Log": [
                    {
                        "Start": "2025-10-29T14:05:58.982547185Z",
                        "End": "2025-10-29T14:05:59.082034763Z",
                        "ExitCode": 0,
                        "Output": "/var/run/postgresql:5432 - accepting connections\n"
                    },
                    {
                        "Start": "2025-10-29T14:06:04.082571309Z",
                        "End": "2025-10-29T14:06:04.166384739Z",
                        "ExitCode": 0,
                        "Output": "/var/run/postgresql:5432 - accepting connections\n"
                    },
                    {
                        "Start": "2025-10-29T14:06:09.20579378Z",
                        "End": "2025-10-29T14:06:09.30526918Z",
                        "ExitCode": 0,
                        "Output": "/var/run/postgresql:5432 - accepting connections\n"
                    },
                    {
                        "Start": "2025-10-29T14:06:14.306207997Z",
                        "End": "2025-10-29T14:06:14.421772541Z",
                        "ExitCode": 0,
                        "Output": "/var/run/postgresql:5432 - accepting connections\n"
                    },
                    {
                        "Start": "2025-10-29T14:06:19.422317304Z",
                        "End": "2025-10-29T14:06:19.523824441Z",
                        "ExitCode": 0,
                        "Output": "/var/run/postgresql:5432 - accepting connections\n"
                    }
                ]
            }
        },
        "Image": "sha256:8eaae3175bd91c9ac3d372926b797076f37917dd64d6cc31ecfbd84b06d12538",
        "ResolvConfPath": "/var/lib/docker/containers/6178a8f7cde729c6525ea9b388e4a24bb4f3a12554a2f3f2698fa142bbf69ad4/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/6178a8f7cde729c6525ea9b388e4a24bb4f3a12554a2f3f2698fa142bbf69ad4/hostname",
        "HostsPath": "/var/lib/docker/containers/6178a8f7cde729c6525ea9b388e4a24bb4f3a12554a2f3f2698fa142bbf69ad4/hosts",
        "LogPath": "/var/lib/docker/containers/6178a8f7cde729c6525ea9b388e4a24bb4f3a12554a2f3f2698fa142bbf69ad4/6178a8f7cde729c6525ea9b388e4a24bb4f3a12554a2f3f2698fa142bbf69ad4-json.log",
        "Name": "/custom_no_tool-postgres-1",
        "RestartCount": 0,
        "Driver": "overlayfs",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": null,
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "custom_no_tool_default",
            "PortBindings": {
                "5432/tcp": [
                    {
                        "HostIp": "",
                        "HostPort": "5432"
                    }
                ]
            },
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "ConsoleSize": [
                0,
                0
            ],
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": null,
            "DnsOptions": null,
            "DnsSearch": null,
            "ExtraHosts": [],
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": false,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": null,
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": null,
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": null,
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": [
                "/proc/asound",
                "/proc/acpi",
                "/proc/interrupts",
                "/proc/kcore",
                "/proc/keys",
                "/proc/latency_stats",
                "/proc/timer_list",
                "/proc/timer_stats",
                "/proc/sched_debug",
                "/proc/scsi",
                "/sys/firmware",
                "/sys/devices/virtual/powercap"
            ],
            "ReadonlyPaths": [
                "/proc/bus",
                "/proc/fs",
                "/proc/irq",
                "/proc/sys",
                "/proc/sysrq-trigger"
            ]
        },
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "Mounts": [
            {
                "Type": "volume",
                "Name": "a62d5c2016ed39c49771b6c095ffb6699b69614aa6c2c33477142432d97cf7c3",
                "Source": "/var/lib/docker/volumes/a62d5c2016ed39c49771b6c095ffb6699b69614aa6c2c33477142432d97cf7c3/_data",
                "Destination": "/var/lib/postgresql/data",
                "Driver": "local",
                "Mode": "",
                "RW": true,
                "Propagation": ""
            }
        ],
        "Config": {
            "Hostname": "6178a8f7cde7",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": true,
            "AttachStderr": true,
            "ExposedPorts": {
                "5432/tcp": {}
            },
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "POSTGRES_PASSWORD=airflow",
                "POSTGRES_DB=airflow",
                "POSTGRES_USER=airflow",
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/lib/postgresql/13/bin",
                "GOSU_VERSION=1.16",
                "LANG=en_US.utf8",
                "PG_MAJOR=13",
                "PG_VERSION=13.9-1.pgdg110+1",
                "PGDATA=/var/lib/postgresql/data"
            ],
            "Cmd": [
                "postgres"
            ],
            "Healthcheck": {
                "Test": [
                    "CMD",
                    "pg_isready",
                    "-U",
                    "airflow"
                ],
                "Interval": 5000000000,
                "Timeout": 5000000000,
                "Retries": 5
            },
            "Image": "postgres:13.9",
            "Volumes": {
                "/var/lib/postgresql/data": {}
            },
            "WorkingDir": "",
            "Entrypoint": [
                "docker-entrypoint.sh"
            ],
            "OnBuild": null,
            "Labels": {
                "com.docker.compose.config-hash": "e897e968849aa43a2c7bc0ec9db24f876c75113d51ed1c5419079f981ba4a811",
                "com.docker.compose.container-number": "1",
                "com.docker.compose.depends_on": "",
                "com.docker.compose.image": "sha256:8eaae3175bd91c9ac3d372926b797076f37917dd64d6cc31ecfbd84b06d12538",
                "com.docker.compose.oneoff": "False",
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.project.config_files": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2020-17526/custom_no_tool/docker-compose.yml",
                "com.docker.compose.project.working_dir": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2020-17526/custom_no_tool",
                "com.docker.compose.service": "postgres",
                "com.docker.compose.version": "2.40.2",
                "desktop.docker.io/wsl-distro": "Ubuntu"
            },
            "StopSignal": "SIGINT",
            "StopTimeout": 1
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "0c7a66ac0e8a20496579f6d3e16caed530e641d187978a711854a823cfbe1fd0",
            "SandboxKey": "/var/run/docker/netns/0c7a66ac0e8a",
            "Ports": {
                "5432/tcp": [
                    {
                        "HostIp": "0.0.0.0",
                        "HostPort": "5432"
                    },
                    {
                        "HostIp": "::",
                        "HostPort": "5432"
                    }
                ]
            },
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "",
            "Gateway": "",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "",
            "IPPrefixLen": 0,
            "IPv6Gateway": "",
            "MacAddress": "",
            "Networks": {
                "custom_no_tool_default": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": [
                        "custom_no_tool-postgres-1",
                        "postgres"
                    ],
                    "MacAddress": "2a:0f:68:d4:6d:9e",
                    "DriverOpts": null,
                    "GwPriority": 0,
                    "NetworkID": "b88f21c1c768f0badfb005066362fd1419357460a918e6307d3ad0d35db990f8",
                    "EndpointID": "e1cb844a43b2d072e818f659b11a9992e16259b21e0ed3642043c23e197060fb",
                    "Gateway": "172.18.0.1",
                    "IPAddress": "172.18.0.2",
                    "IPPrefixLen": 16,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "DNSNames": [
                        "custom_no_tool-postgres-1",
                        "postgres",
                        "6178a8f7cde7"
                    ]
                }
            }
        },
        "ImageManifestDescriptor": {
            "mediaType": "application/vnd.docker.distribution.manifest.v2+json",
            "digest": "sha256:f5911875bf2d18c585a5f245f6596d946d28eabddeffd809ac52ca5720c7c5b5",
            "size": 3039,
            "platform": {
                "architecture": "amd64",
                "os": "linux"
            }
        }
    }
]

sudo docker logs 9068fd495abddcada9e6a2c1d6961ebef12514c5c721ef1eb5e8780679a4257b --details
STDOUT:  Attempting to exploit Docker socket...

STDERR:  Traceback (most recent call last):
   File "/usr/local/lib/python3.10/site-packages/docker/api/client.py", line 275, in _raise_for_status
     response.raise_for_status()
   File "/usr/local/lib/python3.10/site-packages/requests/models.py", line 1026, in raise_for_status
     raise HTTPError(http_error_msg, response=self)
 requests.exceptions.HTTPError: 409 Client Error: Conflict for url: http+docker://localhost/v1.51/containers/c23317413bdb46b7159a97884f6690216bb0c5964f99bde668e5200eb70f26c1/logs?stderr=1&stdout=1&timestamps=0&follow=1&tail=all
 
 The above exception was the direct cause of the following exception:
 
 Traceback (most recent call last):
   File "/app/exploit.py", line 33, in <module>
     create_test_container()
   File "/app/exploit.py", line 28, in create_test_container
     for line in container.logs(stream=True):
   File "/usr/local/lib/python3.10/site-packages/docker/models/containers.py", line 322, in logs
     return self.client.api.logs(self.id, **kwargs)
   File "/usr/local/lib/python3.10/site-packages/docker/utils/decorators.py", line 19, in wrapped
     return f(self, resource_id, *args, **kwargs)
   File "/usr/local/lib/python3.10/site-packages/docker/api/container.py", line 896, in logs
     output = self._get_result(container, stream, res)
   File "/usr/local/lib/python3.10/site-packages/docker/api/client.py", line 483, in _get_result
     return self._get_result_tty(stream, res, self._check_is_tty(container))
   File "/usr/local/lib/python3.10/site-packages/docker/api/client.py", line 492, in _get_result_tty
     self._raise_for_status(res)
   File "/usr/local/lib/python3.10/site-packages/docker/api/client.py", line 277, in _raise_for_status
     raise create_api_error_from_http_exception(e) from e
   File "/usr/local/lib/python3.10/site-packages/docker/errors.py", line 39, in create_api_error_from_http_exception
     raise cls(e, response=response, explanation=explanation) from e
 docker.errors.APIError: 409 Client Error for http+docker://localhost/v1.51/containers/c23317413bdb46b7159a97884f6690216bb0c5964f99bde668e5200eb70f26c1/logs?stderr=1&stdout=1&timestamps=0&follow=1&tail=all: Conflict ("can not get logs from container which is dead or marked for removal")




sudo docker inspect 9068fd495abddcada9e6a2c1d6961ebef12514c5c721ef1eb5e8780679a4257b[
    {
        "Id": "9068fd495abddcada9e6a2c1d6961ebef12514c5c721ef1eb5e8780679a4257b",
        "Created": "2025-10-29T14:05:43.425571787Z",
        "Path": "python",
        "Args": [
            "exploit.py"
        ],
        "State": {
            "Status": "exited",
            "Running": false,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 0,
            "ExitCode": 1,
            "Error": "",
            "StartedAt": "2025-10-29T14:05:49.298855912Z",
            "FinishedAt": "2025-10-29T14:05:50.82520418Z"
        },
        "Image": "sha256:8f6fc653b36a264b9554226d2eb1d3df94641bdca83be335f39b85ce10696e86",
        "ResolvConfPath": "/var/lib/docker/containers/9068fd495abddcada9e6a2c1d6961ebef12514c5c721ef1eb5e8780679a4257b/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/9068fd495abddcada9e6a2c1d6961ebef12514c5c721ef1eb5e8780679a4257b/hostname",
        "HostsPath": "/var/lib/docker/containers/9068fd495abddcada9e6a2c1d6961ebef12514c5c721ef1eb5e8780679a4257b/hosts",
        "LogPath": "/var/lib/docker/containers/9068fd495abddcada9e6a2c1d6961ebef12514c5c721ef1eb5e8780679a4257b/9068fd495abddcada9e6a2c1d6961ebef12514c5c721ef1eb5e8780679a4257b-json.log",
        "Name": "/custom_no_tool-vulnerable-1",
        "RestartCount": 0,
        "Driver": "overlayfs",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": [
                "/var/run/docker.sock:/var/run/docker.sock:rw"
            ],
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "custom_no_tool_default",
            "PortBindings": {},
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "ConsoleSize": [
                0,
                0
            ],
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": null,
            "DnsOptions": null,
            "DnsSearch": null,
            "ExtraHosts": [],
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": true,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": [
                "label=disable"
            ],
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": null,
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": null,
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": null,
            "ReadonlyPaths": null
        },
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "Mounts": [
            {
                "Type": "bind",
                "Source": "/var/run/docker.sock",
                "Destination": "/var/run/docker.sock",
                "Mode": "rw",
                "RW": true,
                "Propagation": "rprivate"
            }
        ],
        "Config": {
            "Hostname": "9068fd495abd",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": true,
            "AttachStderr": true,
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
                "LANG=C.UTF-8",
                "GPG_KEY=A035C8C19219BA821ECEA86B64E628F8D684696D",
                "PYTHON_VERSION=3.10.19",
                "PYTHON_SHA256=c8f4a596572201d81dd7df91f70e177e19a70f1d489968b54b5fbbf29a97c076"
            ],
            "Cmd": null,
            "Image": "custom_no_tool-vulnerable",
            "Volumes": null,
            "WorkingDir": "/app",
            "Entrypoint": [
                "python",
                "exploit.py"
            ],
            "OnBuild": null,
            "Labels": {
                "com.docker.compose.config-hash": "3f9b4f0262eb9e7ca858c876b0adcd86337d0cd922abd816441f45990b81db92",
                "com.docker.compose.container-number": "1",
                "com.docker.compose.depends_on": "postgres:service_healthy:false",
                "com.docker.compose.image": "sha256:8f6fc653b36a264b9554226d2eb1d3df94641bdca83be335f39b85ce10696e86",
                "com.docker.compose.oneoff": "False",
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.project.config_files": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2020-17526/custom_no_tool/docker-compose.yml",
                "com.docker.compose.project.working_dir": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2020-17526/custom_no_tool",
                "com.docker.compose.service": "vulnerable",
                "com.docker.compose.version": "2.40.2",
                "desktop.docker.io/wsl-distro": "Ubuntu"
            },
            "StopTimeout": 1
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "",
            "SandboxKey": "",
            "Ports": {},
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "",
            "Gateway": "",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "",
            "IPPrefixLen": 0,
            "IPv6Gateway": "",
            "MacAddress": "",
            "Networks": {
                "custom_no_tool_default": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": [
                        "custom_no_tool-vulnerable-1",
                        "vulnerable"
                    ],
                    "MacAddress": "",
                    "DriverOpts": null,
                    "GwPriority": 0,
                    "NetworkID": "b88f21c1c768f0badfb005066362fd1419357460a918e6307d3ad0d35db990f8",
                    "EndpointID": "",
                    "Gateway": "",
                    "IPAddress": "",
                    "IPPrefixLen": 0,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "DNSNames": [
                        "custom_no_tool-vulnerable-1",
                        "vulnerable",
                        "9068fd495abd"
                    ]
                }
            }
        },
        "ImageManifestDescriptor": {
            "mediaType": "application/vnd.oci.image.manifest.v1+json",
            "digest": "sha256:c94c182ef89a563aa8ae8a88be0d44fee6a95e5967a1972f41f552730b399e4e",
            "size": 1622,
            "platform": {
                "architecture": "amd64",
                "os": "linux"
            }
        }
    }
]