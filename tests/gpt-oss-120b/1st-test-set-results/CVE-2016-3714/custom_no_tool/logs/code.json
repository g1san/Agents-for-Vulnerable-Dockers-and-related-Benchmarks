{
    "files": [
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/docker-compose.yml",
            "content": "version: '3'\nservices:\n  node:\n    build: ./app\n    ports:\n      - \"8080:8080\"\n    environment:\n      - NODE_ENV=production\n  php:\n    build: ./php\n    ports:\n      - \"80:80\"\n"
        },
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/app/Dockerfile",
            "content": "FROM node:14-bullseye\nWORKDIR /usr/src/app\n# Add an old Debian repository that still provides the vulnerable ImageMagick versions\nRUN echo \"deb http://deb.debian.org/debian stretch main\" > /etc/apt/sources.list.d/stretch.list && \\\n    apt-get update && \\\n    # Pin ImageMagick to a vulnerable version from the allowed list (e.g., 6.9.3-0)\n    apt-get install -y --no-install-recommends imagemagick=6.9.3-0 && \\\n    rm -rf /var/lib/apt/lists/*\nCOPY package.json .\nRUN npm install\nCOPY . .\nEXPOSE 8080\nCMD [\"node\", \"server.js\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/app/package.json",
            "content": "{\n  \"name\": \"vulnerable-app\",\n  \"version\": \"1.0.0\",\n  \"main\": \"server.js\",\n  \"dependencies\": {\n    \"express\": \"^4.16.0\"\n  }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/app/server.js",
            "content": "const express = require('express');\nconst app = express();\n\napp.get('/', (req, res) => {\n  // Static response \u2013 no exec of user\u2011controlled data\n  res.send('Hello from the safe Node.js service running with ImageMagick installed.');\n});\n\napp.listen(8080, () => {\n  console.log('Safe app listening on port 8080');\n});\n"
        },
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/php/Dockerfile",
            "content": "FROM php:7.4-apache\n# Add an old Debian repository that contains the vulnerable ImageMagick version\nRUN echo \"deb http://deb.debian.org/debian stretch main\" > /etc/apt/sources.list.d/stretch.list && \\\n    apt-get update && \\\n    # Install the specific vulnerable ImageMagick version and matching dev headers\n    apt-get install -y --no-install-recommends \\\n        imagemagick=6.9.3-0 \\\n        libmagickwand-6.q16-dev=6.9.3-0 \\\n        libmagickcore-dev=6.9.3-0 \\\n        build-essential \\\n        pkg-config && \\\n    # Build and enable the imagick PECL extension against the pinned ImageMagick\n    pecl install imagick && \\\n    docker-php-ext-enable imagick && \\\n    rm -rf /var/lib/apt/lists/*\nCOPY ./index.php /var/www/html/index.php\n"
        },
        {
            "location": "./../../dockers/CVE-2016-3714/custom_no_tool/php/index.php",
            "content": "<?php\n// Simple demonstration that ImageMagick is present via the imagick extension\n$img = new Imagick();\n$img->newImage(100, 100, new ImagickPixel('red'));\n$img->setImageFormat('png');\nheader('Content-Type: image/png');\necho $img;\n?>\n"
        }
    ],
    "directory_tree": "CVE-2016-3714/custom_no_tool/"
}