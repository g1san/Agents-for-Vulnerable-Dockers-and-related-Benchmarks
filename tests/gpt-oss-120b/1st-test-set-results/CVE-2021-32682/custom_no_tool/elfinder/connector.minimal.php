<?php
// Vulnerable elFinder connector (CVE-2021-32682 demonstration)
$opts = array(
    'roots' => array(
        array(
            'driver' => 'LocalFileSystem',
            'path'   => '/var/www/html/files/',
            'URL'    => '',
            'uploadAllow' => array('all'),
            'uploadDeny'  => array(''),
            'uploadOrder' => 'allow,deny',
        )
    )
);
require_once __DIR__ . '/elFinderConnector.class.php';
require_once __DIR__ . '/elFinder.class.php';
$connector = new elFinderConnector(new elFinder($opts));
$connector->run();
?>
