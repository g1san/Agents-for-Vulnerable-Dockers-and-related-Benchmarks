FROM python:3.9-slim
WORKDIR /app
# Ensure the files directory exists
RUN mkdir -p /app/files
# Install MySQL client that provides mysqladmin
RUN apt-get update && apt-get install -y mariadb-client && rm -rf /var/lib/apt/lists/*
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt
COPY app.py .
# Copy the secret file into the created directory
COPY secret.txt /app/files/secret.txt
# Add wait‑for‑db script
COPY wait-for-db.sh /wait-for-db.sh
RUN chmod +x /wait-for-db.sh
EXPOSE 5000
CMD ["sh", "/wait-for-db.sh", "python", "app.py"]