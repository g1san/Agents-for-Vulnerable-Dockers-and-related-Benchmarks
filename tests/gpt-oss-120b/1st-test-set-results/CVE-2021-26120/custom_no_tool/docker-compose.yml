services:
  docker:
    image: docker:20.10.5-dind
    privileged: true
    ports:
      - "2375:2375"
    environment:
      - DOCKER_TLS_CERTDIR=
    volumes:
      - docker-data:/var/lib/docker
  php:
    build: ./php_app
    environment:
      - PHP_DISPLAY_ERRORS=1
    ports:
      - "8080:80"
  nginx:
    image: nginx:1.25.2
    ports:
      - "80:80"
    volumes:
      - ./nginx/conf.d:/etc/nginx/conf.d:ro
    depends_on:
      - php
volumes:
  docker-data: