{
    "desc": "CVE\u20112021\u201126120 is a remote code execution vulnerability in the Smarty 3 PHP templating engine. The flaw resides in the handling of the `{function}` (and also `{eval}`/`{php}`) tags. When a template contains a crafted `{function name=...}` tag, Smarty inserts the supplied string directly into the generated PHP code without proper validation or quoting. This allows an attacker who can supply or influence a template file to inject arbitrary PHP statements that are executed when the compiled template is included. The vulnerability affects all Smarty 3 releases prior to version 3.1.39. An attacker who can upload a template, modify a template path, or otherwise cause Smarty to render untrusted template content can achieve full remote code execution with the privileges of the web\u2011server process, compromising the entire application and potentially the underlying host.",
    "attack_type": "Remote code execution",
    "services": [
        {
            "name": "smarty/smarty",
            "version": [
                "3.1.0",
                "3.1.1",
                "3.1.2",
                "3.1.3",
                "3.1.4",
                "3.1.5",
                "3.1.6",
                "3.1.7",
                "3.1.8",
                "3.1.9",
                "3.1.10",
                "3.1.11",
                "3.1.12",
                "3.1.13",
                "3.1.14",
                "3.1.15",
                "3.1.16",
                "3.1.17",
                "3.1.18",
                "3.1.19",
                "3.1.20",
                "3.1.21",
                "3.1.22",
                "3.1.23",
                "3.1.24",
                "3.1.25",
                "3.1.26",
                "3.1.27",
                "3.1.28",
                "3.1.29",
                "3.1.30",
                "3.1.31",
                "3.1.32",
                "3.1.33",
                "3.1.34",
                "3.1.35",
                "3.1.36",
                "3.1.37",
                "3.1.38"
            ],
            "dependency_type": "HARD",
            "description": "The vulnerable templating engine that contains the code injection flaw. Required to reproduce the vulnerability."
        },
        {
            "name": "php",
            "version": [
                "8.0.30"
            ],
            "dependency_type": "SOFT",
            "description": "PHP runtime needed to execute the Smarty engine and the injected payload."
        },
        {
            "name": "nginx",
            "version": [
                "1.25.2"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Web server to serve the PHP application that uses Smarty."
        }
    ],
    "input_tokens": 8746,
    "output_tokens": 1775
}