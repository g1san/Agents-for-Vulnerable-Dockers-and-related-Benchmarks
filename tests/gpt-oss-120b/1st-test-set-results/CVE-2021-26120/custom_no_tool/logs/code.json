{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-26120/custom_no_tool/docker-compose.yml",
            "content": "services:\n  docker:\n    image: docker:20.10.5-dind\n    privileged: true\n    ports:\n      - \"2375:2375\"\n    environment:\n      - DOCKER_TLS_CERTDIR=\n    volumes:\n      - docker-data:/var/lib/docker\n  php:\n    build: ./php_app\n    environment:\n      - PHP_DISPLAY_ERRORS=1\n    ports:\n      - \"8080:80\"\n  nginx:\n    image: nginx:1.25.2\n    ports:\n      - \"80:80\"\n    volumes:\n      - ./nginx/conf.d:/etc/nginx/conf.d:ro\n    depends_on:\n      - php\nvolumes:\n  docker-data:"
        },
        {
            "location": "./../../dockers/CVE-2021-26120/custom_no_tool/php_app/Dockerfile",
            "content": "FROM php:8.0-apache\n\n# Install required system packages and PHP extensions\nRUN apt-get update && apt-get install -y \\\n        libzip-dev \\\n        zlib1g-dev \\\n        unzip \\\n    && docker-php-ext-install zip\n\n# Install Composer\nCOPY --from=composer:2.5 /usr/bin/composer /usr/bin/composer\n\nWORKDIR /var/www/html\n\n# Copy application source files\nCOPY index.php .\nCOPY templates ./templates\n\n# Install the vulnerable Smarty version (3.1.38)\nRUN composer require smarty/smarty:3.1.38\n\nEXPOSE 80\nCMD [\"apache2-foreground\"]"
        },
        {
            "location": "./../../dockers/CVE-2021-26120/custom_no_tool/php_app/index.php",
            "content": "<?php\nrequire __DIR__ . '/vendor/autoload.php';\n\nuse Smarty\\Smarty;\n\n$smarty = new Smarty();\n// Configure Smarty directories (using defaults inside the container)\n$smarty->setTemplateDir(__DIR__ . '/templates');\n$smarty->setCompileDir(__DIR__ . '/templates_c');\n$smarty->setCacheDir(__DIR__ . '/cache');\n$smarty->setConfigDir(__DIR__ . '/configs');\n\n// Simple demonstration: load a template whose name can be supplied via query string\n$tpl = isset($_GET['tpl']) ? basename($_GET['tpl']) : 'vuln.tpl';\n$input = isset($_GET['input']) ? $_GET['input'] : 'hello';\n$smarty->assign('user_input', $input);\n\n// NOTE: In a real vulnerable scenario the template name would be controlled by an attacker.\n// The vulnerable Smarty versions allow constructs like {function name=...} inside the template.\n// This demo simply renders the selected template.\n$smarty->display($tpl);\n?>"
        },
        {
            "location": "./../../dockers/CVE-2021-26120/custom_no_tool/php_app/templates/vuln.tpl",
            "content": "User supplied input: {$user_input}\n\n{* Example of a malicious template that could trigger CVE\u20112021\u201126120 *}\n{* {function name=phpinfo} *}"
        },
        {
            "location": "./../../dockers/CVE-2021-26120/custom_no_tool/nginx/conf.d/default.conf",
            "content": "upstream php {\n    server php:80;\n}\n\nserver {\n    listen 80;\n    server_name localhost;\n\n    location / {\n        proxy_pass http://php;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}"
        }
    ],
    "directory_tree": "CVE-2021-26120/custom_no_tool"
}