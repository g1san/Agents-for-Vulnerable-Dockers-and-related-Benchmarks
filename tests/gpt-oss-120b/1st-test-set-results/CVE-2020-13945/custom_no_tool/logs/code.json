{
    "files": [
        {
            "location": "./../../dockers/CVE-2020-13945/custom_no_tool/docker-compose.yml",
            "content": "version: \"3.8\"\nservices:\n  etcd:\n    image: bitnami/etcd:3.5.0\n    environment:\n      ALLOW_NONE_AUTHENTICATION: \"yes\"\n      ETCD_ADVERTISE_CLIENT_URLS: \"http://0.0.0.0:2379\"\n      ETCD_LISTEN_CLIENT_URLS: \"http://0.0.0.0:2379\"\n    ports:\n      - \"2379:2379\"\n\n  apisix:\n    image: apache/apisix:1.5-alpine\n    depends_on:\n      - etcd\n    environment:\n      ETCD_HOST: \"etcd:2379\"\n      ETCD_PREFIX: \"/apisix\"\n      APISIX_ADMIN_KEY: \"custom_non_default_token\"\n      APISIX_PROXY_LISTEN_ADDRESS: \"0.0.0.0:9080\"\n      APISIX_ADMIN_LISTEN_ADDRESS: \"0.0.0.0:9180\"\n    ports:\n      - \"9080:9080\"\n      - \"9180:9180\"\n\n  db:\n    image: mysql:5.7\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: \"rootpass\"\n      MYSQL_DATABASE: \"testdb\"\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\n\n  web:\n    build: ./app\n    ports:\n      - \"3000:3000\"\n    environment:\n      NODE_ENV: \"production\"\n    depends_on:\n      - db\n      - apisix"
        },
        {
            "location": "./../../dockers/CVE-2020-13945/custom_no_tool/app/Dockerfile",
            "content": "FROM node:18-slim\nWORKDIR /usr/src/app\nCOPY package*.json ./\nRUN npm ci --only=production\nCOPY . .\nEXPOSE 3000\nCMD [\"node\", \"index.js\"]"
        },
        {
            "location": "./../../dockers/CVE-2020-13945/custom_no_tool/app/package.json",
            "content": "{\n  \"name\": \"vulnerable-app\",\n  \"version\": \"1.0.0\",\n  \"description\": \"App vulnerable to CVE-2020-13945\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"start\": \"node index.js\"\n  },\n  \"dependencies\": {\n    \"express\": \"^4.17.1\",\n    \"lodash\": \"4.17.11\"\n  }\n}"
        },
        {
            "location": "./../../dockers/CVE-2020-13945/custom_no_tool/app/package-lock.json",
            "content": "{\n  \"name\": \"vulnerable-app\",\n  \"version\": \"1.0.0\",\n  \"lockfileVersion\": 2,\n  \"requires\": true,\n  \"packages\": {\n    \"\": {\n      \"name\": \"vulnerable-app\",\n      \"version\": \"1.0.0\",\n      \"dependencies\": {\n        \"express\": \"^4.17.1\",\n        \"lodash\": \"4.17.11\"\n      }\n    },\n    \"node_modules/express\": {\n      \"version\": \"4.17.1\",\n      \"resolved\": \"https://registry.npmjs.org/express/-/express-4.17.1.tgz\",\n      \"integrity\": \"sha512-XXXXX\",\n      \"requires\": {\n        \"accepts\": \"~1.3.7\",\n        \"body-parser\": \"~1.19.0\"\n      }\n    },\n    \"node_modules/lodash\": {\n      \"version\": \"4.17.11\",\n      \"resolved\": \"https://registry.npmjs.org/lodash/-/lodash-4.17.11.tgz\",\n      \"integrity\": \"sha512-XXXXX\"\n    }\n  }\n}"
        },
        {
            "location": "./../../dockers/CVE-2020-13945/custom_no_tool/app/index.js",
            "content": "const express = require('express');\nconst _ = require('lodash');\nconst app = express();\napp.use(express.urlencoded({ extended: true }));\napp.get('/', (req, res) => {\n  res.send('<form method=\"POST\" action=\"/search\"><input name=\"q\"/><button type=\"submit\">Search</button></form>');\n});\napp.post('/search', (req, res) => {\n  const q = req.body.q || '';\n  // vulnerable use of lodash template (allows prototype pollution)\n  const compiled = _.template(q);\n  const result = compiled({});\n  res.send('Result: ' + result);\n});\napp.listen(3000, () => console.log('App listening on port 3000'));"
        },
        {
            "location": "./../../dockers/CVE-2020-13945/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE users (id INT AUTO_INCREMENT PRIMARY KEY, name VARCHAR(255));\nINSERT INTO users (name) VALUES ('alice'), ('bob');"
        }
    ],
    "directory_tree": "CVE-2020-13945/custom_no_tool"
}