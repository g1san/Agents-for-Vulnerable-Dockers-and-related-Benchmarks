# CVE-2024-23897 Vulnerable Jenkins Environment

This project sets up a Jenkins environment vulnerable to CVE-2024-23897, a critical command injection vulnerability in Jenkins CLI.

## Warning

**This is a deliberately vulnerable environment for educational purposes only. DO NOT deploy this in a production environment or on any internet-facing server.**

## Setup

1. Clone this repository:
   ```
   git clone https://example.com/CVE-2024-23897.git
   cd CVE-2024-23897
   ```

2. Start the container:
   ```
   docker compose up
   ```

3. Access Jenkins at `http://localhost:8080`
   - Username: admin
   - Password: admin

## Understanding the Vulnerability

CVE-2024-23897 is a command injection vulnerability in Jenkins' CLI processing. The vulnerability specifically affects:

- Jenkins core before 2.426.1
- Jenkins LTS before 2.414.3

This environment uses Jenkins 2.414.2-LTS which is vulnerable to this issue.

## Testing the Vulnerability

The vulnerability exists in the remoting-based CLI processing. The CLI is accessible via:
- TCP port 50000 (for remoting-based CLI)
- HTTP interface on port 8080 (web UI)

To verify if the system is vulnerable, you can use the Jenkins CLI client to connect to the server and attempt exploitation.

### Basic CLI connection test:

```
java -jar jenkins-cli.jar -s http://localhost:8080/ help
```

An exploitation proof-of-concept would involve using maliciously crafted arguments to the `getProperty` command.

## Remediation

In a real environment, you would:
1. Update Jenkins to version 2.426.1, LTS 2.414.3, or later
2. Disable the remoting-based CLI if not needed
3. Restrict network access to the CLI port (50000)
4. Ensure proper authentication requirements are in place

## References

- [CVE-2024-23897 Jenkins Security Advisory](https://www.jenkins.io/security/advisory/2024-01-24/)
- [Jenkins CLI Documentation](https://www.jenkins.io/doc/book/managing/cli/)