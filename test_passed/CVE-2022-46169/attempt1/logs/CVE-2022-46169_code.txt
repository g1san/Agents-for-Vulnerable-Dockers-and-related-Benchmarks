{
    "file_name": [
        "docker-compose.yml",
        "cacti/Dockerfile",
        "cacti/config.php",
        "cacti/remote_agent.php"
    ],
    "file_code": [
        "version: '3.7'\nservices:\n  cacti:\n    build: ./cacti\n    image: cve-2022-46169\n    ports:\n      - \"8080:80\"\n    depends_on:\n      - db\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: cacti\n      MYSQL_USER: cactiuser\n      MYSQL_PASSWORD: cactipass\n    volumes:\n      - db_data:/var/lib/mysql\nvolumes:\n  db_data:\n    driver: local\n",
        "FROM php:7.4-apache\n\nRUN apt-get update && \\\n    apt-get install -y librrd-dev libpng-dev libjpeg-dev libxml2-dev && \\\n    docker-php-ext-install mysqli && \\\n    docker-php-ext-install gd && \\\n    a2enmod rewrite\n\nCOPY config.php /var/www/html/config.php\nCOPY remote_agent.php /var/www/html/remote_agent.php\n\n# Simulate vulnerable Cacti version\nRUN echo \"Cacti 1.2.22\" > /var/www/html/version.txt\n\nEXPOSE 80\n",
        "<?php\n// config.php\n$database_type = 'mysql';\n$database_default = 'cacti';\n$database_hostname = 'db';\n$database_username = 'cactiuser';\n$database_password = 'cactipass';\n$database_port = '3306';\n$database_ssl = false;\n\n$url_path = '/';\n",
        "<?php\n// remote_agent.php\n// Simulated vulnerable code for demonstration purposes\nif (isset($_GET['cmd'])) {\n    $cmd = $_GET['cmd'];\n    echo shell_exec($cmd);\n}\n"
    ],
    "directory_tree": "CVE-2022-46169/\n├── docker-compose.yml\n└── cacti/\n    ├── Dockerfile\n    ├── config.php\n    └── remote_agent.php\n"
}