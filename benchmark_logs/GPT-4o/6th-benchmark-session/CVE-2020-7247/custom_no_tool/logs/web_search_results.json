{
    "desc": "CVE-2020-7247 is a critical vulnerability in OpenSMTPD versions before 6.6.2, an open-source mail transfer agent (MTA) for Unix servers, including OpenBSD. The vulnerability arises from improper validation in the smtp_mailaddr() function, which processes sender and recipient email addresses. Specifically, when the MAIL FROM or RCPT TO fields contain shell metacharacters, OpenSMTPD fails to escape these dangerous characters properly. This flaw allows remote attackers to execute arbitrary shell commands on the target system, potentially as the root user, leading to remote code execution. The vulnerability can be exploited by sending a specially crafted SMTP message, leveraging the default behavior of the server to fill in blank domains and execute commands with elevated privileges. The issue was fixed in OpenSMTPD version 6.6.2 and later.",
    "attack_type": "Remote Code Execution",
    "services": [
        {
            "name": "opensmtpd",
            "version": [
                "6.6",
                "6.6.0",
                "6.6.1"
            ],
            "dependency_type": "HARD",
            "description": "OpenSMTPD is the primary service affected by CVE-2020-7247, as it contains the vulnerable smtp_mailaddr() function."
        },
        {
            "name": "openbsd",
            "version": [
                "6.6"
            ],
            "dependency_type": "SOFT-OS",
            "description": "OpenBSD is a common operating system where OpenSMTPD is deployed, providing the environment for the mail server."
        }
    ],
    "input_tokens": 4139,
    "output_tokens": 742
}