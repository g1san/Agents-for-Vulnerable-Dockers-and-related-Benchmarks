services:
  vulnerable-app:
    build: ./app
    ports:
      - "8080:8080"

  ldap-server:
    image: osixia/openldap:1.5.0
    command: --copy-service
    environment:
      LDAP_ORGANISATION: "Example"
      LDAP_DOMAIN: "example.org"
      LDAP_ADMIN_PASSWORD: "admin"
    ports:
      - "389:389"
    volumes:
      - ./ldap/ldif:/container/service/slapd/assets/config/bootstrap/ldif/custom

  attack-server:
    image: alpine
    command: ["/bin/sh", "-c", "while true; do sleep 1000; done"]
    volumes:
      - ./attack:/attack
    depends_on:
      - vulnerable-app
      - ldap-server
