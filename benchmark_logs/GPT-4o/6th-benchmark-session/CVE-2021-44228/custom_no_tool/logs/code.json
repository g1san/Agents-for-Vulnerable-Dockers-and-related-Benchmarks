{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-44228/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\n\nservices:\n  webapp:\n    build: ./webapp\n    ports:\n      - \"8081:8080\"\n    networks:\n      - log4j-network\n    depends_on:\n      - tomcat\n\n  tomcat:\n    image: tomcat:9.0.54-jdk8-openjdk\n    ports:\n      - \"8080:8080\"\n    volumes:\n      - ./webapp/target:/usr/local/tomcat/webapps\n    networks:\n      - log4j-network\n\nnetworks:\n  log4j-network:\n    driver: bridge\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom_no_tool/webapp/Dockerfile",
            "content": "FROM maven:3.8.1-openjdk-8 as builder\nWORKDIR /app\nCOPY . .\nRUN mvn clean package\n\nFROM tomcat:9.0.54-jdk8-openjdk\nCOPY --from=builder /app/target/webapp-1.0-SNAPSHOT.war /usr/local/tomcat/webapps/webapp.war\nCMD [\"catalina.sh\", \"run\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom_no_tool/webapp/pom.xml",
            "content": "<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n    <groupId>com.example</groupId>\n    <artifactId>webapp</artifactId>\n    <version>1.0-SNAPSHOT</version>\n    <packaging>war</packaging>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.apache.logging.log4j</groupId>\n            <artifactId>log4j-core</artifactId>\n            <version>2.14.1</version>\n        </dependency>\n        <dependency>\n            <groupId>org.apache.logging.log4j</groupId>\n            <artifactId>log4j-api</artifactId>\n            <version>2.14.1</version>\n        </dependency>\n        <dependency>\n            <groupId>javax.servlet</groupId>\n            <artifactId>javax.servlet-api</artifactId>\n            <version>4.0.1</version>\n            <scope>provided</scope>\n        </dependency>\n    </dependencies>\n\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-compiler-plugin</artifactId>\n                <version>3.8.1</version>\n                <configuration>\n                    <source>1.8</source>\n                    <target>1.8</target>\n                </configuration>\n            </plugin>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-war-plugin</artifactId>\n                <version>3.3.1</version>\n                <configuration>\n                    <warSourceDirectory>src/main/webapp</warSourceDirectory>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n</project>\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom_no_tool/webapp/src/main/webapp/WEB-INF/web.xml",
            "content": "<web-app xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd\"\n         version=\"3.1\">\n\n    <servlet>\n        <servlet-name>Log4jServlet</servlet-name>\n        <servlet-class>com.example.Log4jServlet</servlet-class>\n    </servlet>\n\n    <servlet-mapping>\n        <servlet-name>Log4jServlet</servlet-name>\n        <url-pattern>/log4j</url-pattern>\n    </servlet-mapping>\n\n</web-app>\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom_no_tool/webapp/src/main/java/com/example/Log4jServlet.java",
            "content": "package com.example;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\n\nimport org.apache.logging.log4j.LogManager;\nimport org.apache.logging.log4j.Logger;\n\n@WebServlet(name = \"Log4jServlet\", urlPatterns = {\"/log4j\"})\npublic class Log4jServlet extends HttpServlet {\n\n    private static final Logger logger = LogManager.getLogger(Log4jServlet.class);\n\n    @Override\n    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        String userAgent = req.getHeader(\"User-Agent\");\n        logger.info(\"User-Agent: \" + userAgent);\n        resp.getWriter().println(\"Logged User-Agent to Log4j\");\n    }\n}\n"
        }
    ],
    "directory_tree": "CVE-2021-44228/\n    \u2514\u2500\u2500 custom_no_tool/\n        \u251c\u2500\u2500 docker-compose.yml\n        \u2514\u2500\u2500 webapp/\n            \u251c\u2500\u2500 Dockerfile\n            \u251c\u2500\u2500 pom.xml\n            \u2514\u2500\u2500 src/\n                \u2514\u2500\u2500 main/\n                    \u251c\u2500\u2500 java/\n                    \u2502   \u2514\u2500\u2500 com/\n                    \u2502       \u2514\u2500\u2500 example/\n                    \u2502           \u2514\u2500\u2500 Log4jServlet.java\n                    \u2514\u2500\u2500 webapp/\n                        \u2514\u2500\u2500 WEB-INF/\n                            \u2514\u2500\u2500 web.xml\n"
}