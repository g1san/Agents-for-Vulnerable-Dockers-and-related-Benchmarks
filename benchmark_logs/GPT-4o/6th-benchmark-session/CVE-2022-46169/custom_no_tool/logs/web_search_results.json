{
    "desc": "CVE-2022-46169 is a critical vulnerability affecting Cacti, an open-source network monitoring solution, up to version 1.2.22. The vulnerability allows for unauthenticated remote code execution through a command injection flaw located in the `remote_agent.php` file. The flaw arises from improper handling of the `poller_id` parameter in the `poll_for_data` function, allowing an attacker to inject commands via `proc_open`. This is possible due to an authentication bypass achieved by manipulating `$_SERVER` variables to spoof the server's IP address. The vulnerability can be exploited if a `poller_item` with the action type `POLLER_ACTION_SCRIPT_PHP` is configured, which is often set by default. The issue was disclosed in December 2022 and actively exploited by January 2023. The vulnerability has a CVSS score of 9.8, indicating high severity, and is patched in Cacti versions 1.2.23 and 1.3.0. Mitigations include upgrading to a patched version, restricting IP spoofing, and sanitizing the `poller_id` parameter.",
    "attack_type": "Unauthenticated Remote Code Execution",
    "services": [
        {
            "name": "cacti",
            "version": [
                "1.2.22"
            ],
            "dependency_type": "HARD",
            "description": "Cacti is the main application affected by CVE-2022-46169, and version 1.2.22 is specifically vulnerable to the unauthenticated remote code execution vulnerability."
        },
        {
            "name": "mysql",
            "version": [
                "5.7"
            ],
            "dependency_type": "SOFT-DB",
            "description": "MySQL is used as the database for storing Cacti's data. Version 5.7 is compatible with Cacti 1.2.22."
        },
        {
            "name": "nginx",
            "version": [
                "1.21"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx acts as the web server to serve the Cacti application. Version 1.21 is compatible with Cacti 1.2.22."
        }
    ],
    "input_tokens": 9097,
    "output_tokens": 1005
}