{
    "files": [
        {
            "location": "./../../dockers/CVE-2022-46169/custom/docker-compose.yml",
            "content": "services:\n  cacti:\n    build: ./cacti\n    ports:\n      - \"8080:80\"\n    environment:\n      - DB_HOST=mysql\n      - DB_NAME=cacti\n      - DB_USER=cactiuser\n      - DB_PASS=cactipassword\n    depends_on:\n      - mysql\n    volumes:\n      - ./cacti:/var/www/html\n\n  mysql:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpassword\n      MYSQL_DATABASE: cacti\n      MYSQL_USER: cactiuser\n      MYSQL_PASSWORD: cactipassword\n    volumes:\n      - mysql_data:/var/lib/mysql\n    ports:\n      - \"3306:3306\"\n\nvolumes:\n  mysql_data:\n    driver: local\n"
        },
        {
            "location": "./../../dockers/CVE-2022-46169/custom/cacti/Dockerfile",
            "content": "FROM alpine:3.14\n\nRUN apk add --no-cache \\\n    apache2 \\\n    php7 \\\n    php7-apache2 \\\n    php7-session \\\n    php7-sockets \\\n    php7-gd \\\n    php7-json \\\n    php7-mbstring \\\n    php7-gettext \\\n    php7-zlib \\\n    php7-ldap \\\n    php7-mysqli \\\n    php7-snmp \\\n    php7-curl \\\n    php7-xml \\\n    php7-simplexml \\\n    php7-dom \\\n    php7-ctype \\\n    php7-posix \\\n    php7-iconv \\\n    php7-openssl \\\n    php7-pdo_mysql \\\n    php7-bcmath \\\n    php7-soap \\\n    php7-xmlreader \\\n    php7-xmlwriter \\\n    php7-tokenizer \\\n    php7-fileinfo \\\n    su-exec \\\n    bash \\\n    net-snmp-tools \\\n    rrdtool \\\n    mariadb-client\n\nRUN mkdir -p /run/apache2\n\nCOPY init.sql /docker-entrypoint-initdb.d/\n\nCOPY ./cacti /var/www/html\n\nRUN chown -R apache:apache /var/www/html\n\nEXPOSE 80\n\nCMD [\"httpd\", \"-D\", \"FOREGROUND\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2022-46169/custom/cacti/init.sql",
            "content": "CREATE DATABASE IF NOT EXISTS cacti;\nCREATE USER 'cactiuser'@'%' IDENTIFIED BY 'cactipassword';\nGRANT ALL PRIVILEGES ON cacti.* TO 'cactiuser'@'%';\nFLUSH PRIVILEGES;\n\nUSE cacti;\n\n-- Sample data for testing\nCREATE TABLE IF NOT EXISTS poller_table (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  ip_address VARCHAR(255) NOT NULL\n);\n\nINSERT INTO poller_table (ip_address) VALUES ('127.0.0.1');\n"
        },
        {
            "location": "./../../dockers/CVE-2022-46169/custom/cacti/cacti/index.php",
            "content": "<?php\n// Simple index file for Cacti application\nphpinfo();\n"
        }
    ],
    "directory_tree": "CVE-2022-46169/\n\u251c\u2500\u2500 custom\n\u2502   \u251c\u2500\u2500 docker-compose.yml\n\u2502   \u2514\u2500\u2500 cacti\n\u2502       \u251c\u2500\u2500 Dockerfile\n\u2502       \u251c\u2500\u2500 init.sql\n\u2502       \u2514\u2500\u2500 cacti\n\u2502           \u2514\u2500\u2500 index.php\n\u2514\u2500\u2500 mysql_data\n    \u2514\u2500\u2500 (volume data) \n"
}