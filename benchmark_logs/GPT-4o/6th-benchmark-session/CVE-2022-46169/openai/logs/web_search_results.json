{
    "desc": "CVE-2022-46169 is a critical vulnerability identified in Cacti, an open-source platform for operational monitoring and fault management. This vulnerability allows an unauthenticated attacker to execute arbitrary commands on a server running affected versions of Cacti, specifically versions up to and including 1.2.22. The vulnerability resides in the `remote_agent.php` file, accessible without authentication. The `get_client_addr` function retrieves the client's IP and resolves it to a hostname. If an entry exists in the `poller` table, the client is authorized. However, due to improper handling of server variables, an attacker can manipulate the `poller_id` parameter, leading to command injection. By providing a crafted `poller_id`, such as `;id`, the attacker can execute arbitrary commands on the server. Exploitation can result in unauthorized system access, allowing attackers to execute arbitrary code, potentially leading to complete system compromise. Given Cacti's role in network monitoring, a successful attack could provide insights into network architecture and access to various network endpoints.",
    "attack_type": "RCE (Remote Code Execution)",
    "services": [
        {
            "name": "cacti",
            "version": [
                "1.2.22 and earlier"
            ],
            "dependency_type": "HARD",
            "description": "Cacti is the main service vulnerable to CVE-2022-46169, requiring specific configurations to exploit the vulnerability."
        },
        {
            "name": "mysql",
            "version": [
                "5.7"
            ],
            "dependency_type": "SOFT-DB",
            "description": "MySQL serves as the database backend for Cacti, necessary for storing and retrieving data."
        },
        {
            "name": "php",
            "version": [
                "7.4"
            ],
            "dependency_type": "SOFT",
            "description": "PHP is required to run Cacti's web-based user interface and scripts."
        },
        {
            "name": "nginx",
            "version": [
                "1.18"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx is the web server used to host Cacti's web interface, facilitating access to the vulnerable components."
        }
    ],
    "input_tokens": 841,
    "output_tokens": 528
}