{
    "desc": "CVE-2021-43798 is a path traversal vulnerability in Grafana versions 8.0.0-beta1 to 8.3.0, which allows unauthenticated attackers to access sensitive files on the server. The vulnerability is located in the public API endpoint `/public/plugins/:pluginId`, which does not adequately sanitize user-provided file paths. This flaw enables attackers to traverse directories and access files outside the intended boundaries, such as `/etc/passwd` or Grafana's SQLite database and configuration files, potentially leading to unauthorized access to sensitive data like user credentials and authentication tokens. The vulnerability can be exploited by sending a crafted HTTP GET request to the vulnerable endpoint, bypassing web browsers' automatic path normalization using tools like `curl`. This issue was publicly disclosed on December 7, 2021, and has a CVSS score of 7.5, indicating high severity. It is recommended to upgrade to patched versions (8.3.1, 8.2.7, 8.1.8, 8.0.7) or use a reverse proxy to normalize request paths.",
    "attack_type": "Directory traversal attack",
    "services": [
        {
            "name": "grafana",
            "version": [
                "8.0.0-beta1",
                "8.0.0-beta2",
                "8.0.0-beta3",
                "8.0.0-beta4",
                "8.0.0-beta5",
                "8.0.0-beta6",
                "8.0.0-beta7",
                "8.0.0",
                "8.0.1",
                "8.0.2",
                "8.0.3",
                "8.0.4",
                "8.0.5",
                "8.0.6",
                "8.1.0",
                "8.1.1",
                "8.1.2",
                "8.1.3",
                "8.1.4",
                "8.1.5",
                "8.1.6",
                "8.1.7",
                "8.2.0",
                "8.2.1",
                "8.2.2",
                "8.2.3",
                "8.2.4",
                "8.2.5",
                "8.2.6",
                "8.3.0"
            ],
            "dependency_type": "HARD",
            "description": "Grafana is the main service vulnerable to CVE-2021-43798, as the vulnerability exists within its path traversal handling in certain versions."
        },
        {
            "name": "mysql",
            "version": [
                "5.7"
            ],
            "dependency_type": "SOFT-DB",
            "description": "MySQL is used as the database service for Grafana to store its data and configurations."
        },
        {
            "name": "nginx",
            "version": [
                "1.21.3"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx serves as a reverse proxy to handle HTTP requests and can be configured to mitigate path traversal attempts."
        }
    ],
    "input_tokens": 11991,
    "output_tokens": 1061,
    "query": "CVE-2021-43798"
}