{
    "desc": "CVE-2022-22947 is a critical vulnerability in the Spring Cloud Gateway, specifically affecting versions prior to 3.1.1 and 3.0.7. This vulnerability involves a code injection issue that can be exploited by attackers to execute arbitrary code on a server. The vulnerability arises when the Gateway Actuator endpoint is enabled, exposed, and unsecured, allowing an attacker to craft a malicious request that can lead to code execution. The exploitation involves using the Spring Expression Language (SpEL) to inject code through HTTP requests to the `/actuator/gateway/routes` endpoint. This poses a significant security risk as it can compromise the integrity and confidentiality of the affected system, and it has been assigned a CVSS score of 10.0, indicating its severity. The vulnerability was discovered by Wyatt Dahlenburg and publicly disclosed on March 1, 2022. Mitigation requires upgrading to Spring Cloud Gateway version 3.0.7, 3.1.1, or later.",
    "attack_type": "Remote Code Execution",
    "services": [
        {
            "name": "springio/gateway",
            "version": [
                "3.0.6",
                "3.0.5",
                "3.0.4",
                "3.0.3",
                "3.0.2",
                "3.0.1",
                "3.0.0",
                "3.1.0",
                "3.1.0-RC1",
                "3.1.0-M1",
                "3.1.0-M2",
                "3.1.0-M3",
                "3.1.0-M4",
                "3.1.0-M5",
                "3.1.0-M6"
            ],
            "dependency_type": "HARD",
            "description": "Spring Cloud Gateway is the core service that contains the vulnerability. Versions prior to 3.1.1 and 3.0.7 are vulnerable to CVE-2022-22947."
        },
        {
            "name": "openjdk",
            "version": [
                "11-jre-slim"
            ],
            "dependency_type": "SOFT",
            "description": "Java Runtime Environment is required to run Spring Cloud Gateway."
        },
        {
            "name": "nginx",
            "version": [
                "1.21.6"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx is used as a reverse proxy to handle incoming HTTP requests and forward them to Spring Cloud Gateway."
        }
    ],
    "input_tokens": 4011,
    "output_tokens": 652,
    "query": "CVE-2022-22947 vulnerability details"
}