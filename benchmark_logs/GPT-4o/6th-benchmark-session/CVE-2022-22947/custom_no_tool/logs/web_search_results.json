{
    "desc": "CVE-2022-22947 is a critical vulnerability in Spring Cloud Gateway that allows for remote code execution due to a code injection flaw. The vulnerability is present in versions 3.1.0, 3.0.0 to 3.0.6, and older unsupported versions of Spring Cloud Gateway. It occurs when the Gateway Actuator endpoint is enabled, exposed, and unsecured, allowing a remote attacker to send a specially crafted request. This request can execute arbitrary code on the host system by exploiting the `/actuator/gateway/routes` endpoint. The vulnerability is severe, with a CVSS score of 10.0, and has been actively exploited in the wild. Mitigation involves upgrading to versions 3.1.1+ or 3.0.7+, securing or disabling the Actuator endpoint, and using Spring Security if the endpoint is necessary.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "springcloud/spring-cloud-gateway",
            "version": [
                "3.1.0",
                "3.0.0",
                "3.0.1",
                "3.0.2",
                "3.0.3",
                "3.0.4",
                "3.0.5",
                "3.0.6"
            ],
            "dependency_type": "HARD",
            "description": "Spring Cloud Gateway is the primary service affected by CVE-2022-22947 due to the code injection vulnerability when the Actuator endpoint is exposed and unsecured."
        },
        {
            "name": "openjdk",
            "version": [
                "11-jre-slim"
            ],
            "dependency_type": "SOFT",
            "description": "OpenJDK is required to run Spring Cloud Gateway, as it is a Java-based application."
        },
        {
            "name": "springcloud/spring-cloud-config-server",
            "version": [
                "3.1.0"
            ],
            "dependency_type": "SOFT",
            "description": "Spring Cloud Config Server is used to provide server-side and client-side support for externalized configuration in a distributed system."
        },
        {
            "name": "mysql",
            "version": [
                "8.0"
            ],
            "dependency_type": "SOFT-DB",
            "description": "MySQL is used as a relational database to store configuration data or any other required data for Spring Cloud Gateway."
        },
        {
            "name": "nginx",
            "version": [
                "1.21"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx is used as a reverse proxy to manage incoming requests to the Spring Cloud Gateway."
        }
    ],
    "input_tokens": 4783,
    "output_tokens": 686
}