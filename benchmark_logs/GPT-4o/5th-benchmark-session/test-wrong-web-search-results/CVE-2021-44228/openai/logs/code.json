{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-44228/openai/docker-compose.yml",
            "content": "services:\n  app:\n    build:\n      context: ./app\n      dockerfile: Dockerfile\n    ports:\n      - \"8080:8080\"\n\n  nginx:\n    image: nginx:1.21.3\n    ports:\n      - \"80:80\"\n    volumes:\n      - ./nginx/nginx.conf:/etc/nginx/nginx.conf\n    depends_on:\n      - app\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/openai/app/Dockerfile",
            "content": "# Stage 1: Build the WAR file\nFROM maven:3.8.4-openjdk-8 AS build\nWORKDIR /app\nCOPY pom.xml .\nCOPY src ./src\nRUN mvn clean package\n\n# Stage 2: Create the final image with the specified OpenJDK version\nFROM openjdk:8u312-jdk\nCOPY --from=build /app/target/vulnerable-app-1.0-SNAPSHOT.war /usr/local/tomcat/webapps/vulnerable-app.war\nCMD [\"java\", \"-jar\", \"/usr/local/tomcat/webapps/vulnerable-app.war\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/openai/app/pom.xml",
            "content": "<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>com.example</groupId>\n    <artifactId>vulnerable-app</artifactId>\n    <version>1.0-SNAPSHOT</version>\n    <packaging>war</packaging>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.apache.logging.log4j</groupId>\n            <artifactId>log4j-core</artifactId>\n            <version>2.14.1</version>\n        </dependency>\n        <dependency>\n            <groupId>javax.servlet</groupId>\n            <artifactId>javax.servlet-api</artifactId>\n            <version>4.0.1</version>\n            <scope>provided</scope>\n        </dependency>\n    </dependencies>\n\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-compiler-plugin</artifactId>\n                <version>3.8.1</version>\n                <configuration>\n                    <source>1.8</source>\n                    <target>1.8</target>\n                </configuration>\n            </plugin>\n\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-war-plugin</artifactId>\n                <version>3.2.3</version>\n                <configuration>\n                    <warSourceDirectory>src/main/webapp</warSourceDirectory>\n                    <failOnMissingWebXml>false</failOnMissingWebXml>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n</project>\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/openai/app/src/main/java/com/example/VulnerableApp.java",
            "content": "package com.example;\n\nimport org.apache.logging.log4j.LogManager;\nimport org.apache.logging.log4j.Logger;\n\nimport java.io.IOException;\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n@WebServlet(\"/\")\npublic class VulnerableApp extends HttpServlet {\n    private static final Logger logger = LogManager.getLogger(VulnerableApp.class);\n\n    @Override\n    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        String userAgent = req.getHeader(\"User-Agent\");\n        logger.error(\"User-Agent: \" + userAgent);\n        resp.getWriter().println(\"Logged User-Agent: \" + userAgent);\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/openai/nginx/nginx.conf",
            "content": "events {}\n\nhttp {\n    server {\n        listen 80;\n\n        location / {\n            proxy_pass http://app:8080;\n        }\n    }\n}\n"
        }
    ],
    "directory_tree": "CVE-2021-44228/\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 app\n\u2502   \u251c\u2500\u2500 Dockerfile\n\u2502   \u251c\u2500\u2500 pom.xml\n\u2502   \u2514\u2500\u2500 src\n\u2502       \u2514\u2500\u2500 main\n\u2502           \u2514\u2500\u2500 java\n\u2502               \u2514\u2500\u2500 com\n\u2502                   \u2514\u2500\u2500 example\n\u2502                       \u2514\u2500\u2500 VulnerableApp.java\n\u2514\u2500\u2500 nginx\n    \u2514\u2500\u2500 nginx.conf\n"
}