{
    "files": [
        {
            "location": "./../../dockers/CVE-2022-22963/openai/docker-compose.yml",
            "content": "version: '3.8'\n\nservices:\n  openjdk:\n    image: openjdk:8-jdk\n    container_name: openjdk\n    build:\n      context: ./app\n      dockerfile: Dockerfile\n    volumes:\n      - ./app:/app\n    working_dir: /app\n    command: [\"./mvnw\", \"spring-boot:run\"]\n    ports:\n      - \"8080:8080\"\n\n  mysql:\n    image: mysql:5.7\n    container_name: mysql\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpassword\n      MYSQL_DATABASE: testdb\n      MYSQL_USER: testuser\n      MYSQL_PASSWORD: testpassword\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - mysql-data:/var/lib/mysql\n    healthcheck:\n      test: [\"CMD\", \"mysqladmin\", \"ping\", \"-h\", \"localhost\"]\n      interval: 10s\n      retries: 3\n\n  redis:\n    image: redis:6.2.6\n    container_name: redis\n    ports:\n      - \"6379:6379\"\n\n  rabbitmq:\n    image: rabbitmq:3.9.13-management\n    container_name: rabbitmq\n    ports:\n      - \"5672:5672\"\n      - \"15672:15672\"\n\nvolumes:\n  mysql-data:\n    driver: local\n"
        },
        {
            "location": "./../../dockers/CVE-2022-22963/openai/app/Dockerfile",
            "content": "FROM openjdk:8-jdk\n\nWORKDIR /app\n\nCOPY . /app\n\nRUN chmod +x /app/mvnw\n\nCMD [\"./mvnw\", \"spring-boot:run\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2022-22963/openai/app/pom.xml",
            "content": "<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>com.example</groupId>\n    <artifactId>vulnerable-spring-app</artifactId>\n    <version>1.0-SNAPSHOT</version>\n\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.5.6</version>\n        <relativePath/> <!-- lookup parent from repository -->\n    </parent>\n\n    <properties>\n        <java.version>1.8</java.version>\n    </properties>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-function-web</artifactId>\n            <version>3.1.6</version>\n        </dependency>\n        <dependency>\n            <groupId>mysql</groupId>\n            <artifactId>mysql-connector-java</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-data-redis</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-amqp</artifactId>\n        </dependency>\n    </dependencies>\n\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n            </plugin>\n        </plugins>\n    </build>\n\n</project>\n"
        },
        {
            "location": "./../../dockers/CVE-2022-22963/openai/app/src/main/java/com/example/vulnerableapp/VulnerableAppApplication.java",
            "content": "package com.example.vulnerableapp;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class VulnerableAppApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(VulnerableAppApplication.class, args);\n    }\n\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2022-22963/openai/app/src/main/java/com/example/vulnerableapp/FunctionController.java",
            "content": "package com.example.vulnerableapp;\n\nimport org.springframework.cloud.function.context.FunctionCatalog;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\npublic class FunctionController {\n\n    private final FunctionCatalog functionCatalog;\n\n    public FunctionController(FunctionCatalog functionCatalog) {\n        this.functionCatalog = functionCatalog;\n    }\n\n    @GetMapping(\"/route\")\n    public String route(String expression) {\n        return functionCatalog.lookup(expression).apply(null);\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2022-22963/openai/app/src/main/resources/application.properties",
            "content": "spring.cloud.function.routing-expression=expression\nspring.datasource.url=jdbc:mysql://mysql:3306/testdb\nspring.datasource.username=testuser\nspring.datasource.password=testpassword\nspring.redis.host=redis\nspring.rabbitmq.host=rabbitmq\n"
        },
        {
            "location": "./../../dockers/CVE-2022-22963/openai/app/mvnw",
            "content": "#!/bin/sh\n# ----------------------------------------------------------------------------\n# Licensed to the Apache Software Foundation (ASF) under one or more\n# contributor license agreements.  See the NOTICE file distributed with\n# this work for additional information regarding copyright ownership.\n# The ASF licenses this file to You under the Apache License, Version 2.0\n# (the \"License\"); you may not use this file except in compliance with\n# the License.  You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n# ----------------------------------------------------------------------------\n\n# ----------------------------------------------------------------------------\n# Maven Start Up Batch script\n#\n# Required ENV vars:\n#\n#   JAVA_HOME - location of a JDK home dir\n#\n# Optional ENV vars\n#\n#   M2_HOME - location of maven2's installed home dir\n#   MAVEN_OPTS - parameters passed to the Java VM when running Maven\n#     e.g. to debug Maven itself, use\n#       set MAVEN_OPTS=-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=8000\n#   MAVEN_SKIP_RC - flag to disable loading of mavenrc files\n# ----------------------------------------------------------------------------\n\nif [ -z \"$MAVEN_SKIP_RC\" ] ; then\n  if [ -f /etc/mavenrc ] ; then\n    . /etc/mavenrc\n  fi\n  if [ -f \"$HOME/.mavenrc\" ] ; then\n    . \"$HOME/.mavenrc\"\n  fi\nfi\n\n# OS specific support.  $var _must_ be set to either true or false.\ncygwin=false;\ndarwin=false;\nmingw=false;\ncase \"`uname`\" in\n  CYGWIN*) cygwin=true ;;\n  Darwin*) darwin=true ;;\n  MINGW*) mingw=true ;;\nesac\n\nif [ -z \"$JAVA_HOME\" ] ; then\n  if [ \"$darwin\" = \"true\" ] ; then\n    if [ -z \"$JAVA_VERSION\" ] ; then\n      JAVA_VERSION=CurrentJDK\n    fi\n    JAVA_HOME=\"/System/Library/Frameworks/JavaVM.framework/Versions/${JAVA_VERSION}/Home\"\n    export JAVA_HOME\n  fi\nfi\n\nif [ -z \"$M2_HOME\" ] ; then\n  M2_HOME=\"/usr/local/apache-maven\"\nfi\n\nif [ -z \"$MAVEN_HOME\" ] ; then\n  MAVEN_HOME=\"$M2_HOME\"\nfi\n\nMAVEN_CMD_LINE_ARGS=\"${@}\"\n\nif [ -z \"$MAVEN_PROJECTBASEDIR\" ] ; then\n  # get the absolute path of the current directory\n  if [ \"`uname`\" = \"Darwin\" ]; then\n    # this would be more simple with -P, but that is not available on all systems\n    current_dir=\"`pwd`\"\n    current_dir=\"`cd \"$current_dir\" && pwd`\"\n  else\n    current_dir=\"`pwd -P`\"\n  fi\n  export MAVEN_PROJECTBASEDIR=\"${current_dir}\"\nfi\n\nif [ -z \"$MAVEN_SKIP_RC\" ] ; then\n  if [ -f \"$MAVEN_PROJECTBASEDIR/.mvn/maven.config\" ] ; then\n    MAVEN_CONFIG=\"`cat \"$MAVEN_PROJECTBASEDIR/.mvn/maven.config\"`\"\n  fi\nfi\n\nexec \"$M2_HOME/bin/mvn\" --batch-mode -Dstyle.color=always -Dmaven.multiModuleProjectDirectory=\"$MAVEN_PROJECTBASEDIR\" $MAVEN_CONFIG \"$@\"\n"
        },
        {
            "location": "./../../dockers/CVE-2022-22963/openai/app/mvnw.cmd",
            "content": "@echo off\n\nsetlocal\n\nset MVNW_VERBOSE=false\n\nif \"%MVNW_VERBOSE%\" == \"true\" (\n  set MAVEN_BATCH_ECHO=on\n  set MAVEN_OPTS=\"%MAVEN_OPTS% -X\"\n)\n\nif not defined JAVA_HOME goto err_no_java_home\n\nset CLASSWORLDS_LAUNCHER=org.codehaus.plexus.classworlds.launcher.Launcher\nset MAVEN_PROJECTBASEDIR=%~dp0\nset MAVEN_HOME=%M2_HOME%\n\nif not defined MAVEN_HOME set MAVEN_HOME=%MAVEN_PROJECTBASEDIR%.mvn\\wrapper\n\nset WRAPPER_JAR=\"%MAVEN_PROJECTBASEDIR%\\.mvn\\wrapper\\maven-wrapper.jar\"\n\nif exist %WRAPPER_JAR% (\n  set WRAPPER_LAUNCHER=org.apache.maven.wrapper.MavenWrapperMain\n  if not defined MVNW_VERBOSE (\n    java -jar %WRAPPER_JAR% %*\n  ) else (\n    java -jar %WRAPPER_JAR% %*\n  )\n) else (\n  if not defined MVNW_VERBOSE (\n    java -classpath \"%MAVEN_HOME%\\boot\\plexus-classworlds-2.6.0.jar\" %CLASSWORLDS_LAUNCHER% %*\n  ) else (\n    java -classpath \"%MAVEN_HOME%\\boot\\plexus-classworlds-2.6.0.jar\" %CLASSWORLDS_LAUNCHER% %*\n  )\n)\n\n:end\n\nendlocal\n\nexit /b %ERRORLEVEL%\n\n:err_no_java_home\n\necho.\necho ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH.\necho.\necho Please set the JAVA_HOME variable in your environment to match the\n\necho location of your Java installation.\necho.\n\nexit /b 1\n"
        }
    ],
    "directory_tree": "CVE-2022-22963/\n\u251c\u2500\u2500 docker-compose.yml\n\u2514\u2500\u2500 app\n    \u251c\u2500\u2500 Dockerfile\n    \u251c\u2500\u2500 mvnw\n    \u251c\u2500\u2500 mvnw.cmd\n    \u251c\u2500\u2500 pom.xml\n    \u251c\u2500\u2500 src\n    \u2502   \u251c\u2500\u2500 main\n    \u2502   \u2502   \u251c\u2500\u2500 java\n    \u2502   \u2502   \u2502   \u2514\u2500\u2500 com\n    \u2502   \u2502   \u2502       \u2514\u2500\u2500 example\n    \u2502   \u2502   \u2502           \u2514\u2500\u2500 vulnerableapp\n    \u2502   \u2502   \u2502               \u251c\u2500\u2500 FunctionController.java\n    \u2502   \u2502   \u2502               \u2514\u2500\u2500 VulnerableAppApplication.java\n    \u2502   \u2502   \u2514\u2500\u2500 resources\n    \u2502   \u2502       \u2514\u2500\u2500 application.properties\n    \u2514\u2500\u2500 .mvn\n        \u2514\u2500\u2500 wrapper\n            \u2514\u2500\u2500 maven-wrapper.jar\n"
}