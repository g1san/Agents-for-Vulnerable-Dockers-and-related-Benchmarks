{
    "desc": "CVE-2022-22963 is a critical vulnerability in the Spring Cloud Function framework, specifically affecting versions 3.1.6, 3.2.2, and older unsupported versions. The vulnerability arises from improper handling of input data when using the routing functionality, allowing an attacker to provide a specially crafted Spring Expression Language (SpEL) as a routing expression. This can lead to remote code execution (RCE) by enabling attackers to exploit the HTTP request header `spring.cloud.function.routing-expression` parameter, injecting and executing SpEL expressions through `StandardEvaluationContext`. The vulnerability can lead to complete host compromise, especially in cloud serverless functions like AWS Lambda or Google Cloud Functions. Exploitation is straightforward, allowing attackers to execute arbitrary commands, such as opening a reverse shell. Proper mitigation involves updating to versions 3.1.7 or 3.2.3, which address the flaw by enforcing stricter input validation and sanitization.",
    "attack_type": "Remote code execution",
    "services": [
        {
            "name": "openjdk",
            "version": [
                "8-jdk"
            ],
            "dependency_type": "SOFT",
            "description": "OpenJDK is required to run Java applications, including the Spring Cloud Function."
        },
        {
            "name": "spring-cloud-function",
            "version": [
                "3.1.6",
                "3.2.2"
            ],
            "dependency_type": "HARD",
            "description": "Spring Cloud Function is the vulnerable service in this CVE. Versions 3.1.6 and 3.2.2 are specifically affected."
        },
        {
            "name": "nginx",
            "version": [
                "1.21.6"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx is used as a reverse proxy and web server to handle HTTP requests directed to the Spring Cloud Function."
        }
    ],
    "input_tokens": 6785,
    "output_tokens": 843
}