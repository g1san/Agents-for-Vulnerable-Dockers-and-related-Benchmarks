{
    "desc": "CVE-2022-22947 is a critical vulnerability in the Spring Cloud Gateway library, which is exploited through the Actuator API endpoint. It allows a remote attacker to execute arbitrary code on the host system by sending specially crafted requests due to improper validation of input data. This vulnerability is particularly severe because it can be exploited without authentication, leading to potential full system compromise. The vulnerability is present in Spring Cloud Gateway versions 3.1.0, 3.0.0 to 3.0.6, and older unsupported versions. The exploit involves deploying a stage to the `/actuator/gateway/routes/` endpoint, executing a command, retrieving the result, and then removing the stage. It highlights significant security risks for applications using affected versions of Spring Cloud Gateway, necessitating immediate updates to versions 3.1.1+ or 3.0.7+ to secure deployments. If the Gateway actuator endpoint is unnecessary, it should be disabled or secured using Spring Security to mitigate this vulnerability.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "springcloud/spring-cloud-gateway",
            "version": [
                "3.1.0",
                "3.0.0",
                "3.0.1",
                "3.0.2",
                "3.0.3",
                "3.0.4",
                "3.0.5",
                "3.0.6"
            ],
            "dependency_type": "HARD",
            "description": "Spring Cloud Gateway is the core service that contains the vulnerability in its Actuator API, allowing remote code execution through code injection attacks."
        },
        {
            "name": "openjdk",
            "version": [
                "11-jre-slim"
            ],
            "dependency_type": "SOFT",
            "description": "OpenJDK is required to run Java applications, including Spring Cloud Gateway, which is a Java-based service."
        },
        {
            "name": "postgres",
            "version": [
                "13"
            ],
            "dependency_type": "SOFT-DB",
            "description": "PostgreSQL is used as a relational database for storing data needed by the Spring Cloud Gateway."
        },
        {
            "name": "nginx",
            "version": [
                "1.21"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx acts as a reverse proxy server to route requests to the Spring Cloud Gateway service."
        }
    ],
    "input_tokens": 4795,
    "output_tokens": 730
}