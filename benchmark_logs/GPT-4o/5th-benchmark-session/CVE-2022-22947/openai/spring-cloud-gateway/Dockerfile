# Use Maven to build the application
FROM maven:3.8.4-openjdk-8 AS build

# Set the working directory
WORKDIR /app

# Copy the Maven project descriptor and source files
COPY pom.xml /app/
COPY src /app/src

# Build the application
RUN mvn -f /app/pom.xml clean package

# Use a minimal OpenJDK image to run the application
FROM openjdk:8u312-jre

# Set the working directory
WORKDIR /app

# Copy the built application from the build stage
COPY --from=build /app/target/spring-cloud-gateway-1.0-SNAPSHOT.jar /app/spring-cloud-gateway.jar

# Run the Spring Cloud Gateway application
CMD ["java", "-jar", "/app/spring-cloud-gateway.jar"]
