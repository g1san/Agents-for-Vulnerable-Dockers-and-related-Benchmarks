{
    "desc": "CVE-2022-46169 is a critical command injection vulnerability found in Cacti version 1.2.22. This vulnerability allows unauthenticated users to execute arbitrary code on a server running the affected version of Cacti. The issue resides in the `remote_agent.php` file, which can be accessed without authentication. The vulnerability exploits the `get_client_addr` function, which determines the client IP address using `$_SERVER` variables that can be manipulated by an attacker. By setting the `Forwarded-For` HTTP header to a specific IP, attackers can bypass client authorization. This bypass occurs because the `remote_client_authorized` function checks the client's IP against entries in the poller table, which can be circumvented. Once the authorization is bypassed, attackers can exploit the `poll_for_data` function to inject commands via the `poller_id` parameter, which is not properly sanitized. This command injection can lead to remote code execution if the system has a poller item configured with the action type `POLLER_ACTION_SCRIPT_PHP`. The vulnerability is mitigated in Cacti versions 1.2.23 and 1.3.0 by preventing IP spoofing and properly sanitizing the `poller_id` parameter.",
    "attack_type": "Remote Code Execution",
    "services": [
        {
            "name": "cacti",
            "version": [
                "1.2.22"
            ],
            "dependency_type": "HARD",
            "description": "Cacti is the main service affected by CVE-2022-46169, and version 1.2.22 is specifically vulnerable to the command injection vulnerability."
        },
        {
            "name": "mysql",
            "version": [
                "5.7"
            ],
            "dependency_type": "SOFT-DB",
            "description": "MySQL is the database service used by Cacti to store its data. Version 5.7 is compatible with Cacti 1.2.22."
        },
        {
            "name": "apache",
            "version": [
                "2.4"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Apache is the web server used to serve the Cacti application. Version 2.4 is compatible with Cacti 1.2.22, providing the necessary environment for the application to run."
        }
    ],
    "input_tokens": 9102,
    "output_tokens": 1014
}