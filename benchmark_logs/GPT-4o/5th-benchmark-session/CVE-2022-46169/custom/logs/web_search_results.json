{
    "desc": "CVE-2022-46169 is a critical command injection vulnerability in the open-source network monitoring tool Cacti, specifically affecting version 1.2.22. This vulnerability exists in the `remote_agent.php` file, which can be accessed without authentication. The flaw allows attackers to manipulate the `get_client_addr` function to return arbitrary IP addresses due to the arbitrary setting of HTTP headers. This manipulation enables attackers to bypass the `remote_client_authorized` function, which checks for authorization. Once bypassed, attackers can exploit the `poll_for_data` function to execute arbitrary PHP scripts by injecting commands via the `poller_id` parameter. This is possible if a `poller_item` with the action type `POLLER_ACTION_SCRIPT_PHP` is configured, which is common in production environments. Consequently, unauthenticated users can execute arbitrary commands on the server. Mitigation involves addressing the authorization bypass by restricting IP spoofing and preventing command injection by properly escaping the `poller_id` parameter. Patches are available in versions 1.2.23 and 1.3.0.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "cacti",
            "version": [
                "1.2.22"
            ],
            "dependency_type": "HARD",
            "description": "Cacti is the vulnerable service. Version 1.2.22 is specifically affected by CVE-2022-46169."
        },
        {
            "name": "mysql",
            "version": [
                "5.7"
            ],
            "dependency_type": "SOFT-DB",
            "description": "MySQL is used as the database backend for Cacti to store configuration and monitoring data."
        },
        {
            "name": "php",
            "version": [
                "7.4-apache"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "PHP is required to run Cacti, and the Apache web server serves the Cacti application."
        }
    ],
    "input_tokens": 9100,
    "output_tokens": 1118,
    "query": "CVE-2022-46169"
}