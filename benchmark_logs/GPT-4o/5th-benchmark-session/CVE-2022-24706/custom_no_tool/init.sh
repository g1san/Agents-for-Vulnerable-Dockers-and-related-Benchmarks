#!/bin/bash

# Wait for CouchDB to start
until curl -s http://admin:password@localhost:5984/_utils/ | grep -q 'Welcome'; do
  echo "Waiting for CouchDB to start..."
  sleep 5
done

# Create a test database and add some test data
curl -X PUT http://admin:password@localhost:5984/testdb
curl -X POST http://admin:password@localhost:5984/testdb -H "Content-Type: application/json" -d '{"name": "test", "type": "example"}'

echo "CouchDB is ready with test data."