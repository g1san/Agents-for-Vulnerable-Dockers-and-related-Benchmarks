{
    "desc": "CVE-2022-46169 is a critical command injection vulnerability found in Cacti, an open-source network monitoring and graphing tool. This vulnerability affects Cacti versions up to 1.2.22 and allows unauthenticated attackers to execute arbitrary code on the server. The flaw is located in the `remote_agent.php` script, which improperly handles IP address verification against the poller table. By manipulating HTTP headers, such as `X-Forwarded-For`, an attacker can spoof the server's IP address and bypass authentication. The vulnerability is exploited through the `polldata` action, where a `poller_item` with the action type `POLLER_ACTION_SCRIPT_PHP` can lead to command injection via `proc_open`. This allows for remote code execution as the `www-data` user without authentication. The vulnerability has a CVSS score of 9.8 due to its high severity and ease of exploitation, impacting confidentiality, integrity, and availability. It has been patched in Cacti versions 1.2.23 and later.",
    "attack_type": "Remote Code Execution",
    "services": [
        {
            "name": "cacti",
            "version": [
                "0.6.8A",
                "0.8.6G",
                "0.8.8C",
                "1.2.22"
            ],
            "dependency_type": "HARD",
            "description": "Cacti is the vulnerable application affected by CVE-2022-46169, which allows unauthenticated remote code execution."
        },
        {
            "name": "mysql",
            "version": [
                "8.0"
            ],
            "dependency_type": "SOFT-DB",
            "description": "MySQL is used as the database to store Cacti's data and configurations, necessary for the application to function properly."
        },
        {
            "name": "nginx",
            "version": [
                "1.21"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx is used as the web server to serve the Cacti application, enabling HTTP requests to reach the application."
        }
    ],
    "input_tokens": 6944,
    "output_tokens": 1013
}