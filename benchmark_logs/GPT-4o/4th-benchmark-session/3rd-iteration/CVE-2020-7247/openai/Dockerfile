FROM debian:10.13

RUN sed -i 's/deb.debian.org/archive.debian.org/g' /etc/apt/sources.list && \
    sed -i '/security.debian.org/d' /etc/apt/sources.list && \
    apt-get update && \
    apt-get install -y wget && \
    apt-get clean

# Download and install OpenSMTPD
RUN wget http://snapshot.debian.org/archive/debian/20200201T000000Z/pool/main/o/opensmtpd/opensmtpd_6.6.0-2_amd64.deb -O /tmp/opensmtpd_6.6.0-2_amd64.deb && \
    dpkg -i /tmp/opensmtpd_6.6.0-2_amd64.deb && \
    rm /tmp/opensmtpd_6.6.0-2_amd64.deb

COPY entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh

ENTRYPOINT ["/entrypoint.sh"]
