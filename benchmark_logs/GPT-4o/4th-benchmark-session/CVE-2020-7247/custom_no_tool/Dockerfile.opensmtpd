FROM alpine:3.11

# Install s6-overlay for process management
ADD https://github.com/just-containers/s6-overlay/releases/download/v2.1.0.2/s6-overlay-amd64.tar.gz /tmp/
RUN tar xzf /tmp/s6-overlay-amd64.tar.gz -C /

# Install OpenSMTPD
RUN apk add --no-cache opensmtpd

# Copy configuration files
COPY smtpd.conf /etc/smtpd/smtpd.conf
COPY root/ /

# Set s6-overlay as the entrypoint
ENTRYPOINT ["/init"]
