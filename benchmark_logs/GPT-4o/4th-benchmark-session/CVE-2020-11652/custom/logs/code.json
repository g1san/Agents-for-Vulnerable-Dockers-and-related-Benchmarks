{
    "file_name": [
        "./../../dockers/CVE-2020-11652/custom/docker-compose.yml",
        "./../../dockers/CVE-2020-11652/custom/Dockerfile",
        "./../../dockers/CVE-2020-11652/custom/salt-master.conf"
    ],
    "file_code": [
        "services:\n  salt-master:\n    build: .\n    container_name: salt-master\n    ports:\n      - \"4505:4505\"\n      - \"4506:4506\"\n    volumes:\n      - ./salt-master.conf:/etc/salt/master\n    networks:\n      - salt-network\n\nnetworks:\n  salt-network:\n    driver: bridge\n",
        "FROM python:3.8-slim\n\nRUN apt-get update \\\n    && apt-get install -y --no-install-recommends \\\n       git \\\n       build-essential \\\n    && rm -rf /var/lib/apt/lists/*\n\n# Install the distro module required for SaltStack\nRUN pip install distro\n\n# Install SaltStack version vulnerable to CVE-2020-11652\nRUN pip install salt==3000.1\n\n# Copy the configuration file\nCOPY salt-master.conf /etc/salt/master\n\n# Modify the SaltStack source code to use 'distro' instead of '_supported_dists'\nRUN sed -i 's/from platform import _supported_dists/import distro as _supported_dists/' /usr/local/lib/python3.8/site-packages/salt/grains/core.py\nRUN sed -i 's/_supported_dists = \\/_supported_dists = distro.linux_distribution()\\/' /usr/local/lib/python3.8/site-packages/salt/grains/core.py\n\n# Start the salt-master service\nCMD [\"salt-master\", \"-l\", \"debug\"]\n",
        "# Salt Master Configuration\nfile_roots:\n  base:\n    - /srv/salt\n\n# Enable file directory traversal vulnerability for testing\nopen_mode: True\n\n# Allow unauthenticated access for testing\nexternal_auth:\n  pam:\n    saltuser:\n      - .*\n      - '@wheel'\n      - '@runner'\n      - '@jobs'\n"
    ],
    "directory_tree": "./../../dockers/CVE-2020-11652/custom\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 Dockerfile\n\u2514\u2500\u2500 salt-master.conf"
}