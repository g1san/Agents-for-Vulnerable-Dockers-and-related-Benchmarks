FROM apache/couchdb:3.2.2

# Set a secure Erlang cookie
RUN echo "a_secure_random_cookie_value" > /opt/couchdb/.erlang.cookie && \
    chmod 400 /opt/couchdb/.erlang.cookie

# Add initialization script
COPY init.sh /opt/couchdb/init.sh
RUN chmod +x /opt/couchdb/init.sh

# Expose the epmd port for communication
EXPOSE 4369
