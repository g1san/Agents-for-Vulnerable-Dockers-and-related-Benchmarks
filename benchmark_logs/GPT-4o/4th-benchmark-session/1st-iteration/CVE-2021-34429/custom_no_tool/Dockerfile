FROM eclipse-temurin:11-jre

# Install Jetty
ENV JETTY_VERSION=9.4.42.v20210604
RUN apt-get update && apt-get install -y wget \
    && wget https://repo1.maven.org/maven2/org/eclipse/jetty/jetty-distribution/${JETTY_VERSION}/jetty-distribution-${JETTY_VERSION}.tar.gz \
    && tar xvf jetty-distribution-${JETTY_VERSION}.tar.gz -C /opt/ \
    && mv /opt/jetty-distribution-${JETTY_VERSION} /opt/jetty \
    && rm jetty-distribution-${JETTY_VERSION}.tar.gz \
    && apt-get remove --purge -y wget \
    && apt-get autoremove -y 

# Set Jetty home
ENV JETTY_HOME=/opt/jetty

# Copy the webapp
COPY webapp /var/lib/jetty/webapps/root

# Expose port
EXPOSE 8080

# Start Jetty
CMD ["/opt/jetty/bin/jetty.sh", "run"]
