#1 [internal] load local bake definitions
#1 reading from stdin 679B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile:
#2 transferring dockerfile: 268B done
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/library/couchdb:3.2.1
#3 DONE 0.5s

#4 [internal] load .dockerignore
#4 transferring context: 2B done
#4 DONE 0.0s

#5 [internal] load build context
#5 transferring context: 775B done
#5 DONE 0.0s

#6 [1/4] FROM docker.io/library/couchdb:3.2.1@sha256:37a7a9aab050c8c376b012d9c52da58e2c94d221b0eb5567edb88d8ceca096ee
#6 resolve docker.io/library/couchdb:3.2.1@sha256:37a7a9aab050c8c376b012d9c52da58e2c94d221b0eb5567edb88d8ceca096ee 0.0s done
#6 CACHED

#7 [2/4] COPY couchdb-entrypoint.sh /usr/local/bin/couchdb-entrypoint.sh
#7 DONE 0.0s

#8 [3/4] COPY local.ini /opt/couchdb/etc/local.ini
#8 DONE 0.0s

#9 [4/4] RUN chmod +x /usr/local/bin/couchdb-entrypoint.sh
#9 DONE 0.2s

#10 exporting to image
#10 exporting layers 0.1s done
#10 exporting manifest sha256:8c9234133d38fec083a03a0cd4214925db00c5efe8ff55060320ebd668b2448c 0.0s done
#10 exporting config sha256:dcb94b77e82a58ef504546e3425577a642399940703975014b09dfce429e497a 0.0s done
#10 exporting attestation manifest sha256:e2c241474fc1901e58da57ea0259417d3c182c612174ea70005930f13a5cefc3 0.0s done
#10 exporting manifest list sha256:cb224aa00a823bf8763084d8a322c045a3742a4bc971bafc7f411b328d248ce6 0.0s done
#10 naming to docker.io/library/openai-couchdb:latest done
#10 unpacking to docker.io/library/openai-couchdb:latest 0.1s done
#10 DONE 0.3s

#11 resolving provenance for metadata file
#11 DONE 0.0s
 openai-couchdb  Built
 Network openai_default  Creating
 Network openai_default  Created
 Volume openai_couchdb_data  Creating
 Volume openai_couchdb_data  Created
 Container openai-couchdb-1  Creating
 Container openai-nginx-1  Creating
 Container openai-nginx-1  Created
 Container openai-couchdb-1  Created
 Container openai-nginx-1  Starting
 Container openai-couchdb-1  Starting
 Container openai-couchdb-1  Started
 Container openai-nginx-1  Started


sudo docker logs ce0e19323d4c0715fb8873197e96b87c8d78b630ed65c1fbaad5fbbde7bf86d1 --details
STDOUT:  {"ok":true}
 {"ok":true}
 {"error":"file_exists","reason":"The database could not be created, the file already exists."}

STDERR:  [info] 2025-10-01T19:06:03.121270Z nonode@nohost <0.250.0> -------- Preflight check: Asserting Admin Account
 
 [info] 2025-10-01T19:06:03.122843Z nonode@nohost <0.250.0> -------- Apache CouchDB 3.2.1 is starting.
 
 [info] 2025-10-01T19:06:03.122913Z nonode@nohost <0.251.0> -------- Starting couch_sup
 [notice] 2025-10-01T19:06:03.128655Z nonode@nohost <0.104.0> -------- config: [admins] admin set to '****' for reason nil
 [info] 2025-10-01T19:06:03.159136Z nonode@nohost <0.250.0> -------- Apache CouchDB has started. Time to relax.
 
 [notice] 2025-10-01T19:06:03.164023Z nonode@nohost <0.304.0> -------- rexi_server : started servers
 [notice] 2025-10-01T19:06:03.165060Z nonode@nohost <0.308.0> -------- rexi_buffer : started servers
 [warning] 2025-10-01T19:06:03.176800Z nonode@nohost <0.316.0> -------- creating missing database: _nodes
 [info] 2025-10-01T19:06:03.176847Z nonode@nohost <0.317.0> -------- open_result error {not_found,no_db_file} for _nodes
 [warning] 2025-10-01T19:06:03.204131Z nonode@nohost <0.331.0> -------- creating missing database: _dbs
 [warning] 2025-10-01T19:06:03.204133Z nonode@nohost <0.332.0> -------- creating missing database: _dbs
 [info] 2025-10-01T19:06:03.204174Z nonode@nohost <0.334.0> -------- open_result error {not_found,no_db_file} for _dbs
 [notice] 2025-10-01T19:06:03.213740Z nonode@nohost <0.346.0> -------- mem3_reshard_dbdoc start init()
 [notice] 2025-10-01T19:06:03.216311Z nonode@nohost <0.348.0> -------- mem3_reshard start init()
 [notice] 2025-10-01T19:06:03.216356Z nonode@nohost <0.349.0> -------- mem3_reshard db monitor <0.349.0> starting
 [notice] 2025-10-01T19:06:03.217367Z nonode@nohost <0.348.0> -------- mem3_reshard starting reloading jobs
 [notice] 2025-10-01T19:06:03.217439Z nonode@nohost <0.348.0> -------- mem3_reshard finished reloading jobs
 [info] 2025-10-01T19:06:03.232198Z nonode@nohost <0.355.0> -------- Apache CouchDB has started. Time to relax.
 
 [info] 2025-10-01T19:06:03.232314Z nonode@nohost <0.355.0> -------- Apache CouchDB has started on http://any:5984/
 [notice] 2025-10-01T19:06:03.236841Z nonode@nohost <0.378.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.
 [error] 2025-10-01T19:06:03.236945Z nonode@nohost emulator -------- Error in process <0.379.0> with exit value:
 {database_does_not_exist,[{mem3_shards,load_shards_from_db,"_users",[{file,"src/mem3_shards.erl"},{line,400}]},{mem3_shards,load_shards_from_disk,1,[{file,"src/mem3_shards.erl"},{line,375}]},{mem3_shards,load_shards_from_disk,2,[{file,"src/mem3_shards.erl"},{line,404}]},{mem3_shards,for_docid,3,[{file,"src/mem3_shards.erl"},{line,97}]},{fabric_doc_open,go,3,[{file,"src/fabric_doc_open.erl"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,"src/chttpd_auth_cache.erl"},{line,198}]},{chttpd_auth_cache,listen_for_changes,1,[{file,"src/chttpd_auth_cache.erl"},{line,145}]}]}
 
 [error] 2025-10-01T19:06:03.237096Z nonode@nohost emulator -------- Error in process <0.379.0> with exit value:
 {database_does_not_exist,[{mem3_shards,load_shards_from_db,"_users",[{file,"src/mem3_shards.erl"},{line,400}]},{mem3_shards,load_shards_from_disk,1,[{file,"src/mem3_shards.erl"},{line,375}]},{mem3_shards,load_shards_from_disk,2,[{file,"src/mem3_shards.erl"},{line,404}]},{mem3_shards,for_docid,3,[{file,"src/mem3_shards.erl"},{line,97}]},{fabric_doc_open,go,3,[{file,"src/fabric_doc_open.erl"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,"src/chttpd_auth_cache.erl"},{line,198}]},{chttpd_auth_cache,listen_for_changes,1,[{file,"src/chttpd_auth_cache.erl"},{line,145}]}]}
 
 [notice] 2025-10-01T19:06:03.256907Z nonode@nohost <0.426.0> -------- Missing system database _users
 [notice] 2025-10-01T19:06:08.231402Z nonode@nohost <0.378.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.
 [error] 2025-10-01T19:06:08.231812Z nonode@nohost emulator -------- Error in process <0.528.0> with exit value:
 {database_does_not_exist,[{mem3_shards,load_shards_from_db,"_users",[{file,"src/mem3_shards.erl"},{line,400}]},{mem3_shards,load_shards_from_disk,1,[{file,"src/mem3_shards.erl"},{line,375}]},{mem3_shards,load_shards_from_disk,2,[{file,"src/mem3_shards.erl"},{line,404}]},{mem3_shards,for_docid,3,[{file,"src/mem3_shards.erl"},{line,97}]},{fabric_doc_open,go,3,[{file,"src/fabric_doc_open.erl"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,"src/chttpd_auth_cache.erl"},{line,198}]},{chttpd_auth_cache,listen_for_changes,1,[{file,"src/chttpd_auth_cache.erl"},{line,145}]}]}
 
 [error] 2025-10-01T19:06:08.231975Z nonode@nohost emulator -------- Error in process <0.528.0> with exit value:
 {database_does_not_exist,[{mem3_shards,load_shards_from_db,"_users",[{file,"src/mem3_shards.erl"},{line,400}]},{mem3_shards,load_shards_from_disk,1,[{file,"src/mem3_shards.erl"},{line,375}]},{mem3_shards,load_shards_from_disk,2,[{file,"src/mem3_shards.erl"},{line,404}]},{mem3_shards,for_docid,3,[{file,"src/mem3_shards.erl"},{line,97}]},{fabric_doc_open,go,3,[{file,"src/fabric_doc_open.erl"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,"src/chttpd_auth_cache.erl"},{line,198}]},{chttpd_auth_cache,listen_for_changes,1,[{file,"src/chttpd_auth_cache.erl"},{line,145}]}]}
 
   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                  Dload  Upload   Total   Spent    Left  Speed
 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0[error] 2025-10-01T19:06:12.606065Z nonode@nohost <0.545.0> 9c4ae83078 Request to create N=3 DB but only 1 node(s)
 
100    12  100    12    0     0    226      0 --:--:-- --:--:-- --:--:--   230
 [notice] 2025-10-01T19:06:12.640084Z nonode@nohost <0.545.0> 9c4ae83078 localhost:5984 127.0.0.1 admin PUT /_users 201 ok 47
   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                  Dload  Upload   Total   Spent    Left  Speed
 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0[error] 2025-10-01T19:06:12.650224Z nonode@nohost <0.546.0> be0db0f6c8 Request to create N=3 DB but only 1 node(s)
 
100    12  100    12    0     0   1000      0 --:--:-- --:--:-- --:--:--  1000
 [notice] 2025-10-01T19:06:12.660873Z nonode@nohost <0.546.0> be0db0f6c8 localhost:5984 127.0.0.1 admin PUT /_nodes 201 ok 11
   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                  Dload  Upload   Total   Spent    Left  Speed
 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100    95  100    95    0     0  95000      0 --:--:-- --:--:-- --:--:-- 95000
 [notice] 2025-10-01T19:06:12.668691Z nonode@nohost <0.547.0> 349fe9ddfe localhost:5984 127.0.0.1 admin PUT /_dbs 412 ok 1


