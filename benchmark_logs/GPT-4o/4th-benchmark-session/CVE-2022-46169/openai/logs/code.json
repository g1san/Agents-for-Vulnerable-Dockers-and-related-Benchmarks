{
    "file_name": [
        "./../../dockers/CVE-2022-46169/openai/docker-compose.yml",
        "./../../dockers/CVE-2022-46169/openai/cacti/Dockerfile",
        "./../../dockers/CVE-2022-46169/openai/cacti/config.php",
        "./../../dockers/CVE-2022-46169/openai/mysql/Dockerfile",
        "./../../dockers/CVE-2022-46169/openai/mysql/init.sql"
    ],
    "file_code": [
        "version: '3.8'\n\nservices:\n  cacti:\n    build: ./cacti\n    ports:\n      - \"8080:80\"\n    volumes:\n      - ./cacti/config.php:/var/www/html/cacti/include/config.php\n    depends_on:\n      - mysql\n\n  mysql:\n    build: ./mysql\n    environment:\n      MYSQL_ROOT_PASSWORD: root\n      MYSQL_DATABASE: cacti\n    volumes:\n      - mysql_data:/var/lib/mysql\n\nvolumes:\n  mysql_data:\n    driver: local\n",
        "FROM php:7.4-apache\n\nRUN apt-get update \\\n    && apt-get install -y \\\n        librrd-dev \\\n        git \\\n        unzip \\\n        libpng-dev \\\n        libjpeg-dev \\\n        libxml2-dev \\\n        libldap2-dev \\\n        libsnmp-dev \\\n        snmp \\\n        snmpd \\\n        rrdtool \\\n        libssl-dev \\\n    && docker-php-ext-configure gd --with-jpeg \\\n    && docker-php-ext-install gd \\\n    && docker-php-ext-install mysqli \\\n    && docker-php-ext-install sockets \\\n    && docker-php-ext-install gettext \\\n    && docker-php-ext-install pdo_mysql \\\n    && docker-php-ext-install ldap \\\n    && docker-php-ext-install snmp\n\n# Download and setup Cacti\nRUN git clone https://github.com/Cacti/cacti.git /var/www/html/cacti \\\n    && cd /var/www/html/cacti \\\n    && git checkout tags/release/1.2.22\n\nWORKDIR /var/www/html/cacti\n\nRUN cp include/config.php.dist include/config.php\n\nEXPOSE 80\n",
        "<?php\n$database_type = 'mysql';\n$database_default = 'cacti';\n$database_hostname = 'mysql';\n$database_username = 'root';\n$database_password = 'root';\n$database_port = '3306';\n$database_ssl = false;\n\n$url_path = '/cacti/';\n\n$poller_id = 1;\n\n$log_destination = 'syslog';\n\n$rrdtool_path = '/usr/bin/rrdtool';\n$rrdtool_version = '1.7.0';\n$rrdtool_default_font = '0:IPAGothic';\n\n$snmp_version = 'net-snmp';\n\n$path_rrdtool = '/usr/bin/rrdtool';\n$path_php_binary = '/usr/bin/php';\n$path_snmpwalk = '/usr/bin/snmpwalk';\n$path_snmpget = '/usr/bin/snmpget';\n$path_snmpbulkwalk = '/usr/bin/snmpbulkwalk';\n$path_snmpgetnext = '/usr/bin/snmpgetnext';\n$path_curl = '/usr/bin/curl';\n$path_unzip = '/usr/bin/unzip';\n$path_7zip = '/usr/bin/7z';\n$path_php = '/usr/bin/php';\n$path_fping = '/usr/bin/fping';\n$path_ping = '/bin/ping';\n$path_traceroute = '/usr/bin/traceroute';\n",
        "FROM mysql:5.7\n\nCOPY init.sql /docker-entrypoint-initdb.d/\n",
        "CREATE DATABASE IF NOT EXISTS cacti;\nUSE cacti;\n\nCREATE TABLE IF NOT EXISTS poller (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    hostname VARCHAR(255) NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS poller_item (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    poller_id INT NOT NULL,\n    action VARCHAR(255) NOT NULL\n);\n\nINSERT INTO poller (hostname) VALUES ('localhost');\nINSERT INTO poller_item (poller_id, action) VALUES (1, 'POLLER_ACTION_SCRIPT_PHP');\n"
    ],
    "directory_tree": "./../../dockers/CVE-2022-46169/openai"
}