FROM php:7.4-apache

RUN apt-get update && \
    apt-get install -y \
    librrd-dev \
    libldap2-dev \
    libsnmp-dev \
    snmp \
    snmpd \
    rrdtool \
    git \
    unzip \
    && rm -rf /var/lib/apt/lists/*

RUN docker-php-ext-install mysqli pdo pdo_mysql snmp

WORKDIR /var/www/html

# Updated to use a vulnerable version
RUN git clone -b release/1.2.22 https://github.com/Cacti/cacti.git .

COPY config.php include/config.php
COPY remote_agent.php include/remote_agent.php

RUN chown -R www-data:www-data /var/www/html
