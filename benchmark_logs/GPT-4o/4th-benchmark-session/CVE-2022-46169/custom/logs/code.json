{
    "file_name": [
        "./../../dockers/CVE-2022-46169/custom/docker-compose.yml",
        "./../../dockers/CVE-2022-46169/custom/Dockerfile",
        "./../../dockers/CVE-2022-46169/custom/cacti.sql"
    ],
    "file_code": [
        "version: '3.7'\n\nservices:\n  db:\n    image: mysql:5.7\n    container_name: cacti_db\n    restart: unless-stopped\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: cacti\n      MYSQL_USER: cactiuser\n      MYSQL_PASSWORD: cactiuserpass\n    volumes:\n      - db_data:/var/lib/mysql\n    networks:\n      - cacti_net\n\n  cacti:\n    build: .\n    container_name: cacti_app\n    restart: unless-stopped\n    environment:\n      - MYSQL_HOST=db\n      - MYSQL_DATABASE=cacti\n      - MYSQL_USER=cactiuser\n      - MYSQL_PASSWORD=cactiuserpass\n    ports:\n      - \"8080:80\"\n    networks:\n      - cacti_net\n    depends_on:\n      - db\n    volumes:\n      - cacti_data:/var/www/html\n\nnetworks:\n  cacti_net:\n    driver: bridge\n\nvolumes:\n  db_data:\n  cacti_data:\n",
        "FROM php:7.4-apache\n\nRUN apt-get update && \\\n    apt-get install -y git librrd-dev libpng-dev libjpeg-dev libxml2-dev && \\\n    docker-php-ext-install mysqli && \\\n    docker-php-ext-install sockets && \\\n    docker-php-ext-install gd && \\\n    docker-php-ext-install xml && \\\n    a2enmod rewrite\n\nCOPY cacti.sql /docker-entrypoint-initdb.d/cacti.sql\n\n# Configure Git to treat the directory as safe\nRUN git config --global --add safe.directory /var/www/html\n\n# Clone the Cacti repository and checkout the specific version\nRUN git clone https://github.com/Cacti/cacti.git /var/www/html && \\\n    cd /var/www/html && \\\n    git checkout tags/release/1.2.22\n\nRUN chown -R www-data:www-data /var/www/html\n\n# Allow .htaccess\nRUN sed -i 's/AllowOverride None/AllowOverride All/g' /etc/apache2/apache2.conf\n\nEXPOSE 80\n\n",
        "-- Cacti Database Schema\nCREATE TABLE IF NOT EXISTS `poller_item` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `poller_id` int(11) NOT NULL,\n  `command` text NOT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\nINSERT INTO `poller_item` (`poller_id`, `command`) VALUES\n(1, 'uptime'),\n(2, 'df -h');\n"
    ],
    "directory_tree": "./../../dockers/CVE-2022-46169/custom\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 cacti.sql\n\u2514\u2500\u2500 docker-compose.yml"
}