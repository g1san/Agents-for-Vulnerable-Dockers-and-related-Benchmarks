FROM php:7.3-apache

# Install required PHP extensions and dependencies
RUN docker-php-ext-install mysqli

# Download and set up phpMyAdmin 4.6.2
RUN apt-get update && \
    apt-get install -y wget unzip && \
    wget https://files.phpmyadmin.net/phpMyAdmin/4.6.2/phpMyAdmin-4.6.2-english.zip && \
    unzip phpMyAdmin-4.6.2-english.zip -d /var/www/html && \
    mv /var/www/html/phpMyAdmin-4.6.2-english /var/www/html/phpmyadmin && \
    rm phpMyAdmin-4.6.2-english.zip && \
    apt-get remove -y wget unzip && \
    apt-get autoremove -y && \
    apt-get clean

# Copy configuration file
COPY ./www/config.inc.php /var/www/html/phpmyadmin/config.inc.php

# Set permissions
RUN chown -R www-data:www-data /var/www/html/phpmyadmin
