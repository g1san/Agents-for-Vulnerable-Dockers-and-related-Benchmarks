{
    "files": [
        {
            "location": "./../../dockers/CVE-2022-24706/openai/docker-compose.yml",
            "content": "version: '3.7'\n\nservices:\n  couchdb:\n    build: .\n    ports:\n      - \"5984:5984\"\n    environment:\n      - COUCHDB_USER=admin\n      - COUCHDB_PASSWORD=password\n    volumes:\n      - couchdb_data:/opt/couchdb/data\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:5984/_up\"]\n      interval: 10s\n      retries: 5\n\nvolumes:\n  couchdb_data:\n    driver: local\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24706/openai/init-couchdb.sh",
            "content": "#!/bin/bash\n# Wait for CouchDB to start\nuntil curl -s http://localhost:5984/_up; do\n  >&2 echo \"CouchDB is unavailable - sleeping\"\n  sleep 1\ndone\n\n# Retry mechanism to ensure databases are created\nfor i in {1..5}; do\n  curl -X PUT http://admin:password@localhost:5984/_users\n  curl -X PUT http://admin:password@localhost:5984/_replicator\n  curl -X PUT http://admin:password@localhost:5984/testdb\n  if [ $? -eq 0 ]; then\n    echo \"Databases created successfully\"\n    break\n  else\n    echo \"Failed to create databases, retrying...\"\n    sleep 2\n  fi\ndone\n\n# Add some test data to the test database\ncurl -X POST http://admin:password@localhost:5984/testdb -H \"Content-Type: application/json\" -d '{\"name\": \"test\", \"type\": \"example\"}'\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24706/openai/Dockerfile",
            "content": "FROM apache/couchdb:3.2.1\n\nCOPY init-couchdb.sh /docker-entrypoint-initdb.d/\nRUN chmod +x /docker-entrypoint-initdb.d/init-couchdb.sh\n\n# No need to specify ENTRYPOINT or CMD, as the default entrypoint\n# will automatically execute scripts in /docker-entrypoint-initdb.d/\n"
        }
    ],
    "directory_tree": "CVE-2022-24706/\n\u2514\u2500\u2500 openai\n    \u251c\u2500\u2500 Dockerfile\n    \u251c\u2500\u2500 docker-compose.yml\n    \u2514\u2500\u2500 init-couchdb.sh"
}