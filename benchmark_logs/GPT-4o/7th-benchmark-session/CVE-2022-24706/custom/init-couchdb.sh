#!/bin/bash
# Script to initialize CouchDB with test data

# Wait for CouchDB to start
until curl -s http://admin:password@secure_couchdb:5984/_all_dbs; do
  echo "Waiting for CouchDB to start..."
  sleep 2
  done

# Create a test database and add some documents
curl -X PUT http://admin:password@secure_couchdb:5984/test_db

curl -X POST http://admin:password@secure_couchdb:5984/test_db -H "Content-Type: application/json" -d '{"name": "test_doc_1", "type": "test"}'
curl -X POST http://admin:password@secure_couchdb:5984/test_db -H "Content-Type: application/json" -d '{"name": "test_doc_2", "type": "test"}'

# Verify the documents
curl http://admin:password@secure_couchdb:5984/test_db/_all_docs
