{
    "files": [
        {
            "location": "./../../dockers/CVE-2022-24706/custom_no_tool/docker-compose.yml",
            "content": "services:\n  couchdb:\n    build: .\n    container_name: couchdb\n    environment:\n      - COUCHDB_USER=admin\n      - COUCHDB_PASSWORD=password\n    ports:\n      - \"5984:5984\"\n    networks:\n      - couchdb-network\n    volumes:\n      - couchdb-data:/opt/couchdb/data\n\n  erlang:\n    image: erlang:23.3.4.5\n    container_name: erlang\n    command: tail -f /dev/null\n    networks:\n      - couchdb-network\n\nnetworks:\n  couchdb-network:\n    driver: bridge\n\nvolumes:\n  couchdb-data:\n    driver: local\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24706/custom_no_tool/couchdb/setup.sh",
            "content": "#!/bin/bash\n\n# This script sets up CouchDB with a secure Erlang cookie and initializes system databases\n\n# Set a secure random Erlang cookie\nCOOKIE_FILE=\"/opt/couchdb/.erlang.cookie\"\nopenssl rand -base64 32 > $COOKIE_FILE\nchmod 400 $COOKIE_FILE\nchown couchdb:couchdb $COOKIE_FILE\n\n# Configure CouchDB admin credentials in local.ini\nINI_FILE=\"/opt/couchdb/etc/local.ini\"\necho \"[admins]\" >> $INI_FILE\necho \"admin = password\" >> $INI_FILE\n\n# Start CouchDB in the background\n/opt/couchdb/bin/couchdb &\n\n# Wait for CouchDB to start\nsleep 10\n\n# Initialize system databases if they do not exist\ncurl -u admin:password -X PUT http://127.0.0.1:5984/_users\ncurl -u admin:password -X PUT http://127.0.0.1:5984/_nodes\ncurl -u admin:password -X PUT http://127.0.0.1:5984/_dbs\n\n# Add test data to the _users database\ncurl -u admin:password -X POST http://127.0.0.1:5984/_users -H \"Content-Type: application/json\" -d '{\"_id\": \"org.couchdb.user:testuser\", \"name\": \"testuser\", \"password\": \"testpass\", \"roles\": [], \"type\": \"user\"}'\n\n# Bring CouchDB to the foreground\nwait\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24706/custom_no_tool/Dockerfile",
            "content": "FROM apache/couchdb:3.2.1\n\nCOPY ./couchdb/setup.sh /usr/local/bin/setup.sh\nRUN chmod +x /usr/local/bin/setup.sh\n\nENTRYPOINT [\"/usr/local/bin/setup.sh\"]\n"
        }
    ],
    "directory_tree": "CVE-2022-24706/\n\u2514\u2500\u2500 custom_no_tool\n    \u251c\u2500\u2500 Dockerfile\n    \u251c\u2500\u2500 couchdb\n    \u2502   \u2514\u2500\u2500 setup.sh\n    \u2514\u2500\u2500 docker-compose.yml"
}