{
    "desc": "CVE-2022-24706 is a critical vulnerability affecting Apache CouchDB versions 3.2.1 and below. This vulnerability allows for remote privilege escalation and remote code execution due to the default installation configuration. The issue arises from CouchDB opening a random network port for clustered operation, which is advertised by the Erlang Port Mapper Daemon (EPMD) that listens on a fixed port (4369). The vulnerability is primarily due to the use of a default cookie value, 'monster', for authentication between Erlang nodes, which is not adequately secured. This allows attackers to gain admin privileges without authentication by exploiting the Erlang/OTP Distribution Protocol. Mitigation involves upgrading to CouchDB 3.2.2 or later, changing the default cookie value, and configuring firewalls to bind EPMD and CouchDB distribution ports to local interfaces only.",
    "attack_type": "Remote Code Execution",
    "services": [
        {
            "name": "couchdb",
            "version": [
                "3.2.1",
                "3.1.0",
                "3.0.0"
            ],
            "dependency_type": "HARD",
            "description": "Apache CouchDB is the core service that is vulnerable to CVE-2022-24706, allowing remote code execution due to improperly secured default settings."
        },
        {
            "name": "erlang",
            "version": [
                "23.3.4.5"
            ],
            "dependency_type": "SOFT",
            "description": "Erlang is required for CouchDB operations and is involved in the vulnerability due to the default cookie value used for node communication."
        },
        {
            "name": "epmd",
            "version": [
                "23.3.4.5"
            ],
            "dependency_type": "SOFT",
            "description": "Erlang Port Mapper Daemon (EPMD) is used by CouchDB for clustered operations and is involved in the vulnerability as it listens on a fixed port that can be exploited."
        }
    ],
    "input_tokens": 6534,
    "output_tokens": 728
}