@echo off

setlocal

set MAVEN_OPTS=%MAVEN_OPTS% -Djansi.passthrough=true

if not "%MAVEN_SKIP_RC%"=="" goto skipRcPre
if exist "%MAVEN_HOME%\mavenrc_pre.bat" call "%MAVEN_HOME%\mavenrc_pre.bat"
if exist "%USERPROFILE%\.mavenrc_pre" call "%USERPROFILE%\.mavenrc_pre"
:skipRcPre

set MAVEN_PROJECTBASEDIR=%~dp0

if not "%MAVEN_SKIP_RC%"=="" goto skipRcPost
if exist "%MAVEN_HOME%\mavenrc_post.bat" call "%MAVEN_HOME%\mavenrc_post.bat"
if exist "%USERPROFILE%\.mavenrc_post" call "%USERPROFILE%\.mavenrc_post"
:skipRcPost

set MAVEN_BATCH_ECHO=off
set MAVEN_BATCH_PAUSE=off

if not "%MAVEN_BATCH_ECHO%"=="" echo %MAVEN_BATCH_ECHO%

if not "%MAVEN_SKIP_RC%"=="" goto skipRc
if exist "%MAVEN_HOME%\mavenrc_pre.bat" call "%MAVEN_HOME%\mavenrc_pre.bat"
if exist "%USERPROFILE%\.mavenrc_pre" call "%USERPROFILE%\.mavenrc_pre"
:skipRc

setlocal

set MAVEN_CMD_LINE_ARGS=

:argLoop
if "%1"=="" goto endArgs
set MAVEN_CMD_LINE_ARGS=%MAVEN_CMD_LINE_ARGS% %1
shift
goto argLoop
:endArgs

set MVN_CMD="%MAVEN_HOME%\bin\mvn.cmd" -Dmaven.multiModuleProjectDirectory="%MAVEN_PROJECTBASEDIR%" %MAVEN_CMD_LINE_ARGS%

if not "%MAVEN_BATCH_PAUSE%"=="" pause

endlocal

if not "%MAVEN_BATCH_PAUSE%"=="" pause

if "%MAVEN_BATCH_ECHO%"=="" goto skipEcho
@echo on
:skipEcho

%MVN_CMD%

endlocal

if "%MAVEN_BATCH_PAUSE%"=="" goto skipPause
@pause
:skipPause

endlocal
