{
    "desc": "CVE-2022-22947 is a critical code injection vulnerability that affects applications using Spring Cloud Gateway. This vulnerability occurs when the Gateway Actuator endpoint is enabled, exposed, and unsecured, allowing a remote attacker to send a malicious request that could result in arbitrary remote code execution on the host. The vulnerability affects Spring Cloud Gateway versions 3.1.0, 3.0.0 to 3.0.6, and older unsupported versions. The issue can be mitigated by upgrading to versions 3.1.1+ or 3.0.7+. If the Gateway actuator endpoint is not necessary, it should be disabled; otherwise, it should be secured using Spring Security. Exploitation involves deploying a stage to the `/actuator/gateway/routes/` endpoint, executing commands, and then removing the stage. This vulnerability poses significant security risks as it can be exploited to execute arbitrary code on the server, potentially leading to unauthorized access and control over the affected system.",
    "attack_type": "Remote Code Execution",
    "services": [
        {
            "name": "springcloud/spring-cloud-gateway",
            "version": [
                "3.1.0",
                "3.0.0",
                "3.0.1",
                "3.0.2",
                "3.0.3",
                "3.0.4",
                "3.0.5",
                "3.0.6"
            ],
            "dependency_type": "HARD",
            "description": "Spring Cloud Gateway is the core service affected by CVE-2022-22947. It is required to demonstrate the vulnerability as it contains the vulnerable code injection point."
        },
        {
            "name": "openjdk",
            "version": [
                "11-jre-slim"
            ],
            "dependency_type": "SOFT",
            "description": "Java runtime environment required to run Spring Cloud Gateway applications."
        },
        {
            "name": "springcloud/spring-cloud-starter-gateway",
            "version": [
                "3.1.0",
                "3.0.0",
                "3.0.1",
                "3.0.2",
                "3.0.3",
                "3.0.4",
                "3.0.5",
                "3.0.6"
            ],
            "dependency_type": "SOFT",
            "description": "Spring Cloud Starter Gateway is necessary to set up the Spring Cloud Gateway application and demonstrate the vulnerability."
        }
    ],
    "input_tokens": 4830,
    "output_tokens": 749
}