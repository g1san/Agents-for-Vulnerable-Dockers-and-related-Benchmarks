# Stage 1: Build stage to install necessary packages
FROM debian:bullseye as builder

RUN apt-get update && \
    apt-get install -y cgi-mapserver && \
    rm -rf /var/lib/apt/lists/*

# Stage 2: Final stage with Apache
FROM httpd:2.4.50

COPY --from=builder /usr/lib/cgi-bin /usr/lib/cgi-bin
COPY ./conf/httpd.conf /usr/local/apache2/conf/httpd.conf
COPY ./html /usr/local/apache2/htdocs/

EXPOSE 80
CMD ["httpd-foreground"]
