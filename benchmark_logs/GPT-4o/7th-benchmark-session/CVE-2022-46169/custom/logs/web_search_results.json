{
    "desc": "CVE-2022-46169 is a critical vulnerability affecting Cacti, a web-based network monitoring tool, specifically in versions up to 1.2.22. This vulnerability allows for authentication bypass and unauthenticated remote code execution, enabling an attacker to execute arbitrary code on the server. The root cause lies in the 'remote_agent.php' file, where the IP address retrieved from the client is checked against entries in the poller table. If an entry matches, the client is authorized. The vulnerability is exploited by sending a specially crafted GET request to the '/remote_agent.php' endpoint with specific parameters. The 'action' parameter is set to 'polldata', and the 'X-Forwarded-For' header is manipulated to match an IP in the poller table. The 'poller_id' is set to the payload, while 'host_id' and 'local_data_id' are either provided or brute-forced. If successful, this allows for command injection via the 'proc_open' function, leading to remote code execution as the 'www-data' user. The vulnerability has been patched in Cacti version 1.2.23 and later.",
    "attack_type": "unauthenticated remote code execution",
    "services": [
        {
            "name": "cacti",
            "version": [
                "1.2.22"
            ],
            "dependency_type": "HARD",
            "description": "Cacti is the application containing the vulnerability, specifically in version 1.2.22, which allows for authentication bypass and remote code execution."
        },
        {
            "name": "mysql",
            "version": [
                "5.7"
            ],
            "dependency_type": "SOFT-DB",
            "description": "MySQL is used as the database backend for Cacti, storing necessary data such as the poller table which is involved in the vulnerability exploitation."
        },
        {
            "name": "php",
            "version": [
                "7.4-apache"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "PHP is required to run Cacti, which is a PHP-based application. The Apache version is needed to serve the web interface."
        }
    ],
    "input_tokens": 9567,
    "output_tokens": 1019,
    "query": "CVE-2022-46169 details"
}