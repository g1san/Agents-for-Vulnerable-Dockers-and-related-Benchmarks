{
    "desc": "CVE-2022-46169 is a critical vulnerability identified in Cacti, an open-source platform designed for operational monitoring and fault management. This flaw allows an unauthenticated attacker to execute arbitrary commands on a server running vulnerable versions of Cacti, specifically those up to and including version 1.2.22. The vulnerability resides in the `remote_agent.php` file, which is accessible without authentication. The issue arises from two primary factors: Authentication Bypass and Command Injection. An attacker can manipulate `$_SERVER` variables to spoof their IP address, leading to unauthorized access. Additionally, insufficient input sanitization in the `poll_for_data` function allows command injection via the `$poller_id` parameter. Exploiting this vulnerability requires valid `host_id` and `local_data_id` values, which can be determined through brute-force methods, along with a `poller_item` with the action type `POLLER_ACTION_SCRIPT_PHP`.",
    "attack_type": "Remote Code Execution (RCE)",
    "services": [
        {
            "name": "Cacti",
            "version": [
                "1.2.22"
            ],
            "dependency_type": "HARD",
            "description": "This is the primary service containing the vulnerability."
        },
        {
            "name": "MariaDB",
            "version": [
                "10.5.8"
            ],
            "dependency_type": "SOFT-DB",
            "description": "Cacti relies on a database to store its operational data."
        },
        {
            "name": "Apache HTTP Server",
            "version": [
                "2.4.46"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Serves as the web server to host the Cacti application."
        },
        {
            "name": "PHP",
            "version": [
                "7.4.11"
            ],
            "dependency_type": "SOFT",
            "description": "Required for Cacti's PHP-based application logic."
        }
    ],
    "input_tokens": 841,
    "output_tokens": 696
}