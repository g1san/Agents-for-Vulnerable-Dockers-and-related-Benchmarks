{
    "desc": "CVE-2022-46169 is a critical vulnerability in Cacti, an open-source network monitoring tool. It affects versions up to 1.2.22 and allows for unauthenticated remote code execution. The vulnerability is due to a combination of an authentication bypass and a command injection flaw in the `remote_agent.php` file. Specifically, the `get_client_addr` function can be manipulated to bypass authentication by exploiting HTTP headers to fake the server's IP address. Once bypassed, the `poll_for_data` function can be exploited to execute arbitrary commands if a `poller_item` with the `POLLER_ACTION_SCRIPT_PHP` action exists. This vulnerability is particularly dangerous because it allows an attacker to execute arbitrary code on the affected system without needing valid credentials. Exploitation involves sending a GET request to `/remote_agent.php` with specific parameters, including `action` set to `polldata`, and potentially setting the `X-Forwarded-For` header to a specific IP address. The issue has been addressed in Cacti versions 1.2.23 and 1.3.0, which include patches to prevent unauthorized IP address manipulation and command injection.",
    "attack_type": "Unauthenticated Remote Code Execution",
    "services": [
        {
            "name": "cacti",
            "version": [
                "1.2.22"
            ],
            "dependency_type": "HARD",
            "description": "Cacti is the vulnerable service affected by CVE-2022-46169. It is an open-source network monitoring tool that, in versions up to 1.2.22, contains the authentication bypass and command injection vulnerabilities."
        },
        {
            "name": "mysql",
            "version": [
                "5.7"
            ],
            "dependency_type": "SOFT-DB",
            "description": "MySQL is used as the database backend for Cacti to store its configuration and collected monitoring data."
        },
        {
            "name": "php",
            "version": [
                "7.4-apache"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "PHP is required to run the Cacti application, and the Apache server is used to serve the web interface of Cacti."
        },
        {
            "name": "ubuntu",
            "version": [
                "21.10"
            ],
            "dependency_type": "SOFT",
            "description": "Ubuntu is the operating system on which the Cacti application and its dependencies are installed. The vulnerability has been tested on this version."
        }
    ],
    "input_tokens": 9097,
    "output_tokens": 1024
}