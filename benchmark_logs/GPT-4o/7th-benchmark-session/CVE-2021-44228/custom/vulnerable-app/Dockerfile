FROM openjdk:8-jdk

WORKDIR /app

# Download correct log4j JAR files
RUN curl -O https://repo1.maven.org/maven2/org/apache/logging/log4j/log4j-api/2.15.0/log4j-api-2.15.0.jar \
    && curl -O https://repo1.maven.org/maven2/org/apache/logging/log4j/log4j-core/2.15.0/log4j-core-2.15.0.jar

# Copy the vulnerable application and configuration
COPY . .

# Compile the Java application
RUN javac -cp .:log4j-core-2.15.0.jar:log4j-api-2.15.0.jar VulnerableApp.java

# The CMD is now defined in docker-compose.yml
