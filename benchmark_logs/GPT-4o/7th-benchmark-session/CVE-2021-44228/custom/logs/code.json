{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-44228/custom/docker-compose.yml",
            "content": "version: '3.8'\n\nservices:\n  vulnerable-app:\n    build: ./vulnerable-app\n    ports:\n      - \"8080:8080\"\n    command: [\"java\", \"-cp\", \".:log4j-core-2.15.0.jar:log4j-api-2.15.0.jar:log4j2.xml\", \"VulnerableApp\", \"test-input\"]\n\n  openjdk:\n    image: openjdk:8-jdk\n    command: tail -f /dev/null\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom/vulnerable-app/Dockerfile",
            "content": "FROM openjdk:8-jdk\n\nWORKDIR /app\n\n# Download correct log4j JAR files\nRUN curl -O https://repo1.maven.org/maven2/org/apache/logging/log4j/log4j-api/2.15.0/log4j-api-2.15.0.jar \\\n    && curl -O https://repo1.maven.org/maven2/org/apache/logging/log4j/log4j-core/2.15.0/log4j-core-2.15.0.jar\n\n# Copy the vulnerable application and configuration\nCOPY . .\n\n# Compile the Java application\nRUN javac -cp .:log4j-core-2.15.0.jar:log4j-api-2.15.0.jar VulnerableApp.java\n\n# The CMD is now defined in docker-compose.yml\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom/vulnerable-app/VulnerableApp.java",
            "content": "import org.apache.logging.log4j.LogManager;\nimport org.apache.logging.log4j.Logger;\n\npublic class VulnerableApp {\n    private static final Logger logger = LogManager.getLogger(VulnerableApp.class);\n\n    public static void main(String[] args) {\n        if (args.length == 0) {\n            System.out.println(\"Usage: java VulnerableApp <input>\");\n            return;\n        }\n\n        // Log user input\n        logger.error(\"User input: \" + args[0]);\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom/vulnerable-app/log4j2.xml",
            "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Configuration status=\"WARN\">\n    <Appenders>\n        <Console name=\"Console\" target=\"SYSTEM_OUT\">\n            <PatternLayout pattern=\"%d [%t] %-5level %logger{36} - %msg%n\"/>\n        </Console>\n        <Console name=\"ErrorConsole\" target=\"SYSTEM_ERR\">\n            <PatternLayout pattern=\"%d [%t] %-5level %logger{36} - %msg%n\"/>\n        </Console>\n    </Appenders>\n    <Loggers>\n        <Root level=\"error\">\n            <AppenderRef ref=\"Console\"/>\n            <AppenderRef ref=\"ErrorConsole\"/>\n        </Root>\n    </Loggers>\n</Configuration>\n"
        }
    ],
    "directory_tree": "CVE-2021-44228/\n\u251c\u2500\u2500 custom/\n\u2502   \u251c\u2500\u2500 docker-compose.yml\n\u2502   \u2514\u2500\u2500 vulnerable-app/\n\u2502       \u251c\u2500\u2500 Dockerfile\n\u2502       \u251c\u2500\u2500 VulnerableApp.java\n\u2502       \u2514\u2500\u2500 log4j2.xml\n"
}