{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-44228/custom_no_tool/docker-compose.yml",
            "content": "version: '3.8'\n\nservices:\n  web:\n    image: nginx:1.21.3\n    ports:\n      - \"8080:80\"\n    volumes:\n      - ./html:/usr/share/nginx/html\n\n  vulnerable-app:\n    build:\n      context: ./vulnerable-app\n    ports:\n      - \"8081:8081\"\n\nvolumes:\n  html:\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom_no_tool/vulnerable-app/Dockerfile",
            "content": "FROM openjdk:8-jdk-alpine\n\n# Install Maven\nRUN apk add --no-cache maven\n\nCOPY . /app\nWORKDIR /app\n\nRUN mvn clean package\n\n# Copy the built jar file to the working directory\nRUN cp target/vulnerable-app-1.0-SNAPSHOT.jar /app/\n\nCMD [\"java\", \"-jar\", \"/app/vulnerable-app-1.0-SNAPSHOT.jar\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom_no_tool/vulnerable-app/pom.xml",
            "content": "<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>com.example</groupId>\n    <artifactId>vulnerable-app</artifactId>\n    <version>1.0-SNAPSHOT</version>\n\n    <properties>\n        <maven.compiler.source>8</maven.compiler.source>\n        <maven.compiler.target>8</maven.compiler.target>\n    </properties>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n            <version>2.6.2</version>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-thymeleaf</artifactId>\n            <version>2.6.2</version>\n        </dependency>\n        <dependency>\n            <groupId>org.apache.logging.log4j</groupId>\n            <artifactId>log4j-core</artifactId>\n            <version>2.14.1</version>\n        </dependency>\n        <dependency>\n            <groupId>org.apache.logging.log4j</groupId>\n            <artifactId>log4j-api</artifactId>\n            <version>2.14.1</version>\n        </dependency>\n    </dependencies>\n\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n                <version>2.6.2</version>\n                <executions>\n                    <execution>\n                        <goals>\n                            <goal>repackage</goal>\n                        </goals>\n                    </execution>\n                </executions>\n            </plugin>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-jar-plugin</artifactId>\n                <version>3.2.0</version>\n                <configuration>\n                    <archive>\n                        <manifest>\n                            <addClasspath>true</addClasspath>\n                            <classpathPrefix>lib/</classpathPrefix>\n                            <mainClass>com.example.vulnerableapp.VulnerableAppApplication</mainClass>\n                        </manifest>\n                    </archive>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n</project>\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom_no_tool/vulnerable-app/src/main/java/com/example/vulnerableapp/VulnerableAppApplication.java",
            "content": "package com.example.vulnerableapp;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class VulnerableAppApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(VulnerableAppApplication.class, args);\n    }\n\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom_no_tool/vulnerable-app/src/main/java/com/example/vulnerableapp/controller/LogController.java",
            "content": "package com.example.vulnerableapp.controller;\n\nimport org.apache.logging.log4j.LogManager;\nimport org.apache.logging.log4j.Logger;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestParam;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\npublic class LogController {\n\n    private static final Logger logger = LogManager.getLogger(LogController.class);\n\n    @GetMapping(\"/log\")\n    public String log(@RequestParam String message) {\n        logger.info(\"Received message: \" + message);\n        return \"Logged: \" + message;\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom_no_tool/html/index.html",
            "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Log4Shell Test</title>\n</head>\n<body>\n    <h1>Log4Shell Vulnerability Test</h1>\n    <form action=\"http://localhost:8081/log\" method=\"get\">\n        <label for=\"message\">Message:</label>\n        <input type=\"text\" id=\"message\" name=\"message\">\n        <input type=\"submit\" value=\"Log\">\n    </form>\n</body>\n</html>\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom_no_tool/vulnerable-app/mvnw",
            "content": "#!/bin/sh\n\n# ----------------------------------------------------------------------------\n# Licensed to the Apache Software Foundation (ASF) under one or more\n# contributor license agreements.  See the NOTICE file distributed with\n# this work for additional information regarding copyright ownership.\n# The ASF licenses this file to You under the Apache License, Version 2.0\n# (the \"License\"); you may not use this file except in compliance with\n# the License.  You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n# ----------------------------------------------------------------------------\n\n# ----------------------------------------------------------------------------\n# Maven Start Up Batch script\n#\n# Required ENV vars:\n#\n#   JAVA_HOME - location of a JDK home dir\n#\n# Optional ENV vars\n#\n#   M2_HOME - location of maven2's installed home dir\n#   MAVEN_OPTS - parameters passed to the Java VM when running Maven\n#     e.g. to debug Maven itself, use\n#       set MAVEN_OPTS=-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=8000\n#   MAVEN_SKIP_RC - flag to disable loading of mavenrc files\n# ----------------------------------------------------------------------------\n\nif [ -z \"$MAVEN_SKIP_RC\" ] ; then\n  if [ -f /etc/mavenrc ] ; then\n    . /etc/mavenrc\n  fi\n  if [ -f \"$HOME/.mavenrc\" ] ; then\n    . \"$HOME/.mavenrc\"\n  fi\nfi\n\n# OS specific support (must be 'true' or 'false').\ncygwin=false;\ndarwin=false;\nmingw=false;\ncase \"`uname`\" in\n  CYGWIN*) cygwin=true ;;\n  MINGW*) mingw=true ;;\n  Darwin*) darwin=true ;;\nesac\n\nif [ -z \"$JAVA_HOME\" ] ; then\n  if [ \"darwin\" = \"true\" ] ; then\n    if [ -x \"/usr/libexec/java_home\" ] ; then\n      JAVA_HOME=`/usr/libexec/java_home`\n    fi\n  fi\nfi\n\nif [ -z \"$M2_HOME\" ] ; then\n  # resolve links - $0 may be a link to Maven's home\n  PRG=\"$0\"\n\n  # need this for relative symlinks\n  while [ -h \"$PRG\" ] ; do\n    ls=`ls -ld \"$PRG\"`\n    link=`expr \"$ls\" : '.*-> \\(.*\\)$'`\n    if expr \"$link\" : '/.*' > /dev/null; then\n      PRG=\"$link\"\n    else\n      PRG=\"`dirname \"$PRG\"`/$link\"\n    fi\n  done\n\n  saveddir=`pwd`\n  M2_HOME=`dirname \"$PRG\"`/..\n  cd \"$saveddir\"\n  M2_HOME=`cd \"$M2_HOME\" && pwd`\n\n  # make it fully qualified\n  if [ \"cygwin\" = \"true\" ]; then\n    M2_HOME=`cygpath --unix \"$M2_HOME\"`\n  fi\nfi\n\nif [ -z \"$M2\" ]; then\n  M2=\"$M2_HOME/bin\"\nfi\n\nexport MAVEN_OPTS=\"$MAVEN_OPTS -Xms256m -Xmx512m\"\n\nexec \"$M2/mvn\" \"$@\"\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom_no_tool/vulnerable-app/.mvn/wrapper/maven-wrapper.properties",
            "content": "distributionUrl=https://repo.maven.apache.org/maven2/org/apache/maven/apache-maven/3.8.4/apache-maven-3.8.4-bin.zip\n"
        },
        {
            "location": "./../../dockers/CVE-2021-44228/custom_no_tool/vulnerable-app/.mvn/wrapper/maven-wrapper.jar",
            "content": "<binary content of maven-wrapper.jar>\n"
        }
    ],
    "directory_tree": "CVE-2021-44228/\n\u251c\u2500\u2500 custom_no_tool/\n\u2502   \u251c\u2500\u2500 docker-compose.yml\n\u2502   \u251c\u2500\u2500 html/\n\u2502   \u2502   \u2514\u2500\u2500 index.html\n\u2502   \u2514\u2500\u2500 vulnerable-app/\n\u2502       \u251c\u2500\u2500 Dockerfile\n\u2502       \u251c\u2500\u2500 mvnw\n\u2502       \u251c\u2500\u2500 pom.xml\n\u2502       \u251c\u2500\u2500 src/\n\u2502       \u2502   \u2514\u2500\u2500 main/\n\u2502       \u2502       \u2514\u2500\u2500 java/\n\u2502       \u2502           \u2514\u2500\u2500 com/\n\u2502       \u2502               \u2514\u2500\u2500 example/\n\u2502       \u2502                   \u2514\u2500\u2500 vulnerableapp/\n\u2502       \u2502                       \u251c\u2500\u2500 VulnerableAppApplication.java\n\u2502       \u2502                       \u2514\u2500\u2500 controller/\n\u2502       \u2502                           \u2514\u2500\u2500 LogController.java\n\u2502       \u2514\u2500\u2500 .mvn/\n\u2502           \u2514\u2500\u2500 wrapper/\n\u2502               \u251c\u2500\u2500 maven-wrapper.properties\n\u2502               \u2514\u2500\u2500 maven-wrapper.jar\n"
}