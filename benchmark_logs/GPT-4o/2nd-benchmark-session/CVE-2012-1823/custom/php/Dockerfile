FROM debian:stretch-slim

RUN echo "deb http://archive.debian.org/debian stretch main" > /etc/apt/sources.list && \
    echo "deb http://archive.debian.org/debian-security stretch/updates main" >> /etc/apt/sources.list && \
    apt-get update -o Acquire::Check-Valid-Until=false -o Acquire::Check-Date=false && \
    apt-get install -y \
    autoconf \
    build-essential \
    libapache2-mod-php5 \
    apache2-dev \
    libxml2-dev \
    && rm -rf /var/lib/apt/lists/*

RUN curl -SL "http://museum.php.net/php5/php-5.3.29.tar.bz2" | tar -xjC /usr/src/ && \
    cd /usr/src/php-5.3.29 && \
    ./configure --with-apxs2=/usr/bin/apxs2 --with-mysqli && \
    make && \
    make install && \
    cd / && rm -rf /usr/src/php-5.3.29

COPY index.php /var/www/html/index.php

CMD ["apache2-foreground"]
