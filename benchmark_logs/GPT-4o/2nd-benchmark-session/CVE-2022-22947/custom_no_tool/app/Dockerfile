FROM openjdk:8-jdk

WORKDIR /app

COPY pom.xml /app/
COPY src /app/src
COPY mvnw /app/
COPY .mvn /app/.mvn

RUN chmod +x mvnw

# Set environment variables for Maven and Java
ENV MAVEN_HOME=/app/.mvn
ENV M2_HOME=/app/.mvn
ENV JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64

# Ensure the Maven wrapper downloads the necessary binaries
RUN java -jar .mvn/wrapper/maven-wrapper.jar

RUN ./mvnw package

CMD ["java", "-jar", "target/demo-0.0.1-SNAPSHOT.jar"]
