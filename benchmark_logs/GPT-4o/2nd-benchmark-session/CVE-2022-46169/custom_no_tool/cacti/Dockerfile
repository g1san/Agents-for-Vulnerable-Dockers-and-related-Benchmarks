FROM php:7.4-apache

RUN apt-get update \
    && apt-get install -y librrd-dev libpng-dev libjpeg-dev libxml2-dev \
    && docker-php-ext-install mysqli \
    && docker-php-ext-install sockets \
    && docker-php-ext-install gd \
    && docker-php-ext-install xml \
    && rm -rf /var/lib/apt/lists/*

COPY config.php /var/www/html/config.php

# Download and extract Cacti 1.2.22
RUN curl -o cacti-1.2.22.tar.gz -L https://github.com/Cacti/cacti/archive/release/1.2.22.tar.gz \
    && tar -zxvf cacti-1.2.22.tar.gz -C /var/www/html --strip-components=1 \
    && rm cacti-1.2.22.tar.gz

WORKDIR /var/www/html
