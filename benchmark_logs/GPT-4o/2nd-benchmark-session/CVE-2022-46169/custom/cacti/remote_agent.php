<?php
// Vulnerable remote_agent.php for CVE-2022-46169 demonstration

if (isset($_REQUEST['action']) && $_REQUEST['action'] === 'polldata') {
    $poller_id = $_REQUEST['poller_id'];
    $host_id = $_REQUEST['host_id'];
    $local_data_ids = $_REQUEST['local_data_ids'];

    // Vulnerable command injection
    $command = "echo $poller_id $host_id $local_data_ids";
    system($command);
}
?>
