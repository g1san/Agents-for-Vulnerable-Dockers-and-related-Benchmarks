FROM debian:jessie

# Install necessary packages and PHP 5.4.6
RUN apt-get update && \
    apt-get install -y \
    curl \
    apache2 \
    php5 \
    php5-mysql \
    && apt-get clean

# Download and setup phpMyAdmin
RUN curl -SL https://files.phpmyadmin.net/phpMyAdmin/4.0.10.15/phpMyAdmin-4.0.10.15-all-languages.tar.gz \
    | tar -xzC /var/www/html --strip-components=1

# Copy configuration file
COPY config.inc.php /var/www/html/config.inc.php

# Set permissions
RUN chown -R www-data:www-data /var/www/html

# Expose port
EXPOSE 80

CMD ["/usr/sbin/apache2ctl", "-D", "FOREGROUND"]
