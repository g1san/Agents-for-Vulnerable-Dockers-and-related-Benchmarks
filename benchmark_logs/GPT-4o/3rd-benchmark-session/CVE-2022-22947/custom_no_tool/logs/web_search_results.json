{
    "desc": "CVE-2022-22947 is a critical code injection vulnerability in Spring Cloud Gateway. This flaw occurs when the Gateway Actuator endpoint is enabled, exposed, and unsecured, allowing a remote attacker to execute arbitrary code on the host through a maliciously crafted request. The vulnerability affects Spring Cloud Gateway versions 3.1.0, 3.0.0 to 3.0.6, and older unsupported versions. It is particularly dangerous because it allows for remote execution with root privileges if exploited successfully. The vulnerability allows attackers to exploit the `/actuator/gateway/routes` endpoint by deploying a stage, executing a command, and then removing the stage. Mitigation involves upgrading to version 3.1.1 or later for the 3.1.x series, and to 3.0.7 or later for the 3.0.x series, or securing the actuator endpoint using Spring Security.",
    "attack_type": "Code Injection, Remote Code Execution",
    "services": [
        {
            "name": "springio/spring-cloud-gateway",
            "version": [
                "3.1.0",
                "3.0.0---3.0.6"
            ],
            "dependency_type": "HARD",
            "description": "Spring Cloud Gateway is the core service that contains the vulnerability. Versions 3.1.0, 3.0.0 to 3.0.6 are vulnerable to CVE-2022-22947."
        },
        {
            "name": "openjdk",
            "version": [
                "8-jdk-alpine"
            ],
            "dependency_type": "SOFT",
            "description": "Java Development Kit is required to run Spring Cloud Gateway, as it is a Java-based application."
        },
        {
            "name": "mysql",
            "version": [
                "5.7"
            ],
            "dependency_type": "SOFT-DB",
            "description": "A relational database like MySQL can be used for data persistence if required by the application running on Spring Cloud Gateway."
        },
        {
            "name": "nginx",
            "version": [
                "1.21-alpine"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx can be used as a reverse proxy server to manage and route traffic to the Spring Cloud Gateway."
        }
    ],
    "input_tokens": 4781,
    "output_tokens": 769
}