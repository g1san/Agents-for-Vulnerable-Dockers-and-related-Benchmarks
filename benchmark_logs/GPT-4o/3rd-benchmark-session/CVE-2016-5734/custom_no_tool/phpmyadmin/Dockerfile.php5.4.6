# Custom script to build PHP 5.4.6

#!/bin/bash

# Install PHP 5.4.6 from source
PHP_VERSION=5.4.6
PHP_INI_DIR=/usr/local/etc/php

apt-get update && apt-get install -y \
    autoconf \
    build-essential \
    curl \
    libxml2-dev \
    && rm -rf /var/lib/apt/lists/*

cd /usr/src && \
    curl -SL "http://museum.php.net/php5/php-$PHP_VERSION.tar.bz2" -o php.tar.bz2 && \
    mkdir -p /usr/src/php && \
    tar -xof php.tar.bz2 -C /usr/src/php --strip-components=1 && \
    rm php.tar.bz2

cd /usr/src/php && \
    ./configure --with-config-file-path="$PHP_INI_DIR" --with-config-file-scan-dir="$PHP_INI_DIR/conf.d" \
    --enable-mbstring --with-curl --with-openssl --enable-soap && \
    make -j"$(nproc)" && \
    make install

# Clean up
rm -r /usr/src/php
