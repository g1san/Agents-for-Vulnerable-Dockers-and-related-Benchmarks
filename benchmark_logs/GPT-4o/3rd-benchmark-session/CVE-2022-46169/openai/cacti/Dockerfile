FROM php:7.4-apache

RUN apt-get update \
    && apt-get install -y \
       librrd-dev \
       rrdtool \
       git \
       unzip \
    && docker-php-ext-install mysqli \
    && a2enmod rewrite

# Set working directory
WORKDIR /var/www/html

# Clone Cacti repository
RUN git clone --branch release/1.2.22 https://github.com/Cacti/cacti.git .

# Copy Cacti configuration
COPY config.php include/config.php

# Set permissions
RUN chown -R www-data:www-data /var/www/html
