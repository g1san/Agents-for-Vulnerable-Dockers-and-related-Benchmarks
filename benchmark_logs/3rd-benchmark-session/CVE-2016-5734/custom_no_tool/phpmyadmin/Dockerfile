FROM ubuntu:14.04

# Install dependencies
RUN apt-get update && \
    apt-get install -y \
    apache2 \
    wget \
    libapache2-mod-php5 \
    php5-cli \
    php5-mysql \
    && apt-get clean

# Setup Apache and phpMyAdmin
COPY config.inc.php /var/www/html/config.inc.php

# Download and setup vulnerable phpMyAdmin version
RUN wget https://files.phpmyadmin.net/phpMyAdmin/4.6.2/phpMyAdmin-4.6.2-all-languages.tar.gz \
    && tar xzvf phpMyAdmin-4.6.2-all-languages.tar.gz -C /var/www/html --strip-components=1 \
    && rm phpMyAdmin-4.6.2-all-languages.tar.gz

CMD ["/usr/sbin/apache2ctl", "-D", "FOREGROUND"]
