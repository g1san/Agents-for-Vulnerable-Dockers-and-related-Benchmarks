{
    "desc": "CVE-2021-43798 is a path traversal vulnerability in Grafana versions 8.0.0-beta1 to 8.3.0, which can be exploited pre-authentication. The vulnerability arises from Grafana's failure to properly sanitize user-provided file paths in its public API endpoint, `/public/plugins/:pluginId`. This allows attackers to traverse directories and access sensitive files on the server, such as `/etc/passwd` or Grafana's SQLite database (`/var/lib/grafana/grafana.db`). The vulnerability can be exploited using crafted HTTP requests to read arbitrary files, potentially exposing user data, authentication tokens, and encrypted data source passwords. The vulnerability was patched in versions 8.3.1, 8.2.7, 8.1.8, and 8.0.7.",
    "attack_type": "Path Traversal",
    "services": [
        {
            "name": "grafana",
            "version": [
                "8.0.0-beta1---8.3.0"
            ],
            "dependency_type": "HARD",
            "description": "Grafana is the main service vulnerable to CVE-2021-43798 due to a path traversal issue in its public API endpoint."
        },
        {
            "name": "mysql",
            "version": [
                "5.7"
            ],
            "dependency_type": "SOFT-DB",
            "description": "MySQL is used as a database service to store Grafana's data and configurations, although the vulnerability can also affect the SQLite database used by Grafana."
        },
        {
            "name": "nginx",
            "version": [
                "1.21"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Nginx can be used as a reverse proxy to mitigate the vulnerability and manage HTTP requests to the Grafana service."
        }
    ],
    "input_tokens": 12184,
    "output_tokens": 1097
}