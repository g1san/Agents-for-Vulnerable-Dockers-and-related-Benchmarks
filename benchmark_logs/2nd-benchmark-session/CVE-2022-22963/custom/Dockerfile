FROM openjdk:8-jdk

RUN mkdir -p /app
WORKDIR /app

COPY ./src /app/src
COPY ./pom.xml /app
COPY ./.mvn /app/.mvn
COPY ./mvnw /app

# Ensure all necessary files have execute permissions
RUN chmod +x /app/mvnw
RUN chmod +x /app/.mvn/wrapper/maven-wrapper.jar

# Run Maven package command
RUN ./mvnw -Dmaven.repo.local=/app/.m2/repository clean package

ENTRYPOINT ["java", "-jar", "target/demo-0.0.1-SNAPSHOT.jar"]
