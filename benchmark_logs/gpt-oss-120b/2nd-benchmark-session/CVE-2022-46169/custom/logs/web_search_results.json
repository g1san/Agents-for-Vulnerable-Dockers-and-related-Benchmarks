{
    "desc": "CVE\u20112022\u201146169 is a critical unauthenticated remote code execution vulnerability in the Cacti web\u2011application (versions up to and including 1.2.22). The flaw resides in the `remote_agent.php` endpoint. The script authenticates clients by extracting the client IP address from HTTP headers and checking it against entries in the `poller` database table. An attacker can spoof these headers (e.g., `X\u2011Forwarded\u2011For`) to bypass authentication. Once authorized, the attacker can invoke the `polldata` action, which processes a `poller_id` parameter. When the associated poller item has the action `POLLER_ACTION_SCRIPT_PHP`, the supplied `poller_id` value is concatenated into a command string that is executed via `proc_open` without any sanitisation, leading to command injection. By sending a crafted request to `/remote_agent.php?action=polldata` with attacker\u2011controlled parameters, arbitrary commands are executed on the server with the privileges of the web\u2011server user (typically `www-data` or `apache`). This enables full remote code execution, allowing an attacker to compromise the host running Cacti.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "cacti",
            "version": [
                "1.2.22"
            ],
            "dependency_type": "HARD",
            "description": "The vulnerable Cacti web application. Version 1.2.22 contains the unauthenticated authentication bypass and command injection in remote_agent.php, which is required to demonstrate CVE\u20112022\u201146169."
        },
        {
            "name": "mysql",
            "version": [
                "5.7"
            ],
            "dependency_type": "SOFT-DB",
            "description": "Relational database required by Cacti to store configuration and poller information. Version 5.7 is compatible with Cacti 1.2.22 and provides the `poller` table used by the vulnerable endpoint."
        }
    ],
    "input_tokens": 9951,
    "output_tokens": 2254,
    "query": "CVE-2022-46169 details"
}