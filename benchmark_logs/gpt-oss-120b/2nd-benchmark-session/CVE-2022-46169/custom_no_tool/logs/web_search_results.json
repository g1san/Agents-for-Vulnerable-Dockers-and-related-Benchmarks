{
    "desc": "CVE\u20112022\u201146169 is an unauthenticated remote command injection vulnerability in the Cacti web\u2011based network monitoring application (versions up to and including 1.2.22). The flaw resides in the public endpoint remote_agent.php. The script obtains the client IP address from HTTP headers that can be forged, allowing an attacker to bypass the authentication check that relies on the poller table. Once authorized, the attacker can invoke the \\\"polldata\\\" action, which builds a command line for proc_open() using the attacker\u2011controlled poller_id parameter without any sanitisation. By supplying a crafted poller_id such as \";id\" the attacker can execute arbitrary operating\u2011system commands on the server as the www\u2011data user. The attack requires only the URL of the vulnerable Cacti installation; no valid credentials or session cookies are needed. Successful exploitation gives the attacker full remote code execution on the host running Cacti.",
    "attack_type": "unauthenticated remote command execution",
    "services": [
        {
            "name": "cacti",
            "version": [
                "1.0.0",
                "1.0.1",
                "1.0.2",
                "1.0.3",
                "1.0.4",
                "1.0.5",
                "1.0.6",
                "1.0.7",
                "1.0.8",
                "1.0.9",
                "1.0.10",
                "1.0.11",
                "1.0.12",
                "1.0.13",
                "1.0.14",
                "1.0.15",
                "1.0.16",
                "1.0.17",
                "1.0.18",
                "1.0.19",
                "1.0.20",
                "1.0.21",
                "1.0.22",
                "1.1.0",
                "1.1.1",
                "1.1.2",
                "1.1.3",
                "1.1.4",
                "1.1.5",
                "1.1.6",
                "1.1.7",
                "1.1.8",
                "1.1.9",
                "1.1.10",
                "1.1.11",
                "1.1.12",
                "1.1.13",
                "1.1.14",
                "1.1.15",
                "1.1.16",
                "1.1.17",
                "1.1.18",
                "1.1.19",
                "1.1.20",
                "1.1.21",
                "1.1.22",
                "1.2.0",
                "1.2.1",
                "1.2.2",
                "1.2.3",
                "1.2.4",
                "1.2.5",
                "1.2.6",
                "1.2.7",
                "1.2.8",
                "1.2.9",
                "1.2.10",
                "1.2.11",
                "1.2.12",
                "1.2.13",
                "1.2.14",
                "1.2.15",
                "1.2.16",
                "1.2.17",
                "1.2.18",
                "1.2.19",
                "1.2.20",
                "1.2.21",
                "1.2.22"
            ],
            "dependency_type": "HARD",
            "description": "Cacti provides the vulnerable web application and endpoint (remote_agent.php) that contains the authentication bypass and command injection flaw."
        },
        {
            "name": "mysql",
            "version": [
                "8.0"
            ],
            "dependency_type": "SOFT-DB",
            "description": "Cacti stores its configuration and poller data in a MySQL database; a compatible MySQL server is required for the application to run."
        },
        {
            "name": "php",
            "version": [
                "8.1-apache"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Cacti runs on PHP with an Apache web server; this image provides the required PHP runtime and HTTP server to serve the Cacti web interface."
        }
    ],
    "input_tokens": 10622,
    "output_tokens": 2385
}