{
    "files": [
        {
            "location": "./../../dockers/CVE-2023-23752/custom_no_tool/docker-compose.yml",
            "content": "services:\n  web:\n    build: ./web\n    ports:\n      - \"8080:80\"\n    depends_on:\n      - db\n    environment:\n      - DB_HOST=db\n      - DB_USER=root\n      - DB_PASSWORD=example\n      - DB_NAME=testdb\n  db:\n    image: mysql:8.0\n    command: --default-authentication-plugin=mysql_native_password\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: example\n      MYSQL_DATABASE: testdb\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\n  phpmyadmin:\n    image: phpmyadmin:5.2\n    depends_on:\n      - db\n    environment:\n      PMA_HOST: db\n      MYSQL_ROOT_PASSWORD: example\n    ports:\n      - \"8081:80\"\nvolumes:\n  db_data:"
        },
        {
            "location": "./../../dockers/CVE-2023-23752/custom_no_tool/web/Dockerfile",
            "content": "FROM php:8.1-apache\nRUN apt-get update && \\\n    apt-get install -y default-mysql-client default-libmysqlclient-dev && \\\n    docker-php-ext-configure mysqli --with-mysql=mysqlnd && \\\n    docker-php-ext-install -j$(nproc) mysqli && \\\n    docker-php-ext-enable mysqli && \\\n    apt-get clean && rm -rf /var/lib/apt/lists/*\nCOPY src/ /var/www/html/"
        },
        {
            "location": "./../../dockers/CVE-2023-23752/custom_no_tool/web/src/index.php",
            "content": "<?php\n$mysqli = new mysqli($_ENV['DB_HOST'], $_ENV['DB_USER'], $_ENV['DB_PASSWORD'], $_ENV['DB_NAME']);\nif ($mysqli->connect_error) {\n    die('Connect Error (' . $mysqli->connect_errno . ') ' . $mysqli->connect_error);\n}\nif (isset($_GET['id'])) {\n    $id = $_GET['id']; // vulnerable to SQL injection (CVE-2023-23752)\n    $result = $mysqli->query(\"SELECT * FROM users WHERE id = $id\");\n    if ($row = $result->fetch_assoc()) {\n        echo \"User: \" . htmlspecialchars($row['username']);\n    } else {\n        echo \"No user found.\";\n    }\n} else {\n    echo \"Provide id parameter.\";\n}\n?>"
        },
        {
            "location": "./../../dockers/CVE-2023-23752/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE users (id INT PRIMARY KEY, username VARCHAR(50));\nINSERT INTO users (id, username) VALUES (1, 'alice'), (2, 'bob');"
        }
    ],
    "directory_tree": "CVE-2023-23752/custom_no_tool/"
}