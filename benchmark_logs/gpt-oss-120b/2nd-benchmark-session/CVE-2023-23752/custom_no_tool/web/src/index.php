<?php
$mysqli = new mysqli($_ENV['DB_HOST'], $_ENV['DB_USER'], $_ENV['DB_PASSWORD'], $_ENV['DB_NAME']);
if ($mysqli->connect_error) {
    die('Connect Error (' . $mysqli->connect_errno . ') ' . $mysqli->connect_error);
}
if (isset($_GET['id'])) {
    $id = $_GET['id']; // vulnerable to SQL injection (CVE-2023-23752)
    $result = $mysqli->query("SELECT * FROM users WHERE id = $id");
    if ($row = $result->fetch_assoc()) {
        echo "User: " . htmlspecialchars($row['username']);
    } else {
        echo "No user found.";
    }
} else {
    echo "Provide id parameter.";
}
?>