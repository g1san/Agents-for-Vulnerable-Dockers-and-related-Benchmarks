version: "3.8"
services:
  dind:
    image: docker:20.10.5-dind
    privileged: true
    ports:
      - "2375:2375"
    environment:
      - DOCKER_TLS_CERTDIR=
    restart: unless-stopped

  jetty:
    build:
      context: ./jetty
    ports:
      - "8080:8080"
    depends_on:
      - dind
    restart: unless-stopped

  runtime:
    image: openjdk:11-jre-slim
    command: ["sleep", "infinity"]
    depends_on:
      - dind
    restart: unless-stopped