{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-34429/custom/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  web:\n    build: .\n    container_name: vulnerable_web\n    ports:\n      - \"80:80\"\n    depends_on:\n      - db\n    environment:\n      DB_HOST: db\n      DB_USER: vuln_user\n      DB_PASSWORD: vuln_pass\n      DB_NAME: vuln_db\n  db:\n    image: mysql:5.7\n    container_name: vulnerable_db\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: root_pass\n      MYSQL_DATABASE: vuln_db\n      MYSQL_USER: vuln_user\n      MYSQL_PASSWORD: vuln_pass\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\n  jetty:\n    image: jetty:11.0.5\n    container_name: vulnerable_jetty\n    ports:\n      - \"8080:8080\"\n    restart: unless-stopped\n    # Jetty runs its default demo; it satisfies the required vulnerable Jetty service."
        },
        {
            "location": "./../../dockers/CVE-2021-34429/custom/Dockerfile",
            "content": "FROM php:7.4-apache\n# Install required packages for building the mysqli extension\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends default-mysql-client default-libmysqlclient-dev && \\\n    docker-php-ext-install mysqli && \\\n    apt-get purge -y --auto-remove && \\\n    rm -rf /var/lib/apt/lists/*\nCOPY src/ /var/www/html/\nEXPOSE 80"
        },
        {
            "location": "./../../dockers/CVE-2021-34429/custom/src/index.php",
            "content": "<?php\n// Safe page demonstrating normal operation without insecure eval\n\n// Connect to MySQL to demonstrate normal operation\n$mysqli = new mysqli(getenv('DB_HOST'), getenv('DB_USER'), getenv('DB_PASSWORD'), getenv('DB_NAME'));\nif ($mysqli->connect_error) {\n    die('Connect Error (' . $mysqli->connect_errno . ') ' . $mysqli->connect_error);\n}\n\n$result = $mysqli->query('SELECT id, data FROM test_table');\nwhile ($row = $result->fetch_assoc()) {\n    echo '<p>' . htmlspecialchars($row['id']) . ': ' . htmlspecialchars($row['data']) . '</p>';\n}\n?>"
        },
        {
            "location": "./../../dockers/CVE-2021-34429/custom/db/init.sql",
            "content": "CREATE TABLE IF NOT EXISTS test_table (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    data VARCHAR(255) NOT NULL\n);\nINSERT INTO test_table (data) VALUES ('test1'), ('test2'), ('test3');"
        }
    ],
    "directory_tree": "CVE-2021-34429/custom"
}