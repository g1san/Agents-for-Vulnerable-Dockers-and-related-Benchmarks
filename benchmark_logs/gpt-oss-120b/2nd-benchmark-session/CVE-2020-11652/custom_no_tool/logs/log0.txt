time="2025-10-24T14:32:23+02:00" level=warning msg="/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2020-11652/custom_no_tool/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
 vulnerable-docker Pulling 
 6a8202733384 Pulling fs layer 
 78fcc3f54ae1 Pulling fs layer 
 e3cc93a7c611 Pulling fs layer 
 fa396aa1c77a Pulling fs layer 
 af8b1978c51e Pulling fs layer 
 57ab6c938e0f Pulling fs layer 
 1a997a372dbd Pulling fs layer 
 fa396aa1c77a Downloading [==================================================>]     544B/544B
 fa396aa1c77a Download complete 
 fa396aa1c77a Pull complete 
 6a8202733384 Download complete 
 af8b1978c51e Download complete 
 78fcc3f54ae1 Download complete 
 e3cc93a7c611 Download complete 
 57ab6c938e0f Download complete 
 af8b1978c51e Pull complete 
 e3cc93a7c611 Extracting 1 s
 e3cc93a7c611 Pull complete 
 1a997a372dbd Downloading [==================>                                ]  2.097MB/5.587MB
 1a997a372dbd Downloading [============================>                      ]  3.146MB/5.587MB
 1a997a372dbd Downloading [==============================================>    ]  5.243MB/5.587MB
 1a997a372dbd Download complete 
 1a997a372dbd Extracting 1 s
 78fcc3f54ae1 Extracting 1 s
 57ab6c938e0f Pull complete 
 1a997a372dbd Pull complete 
 6a8202733384 Pull complete 
 78fcc3f54ae1 Pull complete 
 vulnerable-docker Pulled 
#1 [internal] load local bake definitions
#1 reading from stdin 733B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile: 221B done
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/library/alpine:3.14
#3 DONE 2.3s

#4 [internal] load .dockerignore
#4 transferring context: 2B done
#4 DONE 0.0s

#5 [internal] load build context
#5 transferring context: 595B done
#5 DONE 0.0s

#6 [1/3] FROM docker.io/library/alpine:3.14@sha256:0f2d5c38dd7a4f4f733e688e3a6733cb5ab1ac6e3cb4603a5dd564e5bfb80eed
#6 resolve docker.io/library/alpine:3.14@sha256:0f2d5c38dd7a4f4f733e688e3a6733cb5ab1ac6e3cb4603a5dd564e5bfb80eed 0.0s done
#6 sha256:f7dab3ab2d6ec29aa28769bec35331fb485b5837501b1e8556413d8b5a79c9c8 0B / 2.83MB 0.2s
#6 sha256:f7dab3ab2d6ec29aa28769bec35331fb485b5837501b1e8556413d8b5a79c9c8 2.10MB / 2.83MB 0.5s
#6 sha256:f7dab3ab2d6ec29aa28769bec35331fb485b5837501b1e8556413d8b5a79c9c8 2.83MB / 2.83MB 0.5s done
#6 extracting sha256:f7dab3ab2d6ec29aa28769bec35331fb485b5837501b1e8556413d8b5a79c9c8 0.1s done
#6 DONE 0.7s

#7 [2/3] RUN apk add --no-cache docker-cli curl python3 py3-pip &&     pip install --no-cache-dir requests
#7 0.288 fetch https://dl-cdn.alpinelinux.org/alpine/v3.14/main/x86_64/APKINDEX.tar.gz
#7 0.617 fetch https://dl-cdn.alpinelinux.org/alpine/v3.14/community/x86_64/APKINDEX.tar.gz
#7 0.859 (1/44) Installing ca-certificates (20230506-r0)
#7 0.904 (2/44) Installing brotli-libs (1.0.9-r5)
#7 0.948 (3/44) Installing nghttp2-libs (1.43.0-r0)
#7 0.978 (4/44) Installing libcurl (8.0.1-r0)
#7 1.012 (5/44) Installing curl (8.0.1-r0)
#7 1.039 (6/44) Installing docker-cli (20.10.11-r1)
#7 2.089 (7/44) Installing libbz2 (1.0.8-r1)
#7 2.110 (8/44) Installing expat (2.5.0-r0)
#7 2.135 (9/44) Installing libffi (3.3-r2)
#7 2.154 (10/44) Installing gdbm (1.19-r0)
#7 2.186 (11/44) Installing xz-libs (5.2.5-r1)
#7 2.222 (12/44) Installing libgcc (10.3.1_git20210424-r2)
#7 2.245 (13/44) Installing libstdc++ (10.3.1_git20210424-r2)
#7 2.305 (14/44) Installing mpdecimal (2.5.1-r1)
#7 2.329 (15/44) Installing ncurses-terminfo-base (6.2_p20210612-r1)
#7 2.363 (16/44) Installing ncurses-libs (6.2_p20210612-r1)
#7 2.396 (17/44) Installing readline (8.1.0-r0)
#7 2.455 (18/44) Installing sqlite-libs (3.35.5-r0)
#7 2.520 (19/44) Installing python3 (3.9.17-r0)
#7 3.654 (20/44) Installing py3-appdirs (1.4.4-r2)
#7 3.673 (21/44) Installing py3-chardet (4.0.0-r2)
#7 3.743 (22/44) Installing py3-idna (3.2-r0)
#7 3.771 (23/44) Installing py3-urllib3 (1.26.5-r0)
#7 3.815 (24/44) Installing py3-certifi (2020.12.5-r1)
#7 3.832 (25/44) Installing py3-requests (2.25.1-r4)
#7 3.864 (26/44) Installing py3-msgpack (1.0.2-r1)
#7 3.888 (27/44) Installing py3-lockfile (0.12.2-r4)
#7 3.908 (28/44) Installing py3-cachecontrol (0.12.6-r1)
#7 3.930 (29/44) Installing py3-colorama (0.4.4-r1)
#7 3.949 (30/44) Installing py3-contextlib2 (0.6.0-r1)
#7 3.966 (31/44) Installing py3-distlib (0.3.1-r3)
#7 4.005 (32/44) Installing py3-distro (1.5.0-r3)
#7 4.027 (33/44) Installing py3-six (1.15.0-r1)
#7 4.044 (34/44) Installing py3-webencodings (0.5.1-r4)
#7 4.063 (35/44) Installing py3-html5lib (1.1-r1)
#7 4.103 (36/44) Installing py3-parsing (2.4.7-r2)
#7 4.133 (37/44) Installing py3-packaging (20.9-r1)
#7 4.158 (38/44) Installing py3-toml (0.10.2-r2)
#7 4.177 (39/44) Installing py3-pep517 (0.10.0-r2)
#7 4.200 (40/44) Installing py3-progress (1.5-r2)
#7 4.219 (41/44) Installing py3-retrying (1.3.3-r1)
#7 4.236 (42/44) Installing py3-ordered-set (4.0.2-r1)
#7 4.254 (43/44) Installing py3-setuptools (52.0.0-r3)
#7 4.363 (44/44) Installing py3-pip (20.3.4-r1)
#7 4.617 Executing busybox-1.33.1-r8.trigger
#7 4.621 Executing ca-certificates-20230506-r0.trigger
#7 4.662 OK: 132 MiB in 58 packages
#7 5.068 Requirement already satisfied: requests in /usr/lib/python3.9/site-packages (2.25.1)
#7 5.077 Requirement already satisfied: chardet<5,>=3.0.2 in /usr/lib/python3.9/site-packages (from requests) (4.0.0)
#7 5.078 Requirement already satisfied: idna<3.3,>=2.5 in /usr/lib/python3.9/site-packages (from requests) (3.2)
#7 5.080 Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/lib/python3.9/site-packages (from requests) (1.26.5)
#7 5.082 Requirement already satisfied: certifi>=2017.4.17 in /usr/lib/python3.9/site-packages (from requests) (2020.12.5)
#7 DONE 5.7s

#8 [3/3] COPY exploit.py /exploit.py
#8 DONE 0.1s

#9 exporting to image
#9 exporting layers
#9 exporting layers 5.0s done
#9 exporting manifest sha256:4945a877311acf6e299536cef36ce331aad766d1de740df243c5f41472f43dfa 0.0s done
#9 exporting config sha256:a40718e7fd0aca07386f3c49c34a129e3ed1e4880725327e2ec0e0e6f0bde79d 0.0s done
#9 exporting attestation manifest sha256:4f1ad3dfaf2c9123458d7ade1d978aead1261ad667c05b3c25f8f2ccaa9b7bfc 0.0s done
#9 exporting manifest list sha256:fe5263c4d66939aeb5ad5fda3b1bbb2862fda44e2d8167ca4edbdf7d3738f196 0.0s done
#9 naming to docker.io/library/custom_no_tool-attacker:latest done
#9 unpacking to docker.io/library/custom_no_tool-attacker:latest
#9 unpacking to docker.io/library/custom_no_tool-attacker:latest 1.5s done
#9 DONE 6.6s

#10 resolving provenance for metadata file
#10 DONE 0.0s
 custom_no_tool-attacker  Built
 Network custom_no_tool_default  Creating
 Network custom_no_tool_default  Created
 Container custom_no_tool-vulnerable-docker-1  Creating
 Container custom_no_tool-vulnerable-docker-1  Created
 Container custom_no_tool-attacker-1  Creating
 Container custom_no_tool-attacker-1  Created
 Container custom_no_tool-vulnerable-docker-1  Starting
 Container custom_no_tool-vulnerable-docker-1  Started
 Container custom_no_tool-attacker-1  Starting
 Container custom_no_tool-attacker-1  Started


sudo docker logs 22a18d97a5e532e9253b8a7bac119d184958e8642e99251d8a090e49d027786f --details
STDOUT:  Exploit failed: error during connect: Get "http://vulnerable-docker:2375/v1.24/containers/json?all=1": dial tcp: lookup vulnerable-docker on 127.0.0.11:53: no such host
 

STDERR: 



sudo docker inspect 22a18d97a5e532e9253b8a7bac119d184958e8642e99251d8a090e49d027786f[
    {
        "Id": "22a18d97a5e532e9253b8a7bac119d184958e8642e99251d8a090e49d027786f",
        "Created": "2025-10-24T12:32:43.222826961Z",
        "Path": "python3",
        "Args": [
            "/exploit.py",
            "sh",
            "-c",
            "while true; do sleep 60; done"
        ],
        "State": {
            "Status": "exited",
            "Running": false,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 0,
            "ExitCode": 0,
            "Error": "",
            "StartedAt": "2025-10-24T12:32:43.720568441Z",
            "FinishedAt": "2025-10-24T12:32:56.334105545Z"
        },
        "Image": "sha256:fe5263c4d66939aeb5ad5fda3b1bbb2862fda44e2d8167ca4edbdf7d3738f196",
        "ResolvConfPath": "/var/lib/docker/containers/22a18d97a5e532e9253b8a7bac119d184958e8642e99251d8a090e49d027786f/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/22a18d97a5e532e9253b8a7bac119d184958e8642e99251d8a090e49d027786f/hostname",
        "HostsPath": "/var/lib/docker/containers/22a18d97a5e532e9253b8a7bac119d184958e8642e99251d8a090e49d027786f/hosts",
        "LogPath": "/var/lib/docker/containers/22a18d97a5e532e9253b8a7bac119d184958e8642e99251d8a090e49d027786f/22a18d97a5e532e9253b8a7bac119d184958e8642e99251d8a090e49d027786f-json.log",
        "Name": "/custom_no_tool-attacker-1",
        "RestartCount": 0,
        "Driver": "overlayfs",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": null,
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "custom_no_tool_default",
            "PortBindings": {},
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "ConsoleSize": [
                0,
                0
            ],
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": null,
            "DnsOptions": null,
            "DnsSearch": null,
            "ExtraHosts": [],
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": false,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": null,
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": null,
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": null,
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": [
                "/proc/asound",
                "/proc/acpi",
                "/proc/interrupts",
                "/proc/kcore",
                "/proc/keys",
                "/proc/latency_stats",
                "/proc/timer_list",
                "/proc/timer_stats",
                "/proc/sched_debug",
                "/proc/scsi",
                "/sys/firmware",
                "/sys/devices/virtual/powercap"
            ],
            "ReadonlyPaths": [
                "/proc/bus",
                "/proc/fs",
                "/proc/irq",
                "/proc/sys",
                "/proc/sysrq-trigger"
            ]
        },
        "GraphDriver": {
            "Data": null,
            "Name": "overlayfs"
        },
        "Mounts": [],
        "Config": {
            "Hostname": "22a18d97a5e5",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": true,
            "AttachStderr": true,
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "DOCKER_HOST=tcp://vulnerable-docker:2375",
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
            ],
            "Cmd": [
                "sh",
                "-c",
                "while true; do sleep 60; done"
            ],
            "Image": "custom_no_tool-attacker",
            "Volumes": null,
            "WorkingDir": "",
            "Entrypoint": [
                "python3",
                "/exploit.py"
            ],
            "OnBuild": null,
            "Labels": {
                "com.docker.compose.config-hash": "9571f54f2895e1aa08e275b0e7bfa0e74a9fcd1891390bc43dc56475f51d37c3",
                "com.docker.compose.container-number": "1",
                "com.docker.compose.depends_on": "vulnerable-docker:service_started:false",
                "com.docker.compose.image": "sha256:fe5263c4d66939aeb5ad5fda3b1bbb2862fda44e2d8167ca4edbdf7d3738f196",
                "com.docker.compose.oneoff": "False",
                "com.docker.compose.project": "custom_no_tool",
                "com.docker.compose.project.config_files": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2020-11652/custom_no_tool/docker-compose.yml",
                "com.docker.compose.project.working_dir": "/home/gabriele/thesis-project/Agents-for-Vulnerable-Dockers-and-related-Benchmarks/dockers/CVE-2020-11652/custom_no_tool",
                "com.docker.compose.service": "attacker",
                "com.docker.compose.version": "2.40.2",
                "desktop.docker.io/wsl-distro": "Ubuntu"
            },
            "StopTimeout": 1
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "",
            "SandboxKey": "",
            "Ports": {},
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "",
            "Gateway": "",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "",
            "IPPrefixLen": 0,
            "IPv6Gateway": "",
            "MacAddress": "",
            "Networks": {
                "custom_no_tool_default": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": [
                        "custom_no_tool-attacker-1",
                        "attacker"
                    ],
                    "MacAddress": "",
                    "DriverOpts": null,
                    "GwPriority": 0,
                    "NetworkID": "cfaeefc4923233542b94f24f9167a4f4c490aeebd27a680fb174d906fbad1691",
                    "EndpointID": "",
                    "Gateway": "",
                    "IPAddress": "",
                    "IPPrefixLen": 0,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "DNSNames": [
                        "custom_no_tool-attacker-1",
                        "attacker",
                        "22a18d97a5e5"
                    ]
                }
            }
        },
        "ImageManifestDescriptor": {
            "mediaType": "application/vnd.oci.image.manifest.v1+json",
            "digest": "sha256:4945a877311acf6e299536cef36ce331aad766d1de740df243c5f41472f43dfa",
            "size": 862,
            "platform": {
                "architecture": "amd64",
                "os": "linux"
            }
        }
    }
]