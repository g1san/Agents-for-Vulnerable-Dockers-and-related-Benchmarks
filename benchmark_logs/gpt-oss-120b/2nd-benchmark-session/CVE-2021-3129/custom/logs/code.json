{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-3129/custom/docker-compose.yml",
            "content": "services:\n  web:\n    image: nginx:1.18\n    ports:\n      - \"8080:80\"\n    volumes:\n      - ./web/default.conf:/etc/nginx/conf.d/default.conf:ro\n    depends_on:\n      - app\n\n  app:\n    build:\n      context: ./app\n    ports:\n      - \"8000:80\"\n    environment:\n      - APP_DEBUG=true\n      - DB_HOST=db\n      - DB_DATABASE=vuln\n      - DB_USERNAME=root\n      - DB_PASSWORD=example\n    depends_on:\n      - db\n\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: example\n      MYSQL_DATABASE: vuln\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql:ro\n    healthcheck:\n      test: [\"CMD\",\"mysqladmin\",\"ping\",\"-h\",\"localhost\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n\nvolumes:\n  db_data:\n"
        },
        {
            "location": "./../../dockers/CVE-2021-3129/custom/app/Dockerfile",
            "content": "FROM composer:2 AS composer\n\nFROM php:8.0-apache\n\nARG DEBIAN_FRONTEND=noninteractive\n\n# Install system dependencies required for PHP extensions\nRUN apt-get update && apt-get install -y \\\n        libzip-dev \\\n        libonig-dev \\\n        libxml2-dev \\\n        unzip \\\n        git \\\n    && docker-php-ext-install pdo_mysql zip mbstring xml bcmath ctype \\\n    && a2enmod rewrite \\\n    && apt-get clean && rm -rf /var/lib/apt/lists/*\n\nENV COMPOSER_ALLOW_SUPERUSER=1\n\nCOPY --from=composer /usr/bin/composer /usr/bin/composer\n\nWORKDIR /var/www/html\n\n# Create a fresh Laravel project and install the vulnerable Ignition package (facade/ignition)\nRUN composer create-project --prefer-dist laravel/laravel:^8.0 . --no-interaction \\\n    && composer require facade/ignition:^2.5 --no-interaction\n\nRUN chown -R www-data:www-data /var/www/html\n\nEXPOSE 80\n"
        },
        {
            "location": "./../../dockers/CVE-2021-3129/custom/web/default.conf",
            "content": "server {\n    listen 80;\n    server_name _;\n\n    # Proxy all requests to the Laravel application container\n    location / {\n        proxy_pass http://app:80;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2021-3129/custom/db/init.sql",
            "content": "CREATE TABLE IF NOT EXISTS users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  username VARCHAR(50) NOT NULL,\n  password VARCHAR(255) NOT NULL\n);\nINSERT INTO users (username, password) VALUES ('admin', 'adminpass');\n"
        }
    ],
    "directory_tree": "CVE-2021-3129"
}