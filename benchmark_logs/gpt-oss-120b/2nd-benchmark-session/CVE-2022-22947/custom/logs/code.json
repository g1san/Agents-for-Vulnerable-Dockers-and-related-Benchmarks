{
    "files": [
        {
            "location": "./../../dockers/CVE-2022-22947/custom/docker-compose.yml",
            "content": "services:\n  gateway:\n    build:\n      context: ./gateway\n    ports:\n      - \"8080:8080\"\n    environment:\n      - SPRING_PROFILES_ACTIVE=dev\n    depends_on:\n      - backend\n    healthcheck:\n      test: [\"CMD\", \"/usr/bin/curl\", \"-f\", \"http://localhost:8080/actuator/health\"]\n      interval: 30s\n      timeout: 10s\n      retries: 5\n\n  backend:\n    build:\n      context: ./backend\n    ports:\n      - \"9090:5678\"\n    healthcheck:\n      test: [\"CMD\", \"/usr/bin/curl\", \"-f\", \"http://localhost:5678\"]\n      interval: 30s\n      timeout: 10s\n      retries: 5"
        },
        {
            "location": "./../../dockers/CVE-2022-22947/custom/backend/Dockerfile",
            "content": "FROM hashicorp/http-echo:0.2.3 AS echo\n\n# Use a glibc\u2011based base image so the http\u2011echo binary can run\nFROM debian:bookworm-slim\nRUN apt-get update && apt-get install -y --no-install-recommends curl && rm -rf /var/lib/apt/lists/*\nCOPY --from=echo /http-echo /http-echo\nRUN chmod +x /http-echo\nENTRYPOINT [\"/http-echo\"]\nCMD [\"-text=Hello from backend\"]\nEXPOSE 5678"
        },
        {
            "location": "./../../dockers/CVE-2022-22947/custom/gateway/Dockerfile",
            "content": "FROM maven:3.9.6-eclipse-temurin-17 AS builder\nWORKDIR /app\n\n# Install curl for potential health\u2011check usage inside the builder (optional)\nRUN apt-get update && apt-get install -y --no-install-recommends curl && rm -rf /var/lib/apt/lists/*\n\nCOPY pom.xml .\nCOPY src ./src\n\n# Build the application without running tests\nRUN mvn -B package -DskipTests\n\nFROM eclipse-temurin:17-jre-alpine\nWORKDIR /app\nRUN apk add --no-cache curl\n# Copy the Spring Boot fat\u2011jar (exact name to avoid ambiguity)\nCOPY --from=builder /app/target/gateway-0.0.1-SNAPSHOT.jar app.jar\nEXPOSE 8080\nENTRYPOINT [\"java\",\"-jar\",\"/app/app.jar\"]"
        },
        {
            "location": "./../../dockers/CVE-2022-22947/custom/gateway/pom.xml",
            "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n    <groupId>com.example</groupId>\n    <artifactId>gateway</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <packaging>jar</packaging>\n    <name>gateway</name>\n    <description>Spring Cloud Gateway vulnerable instance</description>\n    <properties>\n        <java.version>17</java.version>\n        <spring-boot.version>2.6.6</spring-boot.version>\n        <!-- Use a Spring Cloud version compatible with the vulnerable gateway version -->\n        <spring-cloud.version>2020.0.4</spring-cloud.version>\n        <spring-cloud-gateway.version>3.0.6</spring-cloud-gateway.version>\n    </properties>\n    <dependencyManagement>\n        <dependencies>\n            <dependency>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-dependencies</artifactId>\n                <version>${spring-boot.version}</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n            <dependency>\n                <groupId>org.springframework.cloud</groupId>\n                <artifactId>spring-cloud-dependencies</artifactId>\n                <version>${spring-cloud.version}</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n        </dependencies>\n    </dependencyManagement>\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-webflux</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-gateway</artifactId>\n            <version>${spring-cloud-gateway.version}</version>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-actuator</artifactId>\n        </dependency>\n    </dependencies>\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-compiler-plugin</artifactId>\n                <version>3.8.1</version>\n                <configuration>\n                    <source>${java.version}</source>\n                    <target>${java.version}</target>\n                </configuration>\n            </plugin>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n                <version>${spring-boot.version}</version>\n                <executions>\n                    <execution>\n                        <goals>\n                            <goal>repackage</goal>\n                        </goals>\n                    </execution>\n                </executions>\n            </plugin>\n        </plugins>\n    </build>\n</project>"
        }
    ],
    "directory_tree": "CVE-2022-22947/custom"
}