{
    "desc": "CVE\u20112022\u201122947 is a critical vulnerability in Spring Cloud Gateway that allows an unauthenticated attacker to execute arbitrary commands on the host running the gateway. The flaw resides in the Actuator route\u2011management API, which evaluates Spring Expression Language (SpEL) strings without proper sanitisation. When the Actuator endpoints (such as /actuator/gateway/routes and /actuator/gateway/refresh) are exposed to the network and not protected, an attacker can send a crafted JSON payload that includes a malicious SpEL expression (e.g., #{T(java.lang.Runtime).getRuntime().exec('id')}). The gateway evaluates this expression when the route is refreshed, causing the injected code to run with the privileges of the application process. Affected versions are all Spring Cloud Gateway releases prior to 3.1.1 and prior to 3.0.7. Successful exploitation results in full remote code execution, enabling the attacker to run arbitrary commands, install back\u2011doors, extract data, or pivot within the internal network. Mitigation requires upgrading to Spring Cloud Gateway 3.1.1, 3.0.7, or later, or disabling/locking down the vulnerable Actuator endpoints.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "springcloud/spring-cloud-gateway",
            "version": [
                "3.0.0",
                "3.0.1",
                "3.0.2",
                "3.0.3",
                "3.0.4",
                "3.0.5",
                "3.0.6",
                "3.1.0"
            ],
            "dependency_type": "HARD",
            "description": "The vulnerable Spring Cloud Gateway application that contains the insecure Actuator route\u2011management API."
        },
        {
            "name": "openjdk",
            "version": [
                "17-jdk-alpine"
            ],
            "dependency_type": "SOFT-BASE",
            "description": "Java runtime environment required to run the Spring Cloud Gateway application inside the container."
        }
    ],
    "input_tokens": 4442,
    "output_tokens": 2014,
    "query": "CVE-2022-22947 vulnerability details"
}