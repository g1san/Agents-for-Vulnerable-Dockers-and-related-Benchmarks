{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-43798/custom/docker-compose.yml",
            "content": "services:\n  grafana:\n    build: ./grafana\n    ports:\n      - \"3000:3000\"\n    environment:\n      - GF_SECURITY_ALLOW_EMBEDDING=true\n      - GF_USERS_ALLOW_SIGN_UP=true\n    volumes:\n      - grafana-data:/var/lib/grafana\n    depends_on:\n      - redis\n  redis:\n    image: redis:6-alpine\n    restart: always\n    ports:\n      - \"6379:6379\"\nvolumes:\n  grafana-data:"
        },
        {
            "location": "./../../dockers/CVE-2021-43798/custom/grafana/Dockerfile",
            "content": "FROM grafana/grafana:8.2.3\n\n# Switch to root to perform privileged operations\nUSER root\n\n# Ensure the plugins directory exists and set proper ownership\nRUN mkdir -p /var/lib/grafana/plugins && \\\n    chown -R 472:472 /var/lib/grafana/plugins\n\n# Copy the malicious plugin into the plugins directory\nCOPY plugins/malicious-plugin /var/lib/grafana/plugins/malicious-plugin\n\n# Adjust ownership of the copied plugin files\nRUN chown -R 472:472 /var/lib/grafana/plugins/malicious-plugin\n\n# Revert to the default Grafana user\nUSER grafana"
        },
        {
            "location": "./../../dockers/CVE-2021-43798/custom/grafana/plugins/malicious-plugin/plugin.json",
            "content": "{\n  \"type\": \"panel\",\n  \"name\": \"Malicious Plugin\",\n  \"id\": \"malicious-plugin\",\n  \"info\": {\n    \"description\": \"Exploits CVE-2021-43798\",\n    \"version\": \"1.0.0\",\n    \"author\": {\n      \"name\": \"exploit\"\n    }\n  },\n  \"paths\": {\n    \"module\": \"plugin.js\"\n  }\n}"
        },
        {
            "location": "./../../dockers/CVE-2021-43798/custom/grafana/plugins/malicious-plugin/plugin.js",
            "content": "console.log('Malicious plugin loaded');\n// Placeholder code that would trigger the directory\u2011traversal vulnerability when the plugin is activated."
        }
    ],
    "directory_tree": "CVE-2021-43798/custom"
}