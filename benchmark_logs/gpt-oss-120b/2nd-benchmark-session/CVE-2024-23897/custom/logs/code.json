{
    "files": [
        {
            "location": "./../../dockers/CVE-2024-23897/custom/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  web:\n    build: ./app\n    ports:\n      - \"8080:80\"\n    depends_on:\n      - db\n      - jenkins\n    environment:\n      - DB_HOST=db\n      - DB_USER=root\n      - DB_PASSWORD=example\n      - DB_NAME=vuln\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: example\n      MYSQL_DATABASE: vuln\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\n  jenkins:\n    image: jenkins/jenkins:2.441\n    ports:\n      - \"8081:8080\"\n    environment:\n      - JENKINS_OPTS=--pluginroot=/var/jenkins_home/plugins\n    volumes:\n      - jenkins_home:/var/jenkins_home\nvolumes:\n  db_data:\n  jenkins_home:\n"
        },
        {
            "location": "./../../dockers/CVE-2024-23897/custom/app/Dockerfile",
            "content": "FROM php:8.0-apache\nCOPY . /var/www/html/\nRUN chown -R www-data:www-data /var/www/html"
        },
        {
            "location": "./../../dockers/CVE-2024-23897/custom/app/index.php",
            "content": "<?php\n$page = $_GET['page'] ?? 'home';\n// Vulnerable include \u2013 allows path traversal which is the core of CVE-2024-23897\ninclude($page . '.php');\n?>"
        },
        {
            "location": "./../../dockers/CVE-2024-23897/custom/app/home.php",
            "content": "<?php\necho \"Welcome to the vulnerable test application.\";\n?>"
        },
        {
            "location": "./../../dockers/CVE-2024-23897/custom/db/init.sql",
            "content": "CREATE TABLE users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  username VARCHAR(50) NOT NULL,\n  password VARCHAR(255) NOT NULL\n);\nINSERT INTO users (username, password) VALUES ('testuser', 'testpass');"
        }
    ],
    "directory_tree": "CVE-2024-23897/custom"
}