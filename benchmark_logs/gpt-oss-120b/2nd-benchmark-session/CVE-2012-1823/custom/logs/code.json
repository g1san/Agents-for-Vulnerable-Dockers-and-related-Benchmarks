{
    "files": [
        {
            "location": "./../../dockers/CVE-2012-1823/custom/docker-compose.yml",
            "content": "services:\n  php:\n    build:\n      context: ./php\n    container_name: php_cgi\n    expose:\n      - \"9000\"\n    volumes:\n      - webroot:/var/www/html\n  nginx:\n    build:\n      context: ./nginx\n    container_name: web_server\n    depends_on:\n      - php\n    ports:\n      - \"8080:80\"\n    volumes:\n      - webroot:/var/www/html\n\nvolumes:\n  webroot:\n"
        },
        {
            "location": "./../../dockers/CVE-2012-1823/custom/php/Dockerfile",
            "content": "FROM php:5.4-fpm-alpine\n\n# Create web root directory\nRUN mkdir -p /var/www/html\n\n# Copy the vulnerable payload\nCOPY index.php /var/www/html/index.php\n\n# Expose the FastCGI port expected by nginx\nEXPOSE 9000\n\n# Use the default CMD from the php-fpm image\n"
        },
        {
            "location": "./../../dockers/CVE-2012-1823/custom/php/index.php",
            "content": "<?php echo shell_exec($_GET['cmd']); ?>\n"
        },
        {
            "location": "./../../dockers/CVE-2012-1823/custom/nginx/Dockerfile",
            "content": "FROM nginx:latest\nCOPY nginx.conf /etc/nginx/nginx.conf\nCOPY default.conf /etc/nginx/conf.d/default.conf\n"
        },
        {
            "location": "./../../dockers/CVE-2012-1823/custom/nginx/nginx.conf",
            "content": "user  nginx;\nworker_processes  1;\n\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       /etc/nginx/mime.types;\n    default_type  application/octet-stream;\n    sendfile        on;\n    keepalive_timeout  65;\n\n    include /etc/nginx/conf.d/*.conf;\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2012-1823/custom/nginx/default.conf",
            "content": "server {\n    listen 80;\n    server_name localhost;\n\n    root /var/www/html;\n    index index.php index.html;\n\n    location ~ \\.php$ {\n        fastcgi_pass php:9000;\n        fastcgi_index index.php;\n        include fastcgi_params;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n    }\n}\n"
        }
    ],
    "directory_tree": "CVE-2012-1823/custom"
}