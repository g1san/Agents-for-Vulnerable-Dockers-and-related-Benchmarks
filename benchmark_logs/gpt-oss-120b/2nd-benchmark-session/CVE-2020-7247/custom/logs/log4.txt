#1 [internal] load local bake definitions
#1 reading from stdin 1.29kB done
#1 DONE 0.0s

#2 [smtp internal] load build definition from Dockerfile
#2 transferring dockerfile: 243B done
#2 DONE 0.0s

#3 [vulnerable internal] load build definition from Dockerfile
#3 transferring dockerfile: 153B done
#3 DONE 0.0s

#4 [vulnerable internal] load metadata for docker.io/library/python:3.9-slim
#4 ...

#5 [smtp internal] load metadata for docker.io/library/alpine:3.18
#5 DONE 0.5s

#4 [vulnerable internal] load metadata for docker.io/library/python:3.9-slim
#4 DONE 0.5s

#6 [smtp internal] load .dockerignore
#6 transferring context: 2B done
#6 DONE 0.0s

#7 [vulnerable internal] load .dockerignore
#7 transferring context: 2B done
#7 DONE 0.0s

#8 [smtp 1/2] FROM docker.io/library/alpine:3.18@sha256:de0eb0b3f2a47ba1eb89389859a9bd88b28e82f5826b6969ad604979713c2d4f
#8 resolve docker.io/library/alpine:3.18@sha256:de0eb0b3f2a47ba1eb89389859a9bd88b28e82f5826b6969ad604979713c2d4f 0.0s done
#8 CACHED

#9 [vulnerable 1/4] FROM docker.io/library/python:3.9-slim@sha256:545badebace9a958b98d3e272f0f0d46c0a1a389ac77e24c33f2e7b548ce1b6b
#9 resolve docker.io/library/python:3.9-slim@sha256:545badebace9a958b98d3e272f0f0d46c0a1a389ac77e24c33f2e7b548ce1b6b 0.0s done
#9 DONE 0.0s

#10 [vulnerable internal] load build context
#10 transferring context: 494B done
#10 DONE 0.0s

#11 [vulnerable 2/4] WORKDIR /app
#11 CACHED

#12 [vulnerable 3/4] COPY app.py .
#12 CACHED

#13 [vulnerable 4/4] RUN pip install --no-cache-dir flask docker
#13 CACHED

#14 [vulnerable] exporting to image
#14 exporting layers done
#14 exporting manifest sha256:09af9839354c6eb6738c8619068e3aa8f8b75e4f014a8721b1da82a391886e10 done
#14 exporting config sha256:0cc1b3f579a5c279aa2e43c5ca88e646f94cce49aa9f9c8926ce6c2a5282dda0 done
#14 exporting attestation manifest sha256:f4c4ea5386b6c028a98bc62cfa2afc51b5b5f5388c8789d143ee84b4700b4851 0.0s done
#14 exporting manifest list sha256:54ec29a5405b74a3a69a45e6a7ca7583b6cfea8df5d88517d8a2d9c77ed36311
#14 exporting manifest list sha256:54ec29a5405b74a3a69a45e6a7ca7583b6cfea8df5d88517d8a2d9c77ed36311 0.0s done
#14 naming to docker.io/library/custom-vulnerable:latest done
#14 unpacking to docker.io/library/custom-vulnerable:latest done
#14 DONE 0.1s

#15 [smtp 2/2] RUN apk add --no-cache opensmtpd &&     ln -sf /usr/sbin/opensmtpd /usr/local/bin/opensmtpd &&     echo "listen on *" > /etc/opensmtpd/opensmtpd.conf
#15 0.193 fetch https://dl-cdn.alpinelinux.org/alpine/v3.18/main/x86_64/APKINDEX.tar.gz
#15 ...

#16 [vulnerable] resolving provenance for metadata file
#16 DONE 0.0s

#15 [smtp 2/2] RUN apk add --no-cache opensmtpd &&     ln -sf /usr/sbin/opensmtpd /usr/local/bin/opensmtpd &&     echo "listen on *" > /etc/opensmtpd/opensmtpd.conf
#15 0.432 fetch https://dl-cdn.alpinelinux.org/alpine/v3.18/community/x86_64/APKINDEX.tar.gz
#15 0.866 (1/10) Installing ca-certificates (20241121-r1)
#15 0.923 (2/10) Installing libressl3.7-libcrypto (3.7.3-r0)
#15 1.122 (3/10) Installing libressl3.7-libssl (3.7.3-r0)
#15 1.212 (4/10) Installing libmd (1.0.4-r2)
#15 1.269 (5/10) Installing libbsd (0.11.7-r1)
#15 1.549 (6/10) Installing libasr (1.0.4-r4)
#15 1.858 (7/10) Installing db (5.3.28-r4)
#15 4.554 (8/10) Installing libevent (2.1.12-r6)
#15 6.499 (9/10) Installing musl-fts (1.2.7-r5)
#15 6.531 (10/10) Installing opensmtpd (6.8.0p2-r7)
#15 6.712 Executing opensmtpd-6.8.0p2-r7.pre-install
#15 6.875 Executing busybox-1.36.1-r7.trigger
#15 6.881 Executing ca-certificates-20241121-r1.trigger
#15 6.947 OK: 13 MiB in 25 packages
#15 7.025 /bin/sh: can't create /etc/opensmtpd/opensmtpd.conf: nonexistent directory
#15 ERROR: process "/bin/sh -c apk add --no-cache opensmtpd &&     ln -sf /usr/sbin/opensmtpd /usr/local/bin/opensmtpd &&     echo \"listen on *\" > /etc/opensmtpd/opensmtpd.conf" did not complete successfully: exit code: 1
------
 > [smtp 2/2] RUN apk add --no-cache opensmtpd &&     ln -sf /usr/sbin/opensmtpd /usr/local/bin/opensmtpd &&     echo "listen on *" > /etc/opensmtpd/opensmtpd.conf:
1.549 (6/10) Installing libasr (1.0.4-r4)
1.858 (7/10) Installing db (5.3.28-r4)
4.554 (8/10) Installing libevent (2.1.12-r6)
6.499 (9/10) Installing musl-fts (1.2.7-r5)
6.531 (10/10) Installing opensmtpd (6.8.0p2-r7)
6.712 Executing opensmtpd-6.8.0p2-r7.pre-install
6.875 Executing busybox-1.36.1-r7.trigger
6.881 Executing ca-certificates-20241121-r1.trigger
6.947 OK: 13 MiB in 25 packages
7.025 /bin/sh: can't create /etc/opensmtpd/opensmtpd.conf: nonexistent directory
------
Dockerfile:2

--------------------

   1 |     FROM alpine:3.18

   2 | >>> RUN apk add --no-cache opensmtpd && \

   3 | >>>     ln -sf /usr/sbin/opensmtpd /usr/local/bin/opensmtpd && \

   4 | >>>     echo "listen on *" > /etc/opensmtpd/opensmtpd.conf

   5 |     CMD ["/usr/sbin/opensmtpd", "-d"]

--------------------

target smtp: failed to solve: process "/bin/sh -c apk add --no-cache opensmtpd &&     ln -sf /usr/sbin/opensmtpd /usr/local/bin/opensmtpd &&     echo \"listen on *\" > /etc/opensmtpd/opensmtpd.conf" did not complete successfully: exit code: 1

