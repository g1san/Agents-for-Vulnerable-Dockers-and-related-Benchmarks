{
    "desc": "CVE-2022-24706 is a critical vulnerability in Apache CouchDB versions up to and including 3.2.1. The default installation of CouchDB starts the Erlang Port Mapper Daemon (EPMD) on TCP port 4369 and a randomly chosen Erlang distribution port that is bound to all network interfaces. The packaging also used a fixed default Erlang cookie value of \"monster\" for node\u2011to\u2011node authentication. An unauthenticated attacker who can reach the EPMD service can query it to discover the random distribution port, authenticate using the known cookie, and then communicate with the Erlang VM. By sending specially crafted Erlang messages, the attacker can invoke the `os:cmd/1` function, resulting in remote code execution with the privileges of the CouchDB process. This gives the attacker full administrative control over the database and the underlying host, allowing data theft, modification, or further lateral movement. The vulnerability is mitigated by upgrading to CouchDB 3.2.2 or later, changing the default cookie, and restricting access to the EPMD and distribution ports.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "couchdb",
            "version": [
                "3.2.1",
                "3.2.0",
                "3.1.1",
                "3.1.0",
                "3.0.2",
                "3.0.1",
                "3.0.0",
                "2.3.1",
                "2.3.0",
                "2.2.0",
                "2.1.1",
                "2.1.0",
                "2.0.0"
            ],
            "dependency_type": "HARD",
            "description": "Apache CouchDB provides the vulnerable Erlang distribution layer and uses the default Erlang cookie; it is the essential component that exhibits the vulnerability."
        }
    ],
    "input_tokens": 7702,
    "output_tokens": 1926,
    "query": "CVE-2022-24706 details vulnerability"
}