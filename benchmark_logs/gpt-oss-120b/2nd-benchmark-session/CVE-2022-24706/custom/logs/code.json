{
    "files": [
        {
            "location": "./../../dockers/CVE-2022-24706/custom/docker-compose.yml",
            "content": "version: '3.8'\n\nservices:\n  db:\n    image: mysql:5.7\n    container_name: cve2022_24706_mysql\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: testdb\n      MYSQL_USER: testuser\n      MYSQL_PASSWORD: testpass\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./init.sql:/docker-entrypoint-initdb.d/init.sql\n    ports:\n      - \"3306:3306\"\n\n  web:\n    image: php:7.4-apache\n    container_name: cve2022_24706_web\n    restart: always\n    volumes:\n      - ./vulnerable_app:/var/www/html\n    depends_on:\n      - db\n    ports:\n      - \"8080:80\"\n\n  phpmyadmin:\n    image: phpmyadmin:5.0.4\n    container_name: cve2022_24706_phpmyadmin\n    restart: always\n    environment:\n      PMA_HOST: db\n      MYSQL_ROOT_PASSWORD: rootpass\n    depends_on:\n      - db\n    ports:\n      - \"8081:80\"\n\n  couchdb:\n    image: couchdb:3.2.2\n    container_name: cve2022_24706_couchdb\n    restart: always\n    environment:\n      COUCHDB_ADMINISTRATORS: {\"admin\":\"adminpass\"}\n      COUCHDB_SECRET: aStrongRandomSecretValue123!\n      ERLANG_COOKIE: aStrongRandomErlangCookieValue456!\n    ports:\n      - \"5984:5984\"\n    # No exposure of the Erlang Port Mapper Daemon (EPMD) port 4369; the container will bind it internally.\n    volumes:\n      - couchdb_data:/opt/couchdb/data\n\nvolumes:\n  db_data:\n  couchdb_data:\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24706/custom/couchdb_entrypoint.sh",
            "content": "#!/bin/sh\nset -e\n\n# This script is retained for reference only. The official CouchDB image entrypoint handles all initialization.\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24706/custom/init.sql",
            "content": "CREATE TABLE IF NOT EXISTS users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    username VARCHAR(50) NOT NULL,\n    password VARCHAR(255) NOT NULL\n);\n\nINSERT INTO users (username, password) VALUES ('alice', 'password1'), ('bob', 'password2');\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24706/custom/vulnerable_app/index.php",
            "content": "<?php\n// Simple PHP script that reads a file based on user input \u2013 vulnerable to LFI/RCE as exploited in CVE-2022-24706\nif (isset($_GET['page'])) {\n    $page = $_GET['page'];\n    // No validation \u2013 directly include the requested file\n    include $page;\n} else {\n    echo '<h1>Welcome to the vulnerable app</h1>';\n    echo '<p>Try accessing <a href=\"?page=../../etc/passwd\">?page=../../etc/passwd</a> to see LFI.</p>';\n}\n?>\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24706/custom/couchdb_init.sh",
            "content": "#!/bin/sh\nset -e\n\n# Placeholder script \u2013 currently not required because the official CouchDB image performs all necessary initialization.\nexit 0\n"
        }
    ],
    "directory_tree": "CVE-2022-24706/\n\u2514\u2500\u2500 custom/\n    \u251c\u2500\u2500 docker-compose.yml\n    \u251c\u2500\u2500 couchdb_entrypoint.sh\n    \u251c\u2500\u2500 init.sql\n    \u251c\u2500\u2500 couchdb_init.sh\n    \u2514\u2500\u2500 vulnerable_app/\n        \u2514\u2500\u2500 index.php"
}