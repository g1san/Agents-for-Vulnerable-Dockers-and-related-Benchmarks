{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-43798/custom/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  vulnerable:\n    build: ./vuln_app\n    ports:\n      - \"5000:5000\"\n    volumes:\n      - ./data:/data\n    restart: unless-stopped\n  grafana:\n    image: grafana/grafana:8.2.0\n    ports:\n      - \"3000:3000\"\n    environment:\n      - GF_SECURITY_ADMIN_PASSWORD=admin\n    volumes:\n      - grafana-data:/var/lib/grafana\n    restart: unless-stopped\nvolumes:\n  grafana-data:"
        },
        {
            "location": "./../../dockers/CVE-2021-43798/custom/vuln_app/Dockerfile",
            "content": "FROM python:3.9-slim\nWORKDIR /app\nCOPY app.py .\nRUN pip install Flask\nEXPOSE 5000\nCMD [\"python\",\"app.py\"]"
        },
        {
            "location": "./../../dockers/CVE-2021-43798/custom/vuln_app/app.py",
            "content": "from flask import Flask, request, abort\nimport os\n\napp = Flask(__name__)\n\n@app.route('/read')\ndef read():\n    filename = request.args.get('file')\n    if not filename:\n        abort(400)\n    # vulnerable: no sanitization of the filename\n    try:\n        with open(os.path.join('/data', filename), 'r') as f:\n            return f.read()\n    except Exception as e:\n        return str(e), 500\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000)"
        },
        {
            "location": "./../../dockers/CVE-2021-43798/custom/data/secret.txt",
            "content": "Sensitive information for CVE-2021-43798 testing."
        }
    ],
    "directory_tree": "CVE-2021-43798/custom"
}