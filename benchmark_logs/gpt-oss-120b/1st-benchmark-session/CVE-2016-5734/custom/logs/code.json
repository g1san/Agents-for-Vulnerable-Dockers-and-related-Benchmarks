{
    "files": [
        {
            "location": "./../../dockers/CVE-2016-5734/custom/docker-compose.yml",
            "content": "services:\n  vulnerable:\n    build: ./vulnerable\n    container_name: vulnerable_cve_2016_5734\n    privileged: true\n    ports:\n      - \"8080:80\"\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n\n  php:\n    build: ./php\n    container_name: php_cve_2016_5734\n    depends_on:\n      - mysql\n    ports:\n      - \"8081:80\"\n    volumes:\n      - ./php:/var/www/html\n\n  mysql:\n    image: mysql:5.7\n    container_name: mysql_cve_2016_5734\n    environment:\n      MYSQL_ROOT_PASSWORD: secret\n      MYSQL_DATABASE: testdb\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - mysql_data:/var/lib/mysql\n      - ./mysql/init.sql:/docker-entrypoint-initdb.d/init.sql\n    command: [\"mysqld\", \"--character-set-server=utf8mb4\", \"--collation-server=utf8mb4_unicode_ci\"]\n\n  phpmyadmin:\n    build: ./phpmyadmin\n    container_name: phpmyadmin_cve_2016_5734\n    depends_on:\n      - mysql\n    ports:\n      - \"8082:80\"\n    environment:\n      PMA_HOST: mysql\n      MYSQL_ROOT_PASSWORD: secret\n    volumes:\n      - sessions:/sessions\n\nvolumes:\n  mysql_data:\n  sessions:"
        },
        {
            "location": "./../../dockers/CVE-2016-5734/custom/vulnerable/Dockerfile",
            "content": "FROM docker:1.11.2\nLABEL maintainer=\"cve-test@example.com\"\n# busybox httpd is already included in the base image\nCOPY index.html /var/www/localhost/index.html\nEXPOSE 80\nCMD [\"httpd\",\"-f\",\"-v\",\"-p\",\"80\",\"-h\",\"/var/www/localhost\"]"
        },
        {
            "location": "./../../dockers/CVE-2016-5734/custom/vulnerable/index.html",
            "content": "<!DOCTYPE html>\n<html>\n<head><title>CVE-2016-5734 Test Page</title></head>\n<body>\n<h1>Vulnerable Docker Engine (v1.11.2)</h1>\n<p>This container runs a Docker version known to be vulnerable to CVE-2016-5734.</p>\n</body>\n</html>"
        },
        {
            "location": "./../../dockers/CVE-2016-5734/custom/php/Dockerfile",
            "content": "FROM php:5.4-apache\nLABEL maintainer=\"cve-test@example.com\"\nCOPY index.php /var/www/html/index.php\nEXPOSE 80"
        },
        {
            "location": "./../../dockers/CVE-2016-5734/custom/php/index.php",
            "content": "<?php\nphpinfo();\n?>"
        },
        {
            "location": "./../../dockers/CVE-2016-5734/custom/mysql/init.sql",
            "content": "CREATE TABLE IF NOT EXISTS test_table (id INT AUTO_INCREMENT PRIMARY KEY, data VARCHAR(255));\nINSERT INTO test_table (data) VALUES ('sample1'), ('sample2');"
        },
        {
            "location": "./../../dockers/CVE-2016-5734/custom/phpmyadmin/Dockerfile",
            "content": "FROM php:5.4-apache\nLABEL maintainer=\"cve-test@example.com\"\n\n# Install utilities needed for extraction\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n        curl unzip && rm -rf /var/lib/apt/lists/*\n\n# Download and extract phpMyAdmin 4.6.2 (version listed in the CVE description)\nRUN curl -fsSL https://files.phpmyadmin.net/phpMyAdmin/4.6.2/phpMyAdmin-4.6.2-all-languages.zip -o /tmp/phpmyadmin.zip \\\n    && unzip /tmp/phpmyadmin.zip -d /usr/src/ \\\n    && mv /usr/src/phpMyAdmin-4.6.2-all-languages /var/www/html/ \\\n    && chown -R www-data:www-data /var/www/html \\\n    && rm -rf /tmp/phpmyadmin.zip /usr/src/phpMyAdmin-4.6.2-all-languages\n\nEXPOSE 80"
        }
    ],
    "directory_tree": "CVE-2016-5734"
}