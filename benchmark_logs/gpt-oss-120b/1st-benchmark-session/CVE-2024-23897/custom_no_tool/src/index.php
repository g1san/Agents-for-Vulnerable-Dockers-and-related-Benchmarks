<?php
// Simple PHP page that triggers the vulnerable imagick function
// This code is intentionally insecure for CVE-2024-23897 testing purposes

if (isset($_GET['image'])) {
    $imagePath = $_GET['image'];
    // The vulnerable function that can be abused via specially crafted image files
    $imagick = new Imagick();
    $imagick->readImage($imagePath);
    header('Content-Type: image/png');
    echo $imagick->getImageBlob();
} else {
    echo '<h1>CVE-2024-23897 Demo</h1>';
    echo '<p>Provide an image URL via the <code>image</code> query parameter to trigger the vulnerability.</p>';
    echo '<p>Example: <code>?image=http://example.com/malicious.png</code></p>';
}
?>