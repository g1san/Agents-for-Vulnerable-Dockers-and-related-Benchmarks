{
    "desc": "CVE\u20112022\u201146169 is a critical unauthenticated command\u2011injection vulnerability in the Cacti web\u2011application (network\u2011monitoring front\u2011end for RRDtool). The flaw resides in the /remote_agent.php script. The script determines client authorization by extracting the client IP from a number of HTTP headers (such as X\u2011Forwarded\u2011For) and then checks this IP against entries in the poller database table. Because the script trusts these headers, an attacker can send a crafted header containing an IP address that matches a poller entry and bypass authentication entirely. Once authorized, the attacker can invoke the \"polldata\" action. The server reads request parameters (host_id, local_data_id, poller_id) and, for any poller_item whose action is POLLER_ACTION_SCRIPT_PHP, builds a command line that concatenates the supplied poller_id directly into a proc_open call. This allows arbitrary command injection, leading to remote code execution under the web\u2011user (www\u2011data) context. The vulnerability affects all Cacti releases up to and including version 1.2.22 and earlier 1.1.x releases. It was patched in Cacti 1.2.23 and later, as well as in the 1.3.0 release.",
    "attack_type": "unauthenticated remote code execution via command injection",
    "services": [
        {
            "name": "cacti",
            "version": [
                "cacti:1.2.22",
                "cacti:1.2.21",
                "cacti:1.2.20",
                "cacti:1.2.19",
                "cacti:1.2.18",
                "cacti:1.2.17",
                "cacti:1.2.16",
                "cacti:1.2.15",
                "cacti:1.2.14",
                "cacti:1.2.13",
                "cacti:1.2.12",
                "cacti:1.2.11",
                "cacti:1.2.10",
                "cacti:1.2.9",
                "cacti:1.2.8",
                "cacti:1.2.7",
                "cacti:1.2.6",
                "cacti:1.2.5",
                "cacti:1.2.4",
                "cacti:1.2.3",
                "cacti:1.2.2",
                "cacti:1.2.1",
                "cacti:1.2.0",
                "cacti:1.1.33",
                "cacti:1.1.32",
                "cacti:1.1.31",
                "cacti:1.1.30",
                "cacti:1.1.29",
                "cacti:1.1.28",
                "cacti:1.1.27",
                "cacti:1.1.26",
                "cacti:1.1.25",
                "cacti:1.1.24",
                "cacti:1.1.23",
                "cacti:1.1.22",
                "cacti:1.1.21",
                "cacti:1.1.20",
                "cacti:1.1.19",
                "cacti:1.1.18",
                "cacti:1.1.17",
                "cacti:1.1.16",
                "cacti:1.1.15",
                "cacti:1.1.14",
                "cacti:1.1.13",
                "cacti:1.1.12",
                "cacti:1.1.11",
                "cacti:1.1.10",
                "cacti:1.1.9",
                "cacti:1.1.8",
                "cacti:1.1.7",
                "cacti:1.1.6",
                "cacti:1.1.5",
                "cacti:1.1.4",
                "cacti:1.1.3",
                "cacti:1.1.2",
                "cacti:1.1.1",
                "cacti:1.1.0"
            ],
            "dependency_type": "HARD",
            "description": "The vulnerable Cacti web\u2011application containing the remote_agent.php script that is directly exploited."
        },
        {
            "name": "mysql",
            "version": [
                "mysql:5.7"
            ],
            "dependency_type": "SOFT-DB",
            "description": "Cacti stores its configuration and poller data in a MySQL database; a compatible database is required for the Cacti container to start."
        },
        {
            "name": "php",
            "version": [
                "php:7.4-apache"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Provides the PHP runtime and Apache web server required by the Cacti image to serve the vulnerable remote_agent.php endpoint."
        }
    ],
    "input_tokens": 9310,
    "output_tokens": 2436,
    "query": "CVE-2022-46169 vulnerability details"
}