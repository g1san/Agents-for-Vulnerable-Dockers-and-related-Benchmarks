{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-28164/custom/docker-compose.yml",
            "content": "services:\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: testdb\n      MYSQL_USER: user\n      MYSQL_PASSWORD: userpass\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - db_data:/var/lib/mysql\n      - ./init.sql:/docker-entrypoint-initdb.d/init.sql:ro\n    healthcheck:\n      test: [\"CMD\", \"mysqladmin\", \"ping\", \"-h\", \"localhost\"]\n      interval: 10s\n      timeout: 5s\n      retries: 3\n\n  app:\n    build: ./vulnerable_app\n    depends_on:\n      db:\n        condition: service_healthy\n\n  jetty:\n    image: jetty:9.4.38-jre11\n    ports:\n      - \"8080:8080\"\n    depends_on:\n      - app\n    volumes:\n      - ./jetty/example.war:/var/lib/jetty/webapps/example.war\n\nvolumes:\n  db_data:"
        },
        {
            "location": "./../../dockers/CVE-2021-28164/custom/init.sql",
            "content": "CREATE TABLE users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  username VARCHAR(50),\n  password VARCHAR(50)\n);\nINSERT INTO users (username, password) VALUES ('admin', 'admin123');"
        },
        {
            "location": "./../../dockers/CVE-2021-28164/custom/vulnerable_app/Dockerfile",
            "content": "FROM node:12-alpine\nWORKDIR /app\nCOPY package.json .\nRUN npm install\nCOPY . .\nEXPOSE 8080\nCMD [\"node\", \"app.js\"]"
        },
        {
            "location": "./../../dockers/CVE-2021-28164/custom/vulnerable_app/package.json",
            "content": "{\n  \"name\": \"vulnerable_app\",\n  \"version\": \"1.0.0\",\n  \"main\": \"app.js\",\n  \"dependencies\": {\n    \"express\": \"4.16.0\",\n    \"mysql\": \"2.18.1\"\n  }\n}"
        },
        {
            "location": "./../../dockers/CVE-2021-28164/custom/vulnerable_app/app.js",
            "content": "const express = require('express');\nconst mysql = require('mysql');\nconst app = express();\napp.use(express.urlencoded({ extended: true }));\nconst db = mysql.createConnection({\n  host: 'db',\n  user: process.env.MYSQL_USER || 'user',\n  password: process.env.MYSQL_PASSWORD || 'userpass',\n  database: process.env.MYSQL_DATABASE || 'testdb'\n});\napp.get('/', (req, res) => {\n  res.send('Vulnerable App');\n});\napp.get('/search', (req, res) => {\n  const q = req.query.q || '';\n  const sql = `SELECT * FROM users WHERE username = '${q}'`;\n  db.query(sql, (err, results) => {\n    if (err) return res.status(500).send('Error');\n    res.json(results);\n  });\n});\napp.listen(8080, () => console.log('Listening on 8080'));"
        },
        {
            "location": "./../../dockers/CVE-2021-28164/custom/jetty/example.war",
            "content": ""
        }
    ],
    "directory_tree": "CVE-2021-28164/custom"
}