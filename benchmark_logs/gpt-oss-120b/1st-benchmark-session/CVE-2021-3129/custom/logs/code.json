{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-3129/custom/docker-compose.yml",
            "content": "services:\n  docker:\n    image: docker:20.10.6-dind\n    privileged: true\n    environment:\n      - DOCKER_TLS_CERTDIR=\n    ports:\n      - \"2375:2375\"\n    volumes:\n      - docker-data:/var/lib/docker\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: app\n      MYSQL_USER: user\n      MYSQL_PASSWORD: pass\n    ports:\n      - \"3306:3306\"\n    healthcheck:\n      test: [\"CMD\", \"mysqladmin\", \"ping\", \"-h\", \"localhost\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n    volumes:\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\n  laravel:\n    build: ./laravel\n    depends_on:\n      db:\n        condition: service_healthy\n    environment:\n      - APP_KEY=base64:ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890ABCDEFGHIJKL=\n      - DB_HOST=db\n      - DB_DATABASE=app\n      - DB_USERNAME=user\n      - DB_PASSWORD=pass\n    ports:\n      - \"8000:8000\"\n  nginx:\n    image: nginx:1.21\n    ports:\n      - \"80:80\"\n    volumes:\n      - ./nginx.conf:/etc/nginx/conf.d/default.conf:ro\n    depends_on:\n      - laravel\nvolumes:\n  docker-data:\n"
        },
        {
            "location": "./../../dockers/CVE-2021-3129/custom/nginx.conf",
            "content": "server {\n    listen 80;\n    server_name _;\n\n    location / {\n        proxy_pass http://laravel:8000;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2021-3129/custom/laravel/Dockerfile",
            "content": "FROM php:8.1-cli\n\n# Install system dependencies required for Composer and PHP extensions\nRUN apt-get update && apt-get install -y \\\n        libzip-dev \\\n        zip \\\n        git \\\n        unzip \\\n    && docker-php-ext-install zip \\\n    && rm -rf /var/lib/apt/lists/*\n\n# Install Composer globally\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer\n\nWORKDIR /var/www/html\n\n# Pin Laravel to a known vulnerable version (8.4.1)\nRUN composer create-project --prefer-dist laravel/laravel:8.4.1 .\n\n# Expose the Laravel version as image metadata\nLABEL laravel.version=\"8.4.1\"\n\nEXPOSE 8000\n\n# Use the built\u2011in PHP server for simplicity\nCMD [\"php\", \"-S\", \"0.0.0.0:8000\", \"-t\", \"public\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2021-3129/custom/laravel/public/index.php",
            "content": "<?php\n\n/**\n * Simple placeholder index for the Laravel image.\n * The real Laravel application is installed via Composer during the build.\n */\n\necho \"Laravel service is up and running.\\n\";\n?>\n"
        },
        {
            "location": "./../../dockers/CVE-2021-3129/custom/db/init.sql",
            "content": "CREATE TABLE users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    email VARCHAR(100) NOT NULL UNIQUE,\n    password VARCHAR(255) NOT NULL\n);\n\nINSERT INTO users (name, email, password) VALUES\n('Alice', 'alice@example.com', 'password_hash'),\n('Bob', 'bob@example.com', 'password_hash');\n"
        }
    ],
    "directory_tree": "CVE-2021-3129/custom"
}