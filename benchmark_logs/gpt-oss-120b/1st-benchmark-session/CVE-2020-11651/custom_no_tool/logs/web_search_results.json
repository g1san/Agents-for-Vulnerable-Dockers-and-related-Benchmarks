{
    "desc": "CVE\u20112020\u201111651 is a remote code execution vulnerability in the SaltStack Salt master service. The flaw resides in the `ClearFuncs` class of the salt\u2011master process, which fails to properly validate method calls that are exposed through the ZeroMQ RPC interface (default TCP port 4506). As a result, an unauthenticated attacker who can reach the master\u2019s ZeroMQ port can invoke privileged Salt functions such as `wheel.key`, `jobs`, and file manipulation APIs. By retrieving the master\u2019s private root key, the attacker gains full control over the master and can:\n1. Execute arbitrary shell commands on the master itself.\n2. Run commands on every connected minion, effectively compromising the entire managed infrastructure.\n3. Read or write arbitrary files on the master, including sensitive credential stores like `/etc/shadow`.\n4. Upload malicious payloads or schedule cron jobs for persistence.\nThe exploitation flow demonstrated by publicly available proof\u2011of\u2011concept scripts is:\n\u2022 Connect to the master\u2019s ZeroMQ endpoint.\n\u2022 Issue a `wheel.key` request to obtain the base\u201164 encoded root key.\n\u2022 Use the retrieved key to authenticate subsequent RPC calls and invoke `salt-run` or `salt '*'` commands.\nThis vulnerability affects all Salt master versions prior to the security updates released on 2020\u201112\u201103. The vulnerable releases are the 2019.2 series up to 2019.2.3 and the Salt 3000 series up to 3000.1. After the fix (Salt 2019.2.4 and Salt 3000.2) proper authentication checks were added to the `ClearFuncs` methods, preventing unauthenticated access.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "saltstack/salt",
            "version": [
                "2019.2.0",
                "2019.2.1",
                "2019.2.2",
                "2019.2.3",
                "3000.0",
                "3000.1"
            ],
            "dependency_type": "HARD",
            "description": "The Salt master container provides the vulnerable SaltStack Salt service. Versions listed are those that contain the ClearFuncs validation bug and allow unauthenticated access to the wheel.key and other privileged RPC functions, making the Docker system exploitable for CVE\u20112020\u201111651."
        },
        {
            "name": "docker",
            "version": [
                "20.10.24"
            ],
            "dependency_type": "SOFT-DOCKER",
            "description": "Docker engine required to run the Salt master container. Any recent version compatible with the listed Salt images is sufficient."
        }
    ],
    "input_tokens": 5384,
    "output_tokens": 1842
}