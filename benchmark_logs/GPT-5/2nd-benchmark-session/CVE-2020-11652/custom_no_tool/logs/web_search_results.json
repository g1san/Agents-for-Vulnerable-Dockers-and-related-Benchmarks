{
    "desc": "CVE-2020-11652 is a flaw in SaltStack\u2019s Salt master (salt-master) file-handling interface. The ClearFuncs methods that back the master\u2019s file server and related \u201cwheel\u201d functionality insufficiently sanitize user-supplied paths. An attacker who can reach the master\u2019s ZeroMQ request interface (typically TCP 4506; often reachable alongside the publisher on 4505) can craft relative paths with directory traversal sequences to escape configured file_roots and other allowed directories. This permits reading arbitrary files anywhere on the master and writing files outside permitted locations by abusing the master\u2019s file transfer helpers. Practical impact includes disclosure of sensitive data (for example, master keys, account files) and placement of attacker-controlled files that can be executed or invoked by the operating system (for example, cron jobs), which can lead to full compromise of the master and potentially all connected minions. Vulnerable releases include Salt versions prior to 2019.2.4 and 3000 prior to 3000.2; the issue was corrected by tightening path validation in the affected code paths.",
    "attack_type": "Directory traversal enabling arbitrary file read and arbitrary file write, which can be leveraged to achieve remote command execution",
    "services": [
        {
            "name": "saltstack/salt",
            "version": [
                "2019.2.0---2019.2.3",
                "3000---3000.1"
            ],
            "dependency_type": "HARD",
            "description": "Provides the vulnerable salt-master service whose ClearFuncs file-handling allows directory traversal leading to arbitrary file read/write. Expose TCP 4505/4506 for a functional, testable master. No additional services are required to make the system vulnerable."
        }
    ],
    "input_tokens": 5906,
    "output_tokens": 3484
}