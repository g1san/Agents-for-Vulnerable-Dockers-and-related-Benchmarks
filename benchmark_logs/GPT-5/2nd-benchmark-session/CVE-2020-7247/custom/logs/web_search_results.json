{
    "desc": "CVE-2020-7247 is a critical vulnerability in OpenSMTPD, the Simple Mail Transfer Protocol daemon from the OpenBSD project that is also packaged on multiple Linux and UNIX distributions. The flaw resides in the sender address validation routine (smtp_mailaddr in smtp_session.c). Due to an incorrect error-handling return path during input validation, user-controlled data in SMTP commands (notably the MAIL FROM address) is not properly sanitized. As a result, shell metacharacters can pass through and be interpreted by the underlying system. When an attacker supplies a specially crafted sender address, OpenSMTPD\u2019s processing may end up invoking a shell with attacker-controlled content embedded, leading to execution of arbitrary commands. Multiple trustworthy sources report that this issue affects OpenSMTPD 6.6 as shipped with OpenBSD 6.6 and other platforms; broader community advisories further indicate the affected range spans versions 6.4.0 through 6.6.1, with the vendor\u2019s fixed version being 6.6.2. The issue is exploitable in default, uncommented configurations and does not require authentication. The only prerequisite is network access to the SMTP service. Successful exploitation typically yields command execution with root privileges because the daemon commonly runs with elevated rights for mail-handling operations. Mitigation is to upgrade OpenSMTPD to version 6.6.2 or later, which corrects the input validation logic and prevents command injection via crafted SMTP addresses.",
    "attack_type": "Unauthenticated remote code execution (arbitrary command execution as root) via input validation failure leading to command injection",
    "services": [
        {
            "name": "instrumentisto/opensmtpd",
            "version": [
                "6.4.0---6.6.1",
                "6.6"
            ],
            "dependency_type": "HARD",
            "description": "OpenSMTPD daemon providing the vulnerable SMTP service. These versions are within the vulnerable range reported by reliable sources (including OpenSMTPD 6.6 as shipped with OpenBSD 6.6 and versions prior to 6.6.2). This single service is sufficient to create a working, network-accessible SMTP endpoint that is vulnerable to CVE-2020-7247."
        }
    ],
    "input_tokens": 15717,
    "output_tokens": 2225,
    "query": "CVE-2020-7247 OpenSMTPD vulnerability remote code execution details exploit patch timeline advisories \"CVE-2020-7247\""
}