{
    "desc": "CVE-2020-7247 is a vulnerability in OpenSMTPD (portable and OpenBSD\u2019s variant) caused by incorrect input validation and an erroneous return path in smtp_mailaddr() (smtp_session.c). Crafted SMTP addresses containing shell metacharacters in MAIL FROM or RCPT TO can reach shell-executed paths, enabling command execution with the daemon\u2019s privileges. In default configurations that bind to all interfaces and accept external mail, this is remotely triggerable without authentication; even loopback-only defaults allow local privilege escalation. Affected portable releases span from the \u201cnew grammar\u201d introduction around 6.4.0 up to, but not including, 6.6.2/6.6.2p1. OpenSMTPD 6.6 (as in OpenBSD 6.6) is explicitly affected. Fixed versions are 6.6.2/6.6.2p1 and later.",
    "attack_type": "Unauthenticated remote command execution as the superuser; Local privilege escalation to the superuser",
    "services": [
        {
            "name": "opensmtpd",
            "version": [
                "6.4.0",
                "6.4.1",
                "6.5.0",
                "6.6.0",
                "6.6.1",
                "6.6.1p1"
            ],
            "dependency_type": "HARD",
            "description": "The vulnerable mail transfer agent. The flaw resides in smtp_mailaddr(); vulnerable from ~6.4.0 through 6.6.1p1 (fixed in 6.6.2/6.6.2p1). Installed inside the base image to expose SMTP on TCP/25 and reproduce CVE-2020-7247."
        },
        {
            "name": "debian",
            "version": [
                "10-slim"
            ],
            "dependency_type": "SOFT",
            "description": "Base OS image used to run OpenSMTPD with minimal footprint and package pinning. Provides the runtime to install and start the vulnerable OpenSMTPD daemon binding to 0.0.0.0:25."
        }
    ],
    "input_tokens": 153358,
    "output_tokens": 4343
}