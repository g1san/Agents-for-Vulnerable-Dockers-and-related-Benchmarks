{
    "desc": "CVE-2020-7247 is a critical vulnerability in OpenSMTPD, the mail transfer agent that implements the Simple Mail Transfer Protocol service used for sending email. The flaw resides in the smtp_mailaddr function within smtp_session.c, introduced after the \u201cnew grammar\u201d changes (synchronized in the portable branch around OpenSMTPD 6.4.0) and present through versions prior to 6.6.2. Due to an incorrect return value when input validation fails, OpenSMTPD does not properly reject or escape shell metacharacters supplied by a remote client in SMTP commands. In particular, a crafted SMTP dialogue that injects shell metacharacters into the MAIL FROM address can pass through validation. Later, when that address is propagated to code paths that invoke shell commands, the metacharacters are interpreted by the system shell, allowing the attacker\u2019s injected commands to execute on the server. This behavior is reachable in the default, \u201cuncommented\u201d configuration and requires only network access to the SMTP service (commonly exposed on port 25). Exploitation is unauthenticated and can yield command execution with root privileges on affected systems, including default installations such as OpenBSD 6.6. Verified reports and advisories indicate the issue affects OpenSMTPD instances on multiple platforms (e.g., OpenBSD 5.9\u20136.6 and portable builds on Linux distributions). The vulnerability is fixed in OpenSMTPD 6.6.2 and later (e.g., via OpenBSD patch 019_smtpd_exec and OpenSMTPD commit 2afab229). Mitigation is to upgrade OpenSMTPD to 6.6.2 or newer or apply vendor patches. The exposure window can also be bounded in deployments by restricting network access to the SMTP service, but full remediation requires upgrading the daemon to a non-vulnerable version.",
    "attack_type": "Unauthenticated remote command execution via operating system command injection over the Simple Mail Transfer Protocol service",
    "services": [
        {
            "name": "instrumentisto/opensmtpd",
            "version": [
                "6.4.0---6.6.1",
                "6.6"
            ],
            "dependency_type": "HARD",
            "description": "OpenSMTPD SMTP daemon providing the network-exposed mail service that contains the vulnerable smtp_mailaddr code path; this single service is sufficient to create a working and testable system vulnerable to CVE-2020-7247 (listening on SMTP port 25)."
        }
    ],
    "input_tokens": 3655,
    "output_tokens": 2075
}