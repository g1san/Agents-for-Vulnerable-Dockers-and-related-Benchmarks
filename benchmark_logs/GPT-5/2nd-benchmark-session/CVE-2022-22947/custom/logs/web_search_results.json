{
    "desc": "CVE-2022-22947 is a critical vulnerability in Spring Cloud Gateway that enables code injection leading to arbitrary remote code execution when specific conditions are met. The flaw resides in the Gateway Actuator route management functionality. When the Gateway Actuator endpoint is enabled, exposed to remote clients, and not properly secured (for example, unauthenticated or broadly reachable over the network), an attacker can send crafted HTTP requests to writable actuator endpoints responsible for managing gateway routes. By abusing route creation or update operations with expressions evaluated by the framework (for example, through Spring Expression Language in certain filters), an attacker can inject malicious expressions that are executed by the application. After installing a malicious route, triggering a refresh or related action causes the injected expression to be evaluated, which results in arbitrary code execution on the host running the Spring Cloud Gateway application. The issue affects Spring Cloud Gateway versions prior to the fixed releases 3.1.1 and 3.0.7\u2014explicitly including 3.1.0 and 3.0.0 through 3.0.6\u2014and older unsupported versions are also impacted. Exploitation has been observed in the wild, often by botnets targeting internet-exposed gateways whose actuator endpoints are reachable without authentication. Successful exploitation requires: (1) a Spring Cloud Gateway application using a vulnerable version, and (2) the Gateway Actuator endpoint to be enabled, exposed over HTTP, and insufficiently secured. Mitigations include upgrading to 3.1.1 or later, or 3.0.7 or later; disabling the Gateway Actuator if not needed; and enforcing strong authentication/authorization and network restrictions on actuator endpoints. The vulnerability is network exploitable without credentials and carries a maximum severity rating due to the potential for full compromise of confidentiality, integrity, and availability.",
    "attack_type": "Remote code execution via code injection through insecurely exposed management endpoints",
    "services": [
        {
            "name": "bitnami/spring-cloud-gateway",
            "version": [
                "3.0.0---3.0.6",
                "3.1.0"
            ],
            "dependency_type": "HARD",
            "description": "A Spring Cloud Gateway application container running a vulnerable Gateway version with the Gateway Actuator endpoint enabled and exposed. This is the core service that contains the vulnerable component; using any of the listed versions makes the system vulnerable when the actuator is reachable and unsecured."
        },
        {
            "name": "eclipse-temurin",
            "version": [
                "11-jre",
                "17-jre"
            ],
            "dependency_type": "SOFT",
            "description": "Java Runtime Environment required to run the Spring Cloud Gateway application inside the container. Choose a version compatible with the application build (Java 11 or 17 are commonly used). This does not introduce the vulnerability but is necessary for the Dockerized application to run."
        }
    ],
    "input_tokens": 66684,
    "output_tokens": 2646,
    "query": "CVE-2022-22947 Spring Cloud Gateway vulnerability details exploit mitigation root cause versions affected CVSS PoC RCE"
}