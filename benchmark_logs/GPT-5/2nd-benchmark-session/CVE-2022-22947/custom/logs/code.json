{
    "file_name": [
        "./../../dockers/CVE-2022-22947/custom/docker-compose.yml",
        "./../../dockers/CVE-2022-22947/custom/Dockerfile",
        "./../../dockers/CVE-2022-22947/custom/pom.xml",
        "./../../dockers/CVE-2022-22947/custom/src/main/java/com/example/gateway/GatewayApplication.java",
        "./../../dockers/CVE-2022-22947/custom/src/main/resources/application.yml"
    ],
    "file_code": [
        "services:\n  gateway:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    image: cve-2022-22947-gateway:local\n    container_name: cve-2022-22947-gateway\n    ports:\n      - \"8080:8080\"\n    environment:\n      - JAVA_TOOL_OPTIONS=-XX:+UseContainerSupport -Xms256m -Xmx512m\n    restart: unless-stopped\n",
        "FROM eclipse-temurin:17-jre AS builder\n\n# Install build toolchain (Maven) and JDK inside the allowed base image\nRUN apt-get update \\\n    && apt-get install -y --no-install-recommends \\\n       maven \\\n       openjdk-17-jdk-headless \\\n       ca-certificates \\\n    && rm -rf /var/lib/apt/lists/*\n\n# Ensure Maven uses the installed JDK (not the base image JRE)\nENV JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64\nENV PATH=\"$JAVA_HOME/bin:${PATH}\"\n\nWORKDIR /src\nCOPY pom.xml .\n# Pre-fetch dependencies for faster builds\nRUN mvn -q -e -U -DskipTests=true dependency:go-offline\n\nCOPY src ./src\nRUN mvn -q -DskipTests=true package\n\nFROM eclipse-temurin:17-jre\nWORKDIR /app\nCOPY --from=builder /src/target/gateway-0.0.1-SNAPSHOT.jar /app/app.jar\nEXPOSE 8080\nENTRYPOINT [\"java\",\"-jar\",\"/app/app.jar\"]\n",
        "<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n  <modelVersion>4.0.0</modelVersion>\n\n  <groupId>com.example</groupId>\n  <artifactId>gateway</artifactId>\n  <version>0.0.1-SNAPSHOT</version>\n  <name>cve-2022-22947-gateway</name>\n  <description>Spring Cloud Gateway vulnerable setup for CVE-2022-22947</description>\n\n  <properties>\n    <java.version>17</java.version>\n    <spring.boot.version>2.6.7</spring.boot.version>\n    <spring.cloud.version>2021.0.0</spring.cloud.version>\n  </properties>\n\n  <dependencyManagement>\n    <dependencies>\n      <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-dependencies</artifactId>\n        <version>${spring.boot.version}</version>\n        <type>pom</type>\n        <scope>import</scope>\n      </dependency>\n      <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-dependencies</artifactId>\n        <version>${spring.cloud.version}</version>\n        <type>pom</type>\n        <scope>import</scope>\n      </dependency>\n    </dependencies>\n  </dependencyManagement>\n\n  <dependencies>\n    <dependency>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-starter-actuator</artifactId>\n    </dependency>\n    <dependency>\n      <groupId>org.springframework.cloud</groupId>\n      <artifactId>spring-cloud-starter-gateway</artifactId>\n      <!-- Via Spring Cloud 2021.0.0 BOM this resolves to Spring Cloud Gateway 3.1.0 (vulnerable) -->\n    </dependency>\n    <dependency>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-starter</artifactId>\n    </dependency>\n    <dependency>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-starter-logging</artifactId>\n    </dependency>\n    <!-- Removed spring-boot-starter-web to avoid pulling Spring MVC onto the classpath -->\n    <dependency>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-starter-test</artifactId>\n      <scope>test</scope>\n    </dependency>\n  </dependencies>\n\n  <build>\n    <plugins>\n      <plugin>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-maven-plugin</artifactId>\n        <version>${spring.boot.version}</version>\n        <configuration>\n          <mainClass>com.example.gateway.GatewayApplication</mainClass>\n        </configuration>\n        <executions>\n          <execution>\n            <goals>\n              <goal>repackage</goal>\n            </goals>\n          </execution>\n        </executions>\n      </plugin>\n      <plugin>\n        <groupId>org.apache.maven.plugins</groupId>\n        <artifactId>maven-compiler-plugin</artifactId>\n        <version>3.11.0</version>\n        <configuration>\n          <source>${java.version}</source>\n          <target>${java.version}</target>\n        </configuration>\n      </plugin>\n    </plugins>\n  </build>\n</project>\n",
        "package com.example.gateway;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class GatewayApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(GatewayApplication.class, args);\n    }\n}\n",
        "server:\n  port: 8080\n\nspring:\n  application:\n    name: vulnerable-gateway\n  main:\n    allow-bean-definition-overriding: true\n    web-application-type: reactive\n  cloud:\n    gateway:\n      # No static routes required; actuator will manage routes dynamically\n      default-filters: []\n\nmanagement:\n  endpoint:\n    gateway:\n      enabled: true\n  endpoints:\n    web:\n      exposure:\n        include: \"*\"\n  server:\n    port: 8080\n\nlogging:\n  level:\n    root: INFO\n"
    ],
    "directory_tree": "./../../dockers/CVE-2022-22947/custom\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 pom.xml\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 main\n        \u251c\u2500\u2500 java\n        \u2502   \u2514\u2500\u2500 com\n        \u2502       \u2514\u2500\u2500 example\n        \u2502           \u2514\u2500\u2500 gateway\n        \u2502               \u2514\u2500\u2500 GatewayApplication.java\n        \u2514\u2500\u2500 resources\n            \u2514\u2500\u2500 application.yml\n"
}