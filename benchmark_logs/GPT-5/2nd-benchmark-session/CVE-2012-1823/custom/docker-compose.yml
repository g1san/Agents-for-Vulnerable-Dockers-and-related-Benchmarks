version: "3.8"

services:
  php:
    build:
      context: ./php-cgi
    image: cve-2012-1823-php-cgi:5.4.1
    container_name: cve2012_php
    volumes:
      - php_cgi_bin:/opt/php-cgi
    command: ["/docker-entrypoint.sh"]

  httpd:
    build:
      context: ./apache
    image: cve-2012-1823-httpd:2.4.59
    container_name: cve2012_httpd
    depends_on:
      - php
    ports:
      - "8080:80"
    volumes:
      - php_cgi_bin:/opt/php-cgi:ro
      - ./web:/usr/local/apache2/htdocs:ro

volumes:
  php_cgi_bin:
