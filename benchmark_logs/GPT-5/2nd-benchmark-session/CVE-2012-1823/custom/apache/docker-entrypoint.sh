#!/bin/sh
set -e

# Wait up to 60s for the php-cgi binary to appear from the php container
TARGET="/opt/php-cgi/php-cgi"
for i in $(seq 1 60); do
  if [ -x "$TARGET" ]; then
    break
  fi
  if [ "$i" -eq 1 ]; then
    echo "[httpd] Waiting for $TARGET ..."
  fi
  sleep 1
done

if [ ! -x "$TARGET" ]; then
  echo "[httpd] WARNING: $TARGET not found or not executable; continuing anyway."
fi

# Run Apache in foreground (as per base image default)
exec httpd-foreground
