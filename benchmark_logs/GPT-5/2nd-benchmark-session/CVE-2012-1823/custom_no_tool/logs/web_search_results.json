{
    "desc": "CVE-2012-1823 is a vulnerability in the PHP Common Gateway Interface Server API (PHP-CGI). When PHP is deployed behind a web server as a CGI executable (php-cgi), the CGI wrapper can forward the raw HTTP query string to PHP. Vulnerable versions of PHP-CGI incorrectly treat query strings that do not contain an equals sign as command\u2011line arguments. As a result, an attacker can place PHP command-line options directly into the URL query string, and PHP-CGI will parse and honor them. This enables multiple high-impact behaviors: (1) source code disclosure via the -s option, which returns the highlighted source of the target .php file, potentially exposing credentials, secrets, or business logic; and (2) configuration overrides via the -d option, such as enabling allow_url_include and specifying auto_prepend_file=php://input, which causes PHP to read and execute attacker-supplied code from the HTTP request body before the intended script runs. In essence, malformed query strings lacking an equals sign are insufficiently sanitized and are transformed into effective command-line switches for php-cgi. The flaw resides in PHP\u2019s CGI argument parsing logic (sapi/cgi/cgi_main.c) that improperly handles QUERY_STRING as argv, failing to prevent option processing in these cases. Exploitation requires only network access to a web server that invokes PHP via the CGI SAPI and forwards the unmodified query string. No database, message queue, or other auxiliary services are required. The original upstream fixes landed in PHP 5.3.12 and 5.4.2; versions earlier than these are vulnerable. Separate follow-on advisories also documented platform-specific bypass nuances (for example, on certain Windows codepages), but the core vulnerability addressed by CVE-2012-1823 concerns argument injection into php-cgi via improperly parsed query strings.",
    "attack_type": "Remote code execution and information disclosure via argument injection into a CGI handler",
    "services": [
        {
            "name": "php",
            "version": [
                "5.3.0---5.3.11",
                "5.4.0---5.4.1"
            ],
            "dependency_type": "HARD",
            "description": "PHP when executed as the CGI SAPI (php-cgi). These versions are vulnerable to query-string argument injection, which is the core of CVE-2012-1823."
        },
        {
            "name": "httpd",
            "version": [
                "2.4.58"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Apache HTTP Server to invoke php-cgi and expose it over HTTP. Any compatible Apache 2.4 will work; it is not the vulnerable component but is needed to run PHP-CGI behind a web server."
        }
    ],
    "input_tokens": 6279,
    "output_tokens": 2194
}