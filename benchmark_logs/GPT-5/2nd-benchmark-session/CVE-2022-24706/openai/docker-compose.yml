version: "3.8"
services:
  couchdb:
    image: couchdb:3.2.1
    container_name: cve-2022-24706-couchdb
    restart: unless-stopped
    environment:
      - ERL_FLAGS=-kernel inet_dist_listen_min 9100 inet_dist_listen_max 9100
      - COUCHDB_USER=admin
      - COUCHDB_PASSWORD=admin
      - COUCHDB_NODENAME=couchdb@127.0.0.1
      - COUCHDB_SECRET=changeme-secret-please
    ports:
      - "5984:5984"   # CouchDB HTTP API
      - "4369:4369"   # epmd
      - "9100:9100"   # Erlang distribution listener
    volumes:
      - couchdb-data:/opt/couchdb/data
volumes:
  couchdb-data:
