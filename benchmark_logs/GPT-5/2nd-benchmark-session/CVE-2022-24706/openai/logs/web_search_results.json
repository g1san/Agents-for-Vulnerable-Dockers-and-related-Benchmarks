{
    "desc": "CVE-2022-24706 is a critical flaw in Apache CouchDB where insecure packaging defaults allowed unauthenticated remote access that could escalate to administrator privileges. On affected builds (<= 3.2.1), epmd (TCP 4369) and the Erlang distribution listener were reachable on non-loopback interfaces, and a default, shared Erlang node cookie (historically \u201cmonster\u201d) permitted any remote Erlang node presenting that cookie to authenticate as a trusted peer. This combination enabled full administrative takeover and, in practice, remote command execution via the Erlang distribution channel. Fixed in 3.2.2 by rejecting the legacy cookie and binding epmd/Erlang distribution to localhost by default. Relevant ports: 5984 (HTTP API), 4369 (epmd), and the Erlang distribution port (official Docker image pins to 9100).",
    "attack_type": "Unauthenticated remote privilege escalation enabling remote execution of commands via the Erlang distribution protocol, resulting in full administrative control over the CouchDB service.",
    "services": [
        {
            "name": "apache/couchdb",
            "version": [
                "prior to 3.2.2 (<= 3.2.1)",
                "3.2.1",
                "3.2.0",
                "3.1.2",
                "2.3.1"
            ],
            "dependency_type": "HARD",
            "description": "CouchDB is the vulnerable component. Using official Docker tags at or below 3.2.1 reproduces the issue. To expose the vulnerable surface in containers, publish TCP ports 5984 (HTTP), 4369 (epmd), and 9100 (Erlang distribution as pinned by the image), and do not override the default Erlang cookie. No additional services are required because epmd and the Erlang distribution listener run within the same container."
        }
    ],
    "input_tokens": 27019,
    "output_tokens": 3639
}