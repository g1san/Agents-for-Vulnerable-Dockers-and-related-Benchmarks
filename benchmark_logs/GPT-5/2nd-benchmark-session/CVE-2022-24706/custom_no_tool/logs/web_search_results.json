{
    "desc": "CVE-2022-24706 is a critical flaw in Apache CouchDB\u2019s default Erlang distribution configuration that allowed unauthenticated takeover of default installations up to and including version 3.2.1. CouchDB is implemented in Erlang and, by default in affected versions, runs as an Erlang node that registers with the Erlang Port Mapper Daemon (epmd) on TCP port 4369 and listens on a random Erlang distribution port bound to all interfaces. Historically, these installs also used a predictable, shared Erlang node cookie value (commonly \u201cmonster\u201d). If an attacker can reach both epmd and the Erlang distribution port, the attacker can query epmd to discover the CouchDB node\u2019s distribution port and then authenticate to the Erlang node using the known cookie. Once authenticated at the Erlang distribution layer, the attacker can issue Erlang commands (for example, invoking operating system command execution primitives) as the CouchDB operating system user, effectively gaining administrative control over CouchDB without any interaction with the HTTP API or its authentication. This results in full administrative privilege escalation on the database service and remote command execution on the underlying host account running CouchDB. Systems that do not expose epmd and the Erlang distribution port externally are not vulnerable, even if the HTTP API (default 5984) is reachable. The issue is fixed in CouchDB 3.2.2 and later, which reject the default cookie and bind epmd and the distribution port to localhost by default. Recommended mitigations include upgrading to 3.2.2+, configuring a unique Erlang cookie, and restricting network access so that only the HTTP API is exposed in single-node deployments.",
    "attack_type": "Unauthenticated remote code execution and administrative privilege escalation via exposed Erlang distribution and default cookie authentication bypass",
    "services": [
        {
            "name": "couchdb",
            "version": [
                "1.0.0---3.2.1",
                "3.2.1"
            ],
            "dependency_type": "HARD",
            "description": "Apache CouchDB itself is sufficient to reproduce the vulnerability. In affected versions, the container\u2019s embedded Erlang runtime starts epmd (TCP/4369) and an Erlang distribution port, and uses a default cookie. No additional external services are required; exposing epmd and the distribution port from this container makes the system vulnerable as described."
        }
    ],
    "input_tokens": 6528,
    "output_tokens": 3023
}