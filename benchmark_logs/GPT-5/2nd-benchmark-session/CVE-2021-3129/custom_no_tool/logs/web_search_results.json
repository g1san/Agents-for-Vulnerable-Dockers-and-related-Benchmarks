{
    "desc": "CVE-2021-3129 is a critical flaw in the Laravel framework\u2019s debug error handling stack, specifically in the Ignition package (the error page/debug handler). When a Laravel application is running with debugging enabled (APP_DEBUG=true) and uses a vulnerable Ignition release, an unauthenticated attacker can abuse Ignition\u2019s solution execution endpoint to manipulate files in the application and ultimately execute arbitrary code. The issue, fixed in Ignition 2.5.2 and Laravel 8.4.2, stems from insecure use of file_get_contents and file_put_contents on attacker-controlled input in Facade\\Ignition\u2019s MakeViewVariableOptionalSolution. Multiple public write-ups and proof-of-concept implementations show two closely related exploitation paths: (1) direct file manipulation via php://filter to write controlled data into storage/logs/laravel.log and then leveraging phar:// stream wrappers to trigger PHP object deserialization; and (2) using Monolog (bundled by default in Laravel) to place a serialized gadget chain into the application log, then converting/reading it as a PHAR to reach a Monolog-based gadget chain and obtain code execution. Conditions required for exploitation are: the Laravel application is reachable over the network; the debug endpoints are exposed; the application\u2019s storage/logs directory is writable by the web process; and a vulnerable Ignition version (prior to 2.5.2) is present, typically alongside Laravel versions prior to 8.4.2. Impact is full compromise of the application process, often used in the wild to run arbitrary shell commands and deploy malware or cryptominers. Mitigation is to disable debug mode in production and upgrade Ignition to 2.5.2 or later and Laravel to 8.4.2 or later.",
    "attack_type": "Unauthenticated arbitrary remote code execution against a web application",
    "services": [
        {
            "name": "php",
            "version": [
                "7.2-apache",
                "7.3-apache",
                "7.4-apache",
                "8.0-apache"
            ],
            "dependency_type": "HARD",
            "description": "PHP runtime with the built-in Apache HTTP Server to host the Laravel application that includes vulnerable Ignition. The vulnerability lives in the Laravel/Ignition application layer, but a PHP web runtime is essential to expose the /_ignition endpoints and to provide PHAR handling and stream wrappers required by known exploits. The listed tags are known-good, Laravel-8\u2013compatible PHP/Apache images."
        },
        {
            "name": "composer",
            "version": [
                "2.1",
                "2.2",
                "2.3"
            ],
            "dependency_type": "SOFT",
            "description": "Dependency manager used during image build to install a Laravel application pinned to vulnerable versions (Laravel < 8.4.2 with facade/ignition < 2.5.2) and to bring in Monolog. Not required at runtime, but needed to assemble the vulnerable app inside the PHP container."
        }
    ],
    "input_tokens": 6453,
    "output_tokens": 2852
}