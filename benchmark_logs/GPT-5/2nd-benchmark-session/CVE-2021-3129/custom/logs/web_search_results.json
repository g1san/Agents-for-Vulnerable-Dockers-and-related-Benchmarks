{
    "desc": "CVE-2021-3129 is a critical vulnerability in Ignition, the error page and debugging tool used by the Laravel framework and other PHP applications. When an application is running in debug mode, Ignition exposes functionality that can be abused to achieve arbitrary code execution on the server without authentication. The flaw arises from unsafe use of file_get_contents() and file_put_contents() within Ignition\u2019s solution execution features. In vulnerable versions, user-controlled input can influence file paths and stream wrappers, enabling an attacker to write and read data on the server in unintended ways.\n\nPublic research shows the most common exploitation path targets the Ignition endpoint /_ignition/execute-solution, particularly classes such as MakeViewVariableOptionalSolution that operate on developer-supplied parameters (for example, a viewFile parameter). By chaining PHP stream/filters tricks (such as php://filter and phar://), an attacker can poison Laravel\u2019s log file with crafted serialized data, then coerce Ignition to decode and execute that payload. This frequently leverages a PHP object injection gadget chain (for instance, payloads generated via phpggc) to gain arbitrary code execution. Successful exploitation yields full remote code execution with the permissions of the web server process.\n\nThe issue impacts Ignition before 2.5.2, and is known to be exploitable on sites using Laravel before 8.4.2 when debug mode is enabled. Additional vendor guidance clarifies affected Ignition branches: 1.x prior to 1.16.14, 2.x prior to 2.4.2, and 2.5.x prior to 2.5.2. In practice, exploitation generally requires the application to be deployed with APP_DEBUG=true (or equivalent debug configuration), which exposes the Ignition interface. Metasploit and numerous proof-of-concept implementations exist, and widespread scanning has been observed in the wild. The impact is severe: an unauthenticated attacker can execute arbitrary commands or code on the target server. Mitigation includes upgrading Ignition to at least 1.16.14, 2.4.2, or 2.5.2 (depending on branch), upgrading Laravel to at least 8.4.2, and disabling debug mode in production environments. Note that some distributions may backport fixes, so version-only checks can be misleading.\n\nKey conditions for exploitability:\n- Application is running in debug mode, exposing the Ignition endpoints.\n- Ignition is a vulnerable version as listed below; environments running Laravel before 8.4.2 are particularly exposed.\n- The attacker can reach the application\u2019s HTTP interface to interact with Ignition\u2019s solution execution endpoint.\n\nRoot cause summary:\n- Insecure file operations (file_get_contents and file_put_contents) in Ignition\u2019s solution handling allow attacker-controlled paths and stream wrappers.\n- These weaknesses enable writing attacker-controlled data (such as serialized objects) to server files and subsequently executing them through filter and stream wrapper abuse.\n\nRemediation summary:\n- Upgrade Ignition to a fixed version (\u22651.16.14 for 1.x, \u22652.4.2 for 2.x, \u22652.5.2 for 2.5.x; generally \u22652.5.2).\n- Upgrade Laravel to \u22658.4.2.\n- Disable debug mode in production to prevent exposure of the Ignition interface.",
    "attack_type": "Unauthenticated remote code execution",
    "services": [
        {
            "name": "php",
            "version": [
                "7.4-apache"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Provides the minimal web server and PHP runtime required to run a Laravel application that includes Ignition. The vulnerability resides in the Laravel Ignition package (a Composer dependency installed within this container), not in PHP itself. A single php:7.4-apache container is sufficient to host a Laravel app in debug mode with a vulnerable Ignition version, making the system testably vulnerable to CVE-2021-3129. Note: The vulnerable component versions are Ignition <1.16.14, 2.x <2.4.2, 2.5.x <2.5.2, typically exploitable with Laravel <8.4.2 when debug is enabled; these are installed via Composer inside this service."
        }
    ],
    "input_tokens": 11130,
    "output_tokens": 2009,
    "query": "CVE-2021-3129 Laravel Ignition debug mode RCE unauthenticated details exploit affected versions patch"
}