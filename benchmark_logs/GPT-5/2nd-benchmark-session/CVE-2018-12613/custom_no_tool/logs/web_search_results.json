{
    "desc": "CVE-2018-12613 is a vulnerability in phpMyAdmin 4.8.x prior to 4.8.2 that stems from improper validation of the internal page routing/whitelist used by index.php. The Core::checkPageValidity logic used a single urldecode() pass when validating the allowed target pages, which allowed an attacker to bypass the whitelist using a double-encoded sequence such as %253f (which becomes %3f after one decode and then ? after the second decode applied elsewhere). As a result, an authenticated user could supply a crafted target parameter (for example, target=db_sql.php%253f/../../..) to traverse directories and force inclusion of arbitrary local files. In practice, this is a directory traversal and local file inclusion flaw in the phpMyAdmin web application (running on PHP under a web server). The immediate impact is disclosure of local files readable by the web server user. More critically, because phpMyAdmin stores user-specific data such as query results and other state in PHP session files (commonly under directories like /var/lib/php/sessions or /var/lib/php5), an attacker can inject PHP code into their own session data (for example via features that write user-controlled content into the session) and then use the local file inclusion vector to include that session file. When included by PHP, the injected code executes with the privileges of the web server process, leading to arbitrary command execution. Exploitation typically requires an authenticated phpMyAdmin session; however, certain configurations reduce or remove this barrier: if $cfg['ServerDefault'] = 0, the vulnerable code path can be reachable without authentication, and if $cfg['AllowArbitraryServer'] = true, an attacker may point phpMyAdmin at a server they control, further easing exploitation. According to NVD/MITRE, affected versions are phpMyAdmin 4.8.0 and 4.8.1, fixed in 4.8.2. The vulnerability can therefore enable both sensitive file disclosure and arbitrary command execution depending on how it is leveraged, with impact including compromise of confidentiality, integrity, and availability of the host running phpMyAdmin.",
    "attack_type": "Directory traversal and local file inclusion that can lead to remote code execution",
    "services": [
        {
            "name": "phpmyadmin",
            "version": [
                "4.8.0---4.8.1",
                "4.8.0",
                "4.8.1"
            ],
            "dependency_type": "HARD",
            "description": "phpMyAdmin is the vulnerable web application. Versions 4.8.0 and 4.8.1 contain the flawed whitelist/target handling that enables the local file inclusion via double-encoded query parameters. The official phpmyadmin image bundles Apache and PHP, so no additional web or PHP service is required."
        },
        {
            "name": "mariadb",
            "version": [
                "10.3"
            ],
            "dependency_type": "SOFT-DB",
            "description": "Relational database used by phpMyAdmin for user authentication and normal operation. While the vulnerability resides entirely in phpMyAdmin, a database service enables a realistic, testable setup where a user can authenticate and exercise the vulnerable code paths. Any 10.3.x MariaDB is compatible with phpMyAdmin 4.8.x."
        }
    ],
    "input_tokens": 7005,
    "output_tokens": 3345
}