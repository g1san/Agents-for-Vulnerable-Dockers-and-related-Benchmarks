{
    "desc": "CVE-2021-43798 is a directory traversal vulnerability in self\u2011hosted Grafana\u2019s built\u2011in web server. In affected releases, the plugin asset handler that serves files from /public/plugins/<plugin_id>/ fails to correctly sanitize user\u2011supplied paths. By requesting a valid plugin slug and appending traversal sequences (for example, /public/plugins/alertlist/../../../../../../../../etc/passwd), a remote, unauthenticated user can force Grafana to read and return files from the underlying filesystem outside the intended plugin directory. The vulnerability is reachable directly over HTTP(S) to the Grafana service (default TCP port 3000) and does not require authentication. A valid plugin identifier must be used; many default, bundled plugin IDs (such as alertlist, graph, and prometheus) are typically present, making exploitation straightforward in default installations.\n\nImpact includes disclosure of sensitive local files on the Grafana host or container, such as /etc/passwd; Grafana configuration at /etc/grafana/grafana.ini (including the secret_key, which was historically a constant default like SW2YcwTIb9zpOOhoPsMm in some packages); and the application database at /var/lib/grafana/grafana.db (commonly SQLite). With access to grafana.ini and grafana.db, an attacker can decrypt stored data source credentials (secureJsonData encrypted with the secret key), potentially leading to broader credential compromise across connected systems. The issue affects self\u2011hosted Grafana only; Grafana Cloud was not impacted. The vulnerability is remediated in 8.0.7, 8.1.8, 8.2.7, and 8.3.1; all prior versions within those branches are vulnerable.",
    "attack_type": "Remote, unauthenticated directory traversal leading to arbitrary local file read over HTTP",
    "services": [
        {
            "name": "grafana/grafana",
            "version": [
                "8.0.0-beta1---8.0.6",
                "8.1.0---8.1.7",
                "8.2.0---8.2.6",
                "8.3.0",
                "Examples of specific vulnerable tags available on Docker Hub: 8.0.6, 8.1.7, 8.2.6, 8.3.0"
            ],
            "dependency_type": "HARD",
            "description": "Grafana itself is the only service required. The vulnerability resides in Grafana\u2019s built\u2011in web server plugin asset endpoint (/public/plugins/<plugin_id>/\u2026), which permits directory traversal and arbitrary file read in affected versions when exposed over HTTP on port 3000. No external database, cache, proxy, or web server is necessary because Grafana ships with an embedded HTTP server and uses a local SQLite database by default."
        }
    ],
    "input_tokens": 26205,
    "output_tokens": 2481,
    "query": "CVE-2021-43798 Grafana arbitrary file read path traversal unauthenticated details fix versions exploit PoC"
}