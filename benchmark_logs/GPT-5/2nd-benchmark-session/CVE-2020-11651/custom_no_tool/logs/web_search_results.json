{
    "desc": "CVE-2020-11651 is an authentication bypass vulnerability in SaltStack Salt\u2019s master service (salt-master). Salt uses a message bus based on ZeroMQ with two primary channels: the \u201cPublish\u201d port (typically TCP 4505) for fan-out to minions and the \u201cRequest/Reply \u2018Clear\u2019 channel\u201d (typically TCP 4506) for unauthenticated bootstrap interactions. In vulnerable versions, the ClearFuncs interface on the salt-master fails to properly validate which methods can be invoked without prior authentication. This design flaw allows an unauthenticated remote client, with only network access to the master\u2019s clear channel, to call sensitive functions. Practical impact includes: (1) extraction of the master\u2019s \u201croot key\u201d (the internal secret used to authorize privileged operations), (2) issuing arbitrary commands for execution directly on the master host, (3) publishing commands to all connected minions to be executed with the minions\u2019 privileges, and (4) accessing master-exposed file server interfaces to read from or write to files managed by the master. No credentials are required; exploitation consists of sending crafted ZeroMQ/msgpack messages to the master\u2019s clear channel. The issue is fixed in Salt 2019.2.4 and 3000.2 (and later). Systems with salt-master network-accessible on TCP 4506 (and typically 4505) are at risk. Mitigations include upgrading to fixed versions and restricting network exposure of the master\u2019s ports via firewalling.",
    "attack_type": "Authentication bypass enabling remote command execution on the master and command publication to minions, as well as unauthorized file access via the master\u2019s interfaces",
    "services": [
        {
            "name": "saltstack/salt",
            "version": [
                "2019.2.0---2019.2.3",
                "3000---3000.1"
            ],
            "dependency_type": "HARD",
            "description": "The salt-master service itself is the vulnerable component. A single container running saltstack/salt in master mode, with its clear channel exposed (typically TCP 4506, and optionally the publish port TCP 4505), is sufficient to reproduce and test the authentication bypass described in CVE-2020-11651. No additional services (databases, queues, web servers, or minions) are required to make the master exploitable."
        }
    ],
    "input_tokens": 4994,
    "output_tokens": 2774
}