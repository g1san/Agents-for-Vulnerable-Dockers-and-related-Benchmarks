{
    "desc": "CVE-2020-11651 is an authentication bypass in Salt\u2019s salt-master (ClearFuncs over the unauthenticated \u201cclear\u201d ZeroMQ channel). Due to insufficient method validation, unauthenticated remote callers can: (1) publish jobs that minions execute as root (remote code execution on minions), and (2) obtain master \u201croot key\u201d/auth material enabling privileged master-level operations. The flaw is actionable when master TCP ports 4505 (publisher) and 4506 (request/return) are reachable. Affected: all Salt < 2019.2.4 and 3000-series < 3000.2. Fixed in 2019.2.4 and 3000.2. (Sources: NVD, SaltProject advisory, public analyses)",
    "attack_type": "Authentication bypass leading to remote code execution on minions and unauthorized administrative actions on the master",
    "services": [
        {
            "name": "cdalvaro/docker-salt-master",
            "version": [
                "Pin Salt master inside container to 2019.2.3",
                "or pin to 3000.1"
            ],
            "dependency_type": "HARD",
            "description": "Vulnerable Salt master where ClearFuncs runs; exposes ports 4505/4506 (ZeroMQ). Essential to make CVE-2020-11651 reachable."
        },
        {
            "name": "ubuntu:18.04 (salt-minion)",
            "version": [
                "ubuntu:18.04 base",
                "salt-minion 2019.2.x (version-aligned with master)"
            ],
            "dependency_type": "HARD",
            "description": "Dedicated Salt minion to observe unauthenticated job publication resulting in command execution; connects to master on ports 4505/4506."
        },
        {
            "name": "ubuntu:18.04 (base for custom master build)",
            "version": [
                "18.04"
            ],
            "dependency_type": "SOFT",
            "description": "Optional base OS if not using a prebuilt master image; install and pin salt-master to 2019.2.3 or 3000.1 inside this image."
        }
    ],
    "input_tokens": 178457,
    "output_tokens": 5889
}