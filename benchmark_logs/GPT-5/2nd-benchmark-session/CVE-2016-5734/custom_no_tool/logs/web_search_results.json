{
    "desc": "CVE-2016-5734 is a vulnerability in phpMyAdmin\u2019s table search-and-replace feature that stems from unsafe use of PHP\u2019s preg_replace with the evaluation modifier. In affected phpMyAdmin versions, user-controlled inputs ($find and $replaceWith) are passed to preg_replace in a way that allows an attacker to introduce the evaluation modifier on the regular expression, causing the replacement string to be interpreted as PHP code. When the pattern matches the subject text (fetched from the database), the attacker-supplied replacement is executed on the server. This issue was documented by the phpMyAdmin project (PMASA-2016-27) and confirmed by NIST. The affected phpMyAdmin series are: 4.0.x before 4.0.10.16, 4.4.x before 4.4.15.7, and 4.6.x before 4.6.3. Successful exploitation typically requires an authenticated phpMyAdmin session (a valid token) because the vulnerable code path is reached through the table find/replace preview functionality in the phpMyAdmin interface. The impact is the ability for a remote, authenticated user to execute arbitrary PHP code in the context of the web server process, leading to full compromise of the phpMyAdmin container and potentially the underlying host if further breakout is achieved. The vulnerability\u2019s expression depends on the PHP runtime: using older PHP versions that still allow code execution via preg_replace with the evaluation modifier makes exploitation feasible, while newer PHP versions (notably PHP 7 and later) prevent code execution via this mechanism. Mitigation recommended by the vendor includes upgrading to phpMyAdmin 4.6.3, 4.4.15.7, or 4.0.10.16 (or newer), and running on PHP versions that do not permit preg_replace-based code execution.",
    "attack_type": "Remote code execution by an authenticated user via malicious input processed by the table search-and-replace feature",
    "services": [
        {
            "name": "phpmyadmin/phpmyadmin",
            "version": [
                "4.0.0---4.0.10.15",
                "4.4.0---4.4.15.6",
                "4.6.0---4.6.2"
            ],
            "dependency_type": "HARD",
            "description": "The vulnerable web application providing the attack surface. Use a tag within one of the listed vulnerable version ranges and a PHP runtime prior to PHP 7 to ensure the vulnerable preg_replace behavior is present. The image includes the necessary web server and PHP runtime."
        },
        {
            "name": "mariadb",
            "version": [
                "10.1"
            ],
            "dependency_type": "SOFT-DB",
            "description": "Relational database required for phpMyAdmin to function and to supply table data used as the subject text in the vulnerable find/replace preview path. Any 10.1.x tag is suitable and compatible with vulnerable phpMyAdmin series."
        }
    ],
    "input_tokens": 5656,
    "output_tokens": 2715
}