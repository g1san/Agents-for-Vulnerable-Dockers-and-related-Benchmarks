{
    "desc": "CVE-2023-42793 is a critical vulnerability in JetBrains TeamCity Server (On\u2011Premises) that allows an unauthenticated attacker to fully compromise a TeamCity instance over its HTTP(S) interface. The core issue is an authentication bypass in the server\u2019s web/REST layer. Research shows two closely related exploitation avenues observed in the wild: (1) a logic flaw involving a global request interceptor that inadvertently disabled pre\u2011handling (including authentication) for any path ending with /RPC2. By abusing an undocumented REST endpoint for user tokens (/app/rest/users/{userLocator}/tokens/{name}), an attacker could create a token whose name is RPC2; the crafted request path then matched /**/RPC2 and bypassed authentication. This resulted in an attacker being able to mint a valid token for a privileged user (for example, the default administrator with id:1) and thereby obtain full administrative access; and (2) direct unauthenticated access to a debug REST endpoint capable of launching processes on the server (for example, POST /app/rest/debug/processes?exePath=echo&params=...). Either route yields immediate control of the TeamCity server, including the ability to create administrator accounts, generate tokens, and execute system commands under the TeamCity service. Public exploitation has been reported, including mass scanning and activity attributed to state\u2011sponsored actors, with follow\u2011on deployment of malware and persistent backdoors on affected servers and even build agents. The impact extends beyond the application itself: once the server is compromised, attackers can control build pipelines, tamper with artifacts, pivot to connected agents, and maintain persistence that may survive upgrades if not thoroughly remediated. TeamCity Cloud is not affected. The issue is fixed in version 2023.05.4; all versions prior to that release are vulnerable. Mitigations include upgrading to 2023.05.4 or later (or applying JetBrains\u2019 official security patch plugin for earlier builds), restricting or disabling access to the debug REST endpoints, limiting external exposure, and monitoring for indicators such as tokens named \u201cRPC2.\u201d",
    "attack_type": "Unauthenticated authentication bypass leading to remote command execution",
    "services": [
        {
            "name": "jetbrains/teamcity-server",
            "version": [
                "2023.05---2023.05.3",
                "2022.10---2022.10.4"
            ],
            "dependency_type": "HARD",
            "description": "TeamCity Server is the vulnerable component. A single, network\u2011reachable TeamCity Server container (prior to 2023.05.4) is sufficient to reproduce and test the vulnerability; it exposes the HTTP(S) web and REST interfaces where the authentication bypass and command execution occur. No external database, web server, or additional services are required for a minimal, working vulnerable setup because TeamCity includes its own web stack and can run with its bundled internal database for testing."
        }
    ],
    "input_tokens": 19141,
    "output_tokens": 1967
}