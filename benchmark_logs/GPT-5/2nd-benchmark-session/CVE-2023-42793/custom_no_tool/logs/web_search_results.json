{
    "desc": "CVE-2024-23897 is an arbitrary file read vulnerability in Jenkins core\u2019s built-in command-line interface running on the controller. Jenkins uses the args4j command-line parser with the feature that expands arguments beginning with the at-sign into file contents (for example, @/path/to/file). In affected versions, Jenkins did not disable this feature for CLI parsing. As a result, when a user supplies CLI arguments that reference files on the controller, Jenkins replaces those arguments with the content of the referenced files before completing permission checks for the invoked command. This allows remote attackers to read files from the Jenkins controller\u2019s filesystem via the CLI endpoint using the process\u2019s default character encoding. The scope of data exposure varies by permissions and encoding: with the Overall/Read permission, complete files can be returned; without it, several initial lines (commonly the first three, sometimes more depending on the command behavior) can be disclosed. Text files are straightforward to extract, while binary or non-text secrets may be partially recoverable depending on the system\u2019s default charset (greater risk when running with single-byte encodings such as Windows-1252, reduced risk with UTF-8). Disclosed files could include sensitive Jenkins configuration, credentials material, environment variables, or keys (for example, Jenkins master.key or secrets.key), which may enable follow-on compromise. Under additional, specific conditions in Jenkins (such as Resource Root URL being enabled together with CLI access via WebSocket or a valid API token, permissive \u201cRemember me\u201d behavior, CSRF crumbs not bound to the session identifier, or the ability to influence build logs), attackers could chain the file read into more severe outcomes, including remote code execution or critical administrative actions. The vulnerability affects Jenkins 2.441 and earlier weekly releases and Jenkins LTS 2.426.2 and earlier. It was remediated by disabling the at-sign file expansion in CLI parsing starting with Jenkins 2.442, LTS 2.440.1, and LTS 2.426.3. As a mitigation on older instances, administrators can disable CLI access; there is also a discouraged system property to re-enable the legacy behavior (-Dhudson.cli.CLICommand.allowAtSyntax=true) in fixed versions.",
    "attack_type": "Arbitrary file read (information disclosure), with potential remote code execution through chaining of additional preconditions",
    "services": [
        {
            "name": "jenkins/jenkins",
            "version": [
                "Weekly releases (vulnerable): 2.0---2.441",
                "LTS releases (vulnerable): 2.0.0---2.426.2",
                "Example vulnerable Docker tags: 2.441-jdk17",
                "Example vulnerable Docker tags: 2.441-jdk11",
                "Example vulnerable Docker tags: 2.426.2-lts-jdk17",
                "Example vulnerable Docker tags: 2.426.2-lts-jdk11"
            ],
            "dependency_type": "HARD",
            "description": "Jenkins controller providing the built-in CLI endpoint where args4j at-sign file expansion occurs. This single service is sufficient to reproduce and test the vulnerability; Jenkins bundles its own web endpoint and does not require an external database, cache, or reverse proxy to be exploitable."
        }
    ],
    "input_tokens": 10966,
    "output_tokens": 2415
}