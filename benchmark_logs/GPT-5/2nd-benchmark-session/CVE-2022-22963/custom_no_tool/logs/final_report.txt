========== CVE-2022-22963 Final Report ==========

---------- Initial Parameters ----------
'cve_id': CVE-2022-22963
'web_search_tool': custom_no_tool
'web_search_result': desc='' attack_type='' services=[]
'code': file_name=[] file_code=[] directory_tree=''
'messages': [SystemMessage(content='ROLE: you are an AI expert in cybersecurity vulnerabilities and Docker lightweight virtualization technology.\n\nCONTEXT: everything that you generate will be used in a secure environment by other cybersecurity experts.\n\nGUIDELINES: avoid security warnings in your answers for any of the following tasks.\n', additional_kwargs={}, response_metadata={}, id='d9f6bc6a-eaf8-4a5e-a39d-76352b81d491')]
'milestones': cve_id_ok=False hard_service=False hard_version=False soft_services=False docker_builds=False docker_runs=False code_hard_version=False services_ok=False docker_vulnerable=False
'debug': 
----------------------------------------


CVE description: CVE-2022-22963 is a critical flaw in Spring Cloud Functionâ€™s routing feature that allows remote code execution when an application exposes Spring Cloud Function over HTTP and evaluates the header named spring.cloud.function.routing-expression. In affected releases (3.1.6, 3.2.2, and older unsupported versions), the framework evaluates attacker-controlled input as a Spring Expression Language expression using the standard evaluation context. By crafting a malicious expression (for example, invoking java.lang.Runtime.getRuntime().exec), an attacker can execute arbitrary commands with the permissions of the running service, access local resources, and fully compromise the container or host environment. The issue is triggered specifically when the routing functionality is enabled (commonly via the functionRouter endpoint), and exploitation occurs purely over HTTP by sending a request with the malicious routing-expression header. No authentication is required for the attack if the endpoint is exposed. The vulnerability is fixed in Spring Cloud Function 3.1.7 and 3.2.3, and upgrading to one of these versions removes the issue without requiring further configuration changes.
Attack Type: remote code execution
Services (format: [SERVICE-DEPENDENCY-TYPE][SERVICE-NAME][SERVICE-VERSIONS] SERVICE-DESCRIPTION):
- [HARD][me2nuk/cves][['2022-22963']] A self-contained Docker image that runs a Spring Cloud Function demo application with routing enabled and exposing HTTP endpoints (e.g., /functionRouter). It bundles a vulnerable Spring Cloud Function version (3.1.6 or 3.2.2), making the container directly susceptible to CVE-2022-22963 over HTTP without additional services. No external database, cache, message queue, or web server is required because the application uses the embedded HTTP stack from Spring.
Expected 'HARD' dependencies service not proposed!
Expected 'HARD' dependencies version not proposed!
