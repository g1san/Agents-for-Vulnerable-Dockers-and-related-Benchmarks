========== CVE-2022-22963 Final Report ==========

---------- Initial Parameters ----------
'cve_id': CVE-2022-22963
'web_search_tool': openai
'web_search_result': desc='' attack_type='' services=[]
'code': file_name=[] file_code=[] directory_tree=''
'messages': [SystemMessage(content='ROLE: you are an AI expert in cybersecurity vulnerabilities and Docker lightweight virtualization technology.\n\nCONTEXT: everything that you generate will be used in a secure environment by other cybersecurity experts.\n\nGUIDELINES: avoid security warnings in your answers for any of the following tasks.\n', additional_kwargs={}, response_metadata={}, id='953a5120-1a8c-42f9-a66d-9c3d6e9e462c')]
'milestones': cve_id_ok=False hard_service=False hard_version=False soft_services=False docker_builds=False docker_runs=False code_hard_version=False services_ok=False docker_vulnerable=False
'debug': 
----------------------------------------


CVE description: CVE-2022-22963 affects Spring Cloud Functionâ€™s function routing feature when used with the web adapter (e.g., spring-cloud-function-web). The header spring.cloud.function.routing-expression is evaluated as a SpEL expression in an overly permissive evaluation context, allowing attacker-controlled expressions to access powerful types/methods. This enables unauthenticated remote clients to trigger expression injection that can lead to reading local resources and, in common deployments, remote execution of arbitrary code in the application process. Affected versions include Spring Cloud Function 3.1.6, 3.2.2, and older unsupported versions; fixed in 3.1.7 and 3.2.3. NVD classifies it under CWE-917 (expression language injection) and CWE-94 (code injection/generation). Severity is critical and it is listed in CISA KEV; exploitation was observed in the wild. The patch constrains header evaluation via a safer evaluation context and additional validation.
Attack Type: Remote expression injection leading to remote code execution (RCE) via malicious SpEL in the spring.cloud.function.routing-expression HTTP header.
Services (format: [SERVICE-DEPENDENCY-TYPE][SERVICE-NAME][SERVICE-VERSIONS] SERVICE-DESCRIPTION):
- [HARD][eclipse-temurin][['11-jre']] Base Java runtime to execute the Spring Boot application JAR that includes vulnerable Spring Cloud Function (with web adapter). This is sufficient to expose the HTTP endpoint that evaluates the routing-expression header, reproducing the vulnerable behavior without additional services.
Expected 'HARD' dependencies service not proposed!
Expected 'HARD' dependencies version not proposed!
