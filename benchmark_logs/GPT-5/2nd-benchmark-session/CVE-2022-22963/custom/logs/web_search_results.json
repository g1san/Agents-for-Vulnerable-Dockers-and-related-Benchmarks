{
    "desc": "CVE-2022-22963 is a critical vulnerability in Spring Cloud Function\u2019s routing feature that allows evaluation of user-supplied Spring Expression Language (SpEL) as part of request-driven function routing. When an application uses Spring Cloud Function together with the web adapter (spring-cloud-function-web) and is configured to route invocations based on the value of the HTTP header named \u201cspring.cloud.function.routing-expression,\u201d the framework treats that header\u2019s value as a SpEL expression. In vulnerable versions, the expression is evaluated without adequate restrictions. An attacker can therefore inject a malicious SpEL payload in that header and have it evaluated by the target application. Because SpEL can access properties, methods, classes, and the file system within the application\u2019s execution context, successful exploitation can lead to arbitrary command execution, arbitrary method invocation, reading or writing local resources, and other impacts consistent with full compromise of the application process.\n\nScope and affected versions: The issue affects Spring Cloud Function 3.1.6, 3.2.2, and older unsupported releases. It is fixed in 3.1.7 and 3.2.3. Exploitation requires that the target application actually employs the routing functionality that evaluates the routing-expression and exposes it over HTTP via the spring-cloud-function-web adapter. No authentication is required for exploitation when such an endpoint is publicly reachable. The vulnerability is independent of the underlying Java runtime version or embedded web server choice, as the flaw resides in the Spring Cloud Function routing-expression evaluation logic itself.\n\nAttack prerequisites and conditions: A victim application must (1) include a vulnerable Spring Cloud Function version, (2) include the spring-cloud-function-web adapter to expose HTTP endpoints, and (3) accept or process the spring.cloud.function.routing-expression value from client-supplied input. Under these conditions, an attacker can craft an HTTP request with a malicious SpEL in that header to trigger evaluation by the framework.\n\nImpact: Successful exploitation enables arbitrary code execution within the application process, which typically allows the attacker to run operating system commands, access application secrets, read or write files, pivot within the environment, or deploy further malware.\n\nMitigation: Upgrade Spring Cloud Function to 3.1.7 or 3.2.3 (or newer). If immediate upgrade is not possible, avoid or disable dynamic routing-expression evaluation and strictly restrict or validate any inputs that could flow into routing-expression processing.",
    "attack_type": "Remote code execution",
    "services": [
        {
            "name": "eclipse-temurin",
            "version": [
                "11-jre"
            ],
            "dependency_type": "SOFT",
            "description": "Java runtime base image to run the vulnerable Spring Cloud Function application (the vulnerability resides in the application\u2019s Spring Cloud Function library; no external web server or database is required). The application layer must include spring-cloud-function-web and a vulnerable Spring Cloud Function version (3.1.6, 3.2.2, or older unsupported) to be exploitable."
        }
    ],
    "input_tokens": 10841,
    "output_tokens": 2380,
    "query": "CVE-2022-22963 Spring Cloud Function SpEL RCE vulnerability details advisory blog PoC affected versions mitigation CVSS"
}