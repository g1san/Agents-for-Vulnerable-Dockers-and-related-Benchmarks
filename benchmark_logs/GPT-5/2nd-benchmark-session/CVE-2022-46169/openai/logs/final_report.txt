========== CVE-2022-46169 Final Report ==========

---------- Initial Parameters ----------
'cve_id': CVE-2022-46169
'web_search_tool': openai
'web_search_result': desc='' attack_type='' services=[]
'code': file_name=[] file_code=[] directory_tree=''
'messages': [SystemMessage(content='ROLE: you are an AI expert in cybersecurity vulnerabilities and Docker lightweight virtualization technology.\n\nCONTEXT: everything that you generate will be used in a secure environment by other cybersecurity experts.\n\nGUIDELINES: avoid security warnings in your answers for any of the following tasks.\n', additional_kwargs={}, response_metadata={}, id='14cefe76-1f9c-42d9-9a1a-3280af208705')]
'milestones': cve_id_ok=False hard_service=False hard_version=False soft_services=False docker_builds=False docker_runs=False code_hard_version=False services_ok=False docker_vulnerable=False
'debug': 
----------------------------------------


CVE description: CVE-2022-46169 is a critical vulnerability in Cacti (<= 1.2.22) enabling unauthenticated OS command execution. Two issues combine: (1) an authorization bypass in remote_agent.php where get_client_addr trusts client-supplied headers (e.g., X-Forwarded-For), letting an attacker appear as a trusted poller host; and (2) a command injection in the polldata action (poll_for_data path) when POLLER_ACTION_SCRIPT_PHP constructs a command with an attacker-controlled poller_id passed to proc_open without proper sanitization. With guessable host_id/local_data_id and commonly present poller items, an external attacker can achieve RCE. Fixed in 1.2.23 and later (including 1.3.x).
Attack Type: Unauthenticated remote code execution via authorization bypass and command injection in a web-exposed endpoint
Services (format: [SERVICE-DEPENDENCY-TYPE][SERVICE-NAME][SERVICE-VERSIONS] SERVICE-DESCRIPTION):
- [SOFT][php][['8.1-apache']] PHP runtime with Apache to host the Cacti web application. Not the vulnerable component; used to run Cacti and required PHP extensions (pdo_mysql, mbstring, gd, xml, json, snmp) plus OS tools (rrdtool, net-snmp).
- [SOFT][mariadb][['10.6']] MySQL-compatible database required by Cacti. Not directly vulnerable for CVE-2022-46169.
- [HARD][cacti][['1.2.0-1.2.22']] The Cacti application code (installed inside the php service) contains the vulnerable paths (remote_agent.php auth bypass and polldata command injection). Fixed starting with 1.2.23.
Expected 'SOFT' role(s) not proposed!
