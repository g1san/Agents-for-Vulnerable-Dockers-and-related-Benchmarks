{
    "desc": "CVE-2022-46169 is a critical vulnerability in Cacti (<= 1.2.22) enabling unauthenticated OS command execution. Two issues combine: (1) an authorization bypass in remote_agent.php where get_client_addr trusts client-supplied headers (e.g., X-Forwarded-For), letting an attacker appear as a trusted poller host; and (2) a command injection in the polldata action (poll_for_data path) when POLLER_ACTION_SCRIPT_PHP constructs a command with an attacker-controlled poller_id passed to proc_open without proper sanitization. With guessable host_id/local_data_id and commonly present poller items, an external attacker can achieve RCE. Fixed in 1.2.23 and later (including 1.3.x).",
    "attack_type": "Unauthenticated remote code execution via authorization bypass and command injection in a web-exposed endpoint",
    "services": [
        {
            "name": "php",
            "version": [
                "8.1-apache"
            ],
            "dependency_type": "SOFT",
            "description": "PHP runtime with Apache to host the Cacti web application. Not the vulnerable component; used to run Cacti and required PHP extensions (pdo_mysql, mbstring, gd, xml, json, snmp) plus OS tools (rrdtool, net-snmp)."
        },
        {
            "name": "mariadb",
            "version": [
                "10.6"
            ],
            "dependency_type": "SOFT",
            "description": "MySQL-compatible database required by Cacti. Not directly vulnerable for CVE-2022-46169."
        },
        {
            "name": "cacti",
            "version": [
                "1.2.0-1.2.22"
            ],
            "dependency_type": "HARD",
            "description": "The Cacti application code (installed inside the php service) contains the vulnerable paths (remote_agent.php auth bypass and polldata command injection). Fixed starting with 1.2.23."
        }
    ],
    "input_tokens": 230364,
    "output_tokens": 3806
}