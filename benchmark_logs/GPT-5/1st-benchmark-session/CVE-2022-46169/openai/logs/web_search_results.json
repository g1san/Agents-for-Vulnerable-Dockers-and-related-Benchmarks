{
    "desc": "CVE-2022-46169 is an authentication bypass plus OS command injection in Cacti\u2019s remote_agent.php, enabling unauthenticated command execution on the Cacti host. The client-IP authorization trusted proxy headers (e.g., X-Forwarded-For), allowing spoofing to match a poller hostname and bypass auth. With action=polldata, an unsafely handled poller_id reached proc_open for script_server.php, enabling attacker-controlled commands. Affects Cacti 1.2.0\u20131.2.22 (fixed in 1.2.23/1.3.0+). Preconditions typically met by default: remote_agent.php reachable and a poller item using the PHP script server action.",
    "attack_type": "Unauthenticated Remote Code Execution (RCE) via authentication bypass and OS command injection",
    "services": [
        {
            "name": "Cacti",
            "version": [
                "1.2.0\u20131.2.22",
                "before 1.2.23"
            ],
            "dependency_type": "HARD",
            "description": "Vulnerable application providing the remote_agent.php endpoint where the flaw resides. Install Cacti 1.2.x prior to 1.2.23 inside the web/PHP container."
        },
        {
            "name": "php (Apache)",
            "version": [
                "8.0-apache",
                "7.4-apache"
            ],
            "dependency_type": "SOFT",
            "description": "Web server and PHP runtime hosting Cacti. Ensure required PHP extensions and system packages (e.g., RRDtool and net-snmp) are installed so remote_agent.php and default templates function."
        },
        {
            "name": "MariaDB (or MySQL)",
            "version": [
                "mariadb:10.6",
                "mysql:8.0"
            ],
            "dependency_type": "SOFT",
            "description": "Relational database backend for Cacti. Use one of MariaDB 10.x or MySQL 8.0; only a single database service is required."
        }
    ],
    "input_tokens": 589870,
    "output_tokens": 8402
}