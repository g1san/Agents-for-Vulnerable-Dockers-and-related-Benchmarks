{
    "desc": "CVE-2022-46169 is a critical security flaw in the Cacti network monitoring application that allows an attacker on the network to execute arbitrary system commands on the Cacti server without prior authentication. The issue resides in remote_agent.php, which is intended to be accessed by trusted pollers. The code attempts to authorize the client by inferring its Internet Protocol address using get_client_addr(), which, prior to the fix, trusted attacker-supplied headers such as X-Forwarded-For and similar HTTP_* headers. If that inferred address resolves to a hostname present in Cacti\u2019s poller table\u2014something commonly true out of the box because a default poller entry matches the server\u2019s own hostname\u2014the function remote_client_authorized() erroneously grants access. Once the authorization check is bypassed, an attacker can reach the action=polldata path, which processes parameters tied to database-defined polling items. When a given poller_item uses the \u201cscript PHP\u201d action (POLLER_ACTION_SCRIPT_PHP), poll_for_data() builds a command string and passes it to proc_open(). In vulnerable versions, the poller_id parameter is embedded into this command without sufficient sanitization, enabling command injection. By combining the spoofed client address (for authentication bypass) with a crafted poller_id value, an attacker can cause Cacti to execute arbitrary commands on the host, typically with the web server user\u2019s privileges (for example, www-data). Successful exploitation generally requires specifying a valid host_id and local_data_id pair, which are commonly present and can be discovered or brute-forced. The vulnerability affects Cacti up to and including version 1.2.22 and was fixed in 1.2.23 (and in the 1.3.x line). Multiple independent analyses (NVD/NIST, the Cacti security advisory, and security researchers) confirm the root cause as the trust of spoofable client Internet Protocol headers in the authorization check and inadequate filtering in the command construction path. The impact is full remote code execution over the network without credentials (CVSS critical). Mitigations include upgrading to 1.2.23 or later, and restricting network access to the remote poller interface (for example, firewalling or allowing only trusted poller addresses).",
    "attack_type": "Unauthenticated remote code execution via authentication bypass and command injection",
    "services": [
        {
            "name": "cacti/cacti",
            "version": [
                "1.2.0---1.2.22",
                "1.2.22"
            ],
            "dependency_type": "HARD",
            "description": "The Cacti web application containing remote_agent.php is the vulnerable component. Versions before 1.2.23 (for example, 1.2.22) permit authentication bypass via spoofed client Internet Protocol headers and command injection in the poller path, enabling remote code execution."
        },
        {
            "name": "mariadb",
            "version": [
                "10.5"
            ],
            "dependency_type": "SOFT-DB",
            "description": "Relational database required by Cacti to operate (stores the poller table and data set metadata leveraged during exploitation). It is not the root cause but is necessary for a working deployment of vulnerable Cacti."
        }
    ],
    "input_tokens": 9081,
    "output_tokens": 5459
}