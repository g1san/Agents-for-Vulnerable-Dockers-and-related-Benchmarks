{
    "file_name": [
        "compose.yaml",
        "app/Dockerfile",
        "app/pom.xml",
        "app/src/main/java/com/example/demo/DemoApplication.java",
        "app/src/main/resources/application.properties"
    ],
    "file_code": [
        "services:\n  app:\n    container_name: cve-2022-22963-app\n    build:\n      context: ./app\n      dockerfile: Dockerfile\n    image: cve-2022-22963-app:latest\n    ports:\n      - \"8080:8080\"\n    restart: unless-stopped\n",
        "# ---- Build stage ----\nFROM maven:3.8.6-eclipse-temurin-11 AS build\nWORKDIR /src\n\nCOPY pom.xml .\nRUN mvn -q -DskipTests dependency:go-offline\n\nCOPY src ./src\nRUN mvn -q -DskipTests clean package\n\n# ---- Runtime stage ----\nFROM eclipse-temurin:11-jre\nWORKDIR /app\n\nCOPY --from=build /src/target/app.jar /app/app.jar\n\nEXPOSE 8080\nENTRYPOINT [\"java\", \"-jar\", \"/app/app.jar\"]\n",
        "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.6.6</version>\n        <relativePath/>\n    </parent>\n\n    <groupId>com.example</groupId>\n    <artifactId>cve-2022-22963-demo</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <name>cve-2022-22963-demo</name>\n    <description>Spring Cloud Function demo app (vulnerable versions) for CVE-2022-22963</description>\n\n    <properties>\n        <java.version>11</java.version>\n        <spring-cloud-function.version>3.2.2</spring-cloud-function.version>\n        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n        <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>\n        <final.app.name>app</final.app.name>\n    </properties>\n\n    <dependencies>\n        <!-- Reactive web stack so the default function router endpoint is available -->\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-webflux</artifactId>\n        </dependency>\n\n        <!-- Vulnerable Spring Cloud Function components (HARD service) -->\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-function-context</artifactId>\n            <version>${spring-cloud-function.version}</version>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-function-web</artifactId>\n            <version>${spring-cloud-function.version}</version>\n        </dependency>\n\n        <!-- Optional: actuator not required; keeping the footprint minimal -->\n    </dependencies>\n\n    <build>\n        <finalName>${final.app.name}</finalName>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n                <configuration>\n                    <mainClass>com.example.demo.DemoApplication</mainClass>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n</project>\n",
        "package com.example.demo;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\nimport java.util.function.Function;\nimport org.springframework.context.annotation.Bean;\n\n@SpringBootApplication\npublic class DemoApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(DemoApplication.class, args);\n    }\n\n    // Sample function bean to demonstrate function routing presence\n    @Bean\n    public Function<String, String> uppercase() {\n        return String::toUpperCase;\n    }\n}\n",
        "server.port=8080\nspring.main.web-application-type=reactive\nlogging.level.org.springframework=INFO\n"
    ],
    "directory_tree": "./../../dockers/CVE-2022-22963/custom_no_tool\n\u251c\u2500\u2500 compose.yaml\n\u2514\u2500\u2500 app\n    \u251c\u2500\u2500 Dockerfile\n    \u251c\u2500\u2500 pom.xml\n    \u2514\u2500\u2500 src\n        \u2514\u2500\u2500 main\n            \u251c\u2500\u2500 java\n            \u2502   \u2514\u2500\u2500 com\n            \u2502       \u2514\u2500\u2500 example\n            \u2502           \u2514\u2500\u2500 demo\n            \u2502               \u2514\u2500\u2500 DemoApplication.java\n            \u2514\u2500\u2500 resources\n                \u2514\u2500\u2500 application.properties\n"
}