{
    "desc": "CVE-2022-22947 is a critical vulnerability in Spring Cloud Gateway\u2019s Actuator Gateway endpoint that enables code injection leading to remote code execution. The flaw arises from the way the Gateway Actuator routes API processes user-supplied route definitions and filter arguments. When the Gateway Actuator endpoint is enabled, reachable over the network, and not protected by authentication and authorization, an unauthenticated attacker can send crafted HTTP requests to the Actuator Gateway routes management endpoints. By injecting Spring Expression Language into route filter arguments, the gateway evaluates the expression during route refresh, allowing arbitrary command execution in the context of the running application process. This grants the attacker the ability to run system commands on the host where the gateway is deployed, read or modify data accessible to the gateway, pivot to adjacent systems, and potentially establish persistence. The vulnerability affects Spring Cloud Gateway versions before the fixed releases 3.1.1 and 3.0.7, including version 3.1.0 and the 3.0.0 through 3.0.6 series; older unsupported versions are also affected. Successful exploitation requires three conditions: the Gateway Actuator endpoint must be enabled by configuration, it must be exposed over HTTP(S) so that it is reachable by the attacker, and it must be unsecured (no authentication/authorization or insufficient restrictions). Mitigations include upgrading to Spring Cloud Gateway 3.1.1 or later (in the 3.1 line) or 3.0.7 or later (in the 3.0 line), disabling the Gateway Actuator endpoint if not needed, or securing the Actuator endpoints with proper authentication and authorization and restricting network access. The issue has been publicly exploited and has a critical severity rating because it enables full remote code execution without prior authentication when misconfigured.",
    "attack_type": "Unauthenticated remote code execution via code injection",
    "services": [
        {
            "name": "springcloud/spring-cloud-gateway",
            "version": [
                "3.1.0",
                "3.0.0---3.0.6"
            ],
            "dependency_type": "HARD",
            "description": "Core gateway service that contains the vulnerable component. To be vulnerable, this container must run a Spring Cloud Gateway application with the Gateway Actuator endpoint enabled, exposed, and not secured. The listed versions reflect the vulnerable ranges cited by authoritative sources (before 3.1.1 and before 3.0.7)."
        },
        {
            "name": "eclipse-temurin",
            "version": [
                "11-jre"
            ],
            "dependency_type": "SOFT",
            "description": "Java Runtime Environment needed to run a Spring Boot application that embeds Spring Cloud Gateway (if you build and run your own application image). Choose a version compatible with Spring Cloud Gateway 3.x (Java 11 is broadly compatible). If using an application image that already includes a JRE, this separate runtime service is not required."
        }
    ],
    "input_tokens": 4777,
    "output_tokens": 4571
}