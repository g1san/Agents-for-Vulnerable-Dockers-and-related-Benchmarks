{
    "file_name": [
        "docker-compose.yml",
        "compose.yaml",
        ".dockerignore",
        "gateway/Dockerfile",
        "gateway/pom.xml",
        "gateway/src/main/java/com/example/gateway/GatewayApplication.java",
        "gateway/src/main/resources/application.yml"
    ],
    "file_code": [
        "version: \"3.8\"\nservices:\n  gateway:\n    build:\n      context: ./gateway\n    container_name: scg-vuln-22947\n    ports:\n      - \"8080:8080\"\n",
        "version: \"3.8\"\nservices:\n  gateway:\n    build:\n      context: ./gateway\n    container_name: scg-vuln-22947\n    ports:\n      - \"8080:8080\"\n",
        "# Maven build output\ngateway/target/\n\n# IDE metadata\n**/.idea/\n**/.vscode/\n**/*.iml\n\n# Git\n.git\n.gitignore\n",
        "# Builder stage with Maven and Temurin JDK 11\nFROM maven:3.8.7-eclipse-temurin-11 AS build\n\nWORKDIR /app\nCOPY pom.xml .\nCOPY src ./src\nRUN mvn -q -DskipTests package\n\n# Runtime stage with Temurin JRE 11\nFROM eclipse-temurin:11-jre\nWORKDIR /app\nCOPY --from=build /app/target/gateway-*.jar /app/app.jar\nEXPOSE 8080\nENTRYPOINT [\"java\", \"-jar\", \"/app/app.jar\"]\n",
        "<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>com.example</groupId>\n    <artifactId>gateway</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <name>gateway</name>\n    <description>Spring Cloud Gateway vulnerable to CVE-2022-22947</description>\n\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.6.3</version>\n        <relativePath/>\n    </parent>\n\n    <properties>\n        <java.version>11</java.version>\n        <spring-cloud.version>2021.0.0</spring-cloud.version>\n        <!-- Explicitly pin the vulnerable Spring Cloud Gateway version -->\n        <spring-cloud-gateway.version>3.1.0</spring-cloud-gateway.version>\n    </properties>\n\n    <dependencyManagement>\n        <dependencies>\n            <dependency>\n                <groupId>org.springframework.cloud</groupId>\n                <artifactId>spring-cloud-dependencies</artifactId>\n                <version>${spring-cloud.version}</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n        </dependencies>\n    </dependencyManagement>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-gateway</artifactId>\n            <version>${spring-cloud-gateway.version}</version>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-actuator</artifactId>\n        </dependency>\n    </dependencies>\n\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n            </plugin>\n        </plugins>\n    </build>\n</project>\n",
        "package com.example.gateway;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class GatewayApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(GatewayApplication.class, args);\n    }\n}\n",
        "server:\n  port: 8080\n\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: \"*\"\n  endpoint:\n    gateway:\n      enabled: true\n\nspring:\n  main:\n    banner-mode: \"off\"\n  cloud:\n    gateway:\n      enabled: true\n      # A simple placeholder route; the vulnerability does not depend on this\n      routes:\n        - id: dummy\n          uri: http://example.com\n          predicates:\n            - Path=/dummy/**\n          filters:\n            - StripPrefix=1\n"
    ],
    "directory_tree": "./../../dockers/CVE-2022-22947/custom_no_tool\n\u251c\u2500\u2500 .dockerignore\n\u251c\u2500\u2500 compose.yaml\n\u251c\u2500\u2500 docker-compose.yml\n\u2514\u2500\u2500 gateway\n    \u251c\u2500\u2500 Dockerfile\n    \u251c\u2500\u2500 pom.xml\n    \u2514\u2500\u2500 src\n        \u251c\u2500\u2500 main\n        \u2502   \u251c\u2500\u2500 java\n        \u2502   \u2502   \u2514\u2500\u2500 com\n        \u2502   \u2502       \u2514\u2500\u2500 example\n        \u2502   \u2502           \u2514\u2500\u2500 gateway\n        \u2502   \u2502               \u2514\u2500\u2500 GatewayApplication.java\n        \u2502   \u2514\u2500\u2500 resources\n        \u2502       \u2514\u2500\u2500 application.yml\n        \u2514\u2500\u2500 test\n"
}