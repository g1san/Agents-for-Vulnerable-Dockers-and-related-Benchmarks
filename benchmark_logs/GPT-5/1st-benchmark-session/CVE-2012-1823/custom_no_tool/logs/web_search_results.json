{
    "desc": "CVE-2012-1823 is a vulnerability in PHP when it is executed via the Common Gateway Interface (CGI) SAPI (often the php-cgi binary) behind a web server. The flaw arises from how php-cgi processes HTTP request query strings that do not contain an equals sign. In such cases, php-cgi mistakenly interprets the entire query string as command-line options intended for the PHP interpreter. If a front-end web server forwards the raw request URI or query string to php-cgi without filtering, an attacker can craft a request whose query string resembles PHP interpreter flags. This allows the attacker to inject php-cgi options at runtime. Practical impacts include: information disclosure (for example, using the syntax-highlighting option to return the source code of a PHP file, which can leak credentials, keys, or application logic) and remote code execution (for example, by setting interpreter options that change configuration values at runtime such as enabling remote file inclusion features and then causing PHP to execute attacker-controlled input). The root cause, as recorded by NIST, is that the CGI SAPI failed to correctly skip option parsing for certain cases when the query string lacked an equals sign, allowing php-cgi to treat user-supplied strings as if they were safe command-line switches. The vulnerability requires that PHP be deployed as CGI (not as an Apache module and not via PHP-FPM) and that the web server forwards unfiltered query strings to the CGI handler. Mitigations include upgrading to fixed PHP versions (5.3.12 or 5.4.2 and later for the original issue), and configuring the web server to reject or sanitize requests whose query strings could be interpreted as interpreter options before they reach php-cgi. Later security notes also highlight platform-specific bypasses of early mitigations (for example, certain Windows code page conversions causing unexpected hyphen characters), underscoring that the core issue is the unsafe interpretation of request-supplied data as interpreter flags in CGI mode.",
    "attack_type": "remote code execution; information disclosure",
    "services": [
        {
            "name": "php",
            "version": [
                "5.3.0---5.3.11",
                "5.4.0---5.4.1"
            ],
            "dependency_type": "HARD",
            "description": "PHP running as CGI (php-cgi) is the vulnerable component. These version ranges match the NIST statement that PHP CGI SAPI before 5.3.12 and 5.4.2 mishandles option-like query strings, enabling option injection that can lead to information disclosure and remote code execution. Ensure the PHP SAPI used is CGI; other SAPIs like Apache module or PHP-FPM are not affected by this specific issue."
        },
        {
            "name": "httpd",
            "version": [
                "2.4.58"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "Apache HTTP Server acts as the front-end web server that invokes php-cgi and forwards the request URI/query string to it. Any modern 2.4.x release is suitable; it is not the vulnerable component but is needed to expose PHP via CGI so the flaw can be exercised."
        }
    ],
    "input_tokens": 6276,
    "output_tokens": 5551
}