{
    "desc": "CVE-2020-11652 is a directory traversal vulnerability in SaltStack\u2019s Salt master service. It stems from insufficient path sanitization in file-handling functionality exposed by the master\u2019s remote interface (notably in ClearFuncs and related fileserver/wheel methods). When a Salt master is reachable on its messaging endpoints (the ZeroMQ-based \u201cclear\u201d transport typically exposed on TCP ports 4505 and 4506), an attacker who can invoke these methods can supply crafted path components (for example, sequences using \u201c../\u201d) to traverse outside the configured file roots on the master. This enables two primary impacts: (1) arbitrary file read on the master host (for example, reading sensitive files such as /etc/shadow or Salt configuration and key material), and (2) arbitrary file write on the master host by abusing write operations that accept a destination expressed as a relative path, allowing the attacker to escape the intended directory and place files in attacker-chosen system locations. While CVE-2020-11652 specifically concerns directory traversal and arbitrary file read/write, it can have broader consequences. For instance, an attacker who can write files to privileged locations (such as cron directories or authorized_keys) may leverage that capability to achieve remote command execution on the master. In many public proofs-of-concept, CVE-2020-11652 is paired with CVE-2020-11651 (an authentication bypass in the same clear transport) to remove the need for prior authentication before invoking the vulnerable file-handling functions; however, CVE-2020-11652 by itself is the path traversal flaw that breaks the master\u2019s filesystem isolation guarantees. The vulnerability affects Salt releases prior to 2019.2.4, and Salt 3000 series releases prior to 3000.2. It is remediated by upgrading to 2019.2.4, 3000.2, or newer, and by restricting network access to the master\u2019s ports (4505/4506) so that only trusted systems can reach them. For constructing a Docker-based vulnerable environment, no external databases, web servers, or caches are required; the only essential component is a Salt master instance itself with an affected Salt version, listening on its ZeroMQ ports.",
    "attack_type": "Directory traversal enabling arbitrary file read and arbitrary file write on the Salt master, with potential remote command execution as a downstream effect",
    "services": [
        {
            "name": "saltstack/salt",
            "version": [
                "2019.2.0---2019.2.3",
                "3000.0---3000.1",
                "2019.2.3",
                "2019.2.2",
                "2019.2.1",
                "2019.2.0",
                "3000.1",
                "3000.0"
            ],
            "dependency_type": "HARD",
            "description": "SaltStack Salt container running the salt-master service (ZeroMQ endpoints on TCP 4505/4506). This is the component that contains the CVE-2020-11652 directory traversal flaw; no external services (databases, message queues, web servers) are required for the master to be vulnerable or reachable."
        }
    ],
    "input_tokens": 5330,
    "output_tokens": 7652
}