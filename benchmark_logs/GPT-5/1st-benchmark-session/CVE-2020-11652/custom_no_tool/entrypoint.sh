#!/bin/sh
set -e

# Ensure writable config tree exists (uses image's own layers/volumes)
mkdir -p /etc/salt

# Stage provided config (if present) into place
if [ -f /mnt/config/master ]; then
  cp -f /mnt/config/master /etc/salt/master
fi

# Make sure PKI directory exists; image declares a VOLUME here
mkdir -p /etc/salt/pki

exec salt-master -l debug -c /etc/salt
