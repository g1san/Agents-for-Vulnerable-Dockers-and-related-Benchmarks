{
    "file_name": [
        "compose.yaml",
        "jenkins/ref/init.groovy.d/01-admin.groovy"
    ],
    "file_code": [
        "version: \"3.8\"\n\nservices:\n  jenkins:\n    image: jenkins/jenkins:2.426.2-lts-jdk17\n    container_name: cve-2024-23897-jenkins\n    ports:\n      - \"8080:8080\"\n    environment:\n      - JAVA_OPTS=-Djenkins.install.runSetupWizard=false -Djenkins.CLI.disabled=false -Djenkins.websocket.enabled=true\n    volumes:\n      - jenkins_home:/var/jenkins_home\n      - ./jenkins/ref/init.groovy.d:/usr/share/jenkins/ref/init.groovy.d:ro\n    restart: unless-stopped\n\nvolumes:\n  jenkins_home:\n",
        "import jenkins.model.Jenkins\nimport hudson.security.*\n\n// Create an admin user and configure security to simplify CLI access\nJenkins instance = Jenkins.get()\n\nHudsonPrivateSecurityRealm hudsonRealm = new HudsonPrivateSecurityRealm(false)\nif (hudsonRealm.getUser(\"admin\") == null) {\n  hudsonRealm.createAccount(\"admin\", \"admin123\")\n}\ninstance.setSecurityRealm(hudsonRealm)\n\nFullControlOnceLoggedInAuthorizationStrategy strategy = new FullControlOnceLoggedInAuthorizationStrategy()\nstrategy.setAllowAnonymousRead(false)\ninstance.setAuthorizationStrategy(strategy)\n\n// Disable CSRF crumbs to make HTTP/WebSocket CLI interactions straightforward\ninstance.setCrumbIssuer(null)\n\ninstance.save()\n"
    ],
    "directory_tree": "./../../dockers/CVE-2024-23897/custom_no_tool\n\u251c\u2500\u2500 compose.yaml\n\u2514\u2500\u2500 jenkins\n    \u2514\u2500\u2500 ref\n        \u2514\u2500\u2500 init.groovy.d\n            \u2514\u2500\u2500 01-admin.groovy\n"
}