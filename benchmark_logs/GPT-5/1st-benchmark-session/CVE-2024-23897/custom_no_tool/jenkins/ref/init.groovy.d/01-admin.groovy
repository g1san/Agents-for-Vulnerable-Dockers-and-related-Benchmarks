import jenkins.model.Jenkins
import hudson.security.*

// Create an admin user and configure security to simplify CLI access
Jenkins instance = Jenkins.get()

HudsonPrivateSecurityRealm hudsonRealm = new HudsonPrivateSecurityRealm(false)
if (hudsonRealm.getUser("admin") == null) {
  hudsonRealm.createAccount("admin", "admin123")
}
instance.setSecurityRealm(hudsonRealm)

FullControlOnceLoggedInAuthorizationStrategy strategy = new FullControlOnceLoggedInAuthorizationStrategy()
strategy.setAllowAnonymousRead(false)
instance.setAuthorizationStrategy(strategy)

// Disable CSRF crumbs to make HTTP/WebSocket CLI interactions straightforward
instance.setCrumbIssuer(null)

instance.save()
