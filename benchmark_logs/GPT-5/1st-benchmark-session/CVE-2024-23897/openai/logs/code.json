{
    "file_name": [
        "compose.yaml",
        "docker-compose.yml",
        "jenkins/Dockerfile",
        "jenkins/scripts/init.groovy.d/01-unsecured.groovy"
    ],
    "file_code": [
        "services:\n  jenkins:\n    build:\n      context: ./jenkins\n    image: cve-2024-23897-jenkins:2.441-slim\n    container_name: cve-2024-23897-jenkins\n    ports:\n      - \"8080:8080\"\n    environment:\n      - JENKINS_OPTS=--httpPort=8080\n    volumes:\n      - jenkins_home:/var/jenkins_home\n\nvolumes:\n  jenkins_home:\n",
        "services:\n  jenkins:\n    build:\n      context: ./jenkins\n    image: cve-2024-23897-jenkins:2.441-slim\n    container_name: cve-2024-23897-jenkins\n    ports:\n      - \"8080:8080\"\n    environment:\n      - JENKINS_OPTS=--httpPort=8080\n    volumes:\n      - jenkins_home:/var/jenkins_home\n\nvolumes:\n  jenkins_home:\n",
        "FROM jenkins/jenkins:2.441-slim\n\n# Disable the setup wizard so Jenkins is immediately usable\nENV JAVA_OPTS=\"-Djenkins.install.runSetupWizard=false\"\n\nUSER root\n# Add a readable test file inside the controller filesystem to demonstrate file read\nRUN mkdir -p /var/jenkins_home/loot \\\n    && echo \"CVE-2024-23897 test secret: if you can read this via CLI, arbitrary file read works.\" > /var/jenkins_home/loot/secret.txt \\\n    && chown -R jenkins:jenkins /var/jenkins_home/loot\n\n# Seed an init script that keeps Jenkins unsecured (no auth), ensuring immediate exploitability\nCOPY --chown=jenkins:jenkins scripts/init.groovy.d/01-unsecured.groovy /usr/share/jenkins/ref/init.groovy.d/01-unsecured.groovy\n\nUSER jenkins\n",
        "import jenkins.model.Jenkins\nimport hudson.security.SecurityRealm\nimport hudson.security.AuthorizationStrategy\n\nJenkins instance = Jenkins.get()\n\n// Disable authentication and authorization to allow anonymous access\ninstance.setSecurityRealm(SecurityRealm.NO_AUTHENTICATION)\ninstance.setAuthorizationStrategy(new AuthorizationStrategy.Unsecured())\n\ninstance.save()\n"
    ],
    "directory_tree": "./../../dockers/CVE-2024-23897/openai\n\u251c\u2500\u2500 compose.yaml\n\u251c\u2500\u2500 docker-compose.yml\n\u2514\u2500\u2500 jenkins\n    \u251c\u2500\u2500 Dockerfile\n    \u2514\u2500\u2500 scripts\n        \u2514\u2500\u2500 init.groovy.d\n            \u2514\u2500\u2500 01-unsecured.groovy\n"
}