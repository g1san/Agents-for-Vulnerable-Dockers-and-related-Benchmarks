{
    "desc": "CVE-2016-5734 is a vulnerability in phpMyAdmin that allows remote code execution through unsafe use of PHP\u2019s preg_replace function with the evaluation modifier. In several code paths (documented most clearly in the table Find/Replace feature), phpMyAdmin incorporated user-controlled input into regular expression parameters without sufficiently preventing the use or effective injection of the evaluation behavior. In affected versions, crafted input can lead preg_replace to evaluate the replacement string as PHP code, causing execution of attacker-supplied code in the context of the web server user. The underlying design flaw is a mix of improper delimiter and modifier handling and reliance on preg_replace\u2019s evaluation capability. On some PHP versions, particularly those prior to PHP 5.4.7, null-termination quirks can allow an injected \u201ce\u201d evaluation modifier to be honored; more broadly, the evaluation modifier itself remained functional (though deprecated) through PHP 5.6 and was removed in PHP 7.0. As a result, the exploitability of this phpMyAdmin bug depends not only on the phpMyAdmin version but also on the PHP runtime behavior. The most reliable practical exploitation reported for this CVE targets environments running PHP 4.3.0 through PHP 5.4.6, where the combination of evaluation behavior and null-byte handling enables the malicious pattern to be interpreted in a way that executes code. Typical prerequisites include a PHP-enabled web server hosting a vulnerable phpMyAdmin release, and a reachable backend MySQL or MariaDB server. Attackers often need authenticated access to phpMyAdmin with the ability to run queries or invoke the Find/Replace functionality; alternatively, they may be able to coerce a logged-in user to trigger the vulnerable flow (cross-site request\u2013like scenarios) if anti-CSRF protections are bypassed within that session context. Successful exploitation allows the attacker to execute arbitrary PHP code with the privileges of the web server user, enabling actions such as writing a web shell, reading or modifying database-stored content, and running system commands according to the web server\u2019s permissions. The issue is fixed in phpMyAdmin 4.6.3 and in the corresponding patched long-term-support lines 4.4.15.7 and 4.0.10.16 by sanitizing parameters and avoiding dangerous use of preg_replace. Affected branches and versions, per authoritative advisories (phpMyAdmin PMASA and NVD), are: 4.0.x before 4.0.10.16, 4.4.x before 4.4.15.7, and 4.6.x before 4.6.3.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "phpmyadmin",
            "version": [
                "4.0.0---4.0.10.15",
                "4.4.0---4.4.15.6",
                "4.6.0---4.6.2"
            ],
            "dependency_type": "HARD",
            "description": "The vulnerable application. These phpMyAdmin versions contain unsafe handling of preg_replace parameters that can lead to arbitrary PHP code execution. Deploying one of these versions is essential to reproduce the vulnerability; choose a branch compatible with the PHP runtime below (for a testable setup, a 4.0.x or 4.4.x build pairs with PHP \u22645.4.6)."
        },
        {
            "name": "php",
            "version": [
                "5.4-apache"
            ],
            "dependency_type": "SOFT-WEB",
            "description": "PHP-enabled web server required to run phpMyAdmin and to expose the vulnerable code path. Using php:5.4-apache provides Apache plus a legacy PHP runtime where preg_replace evaluation semantics and null-byte handling (\u22645.4.6) make exploitation practical. This container serves the phpMyAdmin code."
        },
        {
            "name": "mariadb",
            "version": [
                "10.1"
            ],
            "dependency_type": "SOFT-DB",
            "description": "Relational database backend required by phpMyAdmin to function. Any compatible MySQL or MariaDB works; MariaDB 10.1 is a stable choice that is fully compatible with phpMyAdmin 4.x and supports the features needed to exercise phpMyAdmin\u2019s database operations."
        }
    ],
    "input_tokens": 6426,
    "output_tokens": 7865
}