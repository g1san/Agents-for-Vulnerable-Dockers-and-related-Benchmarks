{
    "file_name": [
        "./../../dockers/CVE-2021-34429/openai/compose.yaml",
        "./../../dockers/CVE-2021-34429/openai/jetty/Dockerfile",
        "./../../dockers/CVE-2021-34429/openai/jetty/webapps/ROOT/index.html",
        "./../../dockers/CVE-2021-34429/openai/jetty/webapps/ROOT/normal.txt",
        "./../../dockers/CVE-2021-34429/openai/jetty/webapps/ROOT/protected/blocked.txt",
        "./../../dockers/CVE-2021-34429/openai/jetty/webapps/ROOT/WEB-INF/web.xml",
        "./../../dockers/CVE-2021-34429/openai/jetty/webapps/ROOT/WEB-INF/secret.txt"
    ],
    "file_code": [
        "services:\n  jetty:\n    build:\n      context: ./jetty\n    image: cve-2021-34429-jetty:9.4.42\n    container_name: cve-2021-34429-jetty\n    ports:\n      - \"8080:8080\"\n    restart: unless-stopped\n",
        "FROM eclipse-temurin:11-jre\n\nARG JETTY_VERSION=9.4.42.v20210604\nENV JETTY_HOME=/opt/jetty \\\n    JETTY_BASE=/var/lib/jetty \\\n    JETTY_VERSION=${JETTY_VERSION}\n\nRUN apt-get update \\\n    && apt-get install -y --no-install-recommends curl ca-certificates tar \\\n    && rm -rf /var/lib/apt/lists/*\n\n# Fetch vulnerable Jetty 9.4.42 distribution\nRUN curl -fsSL https://repo1.maven.org/maven2/org/eclipse/jetty/jetty-distribution/${JETTY_VERSION}/jetty-distribution-${JETTY_VERSION}.tar.gz -o /tmp/jetty.tar.gz \\\n    && mkdir -p /opt \\\n    && tar -xzf /tmp/jetty.tar.gz -C /opt \\\n    && mv /opt/jetty-distribution-${JETTY_VERSION} ${JETTY_HOME} \\\n    && rm /tmp/jetty.tar.gz\n\n# Create a Jetty base with required modules (http, deploy, servlet) for Jetty 9.4\nRUN mkdir -p ${JETTY_BASE}\nWORKDIR ${JETTY_BASE}\nRUN java -jar ${JETTY_HOME}/start.jar --create-startd --add-to-startd=http,deploy,servlet\n\n# Deploy the sample webapp\nCOPY webapps ${JETTY_BASE}/webapps\n\nEXPOSE 8080\nCMD [\"java\", \"-jar\", \"/opt/jetty/start.jar\"]\n",
        "<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\" />\n    <title>CVE-2021-34429 Jetty test app</title>\n  </head>\n  <body>\n    <h1>Jetty vulnerable instance (9.4.42)</h1>\n    <ul>\n      <li><a href=\"/normal.txt\">Normal public file</a></li>\n      <li><a href=\"/protected/blocked.txt\">Protected file (should be blocked)</a></li>\n      <li><a href=\"/WEB-INF/secret.txt\">WEB-INF secret (should be blocked)</a></li>\n    </ul>\n    <p>Use crafted request-target encodings to test path normalization/constraint bypass behavior.</p>\n  </body>\n</html>\n",
        "This is a public file served by Jetty DefaultServlet.\n",
        "This file is under /protected and is covered by a security-constraint. Direct access should be blocked.\n",
        "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<web-app xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd\"\n         version=\"3.1\">\n\n  <display-name>cve-2021-34429-testapp</display-name>\n\n  <!-- Explicit DefaultServlet so static files are served -->\n  <servlet>\n    <servlet-name>default</servlet-name>\n    <servlet-class>org.eclipse.jetty.servlet.DefaultServlet</servlet-class>\n    <init-param>\n      <param-name>dirAllowed</param-name>\n      <param-value>false</param-value>\n    </init-param>\n  </servlet>\n  <servlet-mapping>\n    <servlet-name>default</servlet-name>\n    <url-pattern>/</url-pattern>\n  </servlet-mapping>\n\n  <!-- Security constraint protecting /protected/* without providing credentials -->\n  <!-- This will normally yield 403 for direct access. -->\n  <security-constraint>\n    <web-resource-collection>\n      <web-resource-name>Protected Area</web-resource-name>\n      <url-pattern>/protected/*</url-pattern>\n    </web-resource-collection>\n    <auth-constraint/>\n  </security-constraint>\n\n  <!-- Rely on container semantics disallowing direct access to /WEB-INF/*, -->\n  <!-- combined with path normalization behavior relevant to the CVE. -->\n\n  <welcome-file-list>\n    <welcome-file>index.html</welcome-file>\n  </welcome-file-list>\n</web-app>\n",
        "This is a secret file under WEB-INF that should not be directly retrievable.\n"
    ],
    "directory_tree": "./../../dockers/CVE-2021-34429/openai\n\u251c\u2500\u2500 compose.yaml\n\u2514\u2500\u2500 jetty\n    \u251c\u2500\u2500 Dockerfile\n    \u2514\u2500\u2500 webapps\n        \u2514\u2500\u2500 ROOT\n            \u251c\u2500\u2500 WEB-INF\n            \u2502   \u251c\u2500\u2500 secret.txt\n            \u2502   \u2514\u2500\u2500 web.xml\n            \u251c\u2500\u2500 index.html\n            \u251c\u2500\u2500 normal.txt\n            \u2514\u2500\u2500 protected\n                \u2514\u2500\u2500 blocked.txt\n"
}