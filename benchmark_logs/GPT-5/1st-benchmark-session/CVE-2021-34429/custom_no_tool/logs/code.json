{
    "file_name": [
        "./../../dockers/CVE-2021-34429/custom_no_tool/docker-compose.yml",
        "./../../dockers/CVE-2021-34429/custom_no_tool/jetty/Dockerfile",
        "./../../dockers/CVE-2021-34429/custom_no_tool/jetty/docker-entrypoint.sh",
        "./../../dockers/CVE-2021-34429/custom_no_tool/jetty/start.ini",
        "./../../dockers/CVE-2021-34429/custom_no_tool/jetty/webapp/index.html",
        "./../../dockers/CVE-2021-34429/custom_no_tool/jetty/webapp/WEB-INF/web.xml",
        "./../../dockers/CVE-2021-34429/custom_no_tool/jetty/contexts/ROOT.xml"
    ],
    "file_code": [
        "version: \"3.8\"\nservices:\n  jetty:\n    build:\n      context: ./jetty\n      dockerfile: Dockerfile\n    image: cve-2021-34429-jetty:9.4.42\n    container_name: cve-2021-34429-jetty\n    ports:\n      - \"8080:8080\"\n",
        "FROM eclipse-temurin:11-jre\n\nARG JETTY_VERSION=9.4.42.v20210604\nENV JETTY_HOME=/opt/jetty \\\n    JETTY_BASE=/var/lib/jetty\n\n# Minimal tools to fetch Jetty\nRUN apt-get update \\\n    && apt-get install -y --no-install-recommends curl ca-certificates \\\n    && rm -rf /var/lib/apt/lists/*\n\n# Create user\nRUN useradd -ms /bin/bash jetty\n\n# Fetch vulnerable Jetty Home (9.4.42) and place it at /opt/jetty\nRUN curl -fsSL \\\n      https://repo1.maven.org/maven2/org/eclipse/jetty/jetty-home/${JETTY_VERSION}/jetty-home-${JETTY_VERSION}.tar.gz \\\n      -o /tmp/jetty-home.tgz \\\n    && mkdir -p /opt \\\n    && tar -xzf /tmp/jetty-home.tgz -C /opt \\\n    && mv /opt/jetty-home-${JETTY_VERSION} \"$JETTY_HOME\" \\\n    && rm -f /tmp/jetty-home.tgz\n\n# Prepare Jetty Base directories\nWORKDIR \"$JETTY_BASE\"\nRUN mkdir -p \"$JETTY_BASE/webapps\" \"$JETTY_BASE/contexts\"\n\n# Provide explicit runtime configuration via start.ini (ensures modules are enabled)\nCOPY --chown=jetty:jetty start.ini \"$JETTY_BASE/start.ini\"\n\n# Add the demo webapp under ROOT context and explicit context descriptor\nCOPY --chown=jetty:jetty webapp \"$JETTY_BASE/webapps/ROOT\"\nCOPY --chown=jetty:jetty contexts/ROOT.xml \"$JETTY_BASE/contexts/ROOT.xml\"\n\n# Runtime entrypoint\nCOPY docker-entrypoint.sh /usr/local/bin/docker-entrypoint.sh\nRUN chown jetty:jetty /usr/local/bin/docker-entrypoint.sh \\\n    && chmod +x /usr/local/bin/docker-entrypoint.sh \\\n    && chown -R jetty:jetty \"$JETTY_HOME\" \"$JETTY_BASE\"\n\nEXPOSE 8080\nUSER jetty\nENTRYPOINT [\"/usr/local/bin/docker-entrypoint.sh\"]\n",
        "#!/usr/bin/env bash\nset -e\n\n# Start Jetty with an explicit base to ensure runtime discovers modules/configs\nexec java -Djetty.base=\"$JETTY_BASE\" -jar \"$JETTY_HOME/start.jar\"\n",
        "## Jetty runtime configuration (modules and properties)\n--module=server\n--module=http\n--module=deploy\n--module=webapp\n\n# HTTP connector\njetty.http.port=8080\n",
        "<!doctype html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\" />\n    <title>Jetty CVE-2021-34429 Test App</title>\n    <style>\n      body { font-family: sans-serif; margin: 2rem; }\n      code { background: #f2f2f2; padding: .1rem .3rem; }\n    </style>\n  </head>\n  <body>\n    <h1>Jetty CVE-2021-34429 Test App</h1>\n    <p>This minimal webapp includes a standard non-web-accessible <code>WEB-INF/web.xml</code> file.</p>\n    <p>Requesting <code>/WEB-INF/web.xml</code> should normally be forbidden.</p>\n  </body>\n</html>\n",
        "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<web-app xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd\"\n         version=\"3.1\">\n  <display-name>CVE-2021-34429 Test App</display-name>\n  <context-param>\n    <param-name>secret</param-name>\n    <param-value>super-secret-config</param-value>\n  </context-param>\n</web-app>\n",
        "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE Configure PUBLIC \"-//Mort Bay Consulting//DTD Configure//EN\" \"http://www.eclipse.org/jetty/configure_9_3.dtd\">\n<Configure class=\"org.eclipse.jetty.webapp.WebAppContext\">\n  <Set name=\"contextPath\">/</Set>\n  <Set name=\"war\"><SystemProperty name=\"jetty.base\"/>/webapps/ROOT</Set>\n</Configure>\n"
    ],
    "directory_tree": "./../../dockers/CVE-2021-34429/custom_no_tool\n\u251c\u2500\u2500 docker-compose.yml\n\u2514\u2500\u2500 jetty\n    \u251c\u2500\u2500 Dockerfile\n    \u251c\u2500\u2500 docker-entrypoint.sh\n    \u251c\u2500\u2500 start.ini\n    \u251c\u2500\u2500 contexts\n    \u2502   \u2514\u2500\u2500 ROOT.xml\n    \u2514\u2500\u2500 webapp\n        \u251c\u2500\u2500 index.html\n        \u2514\u2500\u2500 WEB-INF\n            \u2514\u2500\u2500 web.xml\n"
}