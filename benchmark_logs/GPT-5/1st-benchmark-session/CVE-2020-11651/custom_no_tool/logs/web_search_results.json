{
    "desc": "CVE-2020-11651 is a critical flaw in SaltStack Salt that arises from improper authorization on the master\u2019s unauthenticated \u201cClear\u201d request channel, which is served over ZeroMQ on the salt-master\u2019s default TCP port 4506. Internally, Salt exposes a ClearFuncs interface intended to handle non-authenticated requests. In affected releases, this interface insufficiently validates which methods can be invoked, allowing a remote, unauthenticated client to call sensitive Clear channel methods that should require authentication. As a result, an attacker with only network reachability to the salt-master on port 4506 can: (1) invoke methods that return sensitive authentication material (such as the master\u2019s root key or user tokens), and then (2) use privileged capabilities normally restricted to authenticated users, including runner, wheel, and publish actions. These capabilities enable full compromise of the master and, from there, control over connected minions. Practically, attackers can first retrieve the master\u2019s root key and then schedule or directly execute arbitrary commands on the master itself (via runners that execute on the master process) and broadcast jobs to all active minions (via the publish mechanism), resulting in complete takeover of the Salt infrastructure. The defect impacts Salt versions prior to the fixed releases: all 2019.2.x versions before 2019.2.4, and all 3000.x versions before 3000.2. Exploitation requires no valid credentials and no prior foothold, only network access to the master\u2019s Clear channel (tcp/4506). Remediation is to upgrade the master to 2019.2.4 or 3000.2 (or later) so that ClearFuncs correctly enforces method restrictions. Note that file read/write path traversal issues often discussed alongside this vulnerability correspond to CVE-2020-11652; CVE-2020-11651 is specifically the authentication bypass on the Clear channel that leads to arbitrary command execution on the master and command publication to minions.",
    "attack_type": "remote code execution through authentication bypass over a network-exposed service",
    "services": [
        {
            "name": "saltstack/salt",
            "version": [
                "2019.2.0---2019.2.3",
                "3000.0---3000.1"
            ],
            "dependency_type": "HARD",
            "description": "Runs the Salt master (salt-master) process that exposes the vulnerable unauthenticated Clear ZeroMQ request server on tcp/4506. No additional services are required to make the instance vulnerable or to exercise the flaw; a single master with port 4506 reachable is sufficient."
        }
    ],
    "input_tokens": 4985,
    "output_tokens": 5818
}