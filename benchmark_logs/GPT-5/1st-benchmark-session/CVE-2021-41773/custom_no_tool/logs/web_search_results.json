{
    "desc": "CVE-2021-41773 is a vulnerability in Apache HTTP Server where a flaw in the core path normalization logic introduced in version 2.4.49 allows crafted Uniform Resource Locator paths to traverse outside intended directories. Specifically, the ap_normalize_path routine performs insufficient decoding and normalization of dot-segments, so specially encoded traversal sequences such as .%2e/ can bypass checks and be mapped to filesystem locations outside the configured document root or outside directories referenced by Alias-like directives. When those external locations are not explicitly protected by access controls such as Require all denied, an unauthenticated remote user can retrieve arbitrary files that the web server process can read, leading to unintended file disclosure (for example, accessing /etc/passwd). The impact can escalate if Common Gateway Interface support is enabled on aliased paths: traversal into a Common Gateway Interface-enabled location may allow invoking interpreters or scripts in a way that results in remote code execution under the web server\u2019s privileges. This issue was observed being exploited in the wild. Apache 2.4.50 shipped an incomplete fix for the same code path, which resulted in a closely related but distinct vulnerability tracked as CVE-2021-42013; Apache 2.4.51 contains the corrected, complete fix. Recommended mitigations are to upgrade to 2.4.51 or later, ensure that directories outside the intended web content tree are protected with explicit deny rules (for example, a Directory \"/\" block with Require all denied), avoid overly broad Require all granted directives, and restrict or disable Common Gateway Interface and public cgi-bin aliases unless strictly necessary.",
    "attack_type": "Directory traversal leading to arbitrary file disclosure with potential remote code execution when Common Gateway Interface is enabled",
    "services": [
        {
            "name": "httpd",
            "version": [
                "2.4.49"
            ],
            "dependency_type": "HARD",
            "description": "Apache HTTP Server is the vulnerable component; running version 2.4.49 with typical configuration (for example, an Alias or ScriptAlias path without an overriding Require all denied) is sufficient to expose the path traversal/file disclosure flaw, and if Common Gateway Interface is enabled on such a path it can enable remote code execution. No additional services are required to make a minimal, network-accessible and testable vulnerable system."
        }
    ],
    "input_tokens": 35931,
    "output_tokens": 5857
}