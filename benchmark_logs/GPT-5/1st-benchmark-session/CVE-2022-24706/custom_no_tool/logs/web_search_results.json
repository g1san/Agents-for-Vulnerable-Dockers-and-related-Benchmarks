{
    "desc": "CVE-2022-24706 is a critical vulnerability in Apache CouchDB (all releases prior to 3.2.2) that stems from insecure defaults in its Erlang/OTP distribution configuration. In affected versions, a CouchDB node starts an Erlang distribution listener on a randomly chosen TCP port and registers that port with the Erlang Port Mapper Daemon (epmd), which listens on TCP/4369. Historically, many CouchDB packages set a fixed, known Erlang distribution cookie value (commonly \u201cmonster\u201d) for both single\u2011node and clustered deployments. That cookie is the sole authenticator for Erlang inter\u2011node communication. When epmd (4369) and the Erlang distribution port are reachable from outside the host, a remote party can query epmd to discover the CouchDB node and its random port and then authenticate to the Erlang distribution as a peer node using the default cookie. This allows execution of Erlang commands that map to operating system command execution, effectively granting administrative control over the CouchDB instance without any HTTP authentication. The impact includes full administrative access to the database and the ability to execute arbitrary operating system commands under the CouchDB service account, which has been observed in the wild for activities such as deploying unauthorized processes. Systems that bind epmd and the Erlang distribution port to localhost or firewall them (exposing only the HTTP API on TCP/5984) are not vulnerable. The issue is fixed in CouchDB 3.2.2 and later, which reject the default cookie and bind epmd and the distribution port to the loopback interface by default; additional recommended mitigations include setting a unique Erlang cookie and restricting network exposure.",
    "attack_type": "Unauthenticated remote code execution leading to administrative access",
    "services": [
        {
            "name": "couchdb",
            "version": [
                "0---3.2.1",
                "3.2.1"
            ],
            "dependency_type": "HARD",
            "description": "Apache CouchDB server (official Docker Hub image). Versions prior to 3.2.2 start an Erlang node that registers with epmd (TCP/4369) and may use the default Erlang distribution cookie set by packaging. When the container\u2019s epmd and the Erlang distribution port are reachable from outside the host, the instance is vulnerable as described. epmd and the Erlang distribution listener are part of the CouchDB runtime; no separate epmd service is required."
        }
    ],
    "input_tokens": 11968,
    "output_tokens": 6444
}