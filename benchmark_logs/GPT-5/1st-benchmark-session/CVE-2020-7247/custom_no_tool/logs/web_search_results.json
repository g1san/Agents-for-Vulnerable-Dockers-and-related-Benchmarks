{
    "desc": "CVE-2020-7247 is a critical flaw in OpenSMTPD, the mail transfer agent that implements the Simple Mail Transfer Protocol (SMTP). The vulnerability resides in smtp_session.c (function smtp_mailaddr) and stems from a logic error that returns success when input validation actually fails. As a result, when a remote peer supplies an email address containing shell metacharacters in the SMTP MAIL FROM command, OpenSMTPD\u2019s address parsing and subsequent handling fail to properly escape dangerous characters. This incorrect validation allows attacker-controlled input to reach a command execution path. In practical terms, a network attacker who can speak SMTP to the service can inject shell syntax in the sender address of a crafted SMTP session, leading the daemon to execute arbitrary operating system commands. Multiple analyses (Qualys, Debian Security Tracker, Rapid7, NVD) consistently report that exploitation is possible in the default, uncommented configuration and that successful exploitation yields command execution with root privileges on affected systems. The issue became exploitable following the \u201cnew grammar\u201d change introduced in the portable OpenSMTPD line (observed in versions around 6.4.x and 6.6.x), and it was fixed by OpenSMTPD commit 2afab2297347342f81fa31a75bbbf7dbee614fda and released in version 6.6.2 and later. Impact is full system compromise of the host running the SMTP service. The attack surface is any network-exposed OpenSMTPD instance that accepts SMTP sessions. Mitigation is to upgrade to OpenSMTPD 6.6.2 or newer (or apply the vendor patches provided for affected operating systems).",
    "attack_type": "Remote code execution through command injection",
    "services": [
        {
            "name": "instrumentisto/opensmtpd",
            "version": [
                "6.4.0---6.6.1",
                "6.6"
            ],
            "dependency_type": "HARD",
            "description": "OpenSMTPD daemon providing the vulnerable SMTP service. This single service is sufficient to expose the vulnerability; no external database, cache, message queue, or web server is required for a working, network-reachable SMTP endpoint."
        }
    ],
    "input_tokens": 3652,
    "output_tokens": 4876
}