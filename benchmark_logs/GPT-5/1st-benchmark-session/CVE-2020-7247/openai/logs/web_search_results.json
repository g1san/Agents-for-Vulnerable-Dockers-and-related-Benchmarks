{
    "desc": "CVE-2020-7247 is an input-validation flaw in OpenSMTPD\u2019s SMTP session address parser (smtp_mailaddr in smtp_session.c). An incorrect return on failed validation allows crafted MAIL FROM addresses containing shell metacharacters to pass, leading to operating system command injection during local delivery. The issue affects OpenSMTPD 6.6 (including portable builds used on Linux and OpenBSD 6.6). In typical mbox-based local delivery, commands may execute with superuser privileges; with LMTP, execution occurs as an unprivileged user. Remote, unauthenticated exploitation is possible when the daemon listens on all interfaces and accepts external mail; otherwise, exploitation is limited to local senders in loopback-only configurations. The bug was disclosed by Qualys in Jan 2020, assigned a CVSS v3.1 score of 9.8, and fixed by OpenBSD errata 019 with corresponding portable release updates (e.g., 6.6.2p1).",
    "attack_type": "Remote Code Execution (OS command injection); Local Privilege Escalation",
    "services": [
        {
            "name": "OpenSMTPD (portable)",
            "version": [
                "6.6",
                "6.6.1p1"
            ],
            "dependency_type": "HARD",
            "description": "Vulnerable mail transfer agent required to reproduce CVE-2020-7247. Configure to listen on 0.0.0.0:25 and use local mbox delivery to expose the command-injection path. Use a known vulnerable portable build (e.g., 6.6 or 6.6.1p1; fixed in 6.6.2p1)."
        },
        {
            "name": "debian",
            "version": [
                "buster-slim"
            ],
            "dependency_type": "HARD",
            "description": "Base container image to install and run the portable OpenSMTPD 6.6.x series. Official, pin-able tag that readily builds/runs the vulnerable OpenSMTPD and exposes SMTP on the network without extra services."
        }
    ],
    "input_tokens": 155234,
    "output_tokens": 8858
}