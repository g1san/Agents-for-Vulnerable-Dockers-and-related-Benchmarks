{
    "desc": "JetBrains TeamCity On-Premises (self-hosted server) prior to 2023.05.4 is vulnerable to an authentication bypass caused by an overly permissive RequestInterceptors path rule that disables pre-handling (including authentication) for any request ending in \"/RPC2.\" An unauthenticated attacker can call the hidden REST route \"/app/rest/users/{userLocator}/tokens/{name}\" with the token name \"RPC2,\" causing the path to match \"/**/RPC2\" and skip authentication. The server then issues a valid token (e.g., for the administrator), enabling full administrative access and remote code execution via legitimate admin features (e.g., plugin upload). Impact: complete server takeover; CVSS v3.1 base score 9.8. Affected: TeamCity On-Premises before 2023.05.4 (TeamCity Cloud unaffected). Fixed in 2023.05.4; mitigation plugin available for older versions. Documented active exploitation (CISA KEV). TeamCity listens on TCP 8111 by default.",
    "attack_type": "Authentication bypass leading to remote code execution (RCE)",
    "services": [
        {
            "name": "jetbrains/teamcity-server",
            "version": [
                "before 2023.05.4",
                "2023.05.3"
            ],
            "dependency_type": "HARD",
            "description": "The vulnerable TeamCity server itself; includes embedded Tomcat and JRE and can run with the built-in evaluation database. Expose TCP 8111 to reach the HTTP UI/API."
        }
    ],
    "input_tokens": 425812,
    "output_tokens": 6618
}