{
    "desc": "CVE-2021-43798 is a directory traversal flaw in self\u2011hosted Grafana 8.x that allows an unauthenticated remote attacker to read arbitrary local files from the server hosting Grafana. The vulnerability resides in the HTTP handler that serves public plugin assets under the path /public/plugins/<plugin-id>/. User\u2011supplied paths are improperly sanitized, so sequences that traverse directories can escape the intended plugin directory and access files elsewhere on the filesystem. Because Grafana ships with several plugins enabled by default (for example: alertlist, annolist, barchart, bargauge, candlestick, cloudwatch, dashlist, elasticsearch, prometheus, mysql), most installations expose at least one valid plugin identifier, making the issue widely exploitable without prior authentication.\n\nImpact: The flaw enables arbitrary local file read, which is a high confidentiality exposure with no direct integrity or availability impact. Sensitive files commonly exposed include Grafana\u2019s main configuration (grafana.ini or defaults.ini) that contains secret_key and other sensitive settings, and the embedded SQLite database at /var/lib/grafana/grafana.db (holding user accounts, salts, password hashes, API tokens, and data source credentials). With access to grafana.db, attackers can perform offline password cracking against PBKDF2-HMAC-SHA256 hashes, potentially obtaining administrator access to the Grafana user interface and further abusing built-in capabilities (for example, installing plugins) to maintain persistence. The issue is reachable over Grafana\u2019s built-in web server (default TCP port 3000) and requires only a crafted HTTP request. Some HTTP clients normalize paths automatically; successful exploitation may require a client or proxy that preserves traversal sequences.\n\nRoot cause: Inadequate path normalization and validation in the public plugin assets endpoint, including misuse of path cleaning logic in Go that failed to prevent directory traversal. A previously surfaced static analysis warning was not heeded, leaving the handler susceptible to traversal sequences that escape the plugin directory. Grafana Cloud was not affected.\n\nAffected versions and fixes: All self\u2011hosted Grafana releases from 8.0.0\u2011beta1 through 8.3.0 are vulnerable. The issue was fixed in 8.0.7, 8.1.8, 8.2.7, and 8.3.1. Severity is high (CVSS v3.1 base score 7.5) due to remote, unauthenticated exploitation with high confidentiality impact. The disclosure timeline indicates public disclosure on December 3, 2021 and fixes released on December 7, 2021. Recommended mitigations are to upgrade to a fixed version and rotate credentials, tokens, and data source passwords; as a temporary defense, place Grafana behind a reverse proxy that normalizes request paths to eliminate traversal sequences.",
    "attack_type": "Unauthenticated directory traversal leading to arbitrary local file read",
    "services": [
        {
            "name": "grafana/grafana",
            "version": [
                "8.0.0-beta1---8.3.0"
            ],
            "dependency_type": "HARD",
            "description": "Grafana provides the vulnerable HTTP service and built-in web server (default port 3000). No external database or web server is required because Grafana uses an embedded SQLite database by default and serves HTTP directly, so this single container is sufficient to create a working and testable environment that is vulnerable to CVE-2021-43798."
        }
    ],
    "input_tokens": 12183,
    "output_tokens": 7041
}