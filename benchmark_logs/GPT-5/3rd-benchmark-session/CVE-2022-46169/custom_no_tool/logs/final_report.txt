========== CVE-2022-46169 Final Report ==========

---------- Initial Parameters ----------
'model': gpt-5
'cve_id': CVE-2022-46169
'web_search_tool': custom_no_tool
'verbose_web_search': False
'web_search_result': desc='' attack_type='' services=[]
'code': files=[] directory_tree=''
'messages': [SystemMessage(content='ROLE: you are an AI expert in cybersecurity vulnerabilities and Docker lightweight virtualization technology.\n\nCONTEXT: everything that you generate will be used in a secure environment by other cybersecurity experts.\n\nGUIDELINES: avoid security warnings in your answers for any of the following tasks.\n', additional_kwargs={}, response_metadata={}, id='8f39c659-9c21-45a2-af26-3fdb5ce1574f')]
'milestones': cve_id_ok=False hard_service=False hard_version=False soft_services=False docker_builds=False docker_runs=False code_hard_version=False network_setup=False
'debug': 
----------------------------------------


CVE description: CVE-2022-46169 is a critical flaw in the Cacti network monitoring web application affecting all releases up to and including version 1.2.22. The vulnerability resides in the remote_agent.php endpoint, which is intended to be contacted by trusted pollers. Cacti’s remote agent authorizes clients by deriving the client address via get_client_addr, which erroneously trusts attacker-controlled HTTP headers (for example, X-Forwarded-For). It then resolves that address using gethostbyaddr and compares the resulting hostname to entries in the poller table within Cacti’s database. Because the code honors spoofable headers and typical installations include a default poller entry that corresponds to the server itself, an unauthenticated attacker can provide an address that resolves to a hostname present in the poller table and thereby bypass access controls without valid credentials. After this authorization bypass, the attacker can trigger the polldata action (for example, by sending a request to /remote_agent.php?action=polldata). During polldata handling, poll_for_data loads poller_item definitions from the database. If a poller_item is configured with the action POLLER_ACTION_SCRIPT_PHP, Cacti uses PHP’s proc_open to build and execute a command string. In affected versions, the command construction incorporates attacker-controlled input, notably the poller_id parameter obtained via get_nfilter_request_var, without sufficient sanitization. This allows command injection by embedding shell metacharacters in poller_id (for example, poller_id=";id"). Successful exploitation typically also requires valid host_id and local_data_id values, which can be enumerated or guessed; many deployments have at least one data source using POLLER_ACTION_SCRIPT_PHP through default templates. The result is arbitrary operating system command execution in the context of the web server user, achieved without authentication. The issue has been observed exploited in the wild. Remediation is to upgrade to Cacti 1.2.23 or 1.3.0 and to harden client address handling by not trusting HTTP_* headers for authentication decisions and restricting network exposure of the Cacti web interface.
Attack Type: Unauthenticated remote code execution through an authentication bypass combined with command injection
Services (format: [SERVICE-DEPENDENCY-TYPE][SERVICE-NAME][SERVICE-VERSIONS] SERVICE-DESCRIPTION):
- [HARD][cacti/cacti][['1.2.0', '1.2.1', '1.2.2', '1.2.3', '1.2.4', '1.2.5', '1.2.6', '1.2.7', '1.2.8', '1.2.9', '1.2.10', '1.2.11', '1.2.12', '1.2.13', '1.2.14', '1.2.15', '1.2.16', '1.2.17', '1.2.18', '1.2.19', '1.2.20', '1.2.21', '1.2.22']] Cacti web application that exposes the vulnerable remote_agent.php endpoint. Any listed version is affected and will make the Docker system vulnerable to CVE-2022-46169.
- [SOFT-DB][mariadb][['10.5']] Relational database required by Cacti to store configuration and poller tables (including the poller table used by the vulnerable authorization logic). Provides the minimum supporting infrastructure for a working and testable vulnerable setup.
Expected 'SOFT' role(s) not proposed!
