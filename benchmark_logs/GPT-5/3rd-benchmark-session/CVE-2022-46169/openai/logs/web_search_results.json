{
    "desc": "CVE-2022-46169 is a critical unauthenticated command injection in Cacti\u2019s remote_agent.php leading to arbitrary OS command execution as the web server user. The script derives client IP from HTTP headers (via get_client_addr) and compares the resolved hostname to entries in the poller table for \u201cauthorization.\u201d Because proxy/forwarding headers are trusted, an attacker can spoof the source IP to pass this check without authentication. After bypass, the polldata action calls poll_for_data, where attacker-controlled poller_id (retrieved as a raw string) is concatenated into a shell command executed via proc_open when a poller item uses POLLER_ACTION_SCRIPT_PHP\u2014commonly true in default device templates. Affected versions include Cacti up to and including 1.2.22 (also 1.0.x and 1.1.x series per OSV). Fixed in 1.2.23 and 1.3.0 by restricting trusted proxy headers, validating poller_id as integer, and escaping shell arguments.",
    "attack_type": "Unauthenticated RCE via command injection",
    "services": [
        {
            "name": "php",
            "version": [
                "8.0-apache"
            ],
            "dependency_type": "HARD",
            "description": "Hosts the vulnerable Cacti web application (Cacti \u2264 1.2.22 or other affected releases installed inside this container). This is the component where CVE-2022-46169 resides; required to expose remote_agent.php and trigger the vulnerable code path."
        },
        {
            "name": "mariadb",
            "version": [
                "10.6"
            ],
            "dependency_type": "SOFT",
            "description": "Database required by Cacti for installation and runtime (schema, users, poller tables and items). Not the vulnerable component but necessary for a working, testable deployment where the flaw is reachable."
        }
    ],
    "input_tokens": 34803,
    "output_tokens": 5898
}