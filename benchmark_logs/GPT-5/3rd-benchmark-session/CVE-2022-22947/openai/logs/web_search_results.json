{
    "desc": "CVE-2022-22947 is a critical unauthenticated RCE in Spring Cloud Gateway when the Spring Boot Actuator \u201cgateway\u201d endpoint is enabled, exposed, and unsecured. In vulnerable versions, attacker-controlled route definitions are evaluated via Spring Expression Language in a permissive StandardEvaluationContext, enabling arbitrary method invocation and OS command execution. Fixes switch to SimpleEvaluationContext to restrict capabilities. Practical impact: remote execution within the Java process with full CIA impact (CVSS v3 10.0). Affected when all are true: (1) app uses a vulnerable Spring Cloud Gateway version; (2) actuator gateway endpoint is enabled; (3) it is network-reachable and not protected. Vulnerable releases include 3.1.0, and 3.0.0\u20133.0.6 (older unsupported versions also affected). Fixed in 3.1.1+ and 3.0.7+. Packaging note: Gateway is a library; a vulnerable, testable container is a Spring Boot app that depends on a vulnerable Gateway version and exposes the actuator gateway endpoint, running on a Java base image.",
    "attack_type": "Unauthenticated Remote Code Execution (RCE) via actuator gateway management API expression injection",
    "services": [
        {
            "name": "eclipse-temurin",
            "version": [
                "11-jre",
                "17-jre"
            ],
            "dependency_type": "SOFT",
            "description": "Provides the Java runtime to run the Spring Boot/Spring Cloud Gateway app. Spring Cloud Gateway 3.x commonly runs on Java 11 or 17. Eclipse Temurin is the official OpenJDK distribution on Docker Hub."
        },
        {
            "name": "custom-spring-cloud-gateway-app",
            "version": [
                "Spring Cloud Gateway 3.1.0",
                "Spring Cloud Gateway 3.0.0",
                "Spring Cloud Gateway 3.0.1",
                "Spring Cloud Gateway 3.0.2",
                "Spring Cloud Gateway 3.0.3",
                "Spring Cloud Gateway 3.0.4",
                "Spring Cloud Gateway 3.0.5",
                "Spring Cloud Gateway 3.0.6"
            ],
            "dependency_type": "HARD",
            "description": "A custom image built FROM eclipse-temurin that packages a Spring Boot application depending on a vulnerable Spring Cloud Gateway version and with the actuator gateway endpoint enabled, exposed, and unsecured. This is the component that makes the system vulnerable; no database, message queue, reverse proxy, or cache is required for exploitability."
        }
    ],
    "input_tokens": 27099,
    "output_tokens": 4387
}