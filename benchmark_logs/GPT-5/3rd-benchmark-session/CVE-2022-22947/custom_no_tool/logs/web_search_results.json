{
    "desc": "CVE-2022-22947 is a critical vulnerability in Spring Cloud Gateway that arises when the Spring Boot Actuator\u2019s Gateway endpoints are enabled, exposed over the network, and left without adequate security controls. In such configurations, a remote, unauthenticated attacker can send specially crafted requests to the Actuator\u2019s Gateway routes management endpoints. The root issue is an expression injection flaw in how route filter arguments are processed\u2014specifically, attacker-controlled values can be interpreted as Spring Expression Language (SpEL). By creating or updating a route via the Actuator API with malicious SpEL content and then triggering a refresh of the gateway routes, the application evaluates the injected expression. This evaluation enables arbitrary command or code execution with the privileges of the running Spring Cloud Gateway process inside the container or on the host where the container runs. The attack sequence typically involves: posting a route definition that embeds a malicious SpEL payload in filter arguments, invoking the refresh operation to apply the new configuration (thereby evaluating the expression), optionally querying the route for confirmation, and then, if desired, deleting the route and refreshing again to cover tracks. The vulnerability is remotely exploitable without prior authentication when the Gateway Actuator endpoint is reachable from the attacker\u2019s network location. Impact includes full compromise of confidentiality, integrity, and availability of the affected service, often leading to system takeover. According to Spring\u2019s advisory and NVD/MITRE metadata, affected releases include Spring Cloud Gateway 3.1.0 and 3.0.0 through 3.0.6, as well as older, unsupported versions. Remediation is to upgrade to fixed versions (3.1.1+ for the 3.1.x line, 3.0.7+ for the 3.0.x line), and to harden or disable the Actuator Gateway endpoint (for example, disable it if not needed or protect it with Spring Security and network access controls).",
    "attack_type": "Remote code execution via remote, unauthenticated code injection in an exposed and unsecured management endpoint",
    "services": [
        {
            "name": "bitnami/spring-cloud-gateway",
            "version": [
                "3.1.0",
                "3.0.6",
                "3.0.5",
                "3.0.4",
                "3.0.3",
                "3.0.2",
                "3.0.1",
                "3.0.0"
            ],
            "dependency_type": "HARD",
            "description": "Spring Cloud Gateway itself, which contains the vulnerable Actuator Gateway endpoints when enabled and exposed. Using these specific image tags corresponds to the vulnerable versions identified by Spring and NVD. No additional services are strictly required to make a working, testable instance; the vulnerability is triggered solely by enabling and exposing the Actuator Gateway endpoint within this service."
        }
    ],
    "input_tokens": 4849,
    "output_tokens": 2255
}