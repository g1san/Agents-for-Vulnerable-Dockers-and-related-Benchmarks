{
    "desc": "CVE-2022-22963 is a critical vulnerability in Spring Cloud Function\u2019s routing feature. In affected releases, the framework allows a user to influence the routing-expression that determines which function should handle an incoming request. That routing-expression is interpreted by the Spring Expression Language (SpEL). In Spring Cloud Function 3.1.6, 3.2.2, and all older unsupported versions, the value supplied by the client is not properly validated before being evaluated in a StandardEvaluationContext. As a result, an attacker can craft a malicious SpEL payload that gets evaluated on the server side. Because SpEL can reach powerful Java APIs (including java.lang.Runtime), a successful attack can execute arbitrary commands, read or modify local files and environment variables, and generally access local resources with the privileges of the running process. The attack vector is typically an HTTP request to a function endpoint where the attacker controls the header named \"spring.cloud.function.routing-expression\" (or any equivalent input path an application uses for routing). When the application uses Spring Cloud Function\u2019s routing and is deployed with the vulnerable versions, simply sending a crafted HTTP request causes the server to evaluate the attacker\u2019s SpEL and run arbitrary code. The exposure applies across deployment models (traditional apps, serverless adapters) so long as the routing feature is exposed and the attacker can supply the routing-expression. The issue is fixed in Spring Cloud Function 3.1.7 and 3.2.3 by validating and restricting expression evaluation. Mitigation is to upgrade to those fixed versions; no additional hardening steps are required once upgraded.",
    "attack_type": "Remote code execution",
    "services": [
        {
            "name": "eclipse-temurin",
            "version": [
                "Spring Cloud Function 3.1.6",
                "Spring Cloud Function 3.2.2"
            ],
            "dependency_type": "HARD",
            "description": "Application container based on a Java runtime that includes a Spring Cloud Function application with the vulnerable library. These are the specific Spring Cloud Function versions cited by authoritative sources (NVD/MITRE) as vulnerable. Packaging the app into this container and exposing the routing feature makes the system vulnerable."
        },
        {
            "name": "eclipse-temurin",
            "version": [
                "11-jre"
            ],
            "dependency_type": "SOFT",
            "description": "Java Runtime Environment required to run the Spring Cloud Function application inside the container. Any compatible Java 8+ works; 11-jre is a common choice and compatible with the vulnerable Spring Cloud Function versions."
        }
    ],
    "input_tokens": 10491,
    "output_tokens": 2011,
    "query": "CVE-2022-22963 Spring Cloud Function routing expression RCE details versions affected fixed PoC"
}