{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-41773/custom_no_tool/docker-compose.yml",
            "content": "version: \"3.8\"\nservices:\n  httpd:\n    build:\n      context: ./httpd\n    image: cve-2021-41773-httpd:2.4.49\n    ports:\n      - \"80:80\"\n    restart: unless-stopped\n"
        },
        {
            "location": "./../../dockers/CVE-2021-41773/custom_no_tool/httpd/Dockerfile",
            "content": "FROM httpd:2.4.49\n\n# Copy custom Apache configuration and web content\nCOPY conf/httpd.conf /usr/local/apache2/conf/httpd.conf\nCOPY htdocs/ /usr/local/apache2/htdocs/\nCOPY cgi-bin/ /usr/local/apache2/cgi-bin/\n\n# Ensure CGI scripts are executable\nRUN chmod +x /usr/local/apache2/cgi-bin/*.cgi\n\nEXPOSE 80\nCMD [\"httpd-foreground\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2021-41773/custom_no_tool/httpd/conf/httpd.conf",
            "content": "ServerRoot \"/usr/local/apache2\"\nListen 80\nServerName localhost:80\n\nLoadModule mpm_event_module modules/mod_mpm_event.so\nLoadModule authn_core_module modules/mod_authn_core.so\nLoadModule authz_core_module modules/mod_authz_core.so\nLoadModule authz_host_module modules/mod_authz_host.so\nLoadModule dir_module modules/mod_dir.so\nLoadModule mime_module modules/mod_mime.so\nLoadModule log_config_module modules/mod_log_config.so\nLoadModule unixd_module modules/mod_unixd.so\nLoadModule alias_module modules/mod_alias.so\nLoadModule setenvif_module modules/mod_setenvif.so\nLoadModule autoindex_module modules/mod_autoindex.so\nLoadModule negotiation_module modules/mod_negotiation.so\nLoadModule cgid_module modules/mod_cgid.so\nLoadModule headers_module modules/mod_headers.so\n\nPidFile logs/httpd.pid\nUser daemon\nGroup daemon\n\nServerAdmin you@example.com\n\nDocumentRoot \"/usr/local/apache2/htdocs\"\n<Directory \"/usr/local/apache2/htdocs\">\n    Options Indexes FollowSymLinks ExecCGI\n    AllowOverride None\n    Require all granted\n    DirectoryIndex index.html\n</Directory>\n\n# Intentional Alias with permissive access to demonstrate traversal behavior\nAlias /assets/ \"/usr/local/apache2/htdocs/assets/\"\n<Directory \"/usr/local/apache2/htdocs/assets\">\n    Options Indexes FollowSymLinks ExecCGI\n    AllowOverride None\n    Require all granted\n</Directory>\n\n# Enable CGI execution\nScriptAlias /cgi-bin/ \"/usr/local/apache2/cgi-bin/\"\n<Directory \"/usr/local/apache2/cgi-bin\">\n    AllowOverride None\n    Options +ExecCGI\n    Require all granted\n</Directory>\n\n<IfModule mime_module>\n    TypesConfig conf/mime.types\n    AddHandler cgi-script .cgi .pl .sh\n    AddType text/html .shtml\n    AddOutputFilter INCLUDES .shtml\n</IfModule>\n\n<IfModule dir_module>\n    DirectoryIndex index.html\n</IfModule>\n\n<IfModule log_config_module>\n    LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b\" common\n    LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b \\\"%{Referer}i\\\" \\\"%{User-Agent}i\\\"\" combined\n    CustomLog logs/access_log combined\n    ErrorLog logs/error_log\n</IfModule>\n\n<IfModule headers_module>\n    Header always set X-Content-Type-Options \"nosniff\"\n</IfModule>\n\n<IfModule negotiation_module>\n    LanguagePriority en\n    ForceLanguagePriority Prefer Fallback\n</IfModule>\n\n# Default security context for root dir (intentionally permissive in this lab)\n<Directory />\n    AllowOverride None\n    Require all granted\n</Directory>\n\n# Performance and timeouts (defaults)\nTimeout 60\nKeepAlive On\nMaxKeepAliveRequests 100\nKeepAliveTimeout 5\n\n# MPM defaults (event)\n<IfModule mpm_event_module>\n    StartServers 2\n    MinSpareThreads 25\n    MaxSpareThreads 75\n    ThreadLimit 64\n    ThreadsPerChild 25\n    MaxRequestWorkers 150\n    MaxConnectionsPerChild 0\n</IfModule>\n"
        },
        {
            "location": "./../../dockers/CVE-2021-41773/custom_no_tool/httpd/htdocs/index.html",
            "content": "<!doctype html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\" />\n  <title>Apache HTTP Server 2.4.49 - CVE-2021-41773 Lab</title>\n  <style>\n    body { font-family: sans-serif; margin: 2rem; }\n    code { background: #f2f2f2; padding: 0.2rem 0.4rem; }\n  </style>\n</head>\n<body>\n  <h1>Apache HTTP Server 2.4.49</h1>\n  <p>This container is configured for testing CVE-2021-41773.</p>\n  <ul>\n    <li>Static assets: <a href=\"/assets/\">/assets/</a></li>\n    <li>CGI endpoint: <a href=\"/cgi-bin/test.cgi\">/cgi-bin/test.cgi</a></li>\n  </ul>\n</body>\n</html>\n"
        },
        {
            "location": "./../../dockers/CVE-2021-41773/custom_no_tool/httpd/htdocs/assets/README.txt",
            "content": "This is a public assets directory intentionally configured with permissive access for CVE-2021-41773 testing.\n"
        },
        {
            "location": "./../../dockers/CVE-2021-41773/custom_no_tool/httpd/cgi-bin/test.cgi",
            "content": "#!/bin/sh\n\necho \"Content-Type: text/plain\"\necho\n\necho \"CGI test script\"\necho \"-----------------\"\necho \"Date: $(date)\"\necho \"User: $(id)\"\necho \"Uname: $(uname -a)\"\necho\n\necho \"Environment:\"\nenv | sort\n"
        }
    ],
    "directory_tree": "CVE-2021-41773/\n\u2514\u2500\u2500 custom_no_tool/\n    \u251c\u2500\u2500 docker-compose.yml\n    \u2514\u2500\u2500 httpd/\n        \u251c\u2500\u2500 Dockerfile\n        \u251c\u2500\u2500 conf/\n        \u2502   \u2514\u2500\u2500 httpd.conf\n        \u251c\u2500\u2500 cgi-bin/\n        \u2502   \u2514\u2500\u2500 test.cgi\n        \u2514\u2500\u2500 htdocs/\n            \u251c\u2500\u2500 index.html\n            \u2514\u2500\u2500 assets/\n                \u2514\u2500\u2500 README.txt"
}