{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-41773/custom/docker-compose.yml",
            "content": "version: \"3.8\"\nservices:\n  httpd:\n    build:\n      context: ./httpd\n    image: cve-2021-41773:httpd-2.4.49\n    container_name: cve-2021-41773-httpd\n    ports:\n      - \"80:80\"\n    restart: unless-stopped\n"
        },
        {
            "location": "./../../dockers/CVE-2021-41773/custom/httpd/Dockerfile",
            "content": "FROM debian:bullseye-slim\n\nARG HTTPD_VERSION=2.4.49\nARG APR_VERSION=1.7.0\nARG APR_UTIL_VERSION=1.6.1\n\nENV PREFIX=/usr/local/apache2 \\\n    PATH=/usr/local/apache2/bin:${PATH}\n\nRUN apt-get update \\\n && apt-get install -y --no-install-recommends \\\n      ca-certificates \\\n      build-essential \\\n      wget \\\n      curl \\\n      tar \\\n      perl \\\n      libpcre3-dev \\\n      zlib1g-dev \\\n      libssl-dev \\\n      libexpat1-dev \\\n && rm -rf /var/lib/apt/lists/*\n\nWORKDIR /tmp/build\n\n# Download sources\nRUN wget -q https://archive.apache.org/dist/httpd/httpd-${HTTPD_VERSION}.tar.gz \\\n && wget -q https://archive.apache.org/dist/apr/apr-${APR_VERSION}.tar.gz \\\n && wget -q https://archive.apache.org/dist/apr/apr-util-${APR_UTIL_VERSION}.tar.gz \\\n && tar xzf httpd-${HTTPD_VERSION}.tar.gz \\\n && tar xzf apr-${APR_VERSION}.tar.gz \\\n && tar xzf apr-util-${APR_UTIL_VERSION}.tar.gz \\\n && mv apr-${APR_VERSION} httpd-${HTTPD_VERSION}/srclib/apr \\\n && mv apr-util-${APR_UTIL_VERSION} httpd-${HTTPD_VERSION}/srclib/apr-util\n\nWORKDIR /tmp/build/httpd-${HTTPD_VERSION}\n\n# Build and install httpd with shared MPMs and CGI support\nRUN ./configure \\\n      --prefix=${PREFIX} \\\n      --with-included-apr \\\n      --enable-so \\\n      --enable-alias=shared \\\n      --enable-cgi=shared \\\n      --enable-cgid=shared \\\n      --enable-rewrite=shared \\\n      --enable-mime=shared \\\n      --enable-dir=shared \\\n      --enable-log_config=shared \\\n      --enable-setenvif=shared \\\n      --enable-status=shared \\\n      --enable-autoindex=shared \\\n      --enable-negotiation=shared \\\n      --enable-headers=shared \\\n      --enable-env=shared \\\n      --enable-unixd=shared \\\n      --enable-authz_core=shared \\\n      --enable-authz_host=shared \\\n      --enable-access_compat=shared \\\n      --enable-require=shared \\\n      --enable-deflate=shared \\\n      --enable-filter=shared \\\n      --enable-proxy=shared \\\n      --enable-proxy_http=shared \\\n      --enable-mods-shared=all \\\n      --enable-mpms-shared=all \\\n && make -j\"$(nproc)\" \\\n && make install \\\n && rm -rf /tmp/build\n\n# Create runtime dirs and sample content\nRUN mkdir -p ${PREFIX}/htdocs \\\n    && mkdir -p ${PREFIX}/cgi-bin \\\n    && mkdir -p /var/www/uploads \\\n    && echo \"Vulnerable Apache 2.4.49 up - CVE-2021-41773 test page\" > ${PREFIX}/htdocs/index.html \\\n    && echo \"Sample public file in aliased dir\" > /var/www/uploads/public.txt \\\n    && printf \"#!/bin/sh\\n\\necho \\\"Content-Type: text/plain\\\"\\n\\necho \\\"CGI OK\\\"\\n\" > ${PREFIX}/cgi-bin/test.sh \\\n    && chmod +x ${PREFIX}/cgi-bin/test.sh\n\n# Copy our custom httpd.conf\nCOPY conf/httpd.conf ${PREFIX}/conf/httpd.conf\n\nEXPOSE 80\n\nCMD [\"/usr/local/apache2/bin/httpd\", \"-DFOREGROUND\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2021-41773/custom/httpd/conf/httpd.conf",
            "content": "ServerRoot \"/usr/local/apache2\"\nListen 80\nServerName localhost:80\n\n# Load core modules (built as shared)\nLoadModule mpm_prefork_module modules/mod_mpm_prefork.so\nLoadModule authz_core_module modules/mod_authz_core.so\nLoadModule authz_host_module modules/mod_authz_host.so\nLoadModule access_compat_module modules/mod_access_compat.so\nLoadModule unixd_module modules/mod_unixd.so\nLoadModule dir_module modules/mod_dir.so\nLoadModule alias_module modules/mod_alias.so\nLoadModule cgi_module modules/mod_cgi.so\nLoadModule mime_module modules/mod_mime.so\nLoadModule log_config_module modules/mod_log_config.so\nLoadModule setenvif_module modules/mod_setenvif.so\nLoadModule autoindex_module modules/mod_autoindex.so\nLoadModule negotiation_module modules/mod_negotiation.so\nLoadModule headers_module modules/mod_headers.so\nLoadModule env_module modules/mod_env.so\nLoadModule status_module modules/mod_status.so\n\nUser daemon\nGroup daemon\n\nServerAdmin you@example.com\nDocumentRoot \"/usr/local/apache2/htdocs\"\n<Directory \"/usr/local/apache2/htdocs\">\n    Options Indexes FollowSymLinks\n    AllowOverride None\n    Require all granted\n</Directory>\n\n# Default: deny root-level unless explicitly allowed\n<Directory />\n    AllowOverride none\n    Require all denied\n</Directory>\n\n# Logging\nErrorLog logs/error_log\nLogLevel warn\n<IfModule log_config_module>\n    LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b\" common\n    CustomLog logs/access_log common\n</IfModule>\n\n# MIME\nTypesConfig conf/mime.types\nAddType application/x-compress .Z\nAddType application/x-gzip .gz .tgz\nDirectoryIndex index.html\n\n# Vulnerable alias mapping outside DocumentRoot\nAlias /uploads \"/var/www/uploads\"\n<Directory \"/var/www/uploads\">\n    Options Indexes FollowSymLinks\n    AllowOverride None\n    Require all granted\n</Directory>\n\n# Enable CGI and make it broadly accessible\nScriptAlias /cgi-bin/ \"/usr/local/apache2/cgi-bin/\"\n<Directory \"/usr/local/apache2/cgi-bin\">\n    AllowOverride None\n    Options +ExecCGI\n    Require all granted\n    AddHandler cgi-script .cgi .sh\n</Directory>\n\n# KeepAlive/Timeout defaults\nKeepAlive On\nMaxKeepAliveRequests 100\nKeepAliveTimeout 5\n\n# Enable server-status (optional)\n<Location /server-status>\n    SetHandler server-status\n    Require all granted\n</Location>\n"
        },
        {
            "location": "./../../dockers/CVE-2021-41773/custom/README.txt",
            "content": "How to run:\n- From this directory, run: docker compose up --build -d\n- Access http://localhost/ to see the default page\n- Access http://localhost/uploads/public.txt to see the aliased directory content\n- Access http://localhost/cgi-bin/test.sh to verify CGI execution\n\nThis environment runs Apache HTTP Server 2.4.49 with an Alias outside DocumentRoot and CGI enabled, making it suitable to test CVE-2021-41773 behaviors.\n"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2021-41773/custom\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 httpd\n\u2502   \u251c\u2500\u2500 Dockerfile\n\u2502   \u2514\u2500\u2500 conf\n\u2502       \u2514\u2500\u2500 httpd.conf\n\u2514\u2500\u2500 README.txt\n"
}