{
    "files": [
        {
            "location": "./../../dockers/CVE-2020-11652/custom/docker-compose.yml",
            "content": "version: \"3.8\"\n\nservices:\n  salt-master:\n    build:\n      context: ./salt-master\n      dockerfile: Dockerfile\n    container_name: cve-2020-11652-salt-master\n    ports:\n      - \"4505:4505\"\n      - \"4506:4506\"\n    healthcheck:\n      test: [\n        \"CMD\",\n        \"python\",\n        \"-c\",\n        \"import socket,sys; ok=0;\\nfor p in (4505,4506):\\n    s=socket.socket(); s.settimeout(1.5)\\n    try:\\n        s.connect(('127.0.0.1', p)); ok+=1\\n    except Exception:\\n        pass\\n    finally:\\n        s.close()\\nsys.exit(0 if ok==2 else 1)\"\n      ]\n      interval: 10s\n      timeout: 5s\n      retries: 6\n    restart: unless-stopped\n\nnetworks:\n  default:\n    name: cve-2020-11652-net\n"
        },
        {
            "location": "./../../dockers/CVE-2020-11652/custom/salt-master/Dockerfile",
            "content": "FROM saltstack/salt:2019.2.3\n\n# Configure the vulnerable salt-master\nCOPY etc/salt/master /etc/salt/master\n\n# Provide some directories and demo data\nRUN mkdir -p /srv/salt /secrets \\\n    && echo \"super-secret-token = 9f9f2a2d-2a10-4fa9-bb2c-6e0d2c9d1abc\" > /secrets/secret.txt \\\n    && chmod 600 /secrets/secret.txt \\\n    && mkdir -p /var/cache/salt/master /var/log/salt /var/run/salt \\\n    && touch /var/log/salt/master\n\nEXPOSE 4505 4506\n\n# Run the salt-master with info logging for visibility\nCMD [\"salt-master\", \"-l\", \"info\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2020-11652/custom/salt-master/etc/salt/master",
            "content": "# Salt master configuration for CVE-2020-11652 vulnerable environment\n# Version pinned to 2019.2.3 via Dockerfile base image\n\n# Bind to all interfaces for testing\ninterface: 0.0.0.0\n\n# Keep file server simple\nfileserver_backend:\n  - roots\nfile_roots:\n  base:\n    - /srv/salt\n\n# Accept all minion keys automatically to simplify testing\nauto_accept: True\n\n# Open mode relaxes authentication for certain ClearFuncs calls\n# This facilitates exercising ClearFuncs in a lab environment\nopen_mode: True\n\n# Log to stdout/stderr and a file for convenience\nlog_file: /var/log/salt/master\nlog_level: info\n\n# Set ipc mode to zmq (default), and ensure defaults that match the image\ntransport: zeromq\n\n# Avoid randomization for publisher port\npublish_port: 4505\nret_port: 4506\n"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2020-11652/custom\n\u2514\u2500\u2500 docker-compose.yml\n\u2514\u2500\u2500 salt-master\n    \u251c\u2500\u2500 Dockerfile\n    \u2514\u2500\u2500 etc\n        \u2514\u2500\u2500 salt\n            \u2514\u2500\u2500 master"
}