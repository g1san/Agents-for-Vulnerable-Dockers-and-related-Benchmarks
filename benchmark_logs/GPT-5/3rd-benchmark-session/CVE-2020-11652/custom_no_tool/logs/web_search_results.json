{
    "desc": "CVE-2020-11652 is a directory traversal flaw in SaltStack\u2019s Salt Master service (salt-master), specifically in code paths that process filesystem paths for the master\u2019s file-serving and configuration-related functions. The master exposes request/reply interfaces over ZeroMQ on ports 4505/4506. Several methods reachable through the master\u2019s ClearFuncs and wheel interfaces insufficiently sanitized user-supplied paths. Vulnerable components such as wheel.file_roots.find, wheel.file_roots.write, wheel.config.update_config, and tokens.localfs.get_token joined attacker-controlled path segments to configured root directories without robust normalization and containment checks. By supplying crafted relative paths containing sequences like ../ and by leveraging symlink escapes, an attacker who can invoke these endpoints can traverse out of the intended roots to read arbitrary files on the master (for example, /etc/passwd or /etc/shadow) and write files to arbitrary locations reachable from the master\u2019s file server roots (for example, planting cron entries or modifying configuration). This flaw affects Salt releases prior to the fixed versions 2019.2.4 and 3000.2. In many real-world incidents, it was combined with the authentication bypass tracked as CVE-2020-11651 to make exploitation unauthenticated; however, CVE-2020-11652 itself is the path traversal in the master\u2019s file-handling logic. The official fixes added strict path canonicalization and root containment (for example, realpath-based verification) and applied these checks to the affected functions. Exploitation requires only a reachable salt-master service interface; minions, databases, caches, or web servers are not required to trigger this vulnerability.",
    "attack_type": "Directory traversal enabling arbitrary file read and arbitrary file write on the Salt master",
    "services": [
        {
            "name": "saltstack/salt",
            "version": [
                "2019.2.0",
                "2019.2.1",
                "2019.2.2",
                "2019.2.3",
                "3000",
                "3000.1"
            ],
            "dependency_type": "HARD",
            "description": "Provides the vulnerable salt-master service (ZeroMQ request/reply on tcp/4505 and tcp/4506). These specific tags correspond to Salt releases identified by NIST/MITRE as affected (all versions before 2019.2.4 and 3000 before 3000.2). No additional services are required to make the system vulnerable; the flaw resides in the master\u2019s file-handling and wheel/ClearFuncs code paths."
        }
    ],
    "input_tokens": 8592,
    "output_tokens": 3791
}