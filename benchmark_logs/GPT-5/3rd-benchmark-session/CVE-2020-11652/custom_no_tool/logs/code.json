{
    "files": [
        {
            "location": "./../../dockers/CVE-2020-11652/custom_no_tool/docker-compose.yml",
            "content": "version: \"3.8\"\nservices:\n  salt-master:\n    build: ./master\n    image: vulnerable-salt-master:2019.2.3\n    container_name: cve-2020-11652-master\n    ports:\n      - \"4505:4505\"\n      - \"4506:4506\"\n    volumes:\n      - ./master/master.conf:/etc/salt/master:ro\n      - ./srv/salt:/srv/salt:ro\n    command: [\"salt-master\", \"-l\", \"info\", \"-c\", \"/etc/salt\"]\n    restart: unless-stopped\n"
        },
        {
            "location": "./../../dockers/CVE-2020-11652/custom_no_tool/master/Dockerfile",
            "content": "FROM saltstack/salt:2019.2.3\n\n# Create a local OS user for PAM external_auth to allow authenticated access\n# to wheel/runner functions over the ZeroMQ ClearFuncs path.\n# Use adduser since the base image does not provide useradd.\nRUN adduser -D -s /bin/ash saltuser \\\n && echo 'saltuser:saltpass' | chpasswd\n\n# Ensure standard locations exist\nRUN mkdir -p /srv/salt /etc/salt\n\n# Default config in image (compose also binds the same file at runtime)\nCOPY master.conf /etc/salt/master\n\n# Expose the master ports (publisher 4505, request server 4506)\nEXPOSE 4505 4506\n"
        },
        {
            "location": "./../../dockers/CVE-2020-11652/custom_no_tool/master/master.conf",
            "content": "# Salt Master configuration for reproducing CVE-2020-11652\n# Vulnerable Salt versions prior to 2019.2.4 / 3000.2\n\ninterface: 0.0.0.0\nuser: root\n\n# File server roots\nfile_roots:\n  base:\n    - /srv/salt\n\n# Accept any minion keys automatically (not required for this CVE but harmless)\nauto_accept: True\n\n# Enable PAM external authentication for a pre-created local user\nexternal_auth:\n  pam:\n    saltuser:\n      - '@wheel'\n      - '@runner'\n      - '@jobs'\n      - '.*'\n\nauth_timeout: 60\npublisher_acl_blacklist: []\n\n# Keep default token storage (localfs) to exercise affected code paths\n# referenced in CVE-2020-11652 discussions\n# tokens are stored under /var/cache/salt/master/tokens by default\n\nhash_type: sha256\nlog_level: info\npidfile: /var/run/salt-master.pid\n\n# Keep master using ZeroMQ (default)\ntransport: zeromq\n"
        },
        {
            "location": "./../../dockers/CVE-2020-11652/custom_no_tool/srv/salt/top.sls",
            "content": "base:\n  '*':\n    - hello\n"
        },
        {
            "location": "./../../dockers/CVE-2020-11652/custom_no_tool/srv/salt/hello.sls",
            "content": "create_test_file:\n  file.managed:\n    - name: /tmp/hello_from_salt.txt\n    - contents: |\n        Hello from a vulnerable Salt master demo (CVE-2020-11652 setup).\n"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2020-11652/custom_no_tool\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 master\n\u2502   \u251c\u2500\u2500 Dockerfile\n\u2502   \u2514\u2500\u2500 master.conf\n\u2514\u2500\u2500 srv\n    \u2514\u2500\u2500 salt\n        \u251c\u2500\u2500 hello.sls\n        \u2514\u2500\u2500 top.sls"
}