# Salt Master configuration for reproducing CVE-2020-11652
# Vulnerable Salt versions prior to 2019.2.4 / 3000.2

interface: 0.0.0.0
user: root

# File server roots
file_roots:
  base:
    - /srv/salt

# Accept any minion keys automatically (not required for this CVE but harmless)
auto_accept: True

# Enable PAM external authentication for a pre-created local user
external_auth:
  pam:
    saltuser:
      - '@wheel'
      - '@runner'
      - '@jobs'
      - '.*'

auth_timeout: 60
publisher_acl_blacklist: []

# Keep default token storage (localfs) to exercise affected code paths
# referenced in CVE-2020-11652 discussions
# tokens are stored under /var/cache/salt/master/tokens by default

hash_type: sha256
log_level: info
pidfile: /var/run/salt-master.pid

# Keep master using ZeroMQ (default)
transport: zeromq
