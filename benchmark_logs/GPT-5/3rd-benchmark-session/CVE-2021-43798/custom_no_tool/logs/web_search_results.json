{
    "desc": "CVE-2021-43798 is a high\u2011severity pre\u2011authentication path traversal flaw in Grafana 8.x that results in unauthenticated arbitrary local file read from the Grafana host. The vulnerable component is Grafana\u2019s built\u2011in HTTP server route that serves public plugin assets: /public/plugins/:pluginId. Due to improper sanitization of user\u2011controlled path elements after the plugin identifier, traversal sequences such as ../ are not correctly neutralized. As a result, requests can escape the intended plugin asset directory (<grafana>/public/app/plugins/panel/<pluginId>) and reach arbitrary filesystem locations on the host. The flaw stems from misuse of path normalization (notably behavior consistent with Go\u2019s filepath.Clean rules for non\u2011rooted paths), which does not remove leading parent\u2011directory traversal in this context. Attackers need only network access to the Grafana HTTP service (commonly port 3000) and can send raw HTTP requests that preserve the ../ segments (for example, some clients require an option to avoid normalizing paths). No authentication or prior knowledge of valid credentials is required to trigger the vulnerability. Successful exploitation enables disclosure of sensitive files, including system files like /etc/passwd and /etc/shadow; Grafana configuration files such as /etc/grafana/grafana.ini and conf/defaults.ini (which can reveal secret_key and other secrets); and the Grafana SQLite database at /var/lib/grafana/grafana.db, which contains user records (for example, PBKDF2\u2011HMAC\u2011SHA256 password hashes with salts), data source credentials, and authentication tokens. With these disclosures, an attacker may crack weak passwords offline to obtain Grafana administrative access, decrypt stored data source passwords, and further pivot. Although the vulnerability primarily enables file read, the information disclosure can in practice facilitate broader compromise. The issue affects self\u2011hosted Grafana versions from 8.0.0\u2011beta1 through 8.3.0 and was fixed in 8.0.7, 8.1.8, 8.2.7, and 8.3.1; Grafana Cloud was not affected. Mitigations include upgrading to a patched version, restricting network access to the Grafana service, and monitoring or filtering requests that target /public/plugins/ paths with traversal patterns. The vulnerability has been widely exploited in the wild, and proof\u2011of\u2011concept requests typically resemble: GET /public/plugins/<pluginId>/../../../../../../../../etc/passwd, often requiring a client option that prevents automatic path normalization.",
    "attack_type": "Unauthenticated path traversal leading to arbitrary local file read and sensitive data disclosure",
    "services": [
        {
            "name": "grafana/grafana",
            "version": [
                "8.0.0",
                "8.0.1",
                "8.0.2",
                "8.0.3",
                "8.0.4",
                "8.0.5",
                "8.0.6",
                "8.1.0",
                "8.1.1",
                "8.1.2",
                "8.1.3",
                "8.1.4",
                "8.1.5",
                "8.1.6",
                "8.1.7",
                "8.2.0",
                "8.2.1",
                "8.2.2",
                "8.2.3",
                "8.2.4",
                "8.2.5",
                "8.2.6",
                "8.3.0"
            ],
            "dependency_type": "HARD",
            "description": "Grafana itself provides the vulnerable HTTP service and the /public/plugins/:pluginId endpoint. It is the only component required to reproduce the vulnerability; it ships with built\u2011in plugins and uses an embedded SQLite database by default, so no external database or web server is necessary."
        }
    ],
    "input_tokens": 11184,
    "output_tokens": 2623
}