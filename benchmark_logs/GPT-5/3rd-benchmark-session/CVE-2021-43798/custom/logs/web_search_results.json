{
    "desc": "CVE-2021-43798 is a high\u2011severity directory traversal flaw in self\u2011hosted Grafana that leads to unauthenticated local file inclusion and arbitrary local file read. It affects Grafana versions 8.0.0\u2011beta1 through 8.3.0 (Grafana Cloud was not affected). The vulnerability resides in the web server handler for plugin public asset URLs, where requests to /public/plugins/<plugin-id>/... are insufficiently sanitized. Due to a misuse of Go\u2019s filepath.Clean in pkg/api/plugins.go (which does not strip leading \u201c../\u201d on non\u2011rooted paths), an attacker can traverse outside the intended plugin directory using sequences such as ../../ to reach arbitrary files on the filesystem. Any installed or default plugin identifier (for example, alertlist, annolist, barchart, bargauge, candlestick, cloudwatch, dashlist, elasticsearch) can be used to form a valid starting path, after which traversal escapes the plugin assets directory. As a result, a remote, unauthenticated attacker can send a simple HTTP GET request to paths like /public/plugins/{pluginID}/../../../../../../../../etc/passwd to read sensitive local files. Impact includes disclosure of secrets, configuration, and credentials (for example, /etc/grafana/grafana.ini to discover data paths, or the default SQLite database at /var/lib/grafana/grafana.db containing user data and password hashes). Such exposure can facilitate further compromise of the host, lateral movement, and ransomware deployment. The issue was actively exploited in the wild with widespread scanning and public proof\u2011of\u2011concept code shortly after disclosure. Grafana released emergency patches on December 7, 2021: 8.3.1, 8.2.7, 8.1.8, and 8.0.7. Mitigation is to upgrade to one of these or later fixed versions and monitor for traversal attempts against plugin asset URLs. The vulnerability is tracked with a CVSS score of 7.5 and has been included in known\u2011exploited vulnerability catalogs.",
    "attack_type": "Unauthenticated arbitrary local file read via directory traversal",
    "services": [
        {
            "name": "grafana/grafana",
            "version": [
                "8.0.0-beta1",
                "8.0.0",
                "8.0.1",
                "8.0.2",
                "8.0.3",
                "8.0.4",
                "8.0.5",
                "8.0.6",
                "8.1.0",
                "8.1.1",
                "8.1.2",
                "8.1.3",
                "8.1.4",
                "8.1.5",
                "8.1.6",
                "8.1.7",
                "8.2.0",
                "8.2.1",
                "8.2.2",
                "8.2.3",
                "8.2.4",
                "8.2.5",
                "8.2.6",
                "8.3.0"
            ],
            "dependency_type": "HARD",
            "description": "Grafana itself is the only essential component needed to reproduce the vulnerability. The built\u2011in web server and default plugins are sufficient; no external database or reverse proxy is required because Grafana can run standalone using its default SQLite storage."
        }
    ],
    "input_tokens": 28326,
    "output_tokens": 2565,
    "query": "CVE-2021-43798 details Grafana directory traversal exploit mitigation PoC vendor advisory"
}