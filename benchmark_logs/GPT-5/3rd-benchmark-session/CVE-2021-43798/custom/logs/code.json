{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-43798/custom/docker-compose.yml",
            "content": "version: \"3.8\"\nservices:\n  grafana:\n    image: grafana/grafana:8.3.0\n    container_name: grafana-cve-2021-43798\n    ports:\n      - \"3000:3000\"\n    environment:\n      - GF_SECURITY_ADMIN_USER=admin\n      - GF_SECURITY_ADMIN_PASSWORD=admin\n    volumes:\n      - ./grafana/provisioning:/etc/grafana/provisioning\n      - ./grafana/grafana.ini:/etc/grafana/grafana.ini:ro\n      - ./secrets:/secrets:ro\n    restart: unless-stopped\n"
        },
        {
            "location": "./../../dockers/CVE-2021-43798/custom/grafana/grafana.ini",
            "content": "[server]\nhttp_port = 3000\nprotocol = http\n\n[security]\nadmin_user = admin\nadmin_password = admin\n\n[paths]\nprovisioning = /etc/grafana/provisioning\n\n[users]\ndefault_theme = light\n\n[snapshots]\nexternal_enabled = true\n\n# Lab note: this file is intentionally world-readable in the container for testing LFR.\n# Secret token for demo purposes only:\n# DEMO_TOKEN=shh-this-is-a-demo-secret\n"
        },
        {
            "location": "./../../dockers/CVE-2021-43798/custom/grafana/provisioning/datasources/datasource.yml",
            "content": "apiVersion: 1\n\ndatasources:\n  - name: DemoPrometheus\n    type: prometheus\n    access: proxy\n    url: http://prometheus:9090\n    isDefault: false\n    editable: true\n    jsonData:\n      httpMethod: GET\n"
        },
        {
            "location": "./../../dockers/CVE-2021-43798/custom/grafana/provisioning/dashboards/dashboard.yml",
            "content": "apiVersion: 1\nproviders:\n  - name: \"Demo Dashboards\"\n    orgId: 1\n    type: file\n    disableDeletion: false\n    updateIntervalSeconds: 10\n    options:\n      path: /etc/grafana/dashboards\n"
        },
        {
            "location": "./../../dockers/CVE-2021-43798/custom/grafana/dashboards/sample.json",
            "content": "{\n  \"annotations\": {\n    \"list\": [\n      {\n        \"builtIn\": 1,\n        \"datasource\": {\n          \"type\": \"-- Grafana --\",\n          \"uid\": \"grafana\"\n        },\n        \"enable\": true,\n        \"hide\": true,\n        \"iconColor\": \"rgba(0, 211, 255, 1)\",\n        \"name\": \"Annotations & Alerts\",\n        \"type\": \"dashboard\"\n      }\n    ]\n  },\n  \"editable\": true,\n  \"fiscalYearStartMonth\": 0,\n  \"graphTooltip\": 0,\n  \"links\": [],\n  \"liveNow\": false,\n  \"panels\": [\n    {\n      \"type\": \"stat\",\n      \"title\": \"Demo Panel\",\n      \"gridPos\": {\"h\": 6, \"w\": 8, \"x\": 0, \"y\": 0},\n      \"options\": {\n        \"reduceOptions\": {\"calcs\": [\"last\"], \"fields\": \"\", \"values\": false},\n        \"orientation\": \"auto\"\n      },\n      \"targets\": [],\n      \"datasource\": null,\n      \"fieldConfig\": {\"defaults\": {\"color\": {\"mode\": \"palette-classic\"}}, \"overrides\": []}\n    }\n  ],\n  \"refresh\": \"\",\n  \"schemaVersion\": 30,\n  \"style\": \"dark\",\n  \"tags\": [\"demo\"],\n  \"templating\": {\"list\": []},\n  \"time\": {\"from\": \"now-6h\", \"to\": \"now\"},\n  \"timezone\": \"\",\n  \"title\": \"CVE-2021-43798 Demo Dashboard\",\n  \"uid\": \"cve-2021-43798-demo\",\n  \"version\": 1\n}\n"
        },
        {
            "location": "./../../dockers/CVE-2021-43798/custom/secrets/secret.txt",
            "content": "This is a demo secret file to validate CVE-2021-43798 local file read.\nIf you can read this via traversal, the environment is vulnerable.\n\nExample expected request path (using a default plugin id like alertlist):\n/public/plugins/alertlist/../../../../../../../../secrets/secret.txt\n"
        }
    ],
    "directory_tree": "CVE-2021-43798/\n\u2514\u2500\u2500 custom/\n    \u251c\u2500\u2500 docker-compose.yml\n    \u251c\u2500\u2500 grafana/\n    \u2502   \u251c\u2500\u2500 grafana.ini\n    \u2502   \u251c\u2500\u2500 dashboards/\n    \u2502   \u2502   \u2514\u2500\u2500 sample.json\n    \u2502   \u2514\u2500\u2500 provisioning/\n    \u2502       \u251c\u2500\u2500 dashboards/\n    \u2502       \u2502   \u2514\u2500\u2500 dashboard.yml\n    \u2502       \u2514\u2500\u2500 datasources/\n    \u2502           \u2514\u2500\u2500 datasource.yml\n    \u2514\u2500\u2500 secrets/\n        \u2514\u2500\u2500 secret.txt"
}