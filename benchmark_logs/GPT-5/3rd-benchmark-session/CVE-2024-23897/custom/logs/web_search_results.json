{
    "desc": "CVE-2024-23897 is a critical vulnerability in Jenkins core that stems from how the built\u2011in command\u2011line interface (CLI) parses arguments. Jenkins uses the args4j library, which by default enables the feature that expands any argument beginning with the at\u2011sign followed by a file path (for example, @/path/to/file) into the contents of that file (expandAtFiles). In Jenkins 2.441 and earlier, and Jenkins Long\u2011Term Support 2.426.2 and earlier, this expansion behavior was not disabled. As a result, when attackers invoke Jenkins CLI commands and include such @file arguments, the Jenkins controller reads the referenced files and passes their contents to the command parser, causing an arbitrary file read on the controller with the controller\u2019s default character encoding. Depending on configuration and the command used, attackers with Overall/Read permission can read entire files; even without that permission, certain CLI commands process arguments before permission checks and can leak the first lines of files. The number of lines retrievable varies by command (commonly a handful to tens of lines), and the fidelity of binary data leakage depends on the platform\u2019s file.encoding (riskier on Windows\u20111252, less so on UTF\u20118). Sensitive files that may be exposed include Jenkins secrets (for example, master.key, secrets.key), operating system files (for example, /etc/passwd), SSH keys, and other credentials stored on the controller. Disclosure of such data can enable further compromise paths documented by multiple researchers, including remote code execution through abuse of resource root URLs and CLI WebSocket endpoints, forging persistent login cookies, stored cross\u2011site scripting via build logs, cross\u2011site request forgery crumb forgery, secret decryption, item deletion, and heap dump download. The vulnerability affects the Jenkins controller\u2019s integrated CLI over HTTP/WebSocket or SSH transports and can be triggered either via jenkins-cli.jar or direct HTTP POST interactions with the /cli endpoint. The issue is remediated by disabling @\u2011expansion in Jenkins 2.442 and in Long\u2011Term Support 2.426.3 and 2.440.1; administrators can also mitigate exposure by disabling CLI access entirely. A temporary system property exists to re\u2011enable the behavior for compatibility (hudson.cli.CLICommand.allowAtSyntax=true), but it is strongly discouraged.",
    "attack_type": "Unauthorized arbitrary file read leading to information disclosure with potential follow-on remote code execution",
    "services": [
        {
            "name": "jenkins/jenkins",
            "version": [
                "2.441-jdk17",
                "2.426.2-lts-jdk17"
            ],
            "dependency_type": "HARD",
            "description": "Jenkins controller providing the vulnerable built-in CLI over HTTP/WebSocket. These specific image tags correspond to versions explicitly cited as affected (Jenkins 2.441 and LTS 2.426.2). The image includes Jetty and the CLI endpoints needed to reproduce the vulnerability; no external database or web server is required."
        }
    ],
    "input_tokens": 15812,
    "output_tokens": 2876,
    "query": "CVE-2024-23897 Jenkins arbitrary file read vulnerability details exploit PoC mitigation versions affected fixed Jenkins 2.441 LTS 2.426.x security advisory"
}