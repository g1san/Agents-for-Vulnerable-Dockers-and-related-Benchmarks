import jenkins.model.*
import hudson.security.*

Jenkins j = Jenkins.get()

def realm = new HudsonPrivateSecurityRealm(false)
if (realm.getUser("admin") == null) {
  realm.createAccount("admin", "admin123")
}
j.setSecurityRealm(realm)

def strategy = new GlobalMatrixAuthorizationStrategy()
strategy.add(Jenkins.ADMINISTER, "admin")
strategy.add(Jenkins.READ, "anonymous")

j.setAuthorizationStrategy(strategy)

j.save()
