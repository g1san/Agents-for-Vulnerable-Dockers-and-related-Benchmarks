FROM jenkins/jenkins:2.441-jdk17

USER root
RUN mkdir -p /usr/share/jenkins/ref/init.groovy.d \
    && mkdir -p /usr/share/jenkins/ref/testdata \
    && chown -R jenkins:jenkins /usr/share/jenkins/ref
USER jenkins

# Seed Jenkins with security configuration and test files
COPY init.groovy.d/ /usr/share/jenkins/ref/init.groovy.d/
COPY ref/ /usr/share/jenkins/ref/

# Expose default Jenkins ports (HTTP 8080, inbound agents 50000)
EXPOSE 8080 50000
