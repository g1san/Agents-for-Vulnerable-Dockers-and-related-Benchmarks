{
    "files": [
        {
            "location": "./../../dockers/CVE-2020-11651/custom_no_tool/docker-compose.yml",
            "content": "version: \"3.8\"\nservices:\n  salt-master:\n    build:\n      context: ./salt-master\n      dockerfile: Dockerfile\n    image: cve-2020-11651/salt-master:3000.1\n    container_name: salt-master\n    hostname: salt-master\n    ports:\n      - \"4505:4505\"\n      - \"4506:4506\"\n    restart: unless-stopped\n\n  salt-minion:\n    build:\n      context: ./salt-minion\n      dockerfile: Dockerfile\n    image: cve-2020-11651/salt-minion:3000.1\n    container_name: salt-minion\n    hostname: salt-minion\n    depends_on:\n      - salt-master\n    environment:\n      - SALT_MASTER_HOST=salt-master\n    restart: unless-stopped\n"
        },
        {
            "location": "./../../dockers/CVE-2020-11651/custom_no_tool/salt-master/Dockerfile",
            "content": "FROM saltstack/salt:3000.1\n\n# Copy Salt master configuration\nCOPY config/master /etc/salt/master\n\n# Ensure required directories exist\nRUN mkdir -p /srv/salt /etc/salt/pki/master /var/log/salt /var/cache/salt /var/run/salt \\\n    && chown -R root:root /etc/salt /srv/salt /var/log/salt /var/cache/salt /var/run/salt\n\nEXPOSE 4505 4506\n\n# Use exec-form ENTRYPOINT/CMD to avoid shell interpretation issues\nENTRYPOINT [\"salt-master\"]\nCMD [\"-l\", \"info\", \"-u\", \"root\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2020-11651/custom_no_tool/salt-master/config/master",
            "content": "# Minimal Salt master configuration tailored for CVE-2020-11651 reproduction\ninterface: 0.0.0.0\npublish_port: 4505\nret_port: 4506\nuser: root\n\n# Auto-accept minion keys so the minion joins without manual steps\nauto_accept: True\n\n# Reduce any interference for the lab environment\nhash_type: sha256\nfile_roots:\n  base:\n    - /srv/salt\n\n# Logging\nlog_level: info\nlog_file: /var/log/salt/master\n\n# Keep default external interfaces for clear/publishers (ZeroMQ)\n"
        },
        {
            "location": "./../../dockers/CVE-2020-11651/custom_no_tool/salt-minion/Dockerfile",
            "content": "FROM saltstack/salt:3000.1\n\n# Copy Salt minion configuration\nCOPY config/minion /etc/salt/minion\n\n# Startup script to set master host and run the minion\nCOPY start-minion.sh /usr/local/bin/start-minion.sh\nRUN chmod +x /usr/local/bin/start-minion.sh \\\n    && mkdir -p /var/log/salt /var/cache/salt /var/run/salt \\\n    && chown -R root:root /etc/salt /var/log/salt /var/cache/salt /var/run/salt\n\n# Use exec-form ENTRYPOINT to avoid shell entrypoint conflicts\nENTRYPOINT [\"/usr/local/bin/start-minion.sh\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2020-11651/custom_no_tool/salt-minion/config/minion",
            "content": "# Minimal Salt minion configuration to auto-connect to the lab master\nmaster: salt-master\nid: salt-minion\nuser: root\n\nlog_level: info\nlog_file: /var/log/salt/minion\n\n# Avoid IPv6 issues in some environments\nipv6: False\n"
        },
        {
            "location": "./../../dockers/CVE-2020-11651/custom_no_tool/salt-minion/start-minion.sh",
            "content": "#!/bin/sh\nset -e\nMASTER=\"${SALT_MASTER_HOST:-salt-master}\"\nsed -i \"s/^master:.*/master: ${MASTER}/\" /etc/salt/minion\nexec salt-minion -l info -u root\n"
        }
    ],
    "directory_tree": "./CVE-2020-11651/\n\u2514\u2500\u2500 custom_no_tool\n    \u251c\u2500\u2500 docker-compose.yml\n    \u251c\u2500\u2500 salt-master\n    \u2502   \u251c\u2500\u2500 Dockerfile\n    \u2502   \u2514\u2500\u2500 config\n    \u2502       \u2514\u2500\u2500 master\n    \u2514\u2500\u2500 salt-minion\n        \u251c\u2500\u2500 Dockerfile\n        \u251c\u2500\u2500 config\n        \u2502   \u2514\u2500\u2500 minion\n        \u2514\u2500\u2500 start-minion.sh"
}