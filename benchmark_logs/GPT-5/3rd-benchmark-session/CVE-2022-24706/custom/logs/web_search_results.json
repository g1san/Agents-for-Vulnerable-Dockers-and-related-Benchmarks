{
    "desc": "CVE-2022-24706 is a critical vulnerability in Apache CouchDB that stems from insecure default settings in the Erlang/OTP distribution subsystem bundled with CouchDB. On start-up, vulnerable CouchDB releases start an Erlang distribution listener on a random high TCP port bound to all network interfaces and register this port via the Erlang Port Mapper Daemon (epmd) listening on TCP/4369. Historically, many CouchDB packages also shipped with a default Erlang node cookie value set to \u201cmonster,\u201d which is used to authenticate Erlang node-to-node communications. If both epmd (4369) and the Erlang distribution port are reachable from an attacker\u2019s network, the attacker can discover the CouchDB node\u2019s distribution port through epmd, authenticate to the Erlang node using the default cookie, and then issue Erlang distribution commands. Through this channel, an attacker can gain CouchDB administrative privileges without using the HTTP API authentication and can execute operating system commands (for example, via the Erlang function os:cmd), achieving full system compromise. Public exploits and a Metasploit module demonstrate practical end-to-end exploitation. Affected versions include CouchDB prior to 3.2.2. Mitigations include upgrading to CouchDB 3.2.2 or later (which refuses the default cookie and binds epmd/distribution to localhost by default), changing the Erlang cookie to a unique value, restricting network exposure by firewalling epmd and the distribution port, and exposing only the HTTP service on 5984 for single-node deployments.",
    "attack_type": "Unauthenticated remote code execution leading to full administrative control via insecure inter-node Erlang distribution authentication",
    "services": [
        {
            "name": "couchdb",
            "version": [
                "3.2.1",
                "3.2.0",
                "3.1.2",
                "3.1.1",
                "3.1.0",
                "3.0.1",
                "3.0.0",
                "2.3.1",
                "2.3.0"
            ],
            "dependency_type": "HARD",
            "description": "Apache CouchDB server is the vulnerable component. Use an affected tag and default configuration that leaves the Erlang node cookie as \u201cmonster,\u201d binds epmd on TCP/4369 and the Erlang distribution port to 0.0.0.0, and exposes these ports. This alone is sufficient to create a working and testable system vulnerable to CVE-2022-24706; no additional services are required."
        }
    ],
    "input_tokens": 23499,
    "output_tokens": 2710,
    "query": "CVE-2022-24706 details advisory blog exploit affected versions"
}