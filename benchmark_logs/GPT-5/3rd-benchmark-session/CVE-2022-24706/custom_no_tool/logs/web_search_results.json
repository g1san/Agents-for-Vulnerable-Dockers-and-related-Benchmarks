{
    "desc": "CVE-2022-24706 is a critical vulnerability in Apache CouchDB\u2019s default Erlang distribution configuration affecting releases prior to 3.2.2. In default installs of affected versions, CouchDB launches an Erlang node that participates in the Erlang/OTP distribution system. Two network endpoints are involved: the Erlang Port Mapper Daemon (epmd) listening on the fixed TCP port 4369, and a separate Erlang distribution port that CouchDB opens on a random high TCP port. Historically, many CouchDB packages also set a default Erlang cookie value (commonly \u201cmonster\u201d), which is used to authenticate distributed Erlang nodes. When epmd and the Erlang distribution port are reachable from untrusted networks, an unauthenticated remote party can query epmd to discover the randomly chosen distribution port for the CouchDB Erlang node, then authenticate as a peer Erlang node using the default cookie. Once joined to the Erlang distribution, the attacker can invoke functions exposed by the Erlang runtime (for example, executing operating system commands) and thereby obtain administrative control over the CouchDB node. This issue does not involve the public HTTP API on TCP 5984 directly; rather, it stems from exposing epmd and the Erlang distribution port and relying on a default, predictable cookie. Systems that bind these Erlang-related ports only to localhost or firewall them off are not vulnerable. The CouchDB project remediated the problem in 3.2.2 by rejecting the default cookie value and by ensuring packages bind epmd and the distribution port to localhost by default. Recommended mitigations include upgrading to 3.2.2 or later, setting a unique Erlang cookie, and restricting network exposure so only the HTTP API port is accessible externally.",
    "attack_type": "unauthorized remote code execution leading to remote administrative privilege acquisition",
    "services": [
        {
            "name": "couchdb",
            "version": [
                "3.2.1",
                "3.2.0",
                "3.1.2",
                "3.1.1",
                "3.1.0",
                "3.0.1",
                "3.0.0",
                "2.3.1"
            ],
            "dependency_type": "HARD",
            "description": "Apache CouchDB is the sole service required. The vulnerability arises from CouchDB\u2019s embedded Erlang node exposing epmd (TCP 4369) and a random Erlang distribution port with a default cookie. To create a working, testable vulnerable Docker setup, deploy an affected CouchDB version and expose TCP 4369 plus the advertised random distribution port (along with 5984 if HTTP access is desired). No additional databases, message queues, web servers, or caches are required because epmd and the Erlang distribution are part of the CouchDB runtime within this container."
        }
    ],
    "input_tokens": 6528,
    "output_tokens": 2659
}