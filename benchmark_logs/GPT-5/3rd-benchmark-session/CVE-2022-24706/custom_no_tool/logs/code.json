{
    "files": [
        {
            "location": "./../../dockers/CVE-2022-24706/custom_no_tool/docker-compose.yml",
            "content": "services:\n  couchdb:\n    build: .\n    container_name: cve-2022-24706-couchdb\n    hostname: couchdb\n    environment:\n      - COUCHDB_USER=admin\n      - COUCHDB_PASSWORD=admin123\n      - NODENAME=couchdb\n      - ERL_FLAGS=-eval 'os:cmd(\"/usr/local/bin/init.sh &\")'\n      - RELEASE_COOKIE=monster\n    ports:\n      - \"5984:5984\"   # CouchDB HTTP API (default)\n      - \"4369:4369\"   # epmd (Erlang Port Mapper, default)\n    networks:\n      - cve-24706-net\n\nnetworks:\n  cve-24706-net:\n    driver: bridge\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24706/custom_no_tool/Dockerfile",
            "content": "FROM apache/couchdb:3.2.1\n\nUSER root\nRUN apt-get update \\\n    && apt-get install -y --no-install-recommends curl \\\n    && rm -rf /var/lib/apt/lists/*\n\nCOPY init.sh /usr/local/bin/init.sh\nRUN chmod +x /usr/local/bin/init.sh\n\n# Return to the default user used by the base image.\nUSER couchdb\n# Use the base image's default ENTRYPOINT and CMD (couchdb) so admin bootstrap works.\n"
        },
        {
            "location": "./../../dockers/CVE-2022-24706/custom_no_tool/init.sh",
            "content": "#!/bin/bash\nset -euo pipefail\n\n# Wait for CouchDB to be reachable on its HTTP port inside the container\nuntil curl -sf http://127.0.0.1:5984/ >/dev/null 2>&1; do\n  sleep 1\ndone\n# Small extra delay to ensure full readiness\nsleep 2\n\n# Create a sample database and insert a test document using the admin credentials\nDB_URL=\"http://127.0.0.1:5984\"\nAUTH=\"${COUCHDB_USER}:${COUCHDB_PASSWORD}\"\n\n# Create test database (idempotent)\ncurl -sf -u \"$AUTH\" -X PUT \"${DB_URL}/testdb\" >/dev/null 2>&1 || true\n\n# Insert a sample document\ncurl -sf -u \"$AUTH\" -H 'Content-Type: application/json' -X POST \\\n  \"${DB_URL}/testdb\" \\\n  -d '{\"_id\":\"doc1\",\"type\":\"demo\",\"msg\":\"hello from CVE-2022-24706 setup\"}' >/dev/null 2>&1 || true\n"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2022-24706/custom_no_tool\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 docker-compose.yml\n\u2514\u2500\u2500 init.sh"
}