{
    "files": [
        {
            "location": "./../../dockers/CVE-2012-1823/custom/docker-compose.yml",
            "content": "version: \"3.8\"\nservices:\n  web:\n    build: ./web\n    ports:\n      - \"80:80\"\n    container_name: cve-2012-1823-web\n    restart: unless-stopped\n"
        },
        {
            "location": "./../../dockers/CVE-2012-1823/custom/web/Dockerfile",
            "content": "# Multistage build: build vulnerable php-cgi (5.4.1) and serve with Apache HTTP Server 2.4.59\n\n# Builder stage: compile PHP 5.4.1 CGI SAPI using a modern Debian to avoid snapshot issues\nFROM debian:bullseye AS php-builder\n\nENV DEBIAN_FRONTEND=noninteractive\n\nRUN set -eux; \\\n    apt-get update; \\\n    apt-get install -y --no-install-recommends \\\n       ca-certificates wget build-essential autoconf pkg-config \\\n       libxml2-dev bison re2c; \\\n    rm -rf /var/lib/apt/lists/*\n\nWORKDIR /tmp\nRUN set -eux; \\\n    wget https://museum.php.net/php5/php-5.4.1.tar.gz; \\\n    echo \"Downloading PHP 5.4.1\"; \\\n    tar xzf php-5.4.1.tar.gz; \\\n    cd php-5.4.1; \\\n    # Avoid buildconf on release tarball; ensure compatibility with newer GCC\n    export CFLAGS=\"-O2 -fcommon\"; \\\n    ./configure \\\n      --prefix=/usr/local/php541 \\\n      --enable-cgi \\\n      --disable-all \\\n      --without-pear; \\\n    make -j\"$(nproc)\"; \\\n    make install\n\n# Final stage: Apache HTTP Server 2.4.59 serving .php via CGI using the vulnerable php-cgi\nFROM httpd:2.4.59\n\n# Copy php-cgi binary into Apache's cgi-bin\nCOPY --from=php-builder /usr/local/php541/bin/php-cgi /usr/local/apache2/cgi-bin/php-cgi\nRUN chmod +x /usr/local/apache2/cgi-bin/php-cgi\n\n# Provide full Apache configuration enabling CGI and mapping .php to php-cgi\nCOPY ./httpd.conf /usr/local/apache2/conf/httpd.conf\n\n# Web root with test PHP script\nCOPY ./htdocs/ /usr/local/apache2/htdocs/\n\n# Expose default HTTP port (80) by base image; no CMD override needed (httpd-foreground)\n"
        },
        {
            "location": "./../../dockers/CVE-2012-1823/custom/web/httpd.conf",
            "content": "ServerRoot \"/usr/local/apache2\"\nListen 80\nServerName localhost\n\nLoadModule mpm_event_module modules/mod_mpm_event.so\nLoadModule authn_core_module modules/mod_authn_core.so\nLoadModule authz_core_module modules/mod_authz_core.so\nLoadModule access_compat_module modules/mod_access_compat.so\nLoadModule alias_module modules/mod_alias.so\nLoadModule dir_module modules/mod_dir.so\nLoadModule mime_module modules/mod_mime.so\nLoadModule log_config_module modules/mod_log_config.so\nLoadModule unixd_module modules/mod_unixd.so\nLoadModule headers_module modules/mod_headers.so\nLoadModule setenvif_module modules/mod_setenvif.so\nLoadModule deflate_module modules/mod_deflate.so\nLoadModule filter_module modules/mod_filter.so\nLoadModule actions_module modules/mod_actions.so\nLoadModule cgid_module modules/mod_cgid.so\n\nUser daemon\nGroup daemon\nServerAdmin you@example.com\n\n<IfModule unixd_module>\n    # This is the default on the official image\n    #User daemon\n    #Group daemon\n</IfModule>\n\n# Logging\nErrorLog /proc/self/fd/2\nLogLevel warn\nCustomLog /proc/self/fd/1 common\n\n# Document root\nDocumentRoot \"/usr/local/apache2/htdocs\"\n<Directory \"/usr/local/apache2/htdocs\">\n    Options Indexes FollowSymLinks\n    AllowOverride None\n    Require all granted\n</Directory>\n\n# CGI configuration\nScriptAlias /cgi-bin/ \"/usr/local/apache2/cgi-bin/\"\n<Directory \"/usr/local/apache2/cgi-bin\">\n    AllowOverride None\n    Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch\n    Require all granted\n</Directory>\n\n# Map .php to the vulnerable php-cgi via CGI SAPI\nAddHandler php5-script .php\nAction php5-script \"/cgi-bin/php-cgi\"\nTypesConfig conf/mime.types\nAddType text/html .php\n\n# Directory index\nDirectoryIndex index.php index.html\n\n# Minimal configuration to allow CGI invocation path as required\n<IfModule cgid_module>\n    # Use absolute path to avoid duplicate logs/ prefixing\n    ScriptSock /usr/local/apache2/logs/cgi.sock\n</IfModule>\n\n# Keep base defaults similar to upstream\n<IfModule mime_module>\n    AddType application/x-compress .Z\n    AddType application/x-gzip .gz .tgz\n</IfModule>\n\n# Include any additional configs (none by default)\n#IncludeOptional conf/extra/*.conf\n"
        },
        {
            "location": "./../../dockers/CVE-2012-1823/custom/web/htdocs/index.php",
            "content": "<?php\n// Simple landing page\n?><!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\" />\n    <title>CVE-2012-1823 Testbed</title>\n  </head>\n  <body>\n    <h1>CVE-2012-1823 Vulnerable PHP-CGI Testbed</h1>\n    <p>If you can see this page rendered via PHP, the environment is ready.</p>\n    <p>PHP Version (from phpinfo):</p>\n    <?php phpinfo(); ?>\n  </body>\n</html>\n"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2012-1823/custom\n\u251c\u2500\u2500 docker-compose.yml\n\u2514\u2500\u2500 web\n    \u251c\u2500\u2500 Dockerfile\n    \u251c\u2500\u2500 httpd.conf\n    \u2514\u2500\u2500 htdocs\n        \u2514\u2500\u2500 index.php"
}