{
    "files": [
        {
            "location": "./../../dockers/CVE-2012-1823/custom_no_tool/docker-compose.yml",
            "content": "version: \"3.8\"\nservices:\n  httpd-php-cgi:\n    build: .\n    container_name: cve-2012-1823-httpd\n    ports:\n      - \"80:80\"\n    restart: unless-stopped\n"
        },
        {
            "location": "./../../dockers/CVE-2012-1823/custom_no_tool/Dockerfile",
            "content": "FROM httpd:2.4.58\n\n# Build vulnerable php-cgi (PHP 5.3.x vulnerable line)\nRUN apt-get update \\\n && apt-get install -y --no-install-recommends \\\n      ca-certificates \\\n      build-essential \\\n      curl \\\n      zlib1g-dev \\\n      libxml2-dev \\\n && rm -rf /var/lib/apt/lists/*\n\nENV PHP_VERSION=5.3.10\n\nRUN curl -fsSL https://museum.php.net/php5/php-${PHP_VERSION}.tar.gz -o /tmp/php.tar.gz \\\n && tar -xf /tmp/php.tar.gz -C /tmp \\\n && cd /tmp/php-${PHP_VERSION} \\\n && ./configure \\\n      --prefix=/usr/local/php-5.3 \\\n      --enable-cgi \\\n      --with-zlib \\\n      --disable-dom \\\n      --disable-simplexml \\\n      --disable-xml \\\n      --disable-xmlreader \\\n      --disable-xmlwriter \\\n      --without-pear \\\n && make -j\"$(nproc)\" \\\n && make install \\\n && rm -rf /tmp/php* \\\n && apt-get purge -y build-essential curl zlib1g-dev libxml2-dev \\\n && apt-get autoremove -y \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/*\n\n# Apache HTTPD configuration to run php-cgi via CGI/Action\nCOPY httpd.conf /usr/local/apache2/conf/httpd.conf\n\n# CGI wrapper invoking the vulnerable php-cgi binary\nCOPY cgi-bin/php-cgi /usr/local/apache2/cgi-bin/php-cgi\nRUN chmod +x /usr/local/apache2/cgi-bin/php-cgi\n\n# Sample PHP application\nCOPY htdocs/ /usr/local/apache2/htdocs/\n\nEXPOSE 80\nCMD [\"httpd-foreground\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2012-1823/custom_no_tool/httpd.conf",
            "content": "ServerRoot \"/usr/local/apache2\"\nListen 80\n\nLoadModule mpm_event_module modules/mod_mpm_event.so\nLoadModule authn_core_module modules/mod_authn_core.so\nLoadModule authz_core_module modules/mod_authz_core.so\nLoadModule headers_module modules/mod_headers.so\nLoadModule mime_module modules/mod_mime.so\nLoadModule dir_module modules/mod_dir.so\nLoadModule alias_module modules/mod_alias.so\nLoadModule cgid_module modules/mod_cgid.so\nLoadModule actions_module modules/mod_actions.so\nLoadModule rewrite_module modules/mod_rewrite.so\nLoadModule setenvif_module modules/mod_setenvif.so\nLoadModule log_config_module modules/mod_log_config.so\nLoadModule unixd_module modules/mod_unixd.so\nLoadModule authn_file_module modules/mod_authn_file.so\nLoadModule authz_host_module modules/mod_authz_host.so\n\nUser daemon\nGroup daemon\nServerAdmin you@example.com\n\nDocumentRoot \"/usr/local/apache2/htdocs\"\n<Directory \"/usr/local/apache2/htdocs\">\n    Options Indexes FollowSymLinks\n    AllowOverride None\n    Require all granted\n</Directory>\n\nDirectoryIndex index.php index.html\n\n# Expose cgi-bin and allow executing CGI scripts\nScriptAlias /cgi-bin/ \"/usr/local/apache2/cgi-bin/\"\n<Directory \"/usr/local/apache2/cgi-bin\">\n    AllowOverride None\n    Options +ExecCGI\n    Require all granted\n</Directory>\n\n# Map .php to php-cgi via CGI Action (vulnerable CGI SAPI)\nAddHandler application/x-httpd-php .php\nAction application/x-httpd-php \"/cgi-bin/php-cgi\"\n\nTypesConfig conf/mime.types\n\nErrorLog \"/proc/self/fd/2\"\nCustomLog \"/proc/self/fd/1\" common\n\n<IfModule mime_module>\n    AddType text/html .shtml\n    AddOutputFilter INCLUDES .shtml\n</IfModule>\n"
        },
        {
            "location": "./../../dockers/CVE-2012-1823/custom_no_tool/cgi-bin/php-cgi",
            "content": "#!/bin/sh\n# Simple wrapper to invoke the vulnerable php-cgi interpreter\nexec /usr/local/php-5.3/bin/php-cgi\n"
        },
        {
            "location": "./../../dockers/CVE-2012-1823/custom_no_tool/htdocs/index.php",
            "content": "<?php\n// Minimal PHP page served through php-cgi (CGI SAPI)\n// This endpoint is intended to be used to validate the vulnerable behavior of php-cgi\nheader('Content-Type: text/plain');\necho \"PHP CGI test endpoint\\n\";\necho \"Time: \".date('c').\"\\n\";\necho \"Client: \".($_SERVER['REMOTE_ADDR'] ?? 'unknown').\"\\n\";\n?>\n"
        },
        {
            "location": "./../../dockers/CVE-2012-1823/custom_no_tool/htdocs/hello.php",
            "content": "<?php\nheader('Content-Type: text/plain');\n$name = isset($_GET['name']) ? $_GET['name'] : 'world';\necho \"Hello, {$name}!\\n\";\n?>\n"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2012-1823/custom_no_tool\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 httpd.conf\n\u251c\u2500\u2500 cgi-bin\n\u2502   \u2514\u2500\u2500 php-cgi\n\u2514\u2500\u2500 htdocs\n    \u251c\u2500\u2500 hello.php\n    \u2514\u2500\u2500 index.php"
}