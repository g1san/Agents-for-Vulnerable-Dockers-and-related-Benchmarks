{
    "desc": "CVE-2023-42793 is a critical vulnerability in JetBrains TeamCity Server (On\u2011Premises; TeamCity Cloud is not affected) that allows an unauthenticated attacker to bypass authentication and ultimately execute operating system commands on the TeamCity Server. The root cause is a flawed global request interceptor in TeamCity versions prior to 2023.05.4. TeamCity disabled pre\u2011handling, including authentication, for any request path matching the wildcard pattern /**/RPC2. Attackers can craft requests whose paths end in /RPC2 so they are processed without authentication. This design flaw can be combined with a hidden REST endpoint that manages user tokens: POST /app/rest/users/{userLocator}/tokens/{name}. By setting the token name to RPC2, the request path ends with /RPC2, thereby skipping authentication, and the server creates an authentication token for an arbitrary user such as the administrative user with identifier 1. With that token, the attacker gains full administrative access to the TeamCity REST API and user interface. From there, the attacker can execute commands on the TeamCity Server through exposed debug or process\u2011spawning endpoints (for example, invoking /app/rest/debug/processes?exePath=<command>&params=<args>) or by abusing build configurations and agents, resulting in remote code execution. Consequences include theft of source code, credentials, and signing keys stored in the server or build pipelines; takeover of build agents; and poisoning of build artifacts. The vulnerability was discovered by Sonar and fixed in TeamCity 2023.05.4 by narrowing the exception so only the exact path /RPC2 is exempted from pre\u2011handling, eliminating the wildcard bypass. Multiple security reports and telemetry (including from Fortinet and Microsoft) indicate widespread, real\u2011world exploitation beginning in early October 2023, including by advanced persistent threat actors who used the flaw for initial access and persistence. Indicators of compromise include the presence of a user token named \u201cRPC2.\u201d Mitigation requires upgrading to 2023.05.4 or later or applying JetBrains\u2019 security patch plugin on earlier releases, followed by thorough compromise assessment when servers were exposed to the internet before patching.",
    "attack_type": "Authentication bypass leading to remote code execution",
    "services": [
        {
            "name": "jetbrains/teamcity-server",
            "version": [
                "2023.05.3"
            ],
            "dependency_type": "HARD",
            "description": "JetBrains TeamCity Server provides the vulnerable web and REST services. Version 2023.05.3 (and other versions prior to 2023.05.4) contains the authentication bypass that enables unauthenticated token creation and follow-on command execution. Running this single container with its built-in database is sufficient to reproduce the vulnerability; no additional services are required."
        }
    ],
    "input_tokens": 19162,
    "output_tokens": 2098
}