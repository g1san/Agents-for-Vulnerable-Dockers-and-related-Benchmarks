{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-28164/custom/docker-compose.yml",
            "content": "services:\n  jetty:\n    build:\n      context: ./jetty\n      dockerfile: Dockerfile\n    image: cve-2021-28164-jetty:9.4.37-jre11\n    container_name: cve-2021-28164-jetty\n    ports:\n      - \"8080:8080\"\n    restart: unless-stopped\n"
        },
        {
            "location": "./../../dockers/CVE-2021-28164/custom/jetty/Dockerfile",
            "content": "FROM eclipse-temurin:11-jre\n\nENV JETTY_VERSION=9.4.37.v20210219 \\\n    JETTY_HOME=/opt/jetty \\\n    JETTY_BASE=/var/lib/jetty\n\n# Create jetty user/group and install prerequisites\nRUN useradd -r -m -U -d ${JETTY_HOME} -s /usr/sbin/nologin jetty \\\n    && apt-get update \\\n    && apt-get install -y --no-install-recommends ca-certificates curl bash \\\n    && rm -rf /var/lib/apt/lists/* \\\n    # Fetch and install Jetty distribution\n    && mkdir -p ${JETTY_HOME} \\\n    && curl -fsSL https://repo1.maven.org/maven2/org/eclipse/jetty/jetty-distribution/${JETTY_VERSION}/jetty-distribution-${JETTY_VERSION}.tar.gz -o /tmp/jetty.tar.gz \\\n    && tar -xzf /tmp/jetty.tar.gz -C ${JETTY_HOME} --strip-components=1 \\\n    && rm /tmp/jetty.tar.gz \\\n    # Initialize Jetty base with needed modules (ensure server, http, and deploy are enabled)\n    && mkdir -p ${JETTY_BASE} \\\n    && JETTY_BASE=${JETTY_BASE} java -jar ${JETTY_HOME}/start.jar --create-startd --add-to-start=server,http,deploy \\\n    && chown -R jetty:jetty ${JETTY_HOME} ${JETTY_BASE}\n\n# Copy vulnerable demo webapp into Jetty's webapps directory\nCOPY webapps/ ${JETTY_BASE}/webapps/\n\n# Ensure ownership for runtime\nRUN chown -R jetty:jetty ${JETTY_BASE}\n\nUSER jetty\nWORKDIR ${JETTY_BASE}\nEXPOSE 8080\n\n# Start Jetty with explicit modules to guarantee a runnable server\nCMD [\"java\", \"-jar\", \"/opt/jetty/start.jar\", \"--module=server,http,deploy\"]\n"
        },
        {
            "location": "./../../dockers/CVE-2021-28164/custom/jetty/webapps/app/index.html",
            "content": "<!doctype html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\" />\n    <title>Jetty CVE-2021-28164 Demo</title>\n  </head>\n  <body>\n    <h1>Jetty CVE-2021-28164 Demo App</h1>\n    <p>This is a simple web application served by Jetty 9.4.37-jre11 at context path <code>/app</code>.</p>\n    <p>Default page is served from <code>/app/index.html</code>.</p>\n  </body>\n</html>\n"
        },
        {
            "location": "./../../dockers/CVE-2021-28164/custom/jetty/webapps/app/WEB-INF/web.xml",
            "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<web-app xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd\"\n         version=\"3.1\"\n         metadata-complete=\"true\">\n\n  <display-name>Vulnerable Jetty Demo</display-name>\n\n  <welcome-file-list>\n    <welcome-file>index.html</welcome-file>\n  </welcome-file-list>\n\n  <!-- Intentional placeholder to make WEB-INF/web.xml content recognizable -->\n  <context-param>\n    <param-name>demo-flag</param-name>\n    <param-value>CVE-2021-28164-test-artifact</param-value>\n  </context-param>\n\n</web-app>\n"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2021-28164/custom\n\u2514\u2500\u2500 docker-compose.yml\n\u2514\u2500\u2500 jetty\n    \u251c\u2500\u2500 Dockerfile\n    \u2514\u2500\u2500 webapps\n        \u2514\u2500\u2500 app\n            \u251c\u2500\u2500 index.html\n            \u2514\u2500\u2500 WEB-INF\n                \u2514\u2500\u2500 web.xml"
}