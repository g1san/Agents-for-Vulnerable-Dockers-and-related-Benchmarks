{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-42013/custom_no_tool/docker-compose.yml",
            "content": "version: \"3.8\"\nservices:\n  httpd:\n    build: ./httpd\n    ports:\n      - \"80:80\"\n    restart: unless-stopped\n"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom_no_tool/httpd/Dockerfile",
            "content": "FROM httpd:2.4.49\n\n# Provide custom configuration enabling CGI and an aliased directory with permissive access\nCOPY httpd.conf /usr/local/apache2/conf/httpd.conf\n\n# Web content\nCOPY htdocs/ /usr/local/apache2/htdocs/\n\n# CGI scripts\nCOPY cgi-bin/ /usr/local/apache2/cgi-bin/\n\n# Aliased directory content (world-accessible)\nRUN mkdir -p /var/www/alias\nCOPY alias/ /var/www/alias/\n\n# Ensure CGI scripts are executable\nRUN chmod +x /usr/local/apache2/cgi-bin/*.sh || true \\\n && chmod +x /var/www/alias/*.sh || true\n"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom_no_tool/httpd/httpd.conf",
            "content": "ServerRoot \"/usr/local/apache2\"\nListen 80\nServerName localhost\n\n# Load core modules and those needed for Alias, CGI, and directory listings\nLoadModule mpm_event_module modules/mod_mpm_event.so\nLoadModule unixd_module modules/mod_unixd.so\nLoadModule authz_core_module modules/mod_authz_core.so\nLoadModule alias_module modules/mod_alias.so\nLoadModule dir_module modules/mod_dir.so\nLoadModule mime_module modules/mod_mime.so\nLoadModule autoindex_module modules/mod_autoindex.so\nLoadModule negotiation_module modules/mod_negotiation.so\nLoadModule log_config_module modules/mod_log_config.so\nLoadModule cgid_module modules/mod_cgid.so\nLoadModule setenvif_module modules/mod_setenvif.so\n\nUser daemon\nGroup daemon\n\nPidFile logs/httpd.pid\nErrorLog logs/error_log\nLogLevel warn\nCustomLog logs/access_log combined\n\nTypesConfig conf/mime.types\nDefaultType text/plain\n\n# Document root\nDocumentRoot \"/usr/local/apache2/htdocs\"\n<Directory \"/usr/local/apache2/htdocs\">\n    Options Indexes FollowSymLinks\n    AllowOverride None\n    Require all granted\n</Directory>\n\n# Enable directory index\nDirectoryIndex index.html\n\n# Standard CGI location mapped via ScriptAlias\nScriptAlias /cgi-bin/ \"/usr/local/apache2/cgi-bin/\"\n<Directory \"/usr/local/apache2/cgi-bin\">\n    AllowOverride None\n    Options +ExecCGI\n    AddHandler cgi-script .cgi .pl .sh\n    Require all granted\n</Directory>\n\n# Aliased directory intentionally left broadly accessible (to reproduce CVE behavior)\nAlias /public/ \"/var/www/alias/\"\n<Directory \"/var/www/alias\">\n    Options Indexes FollowSymLinks ExecCGI\n    AllowOverride None\n    AddHandler cgi-script .cgi .pl .sh\n    Require all granted\n</Directory>\n\n# Basic MIME types\nAddType text/html .html .htm\nAddType text/plain .txt .log\n\n# KeepAlive settings\nKeepAlive On\nMaxKeepAliveRequests 100\nKeepAliveTimeout 5\n\n# Accept CGI via mod_cgid\nScriptSock logs/cgisock\n"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom_no_tool/httpd/htdocs/index.html",
            "content": "<!doctype html>\n<html>\n<head>\n  <meta charset=\"utf-8\" />\n  <title>CVE-2021-42013 Testbed</title>\n</head>\n<body>\n  <h1>Apache HTTP Server 2.4.49 Testbed</h1>\n  <p>This container exposes:</p>\n  <ul>\n    <li>DocumentRoot at / (served from /usr/local/apache2/htdocs)</li>\n    <li>CGI at /cgi-bin/ (mod_cgid enabled)</li>\n    <li>Aliased directory at /public/ (world accessible, ExecCGI enabled)</li>\n  </ul>\n  <p>Default port: 80 (published on host as 80)</p>\n</body>\n</html>\n"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom_no_tool/httpd/cgi-bin/test.sh",
            "content": "#!/bin/sh\n# Simple CGI that executes a command passed via the query string as cmd=...\n# Example: /cgi-bin/test.sh?cmd=id\n\necho \"Content-Type: text/plain\"\necho\n\nif [ -n \"$QUERY_STRING\" ]; then\n  CMD=$(printf '%s' \"$QUERY_STRING\" | sed -n 's/^cmd=\\(.*\\)$/\\1/p')\n  if [ -n \"$CMD\" ]; then\n    sh -c \"$CMD\"\n    exit 0\n  fi\nfi\n\necho \"Usage: /cgi-bin/test.sh?cmd=<shell-command>\"\n"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom_no_tool/httpd/alias/echo.sh",
            "content": "#!/bin/sh\n# A trivial CGI in the aliased directory\n\necho \"Content-Type: text/plain\"\necho\n\necho \"CGI from aliased directory works.\"\n"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom_no_tool/httpd/alias/sample.txt",
            "content": "This is a sample file within the aliased directory (/public/).\n"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2021-42013/custom_no_tool\n\u251c\u2500\u2500 docker-compose.yml\n\u2514\u2500\u2500 httpd\n    \u251c\u2500\u2500 Dockerfile\n    \u251c\u2500\u2500 httpd.conf\n    \u251c\u2500\u2500 alias\n    \u2502   \u251c\u2500\u2500 echo.sh\n    \u2502   \u2514\u2500\u2500 sample.txt\n    \u251c\u2500\u2500 cgi-bin\n    \u2502   \u2514\u2500\u2500 test.sh\n    \u2514\u2500\u2500 htdocs\n        \u2514\u2500\u2500 index.html\n"
}