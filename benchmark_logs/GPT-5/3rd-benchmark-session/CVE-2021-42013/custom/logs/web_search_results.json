{
    "desc": "CVE-2021-42013 is a vulnerability in Apache HTTP Server that stems from an incomplete fix for CVE-2021-41773. In versions 2.4.49 and 2.4.50, the core path normalization routine (ap_normalize_path) incorrectly handles a mix of decoded and percent-encoded dot segments (for example, \".%2e\"), which allows an attacker to bypass directory traversal checks. As a result, a crafted URL can be mapped to files outside of the intended DocumentRoot or outside directories guarded by Alias-like directives. When such external locations are not protected by the default access control of \u201cRequire all denied,\u201d attackers can retrieve arbitrary files from the underlying filesystem (for example, reading /etc/passwd by traversing outside the webroot). The risk significantly increases under misconfigurations that grant broad access, such as applying \u201cRequire all granted\u201d at the root level or exposing a publicly accessible alias like cgi-bin. If the Common Gateway Interface is enabled for those aliased paths (for example, mod_cgi or mod_cgid with ScriptAlias for cgi-bin), an attacker can escalate from file disclosure to executing arbitrary commands on the server. This happens because the traversal permits invoking interpreters or scripts (such as /bin/sh) as if they were within the CGI-enabled directory, allowing command execution through crafted requests (for example, sending POST data that becomes the standard input to /bin/sh invoked via a traversed cgi-bin path). Only Apache HTTP Server 2.4.49 and 2.4.50 are affected; the issue was corrected in 2.4.51 by strengthening the path normalization and restoring intended access controls. Recommended mitigations include upgrading to 2.4.51 or later, ensuring non-public locations remain protected by \u201cRequire all denied,\u201d avoiding overly permissive directives at the root, disabling or strictly limiting Common Gateway Interface execution, and auditing Alias/ScriptAlias configurations to prevent unintended exposure of filesystem paths.",
    "attack_type": "Path traversal leading to arbitrary file read and remote code execution",
    "services": [
        {
            "name": "httpd",
            "version": [
                "2.4.49",
                "2.4.50"
            ],
            "dependency_type": "HARD",
            "description": "Apache HTTP Server is the core and only required service to reproduce the vulnerability. Use the official httpd image at vulnerable versions (2.4.49 or 2.4.50). In configuration, enable Common Gateway Interface (for example, LoadModule cgi_module modules/mod_cgi.so or mod_cgid) and expose an Alias/ScriptAlias such as /cgi-bin/ with access improperly granted (for example, Require all granted) so that traversal via mixed encoded dot segments can reach outside the intended directory. No additional services are required; misconfiguration and module enablement occur within httpd itself."
        }
    ],
    "input_tokens": 33957,
    "output_tokens": 1634,
    "query": "CVE-2021-42013 Apache HTTP Server 2.4.49 2.4.50 path traversal RCE details exploit mitigation timeline"
}