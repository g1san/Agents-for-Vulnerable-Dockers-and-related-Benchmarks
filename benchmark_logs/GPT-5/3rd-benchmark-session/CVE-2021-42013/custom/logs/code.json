{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-42013/custom/docker-compose.yml",
            "content": "version: \"3.8\"\nservices:\n  httpd:\n    build: ./httpd\n    image: cve-2021-42013-httpd:2.4.49\n    container_name: cve-2021-42013-httpd\n    ports:\n      - \"80:80\"\n    restart: unless-stopped\n"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom/httpd/Dockerfile",
            "content": "FROM httpd:2.4.49\n\n# Copy vulnerable configuration and content\nCOPY conf/httpd.conf /usr/local/apache2/conf/httpd.conf\nCOPY htdocs/ /usr/local/apache2/htdocs/\nCOPY cgi-bin/ /usr/local/apache2/cgi-bin/\n\n# Ensure CGI scripts are executable\nRUN chmod +x /usr/local/apache2/cgi-bin/* || true\n\n# Default command provided by base image\n"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom/httpd/conf/httpd.conf",
            "content": "ServerRoot \"/usr/local/apache2\"\nListen 80\n\n# Core modules and essentials\nLoadModule mpm_event_module modules/mod_mpm_event.so\nLoadModule authn_core_module modules/mod_authn_core.so\nLoadModule authz_core_module modules/mod_authz_core.so\nLoadModule authz_host_module modules/mod_authz_host.so\nLoadModule access_compat_module modules/mod_access_compat.so\nLoadModule dir_module modules/mod_dir.so\nLoadModule mime_module modules/mod_mime.so\nLoadModule log_config_module modules/mod_log_config.so\nLoadModule unixd_module modules/mod_unixd.so\nLoadModule alias_module modules/mod_alias.so\nLoadModule cgid_module modules/mod_cgid.so\nLoadModule env_module modules/mod_env.so\nLoadModule setenvif_module modules/mod_setenvif.so\nLoadModule headers_module modules/mod_headers.so\nLoadModule autoindex_module modules/mod_autoindex.so\n\nUser daemon\nGroup daemon\n\nServerAdmin admin@example.local\nServerName localhost\n\n# Intentionally permissive access to make the issue reachable\n<Directory />\n    AllowOverride None\n    Require all granted\n</Directory>\n\nDocumentRoot \"/usr/local/apache2/htdocs\"\n<Directory \"/usr/local/apache2/htdocs\">\n    Options Indexes FollowSymLinks\n    AllowOverride None\n    Require all granted\n</Directory>\n\n# Enable CGI with broad access on /cgi-bin/\nScriptAlias /cgi-bin/ \"/usr/local/apache2/cgi-bin/\"\n<Directory \"/usr/local/apache2/cgi-bin\">\n    AllowOverride None\n    Options +ExecCGI\n    Require all granted\n</Directory>\n\n# Allow common CGI extensions\nAddHandler cgi-script .cgi .pl .sh\n\n# MIME, logging, defaults\nTypesConfig conf/mime.types\nAddType text/html .shtml\nAddOutputFilter INCLUDES .shtml\n\nDirectoryIndex index.html\n\nErrorLog logs/error.log\nCustomLog logs/access.log combined\n\n# KeepAlive and simple defaults\nKeepAlive On\nMaxKeepAliveRequests 100\nKeepAliveTimeout 5\n\n# Security tokens kept default for this lab\nServerTokens Full\nServerSignature On\n\n# Ensure cgid socket path exists (default)\n# ScriptSock logs/cgid.sock\n"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom/httpd/htdocs/index.html",
            "content": "<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"utf-8\" />\n  <title>CVE-2021-42013 Lab - Apache 2.4.49</title>\n</head>\n<body>\n  <h1>Apache HTTP Server 2.4.49</h1>\n  <p>This container is configured to reproduce CVE-2021-42013 conditions.</p>\n  <p>Static content is served from /usr/local/apache2/htdocs</p>\n  <p>CGI is enabled at /cgi-bin/</p>\n</body>\n</html>\n"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom/httpd/cgi-bin/test.cgi",
            "content": "#!/usr/bin/env sh\nprintf \"Content-Type: text/plain\\r\\n\\r\\n\"\necho \"Hello from CGI\"\necho \"PATH_INFO=$PATH_INFO\"\necho \"QUERY_STRING=$QUERY_STRING\"\n"
        }
    ],
    "directory_tree": "CVE-2021-42013/\n\u2514\u2500 custom/\n   \u251c\u2500 docker-compose.yml\n   \u2514\u2500 httpd/\n      \u251c\u2500 Dockerfile\n      \u251c\u2500 conf/\n      \u2502  \u2514\u2500 httpd.conf\n      \u251c\u2500 htdocs/\n      \u2502  \u2514\u2500 index.html\n      \u2514\u2500 cgi-bin/\n         \u2514\u2500 test.cgi\n"
}