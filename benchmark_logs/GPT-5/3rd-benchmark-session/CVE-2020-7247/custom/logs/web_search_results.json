{
    "desc": "CVE-2020-7247 is a critical vulnerability in OpenSMTPD (the Simple Mail Transfer Protocol daemon from the OpenBSD project) that allows arbitrary command execution with superuser privileges, both remotely and locally, in the default configuration. The root cause is a logic flaw in the smtp_mailaddr() function (smtp_session.c). When the domain part of an email address is missing in an SMTP command, OpenSMTPD auto-completes it with a default domain and incorrectly returns success even if the local-part is invalid. This bypasses intended whitelist and escaping checks. In default setups, OpenSMTPD invokes the mail delivery agent via a shell using a command akin to: /bin/sh -c '/usr/libexec/mail.local -f %{mbox.from} %{user.username}'. Because the %{mbox.from} field is attacker-controlled (derived from the SMTP MAIL FROM command), shell metacharacters can be injected into the command line. Due to the flawed validation, certain invalid characters and constructs can reach the shell unescaped, leading to arbitrary command execution as the root user. The issue affects OpenSMTPD as shipped with OpenBSD 6.6 and other distributions packaging OpenSMTPD 6.6-era releases, and it has been exploitable since around May 2018. Researchers demonstrated practical exploit paths despite constraints such as a maximum local-part length (64 characters) and partial escaping of some characters. The default, uncommented configuration of the OpenSMTPD SMTP service is impacted. The vulnerability was fixed by patches from OpenBSD and by upgrading OpenSMTPD to 6.6.2p1 or later.",
    "attack_type": "Arbitrary command execution as superuser via remote input validation failure in an email submission dialog (remote code execution)",
    "services": [
        {
            "name": "instrumentisto/opensmtpd",
            "version": [
                "6.6"
            ],
            "dependency_type": "HARD",
            "description": "OpenSMTPD daemon providing the vulnerable SMTP service. Version 6.6 is explicitly identified by NIST/MITRE as affected; running this container alone exposes the vulnerable smtp_mailaddr() path and default local delivery command invocation that enables command injection."
        }
    ],
    "input_tokens": 1573,
    "output_tokens": 772,
    "query": "CVE-2020-7247 OpenSMTPD remote code execution details affected versions exploit patch 6.6.2p1 Qualys"
}