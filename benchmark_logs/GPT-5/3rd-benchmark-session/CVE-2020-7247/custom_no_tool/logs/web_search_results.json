{
    "desc": "CVE-2020-7247 is a critical vulnerability in OpenSMTPD, the Simple Mail Transfer Protocol daemon used by OpenBSD and portable distributions. The flaw resides in smtp_session.c (function smtp_mailaddr) and stems from an incorrect return value during input validation after the \u201cnew grammar\u201d changes introduced in the 6.4 series. In vulnerable releases, user-controlled input in the SMTP envelope (specifically the MAIL FROM address) is not properly sanitized; shell metacharacters included in that field can be propagated to shell execution contexts. As a result, a remote, unauthenticated attacker can deliver a specially crafted SMTP dialogue to the daemon (typically via TCP port 25) that injects commands and causes execution of arbitrary shell commands with root privileges under the default, uncommented configuration. Public analyses (e.g., Qualys) and vendor trackers emphasized that exploitation is straightforward against any system exposing the SMTP service, because no additional components or uncommon configuration are required beyond a reachable OpenSMTPD listener. The vulnerability affects OpenBSD\u2019s base OpenSMTPD (e.g., OpenBSD 6.6, 6.5, 6.4, 5.9) and portable OpenSMTPD builds that incorporate the flawed code path. The issue was fixed by OpenSMTPD commit 2afab2297 and released as OpenSMTPD 6.6.2; upgrading to 6.6.2 or later remediates the problem. Security advisories and trackers (NVD/NIST, Debian, Rapid7) rate the issue at the highest severity because it enables remote command execution as root via crafted SMTP input in the MAIL FROM field and requires only network access to the SMTP daemon. In summary, the core conditions for exploitation are: a vulnerable OpenSMTPD daemon reachable on its SMTP port, the default or equivalently permissive configuration, and a maliciously crafted MAIL FROM value that injects shell metacharacters, which the daemon mishandles and executes.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "instrumentisto/opensmtpd",
            "version": [
                "6.6"
            ],
            "dependency_type": "HARD",
            "description": "OpenSMTPD daemon exposing SMTP (TCP/25). This is the vulnerable component; using a tag corresponding to OpenSMTPD 6.6 satisfies the NVD-cited affected version and makes the container susceptible to CVE-2020-7247."
        }
    ],
    "input_tokens": 3657,
    "output_tokens": 2217
}