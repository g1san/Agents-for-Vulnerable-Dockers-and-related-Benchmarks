{
    "desc": "OpenSMTPD\u2019s smtp_mailaddr function in smtp_session.c improperly validates input in the SMTP envelope parsing of the MAIL FROM address. Crafted MAIL FROM values containing shell metacharacters can be interpreted and executed with root privileges. The flaw stems from an incorrect return-path after a validation failure, allowing dangerous input to proceed. It is reachable remotely in the default configuration that listens on all interfaces and locally in loopback\u2011only defaults. Affected upstream family is OpenSMTPD 6.6 (portable), with practical vulnerable releases being 6.6.0p1, 6.6.1, 6.6.1p1, and 6.6.2; the issue was fixed in 6.6.2p1.",
    "attack_type": "Unauthenticated remote operating-system command execution via SMTP MAIL FROM input, resulting in execution of attacker-supplied commands with root privileges.",
    "services": [
        {
            "name": "debian",
            "version": [
                "10-slim"
            ],
            "dependency_type": "SOFT",
            "description": "Minimal Linux base image used to build and run OpenSMTPD 6.6.x; provides glibc and tooling. Expose TCP port 25 for SMTP. Suitable for compiling and installing the specified vulnerable OpenSMTPD versions."
        },
        {
            "name": "OpenSMTPD",
            "version": [
                "6.6.0p1",
                "6.6.1",
                "6.6.1p1",
                "6.6.2"
            ],
            "dependency_type": "HARD",
            "description": "Mail transfer agent containing the vulnerable smtp_mailaddr parsing logic. Required for the system to be susceptible to CVE-2020-7247. Upstream fixed version boundary is 6.6.2p1 (use only for patched/control builds)."
        }
    ],
    "input_tokens": 33722,
    "output_tokens": 4681
}