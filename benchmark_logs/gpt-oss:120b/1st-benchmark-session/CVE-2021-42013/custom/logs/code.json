{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-42013/custom/docker-compose.yml",
            "content": "version: \"3.8\"\nservices:\n  web:\n    build: .\n    ports:\n      - \"8080:80\"\n    volumes:\n      - ./htdocs:/usr/local/apache2/htdocs\n      - ./conf/httpd.conf:/usr/local/apache2/conf/httpd.conf\n    restart: unless-stopped"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom/Dockerfile",
            "content": "FROM httpd:2.4.49\n\n# Create cgi-bin directory\nRUN mkdir -p /usr/local/apache2/cgi-bin\n\n# Enable CGI module and set ServerName\nRUN sed -i 's/#LoadModule cgi_module modules\\/mod_cgi.so/LoadModule cgi_module modules\\/mod_cgi.so/' /usr/local/apache2/conf/httpd.conf && \\\n    sed -i 's/Listen 80/Listen 80\\n    ServerName localhost/' /usr/local/apache2/conf/httpd.conf\n\n# Add CGI directory configuration\nRUN echo -e '\\n<Directory \"/usr/local/apache2/cgi-bin\">\\n    Options +ExecCGI\\n    AddHandler cgi-script .cgi .pl .py\\n</Directory>' >> /usr/local/apache2/conf/httpd.conf\n\n# Add ScriptAlias for CGI\nRUN echo -e '\\nScriptAlias /cgi-bin/ \"/usr/local/apache2/cgi-bin/\"' >> /usr/local/apache2/conf/httpd.conf\n\n# Copy vulnerable CGI script\nCOPY cgi-bin/vuln.cgi /usr/local/apache2/cgi-bin/vuln.cgi\nRUN chmod +x /usr/local/apache2/cgi-bin/vuln.cgi"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom/conf/httpd.conf",
            "content": "ServerRoot \"/usr/local/apache2\"\nListen 80\nLoadModule mpm_event_module modules/mod_mpm_event.so\nLoadModule authn_file_module modules/mod_authn_file.so\nLoadModule authz_host_module modules/mod_authz_host.so\nLoadModule authz_core_module modules/mod_authz_core.so\nLoadModule dir_module modules/mod_dir.so\nLoadModule alias_module modules/mod_alias.so\nLoadModule rewrite_module modules/mod_rewrite.so\nLoadModule cgi_module modules/mod_cgi.so\nLoadModule mime_module modules/mod_mime.so\nLoadModule log_config_module modules/mod_log_config.so\nLoadModule unixd_module modules/mod_unixd.so\n\n#User daemon\n#Group daemon\n\nServerAdmin you@example.com\nServerName localhost\n\nDocumentRoot \"/usr/local/apache2/htdocs\"\n<Directory \"/usr/local/apache2/htdocs\">\n    Options Indexes FollowSymLinks\n    AllowOverride None\n    Require all granted\n</Directory>\n\nScriptAlias /cgi-bin/ \"/usr/local/apache2/cgi-bin/\"\n<Directory \"/usr/local/apache2/cgi-bin\">\n    Options +ExecCGI\n    AddHandler cgi-script .cgi .pl .py\n    Require all granted\n</Directory>\n\nErrorLog /proc/self/fd/2\nCustomLog /proc/self/fd/1 combined"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom/htdocs/index.html",
            "content": "<!DOCTYPE html>\n<html>\n<head>\n    <title>Vulnerable Apache Demo</title>\n</head>\n<body>\n    <h1>Welcome to the vulnerable Apache server (CVE-2021-42013)</h1>\n    <p>Try accessing the CGI script: <a href=\"/cgi-bin/vuln.cgi\">vuln.cgi</a></p>\n</body>\n</html>"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom/cgi-bin/vuln.cgi",
            "content": "#!/usr/bin/env perl\nuse strict;\nuse warnings;\n\nprint \"Content-type: text/plain\\n\\n\";\nprint \"--- Vulnerable CGI Output ---\\n\";\nprint \"You requested: $ENV{REQUEST_URI}\\n\";\n\n# Echo back any query parameters (demonstrates lack of sanitisation)\nif (defined $ENV{QUERY_STRING}) {\n    print \"Query string: $ENV{QUERY_STRING}\\n\";\n}\n\n# Attempt to read a file path supplied via a \"file\" parameter (illustrates path traversal)\nif ($ENV{QUERY_STRING} && $ENV{QUERY_STRING} =~ /file=([^&]+)/) {\n    my $file = $1;\n    $file =~ s/%([0-9A-Fa-f]{2})/chr(hex($1))/ge;  # URL decode\n    if (open my $fh, '<', $file) {\n        print \"\\n--- Contents of $file ---\\n\";\n        while (my $line = <$fh>) {\n            print $line;\n        }\n        close $fh;\n    } else {\n        print \"\\nFailed to open $file: $!\\n\";\n    }\n}\n"
        }
    ],
    "directory_tree": "CVE-2021-42013/custom"
}