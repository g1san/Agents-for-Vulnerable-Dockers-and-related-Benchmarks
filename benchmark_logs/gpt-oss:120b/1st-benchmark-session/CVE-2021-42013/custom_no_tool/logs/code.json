{
    "files": [
        {
            "location": "./../../dockers/CVE-2021-42013/custom_no_tool/docker-compose.yml",
            "content": "version: \"3.8\"\n\nservices:\n  apache:\n    build:\n      context: ./apache\n      dockerfile: Dockerfile\n    ports:\n      - \"8080:80\"\n    depends_on:\n      - backend\n    networks:\n      - vulnnet\n    restart: unless-stopped\n\n  backend:\n    build:\n      context: ./backend\n      dockerfile: Dockerfile\n    # No host port exposure \u2013 backend is only reachable via Apache proxy\n    networks:\n      - vulnnet\n    restart: unless-stopped\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:5000/\" ]\n      interval: 30s\n      timeout: 5s\n      retries: 3\n      start_period: 5s\n\nnetworks:\n  vulnnet:\n    driver: bridge"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom_no_tool/apache/Dockerfile",
            "content": "FROM httpd:2.4.49\nCOPY httpd.conf /usr/local/apache2/conf/httpd.conf\nCOPY ./public/ /usr/local/apache2/htdocs/"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom_no_tool/apache/httpd.conf",
            "content": "ServerRoot \"/usr/local/apache2\"\nListen 80\n\n# Load only the modules required for the demo and the vulnerable proxy configuration\nLoadModule mpm_event_module modules/mod_mpm_event.so\nLoadModule authz_core_module modules/mod_authz_core.so\nLoadModule authz_host_module modules/mod_authz_host.so\nLoadModule dir_module modules/mod_dir.so\nLoadModule alias_module modules/mod_alias.so\nLoadModule proxy_module modules/mod_proxy.so\nLoadModule proxy_http_module modules/mod_proxy_http.so\nLoadModule rewrite_module modules/mod_rewrite.so\n\nServerAdmin you@example.com\nServerName localhost\nDocumentRoot \"/usr/local/apache2/htdocs\"\n\n<Directory \"/usr/local/apache2/htdocs\">\n    Options Indexes FollowSymLinks\n    AllowOverride All\n    Require all granted\n</Directory>\n\n# Vulnerable proxy configuration (CVE-2021-42013)\nProxyRequests Off\nProxyPreserveHost On\n<IfModule mod_proxy.c>\n    ProxyPass \"/api/\" \"http://backend:5000/\"\n    ProxyPassReverse \"/api/\" \"http://backend:5000/\"\n</IfModule>\n\nErrorLog \"logs/error_log\"\nCustomLog \"logs/access_log\" combined"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom_no_tool/apache/public/index.html",
            "content": "<!DOCTYPE html>\n<html>\n<head><title>Vulnerable Apache</title></head>\n<body>\n<h1>Apache Server vulnerable to CVE-2021-42013</h1>\n<p>Use /api/ endpoint to reach the backend.</p>\n</body>\n</html>"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom_no_tool/backend/Dockerfile",
            "content": "FROM python:3.9-slim\nENV PYTHONUNBUFFERED=1\nWORKDIR /app\nCOPY requirements.txt ./\nRUN apt-get update && apt-get install -y --no-install-recommends curl \\\n    && pip install --no-cache-dir -r requirements.txt \\\n    && rm -rf /var/lib/apt/lists/*\nCOPY app.py ./\nEXPOSE 5000\nCMD [\"python\", \"app.py\"]"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom_no_tool/backend/requirements.txt",
            "content": "Flask==2.0.3\nWerkzeug==2.1.2"
        },
        {
            "location": "./../../dockers/CVE-2021-42013/custom_no_tool/backend/app.py",
            "content": "from flask import Flask, jsonify\n\napp = Flask(__name__)\n\n@app.route('/')\ndef home():\n    return jsonify({\"message\": \"Backend service reachable\"})\n\n# Endpoint that matches the Apache ProxyPass configuration (both with and without trailing slash)\n@app.route('/api/')\n@app.route('/api')\ndef api_root():\n    return jsonify({\"message\": \"API endpoint reachable via Apache proxy\"})\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000, debug=False)"
        }
    ],
    "directory_tree": "CVE-2021-42013/custom_no_tool"
}