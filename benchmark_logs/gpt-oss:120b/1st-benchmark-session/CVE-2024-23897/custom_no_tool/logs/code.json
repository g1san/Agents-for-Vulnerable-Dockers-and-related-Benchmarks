{
    "files": [
        {
            "location": "./../../dockers/CVE-2024-23897/custom_no_tool/docker-compose.yml",
            "content": "services:\n  vulnerable-app:\n    build: .\n    environment:\n      - VULN=1\n    restart: unless-stopped\n    networks:\n      - appnet\n\n  jenkins:\n    image: jenkins/jenkins:2.426.2\n    ports:\n      - \"8080:8080\"\n    restart: unless-stopped\n    networks:\n      - appnet\n\n  nginx:\n    image: nginx:1.27.2\n    ports:\n      - \"80:80\"\n    volumes:\n      - ./nginx/conf.d:/etc/nginx/conf.d:ro\n    restart: unless-stopped\n    depends_on:\n      - vulnerable-app\n    networks:\n      - appnet\n\nnetworks:\n  appnet:\n    driver: bridge"
        },
        {
            "location": "./../../dockers/CVE-2024-23897/custom_no_tool/Dockerfile",
            "content": "FROM php:8.2-apache\n\n# Install dependencies for the vulnerable imagick extension (example version vulnerable to CVE-2024-23897)\nRUN apt-get update && \\\n    apt-get install -y libmagickwand-dev && \\\n    pecl install imagick-3.7.0 && \\\n    docker-php-ext-enable imagick && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Copy the vulnerable application code\nCOPY src/ /var/www/html/\n\n# Set proper permissions\nRUN chown -R www-data:www-data /var/www/html"
        },
        {
            "location": "./../../dockers/CVE-2024-23897/custom_no_tool/src/index.php",
            "content": "<?php\n// Simple PHP page that triggers the vulnerable imagick function\n// This code is intentionally insecure for CVE-2024-23897 testing purposes\n\nif (isset($_GET['image'])) {\n    $imagePath = $_GET['image'];\n    // The vulnerable function that can be abused via specially crafted image files\n    $imagick = new Imagick();\n    $imagick->readImage($imagePath);\n    header('Content-Type: image/png');\n    echo $imagick->getImageBlob();\n} else {\n    echo '<h1>CVE-2024-23897 Demo</h1>';\n    echo '<p>Provide an image URL via the <code>image</code> query parameter to trigger the vulnerability.</p>';\n    echo '<p>Example: <code>?image=http://example.com/malicious.png</code></p>';\n}\n?>"
        },
        {
            "location": "./../../dockers/CVE-2024-23897/custom_no_tool/src/.htaccess",
            "content": "Options +Indexes\nAllowOverride All"
        },
        {
            "location": "./../../dockers/CVE-2024-23897/custom_no_tool/nginx/conf.d/default.conf",
            "content": "server {\n    listen 80;\n    server_name _;\n\n    # Proxy to the vulnerable PHP application\n    location /app/ {\n        proxy_pass http://vulnerable-app:80/;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    }\n\n    # Optional direct access to Jenkins (also reachable on host port 8080)\n    location /jenkins/ {\n        proxy_pass http://jenkins:8080/;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    }\n}"
        }
    ],
    "directory_tree": "CVE-2024-23897/custom_no_tool"
}