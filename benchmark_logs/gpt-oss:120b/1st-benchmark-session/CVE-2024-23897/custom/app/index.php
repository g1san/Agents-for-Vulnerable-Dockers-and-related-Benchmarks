<?php
$redis = new Redis();
$redis->connect(getenv('REDIS_HOST'), getenv('REDIS_PORT'));
// Simulate vulnerable deserialization
if (isset($_GET['payload'])) {
    $data = $_GET['payload'];
    // Unsafe unserialize for demonstration of CVE-2024-23897
    $obj = unserialize(base64_decode($data));
    echo "Deserialized object: " . print_r($obj, true);
} else {
    echo "Send a payload via ?payload=BASE64_ENCODED_STRING";
}
?>
