{
    "files": [
        {
            "location": "./../../dockers/CVE-2024-23897/custom/docker-compose.yml",
            "content": "version: '3.8'\nservices:\n  jenkins:\n    image: jenkins/jenkins:2.441\n    container_name: jenkins\n    ports:\n      - \"8080:8080\"\n    environment:\n      - JAVA_OPTS=-Djenkins.install.runSetupWizard=false\n    volumes:\n      - jenkins_home:/var/jenkins_home\n    depends_on:\n      - postgres\n  postgres:\n    image: postgres:15\n    container_name: postgres\n    environment:\n      - POSTGRES_USER=jenkins\n      - POSTGRES_PASSWORD=secret\n      - POSTGRES_DB=jenkins\n    ports:\n      - \"5432:5432\"\n    volumes:\n      - pg_data:/var/lib/postgresql/data\n      - ./init.sql:/docker-entrypoint-initdb.d/init.sql\n  vulnerable-app:\n    image: php:8.2-apache\n    container_name: vulnerable_app\n    ports:\n      - \"8081:80\"\n    volumes:\n      - ./app:/var/www/html\n    depends_on:\n      - vulnerable-redis\n    environment:\n      - REDIS_HOST=vulnerable-redis\n      - REDIS_PORT=6379\n  vulnerable-redis:\n    image: redis:6.0\n    container_name: vulnerable_redis\n    ports:\n      - \"6379:6379\"\n    command: [\"redis-server\", \"--protected-mode\", \"no\", \"--loglevel\", \"warning\"]\n    volumes:\n      - redis-data:/data\nvolumes:\n  jenkins_home:\n  pg_data:\n  redis-data:\n"
        },
        {
            "location": "./../../dockers/CVE-2024-23897/custom/init.sql",
            "content": "CREATE TABLE test (id SERIAL PRIMARY KEY, name TEXT);\nINSERT INTO test (name) VALUES ('sample');\n"
        },
        {
            "location": "./../../dockers/CVE-2024-23897/custom/app/index.php",
            "content": "<?php\n$redis = new Redis();\n$redis->connect(getenv('REDIS_HOST'), getenv('REDIS_PORT'));\n// Simulate vulnerable deserialization\nif (isset($_GET['payload'])) {\n    $data = $_GET['payload'];\n    // Unsafe unserialize for demonstration of CVE-2024-23897\n    $obj = unserialize(base64_decode($data));\n    echo \"Deserialized object: \" . print_r($obj, true);\n} else {\n    echo \"Send a payload via ?payload=BASE64_ENCODED_STRING\";\n}\n?>\n"
        },
        {
            "location": "./../../dockers/CVE-2024-23897/custom/app/.htaccess",
            "content": "Options +Indexes\n"
        }
    ],
    "directory_tree": "CVE-2024-23897/custom"
}