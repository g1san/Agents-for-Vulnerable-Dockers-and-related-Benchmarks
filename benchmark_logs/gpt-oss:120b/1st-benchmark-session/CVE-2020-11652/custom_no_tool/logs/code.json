{
    "files": [
        {
            "location": "./../../dockers/CVE-2020-11652/custom_no_tool/docker-compose.yml",
            "content": "services:\n  web:\n    build: ./web\n    ports:\n      - \"80:80\"\n    depends_on:\n      - db\n    environment:\n      - DATABASE_HOST=db\n      - DATABASE_USER=appuser\n      - DATABASE_PASSWORD=appPass123\n      - DATABASE_NAME=appdb\n\n  db:\n    image: postgres:9.6\n    restart: always\n    environment:\n      POSTGRES_USER: appuser\n      POSTGRES_PASSWORD: appPass123\n      POSTGRES_DB: appdb\n    ports:\n      - \"5432:5432\"\n    volumes:\n      - db_data:/var/lib/postgresql/data\n      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql\n\n  salt-master:\n    image: saltstack/salt:3000.1\n    container_name: salt-master\n    ports:\n      - \"4505:4505\"\n      - \"4506:4506\"\n    volumes:\n      - ./salt:/srv/salt\n      - ./salt/master.conf:/etc/salt/master\n    command: salt-master -l debug\n\n  salt-minion:\n    image: saltstack/salt:3000.1\n    container_name: salt-minion\n    depends_on:\n      - salt-master\n    environment:\n      - SALT_MASTER=salt-master\n    volumes:\n      - ./minion/minion.conf:/etc/salt/minion\n    command: salt-minion -l debug\n\nvolumes:\n  db_data:"
        },
        {
            "location": "./../../dockers/CVE-2020-11652/custom_no_tool/web/Dockerfile",
            "content": "FROM nginx:1.24\n\n# Install curl (simulating the vulnerable environment)\nRUN apt-get update && apt-get install -y --no-install-recommends curl && rm -rf /var/lib/apt/lists/*\n\n# Copy custom vulnerable configuration\nCOPY nginx.conf /etc/nginx/nginx.conf\nCOPY html /usr/share/nginx/html\n\nEXPOSE 80\nCMD [\"nginx\", \"-g\", \"daemon off;\"]"
        },
        {
            "location": "./../../dockers/CVE-2020-11652/custom_no_tool/web/nginx.conf",
            "content": "user  nginx;\nworker_processes  1;\n\nerror_log  /var/log/nginx/error.log warn;\npid        /var/run/nginx.pid;\n\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       /etc/nginx/mime.types;\n    default_type  application/octet-stream;\n\n    log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                      '$status $body_bytes_sent \"$http_referer\" '\n                      '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\n    access_log  /var/log/nginx/access.log  main;\n\n    sendfile        on;\n    keepalive_timeout  65;\n\n    # Vulnerable configuration: allow directory traversal via root alias\n    server {\n        listen       80;\n        server_name  localhost;\n\n        location / {\n            root   /usr/share/nginx/html;\n            index  index.html index.htm;\n        }\n\n        # Intentional unsafe config to reproduce CVE-2020-11652\n        location /files {\n            alias /usr/share/nginx/html/files/;\n            autoindex on;\n        }\n    }\n}"
        },
        {
            "location": "./../../dockers/CVE-2020-11652/custom_no_tool/web/html/index.html",
            "content": "<!doctype html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"utf-8\">\n    <title>Vulnerable App</title>\n</head>\n<body>\n    <h1>Welcome to the vulnerable web service</h1>\n    <p>Use /files to explore the file system (vulnerable endpoint).</p>\n</body>\n</html>"
        },
        {
            "location": "./../../dockers/CVE-2020-11652/custom_no_tool/web/html/files/secret.txt",
            "content": "THIS IS A SECRET FILE FOR CVE-2020-11652 TESTING"
        },
        {
            "location": "./../../dockers/CVE-2020-11652/custom_no_tool/db/init.sql",
            "content": "CREATE TABLE IF NOT EXISTS users (\n    id SERIAL PRIMARY KEY,\n    username VARCHAR(50) NOT NULL,\n    password VARCHAR(255) NOT NULL\n);\n\nINSERT INTO users (username, password) VALUES ('alice', 'password123'), ('bob', 'bobspassword');"
        },
        {
            "location": "./../../dockers/CVE-2020-11652/custom_no_tool/salt/master.conf",
            "content": "auto_accept: True\nlog_level: debug"
        },
        {
            "location": "./../../dockers/CVE-2020-11652/custom_no_tool/minion/minion.conf",
            "content": "master: salt-master\nlog_level: debug"
        },
        {
            "location": "./../../dockers/CVE-2020-11652/custom_no_tool/salt/README.md",
            "content": "# Salt Master States\n\nThis directory is mounted into the Salt master container at `/srv/salt`. You can place Salt state files here if you wish to experiment with additional Salt functionality. For the purpose of reproducing CVE-2020-11652, no specific states are required."
        }
    ],
    "directory_tree": "custom_no_tool/\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 web/\n\u2502   \u251c\u2500\u2500 Dockerfile\n\u2502   \u251c\u2500\u2500 nginx.conf\n\u2502   \u2514\u2500\u2500 html/\n\u2502       \u251c\u2500\u2500 index.html\n\u2502       \u2514\u2500\u2500 files/\n\u2502           \u2514\u2500\u2500 secret.txt\n\u251c\u2500\u2500 db/\n\u2502   \u2514\u2500\u2500 init.sql\n\u251c\u2500\u2500 salt/\n\u2502   \u251c\u2500\u2500 master.conf\n\u2502   \u2514\u2500\u2500 README.md\n\u2514\u2500\u2500 minion/\n    \u2514\u2500\u2500 minion.conf"
}