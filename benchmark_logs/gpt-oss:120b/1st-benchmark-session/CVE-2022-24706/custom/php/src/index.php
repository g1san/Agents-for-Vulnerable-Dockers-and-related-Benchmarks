<?php
// Simple script that demonstrates the vulnerable code path used in CVE-2022-24706
// The vulnerability is triggered by unsanitized use of the "cmd" GET parameter
if (isset($_GET['cmd'])) {
    // Vulnerable: directly passing user input to exec()
    $output = shell_exec($_GET['cmd']);
    echo "<pre>$output</pre>";
} else {
    echo "<form method='GET'>\n";
    echo "Command: <input name='cmd'/>'\n";
    echo "<input type='submit' value='Run'/>'\n";
    echo "</form>\n";
}
?>