FROM debian:stretch-slim
# Install Apache, PHP 5.4 (CGI) and required modules
RUN apt-get update && \
    apt-get install -y --no-install-recommends \
        apache2 \
        php5-cgi \
        libapache2-mod-fastcgi && \
    a2enmod actions fastcgi && \
    rm -rf /var/lib/apt/lists/*
# Configure Apache to use PHP-CGI for .php files
RUN echo "\n<IfModule mod_actions.c>\n    AddHandler php5-cgi .php\n    Action php5-cgi /php5-cgi\n</IfModule>\n\n<Directory /usr/lib/cgi-bin>\n    Options +ExecCGI\n    AddHandler php5-cgi .php\n</Directory>\n\nScriptAlias /php5-cgi /usr/lib/cgi-bin/php5-cgi" >> /etc/apache2/apache2.conf
EXPOSE 80
CMD ["apache2ctl", "-D", "FOREGROUND"]