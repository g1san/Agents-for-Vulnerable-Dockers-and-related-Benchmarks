{
    "files": [
        {
            "location": "./../../dockers/CVE-2012-1823/custom/docker-compose.yml",
            "content": "services:\n  vulnerable:\n    build:\n      context: ./vulnerable\n    restart: unless-stopped\n    ports:\n      - \"8080:80\"\n    volumes:\n      - ./php/index.php:/var/www/html/index.php:ro\n  nginx:\n    image: nginx:1.25.3\n    restart: unless-stopped\n    ports:\n      - \"80:80\"\n    volumes:\n      - ./nginx/conf.d:/etc/nginx/conf.d:ro\n    depends_on:\n      - vulnerable"
        },
        {
            "location": "./../../dockers/CVE-2012-1823/custom/vulnerable/Dockerfile",
            "content": "FROM debian:stretch-slim\n# Install Apache, PHP 5.4 (CGI) and required modules\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends \\\n        apache2 \\\n        php5-cgi \\\n        libapache2-mod-fastcgi && \\\n    a2enmod actions fastcgi && \\\n    rm -rf /var/lib/apt/lists/*\n# Configure Apache to use PHP-CGI for .php files\nRUN echo \"\\n<IfModule mod_actions.c>\\n    AddHandler php5-cgi .php\\n    Action php5-cgi /php5-cgi\\n</IfModule>\\n\\n<Directory /usr/lib/cgi-bin>\\n    Options +ExecCGI\\n    AddHandler php5-cgi .php\\n</Directory>\\n\\nScriptAlias /php5-cgi /usr/lib/cgi-bin/php5-cgi\" >> /etc/apache2/apache2.conf\nEXPOSE 80\nCMD [\"apache2ctl\", \"-D\", \"FOREGROUND\"]"
        },
        {
            "location": "./../../dockers/CVE-2012-1823/custom/php/index.php",
            "content": "<?php\n// Simple script to demonstrate CVE-2012-1823 vulnerability\n// The vulnerability can be triggered via crafted query strings\nphpinfo();\n?>"
        },
        {
            "location": "./../../dockers/CVE-2012-1823/custom/nginx/conf.d/default.conf",
            "content": "server {\n    listen 80;\n    server_name _;\n    location / {\n        proxy_pass http://vulnerable:80;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    }\n}"
        }
    ],
    "directory_tree": "./../../dockers/CVE-2012-1823/custom"
}