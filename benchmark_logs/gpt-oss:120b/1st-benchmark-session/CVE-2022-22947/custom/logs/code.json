{
    "files": [
        {
            "location": "./../../dockers/CVE-2022-22947/custom/docker-compose.yml",
            "content": "services:\n  downstream:\n    build:\n      context: ./downstream\n    container_name: downstream\n    ports:\n      - \"8080:8080\"\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8080/actuator/health\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n  gateway:\n    build:\n      context: ./gateway\n    container_name: gateway\n    ports:\n      - \"8080:8080\"\n    depends_on:\n      downstream:\n        condition: service_healthy\n    environment:\n      - SPRING_APPLICATION_JSON={\"downstream.url\":\"http://downstream:8080\"}\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8080/actuator/health\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5"
        },
        {
            "location": "./../../dockers/CVE-2022-22947/custom/gateway/Dockerfile",
            "content": "FROM maven:3.9.6-amazoncorretto-17 AS build\nWORKDIR /app\nCOPY . /app\nRUN mvn -B -DskipTests package\n\nFROM amazoncorretto:17-alpine AS runtime\nWORKDIR /app\n# install curl for healthcheck (the base image is Alpine based)\nRUN apk add --no-cache curl\nCOPY --from=build /app/target/gateway-0.0.1-SNAPSHOT.jar app.jar\nENTRYPOINT [\"java\",\"-jar\",\"app.jar\"]"
        },
        {
            "location": "./../../dockers/CVE-2022-22947/custom/gateway/pom.xml",
            "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n    <groupId>com.example</groupId>\n    <artifactId>gateway</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <packaging>jar</packaging>\n    <name>gateway</name>\n    <description>Gateway service for CVE-2022-22947</description>\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.6.6</version>\n        <relativePath/> <!-- lookup parent from repository -->\n    </parent>\n    <properties>\n        <java.version>17</java.version>\n    </properties>\n    <dependencyManagement>\n        <dependencies>\n            <dependency>\n                <groupId>org.springframework.cloud</groupId>\n                <artifactId>spring-cloud-dependencies</artifactId>\n                <version>2021.0.7</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n        </dependencies>\n    </dependencyManagement>\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-webflux</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-actuator</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-gateway</artifactId>\n            <version>3.1.3</version>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-test</artifactId>\n            <scope>test</scope>\n        </dependency>\n    </dependencies>\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n            </plugin>\n        </plugins>\n    </build>\n</project>"
        },
        {
            "location": "./../../dockers/CVE-2022-22947/custom/gateway/application.yml",
            "content": "server:\n  port: 8080\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: \"*\""
        },
        {
            "location": "./../../dockers/CVE-2022-22947/custom/gateway/GatewayApplication.java",
            "content": "package com.example.gateway;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class GatewayApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(GatewayApplication.class, args);\n    }\n}"
        },
        {
            "location": "./../../dockers/CVE-2022-22947/custom/downstream/Dockerfile",
            "content": "FROM maven:3.9.6-amazoncorretto-17 AS build\nWORKDIR /app\nCOPY . /app\nRUN mvn -B -DskipTests package\n\nFROM amazoncorretto:17-alpine\nWORKDIR /app\n# install curl for healthcheck\nRUN apk add --no-cache curl\nCOPY --from=build /app/target/downstream-0.0.1-SNAPSHOT.jar app.jar\nENTRYPOINT [\"java\",\"-jar\",\"app.jar\"]"
        },
        {
            "location": "./../../dockers/CVE-2022-22947/custom/downstream/pom.xml",
            "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n    <groupId>com.example</groupId>\n    <artifactId>downstream</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <packaging>jar</packaging>\n    <name>downstream</name>\n    <description>Downstream service for CVE-2022-22947</description>\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.6.6</version>\n        <relativePath/> <!-- lookup parent from repository -->\n    </parent>\n    <properties>\n        <java.version>17</java.version>\n    </properties>\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-actuator</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-test</artifactId>\n            <scope>test</scope>\n        </dependency>\n    </dependencies>\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n            </plugin>\n        </plugins>\n    </build>\n</project>"
        },
        {
            "location": "./../../dockers/CVE-2022-22947/custom/downstream/application.yml",
            "content": "server:\n  port: 8080\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: \"*\""
        },
        {
            "location": "./../../dockers/CVE-2022-22947/custom/downstream/DownstreamApplication.java",
            "content": "package com.example.downstream;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class DownstreamApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(DownstreamApplication.class, args);\n    }\n}"
        }
    ],
    "directory_tree": "CVE-2022-22947/custom"
}