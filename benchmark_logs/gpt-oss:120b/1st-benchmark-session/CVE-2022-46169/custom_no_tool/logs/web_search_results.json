{
    "desc": "CVE\u20112022\u201146169 is a critical remote code execution flaw in the Cacti network\u2011monitoring web application. The vulnerability resides in the unauthenticated \\`remote_agent.php\\` endpoint (versions \u2264 1.2.22). An attacker can forge client IP headers (e.g., X\u2011Forwarded\u2011For) to bypass the IP\u2011based authentication check performed by \\`remote_client_authorized()\\`. Once authorized, the attacker can invoke the \\`polldata\\` action. The handler \\`poll_for_data()\\` builds a command line that includes the user\u2011supplied \\`poller_id\\` value without sanitisation and executes it via \\`proc_open\\`. By supplying a malicious payload such as \\`poller_id=;id\\`, arbitrary operating\u2011system commands are executed with the privileges of the web\u2011server user. The attack requires no credentials and can be carried out over the internet against any exposed Cacti instance running a vulnerable version. The impact is full system compromise (confidentiality, integrity and availability are all severely affected). The issue was fixed in Cacti 1.2.23 and 1.3.0.",
    "attack_type": "unauthenticated remote command execution",
    "services": [
        {
            "name": "cacti",
            "version": [
                "1.2.22",
                "1.2.21",
                "1.2.20",
                "1.2.19",
                "1.2.18",
                "1.2.17",
                "1.2.16",
                "1.2.15",
                "1.2.14",
                "1.2.13",
                "1.2.12",
                "1.2.11",
                "1.2.10",
                "1.2.9",
                "1.2.8",
                "1.2.7",
                "1.2.6",
                "1.2.5",
                "1.2.4",
                "1.2.3",
                "1.2.2",
                "1.2.1",
                "1.2.0",
                "1.1.38",
                "1.1.37",
                "1.1.36",
                "1.1.35",
                "1.1.34",
                "1.1.33",
                "1.1.32",
                "1.1.31",
                "1.1.30",
                "1.1.29",
                "1.1.28",
                "1.1.27",
                "1.1.26",
                "1.1.25",
                "1.1.24",
                "1.1.23",
                "1.1.22",
                "1.1.21",
                "1.1.20",
                "1.1.19",
                "1.1.18",
                "1.1.17",
                "1.1.16",
                "1.1.15",
                "1.1.14",
                "1.1.13",
                "1.1.12",
                "1.1.11",
                "1.1.10",
                "1.1.9",
                "1.1.8",
                "1.1.7",
                "1.1.6",
                "1.1.5",
                "1.1.4",
                "1.1.3",
                "1.1.2",
                "1.1.1",
                "1.1.0"
            ],
            "dependency_type": "HARD",
            "description": "Cacti web application containing the vulnerable remote_agent.php endpoint. This service provides the vulnerable code path required to reproduce CVE\u20112022\u201146169."
        },
        {
            "name": "mysql",
            "version": [
                "5.7"
            ],
            "dependency_type": "SOFT-DB",
            "description": "Relational database required by the Cacti application to store poller and host data."
        }
    ],
    "input_tokens": 9486,
    "output_tokens": 2396
}