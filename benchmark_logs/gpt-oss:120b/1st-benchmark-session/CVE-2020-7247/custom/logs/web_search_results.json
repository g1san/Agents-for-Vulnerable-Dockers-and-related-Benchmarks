{
    "desc": "CVE\u20112020\u20117247 is a remote code execution vulnerability in the OpenSMTPD mail transfer agent. The flaw resides in the `smtp_mailaddr()` function, which fails to properly sanitise the email address supplied in SMTP commands such as **MAIL FROM** and **RCPT TO**. When validation of the local\u2011part or domain part fails, the daemon incorrectly appends the server's default domain and treats the address as valid, later interpolating the unchecked value directly into a shell command that invokes the local mail delivery agent. This allows an unauthenticated attacker to inject arbitrary shell metacharacters via the SMTP session, causing the OpenSMTPD process \u2013 which normally runs with root privileges \u2013 to execute attacker\u2011controlled commands. The impact is full system compromise, as the attacker can obtain a root shell, install back\u2011doors, modify data, or otherwise control the host. The vulnerability is present in all OpenSMTPD releases prior to version 6.6.2 that contain the vulnerable code path (specifically after commit a8e222352f and before the 6.6.2 release). Exploitation is straightforward: connect to the SMTP port (25 or 587), issue a crafted `MAIL FROM:<; <payload> ;>` line, and the payload is executed. Proof\u2011of\u2011concept scripts exist in Python using the pwntools library, and manual exploitation can be performed with netcat or telnet. Mitigation consists of upgrading OpenSMTPD to version 6.6.2 or later, or applying the upstream patch that corrects the validation logic.",
    "attack_type": "remote code execution",
    "services": [
        {
            "name": "opensmtpd",
            "version": [
                "6.6.0",
                "6.6.1"
            ],
            "dependency_type": "HARD",
            "description": "Vulnerable OpenSMTPD daemon that contains the input\u2011validation flaw enabling remote code execution."
        },
        {
            "name": "ubuntu",
            "version": [
                "22.04"
            ],
            "dependency_type": "SOFT-BASE",
            "description": "Base operating system image required to run the OpenSMTPD container."
        }
    ],
    "input_tokens": 4272,
    "output_tokens": 1321,
    "query": "CVE-2020-7247 details"
}